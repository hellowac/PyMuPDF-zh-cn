<!doctype html>
<html class="no-js" lang="zh-CN">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="Artifex" name="author" />
<meta content="PyMuPDF 是一个高性能 Python 库，用于 PDF（及其他）文档的数据提取、分析、转换和操作。" name="description" />
<meta content="PDF Text Extraction, PDF Image Extraction, PDF Conversion, PDF Tables, PDF Splitting, PDF Creation, Pyodide, PyScript" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZTN4VTL9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZTN4VTL9M');
    </script>
    <link rel="author" title="关于此文档" href="about.html" /><link rel="index" title="索引" href="genindex.html" /><link rel="search" title="搜索" href="search.html" /><link rel="next" title="命令行界面" href="module.html" /><link rel="prev" title="低级接口" href="recipes-low-level-interfaces.html" />

    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/><!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>常见问题及其解决方案 - PyMuPDF 1.25.4 文档</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMuPDF 1.25.4 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/sidebar-logo-dark.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/sidebar-logo-light.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyMuPDF 1.25.4 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">关于/About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">功能比较</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-performance">性能</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-license">许可和版权</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf4llm/index.html">PyMuPDF4LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf-pro.html">PyMuPDF Pro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">用户指南/User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-basics.html">基础用法</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">PyMuPDF、LLM 和 RAG</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">资源</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">教程/How to Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="how-to-open-a-file.html">打开文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-text.html">文本</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-images.html">图片</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-annotations.html">注释</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-drawing-and-graphics.html">绘图和图形</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-stories.html">故事</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-journalling.html">日记</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-multiprocessing.html">多进程</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-ocr.html">OCR - 光学字符识别</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-optional-content.html">可选内容支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-low-level-interfaces.html">低级接口</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">常见问题及其解决方案</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API参考/API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="module.html">命令行界面</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="classes.html">类</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="annot.html">Annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="archive-class.html">Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="colorspace.html">Colorspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="displaylist.html">DisplayList</a></li>
<li class="toctree-l2"><a class="reference internal" href="document.html">Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-writer-class.html">DocumentWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="font.html">Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="irect.html">IRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="link.html">Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkdest.html">linkDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="outline.html">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixmap.html">Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="point.html">Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="quad.html">Quad</a></li>
<li class="toctree-l2"><a class="reference internal" href="rect.html">Rect</a></li>
<li class="toctree-l2"><a class="reference internal" href="shape.html">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="story-class.html">Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="textpage.html">TextPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="textwriter.html">TextWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="widget.html">Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml-class.html">Xml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algebra.html">几何对象的运算符代数</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lowlevel.html">低级函数和类</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html">函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="device.html">设备</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop_low.html">协同工作: DisplayList 和 TextPage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">常量和枚举</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">颜色数据库</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">其他/Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app1.html">附录 1：文本提取详细信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app2.html">附录 2：嵌入式文件的注意事项</a></li>
<li class="toctree-l1"><a class="reference internal" href="app3.html">附录 3：各类技术信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app4.html">附录 4：性能比较方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">更新日志</a></li>
<li class="toctree-l1"><a class="reference internal" href="znames.html">已废弃名称</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div style="display:flex;justify-content:space-between;align-items: center;">
    <form class="sidebar-search-container top" method="get" action="search.html" role="search" style="width:75%">
      <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
    <div class="discordLink" style="display:flex;align-items:center;margin-top: -5px;">
        <a href="https://discord.gg/TSpYGBW4eq" id="findOnDiscord" target=_blank>Find <b>#pymupdf</b> on <b>Discord</b></a>
        <a href="https://discord.gg/TSpYGBW4eq" target=_blank>
            <div style="width:30px;height:30px;margin-left:5px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
                    <defs>
                        <style>.discordLogoFill{fill:#5865f2;}</style>
                    </defs>
                    <g id="Discord_Logo" data-name="Discord Logo">
                        <path class="discordLogoFill" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                    </g>
                </svg>
            </div>
        </a>
    </div>

</div><section id="recipescommonissuesandtheirsolutions">
<span id="id1"></span><h1>常见问题及其解决方案<a class="headerlink" href="#recipescommonissuesandtheirsolutions" title="此标题的永久链接">#</a></h1>
<p>Common Issues and their Solutions</p>
<section id="pdf">
<h2>如何动态清理损坏的 <cite>PDF</cite><a class="headerlink" href="#pdf" title="此标题的永久链接">#</a></h2>
<p>How To Dynamically Clean Up Corrupt <cite>PDFs</cite></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">中文</label><div class="tab-content docutils container">
<p>此示例展示了 <cite>PyMuPDF</cite> 与其他 Python PDF 库的潜在结合使用方式（这里以优秀的纯 Python 包 <a class="reference external" href="https://pypi.python.org/pypi/pdfrw">pdfrw</a> 为例）。</p>
<p>如果需要一个干净、无损坏、已解压缩的 PDF，可以动态调用 PyMuPDF 来修复许多问题，如下所示:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pdfrw</span><span class="w"> </span><span class="kn">import</span> <span class="n">PdfReader</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="c1">#---------------------------------------</span>
<span class="c1"># “容错” PDF 读取器</span>
<span class="c1">#---------------------------------------</span>
<span class="k">def</span><span class="w"> </span><span class="nf">reader</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">idata</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># 读取 PDF 到内存</span>
    <span class="n">ibuffer</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">idata</span><span class="p">)</span>  <span class="c1"># 转换为流</span>
    <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PdfReader</span><span class="p">(</span><span class="n">ibuffer</span><span class="p">)</span>  <span class="c1"># 如果可以正常读取，则直接返回</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="c1"># 需要密码，或遇到问题的 PDF</span>
    <span class="c1"># 创建修复 / 解压缩 / 解密版本</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="n">ibuffer</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># 如果提供了密码，则解密</span>
        <span class="n">rc</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;密码错误&quot;</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">tobytes</span><span class="p">(</span><span class="n">garbage</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">deflate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">doc</span>  <span class="c1"># 关闭并删除 doc</span>
    <span class="k">return</span> <span class="n">PdfReader</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>  <span class="c1"># 让 pdfrw 重新尝试读取</span>

<span class="c1">#---------------------------------------</span>
<span class="c1"># 主程序</span>
<span class="c1">#---------------------------------------</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">reader</span><span class="p">(</span><span class="s2">&quot;pymupdf.pdf&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># 如有必要，提供密码</span>
<span class="nb">print</span> <span class="n">pdf</span><span class="o">.</span><span class="n">Info</span>
<span class="c1"># 进行后续处理</span>
</pre></div>
</div>
<p>使用命令行工具 <em>pdftk</em> （ <a class="reference external" href="https://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/">仅适用于 Windows</a> ，但据报道可在 <a class="reference external" href="https://www.winehq.org/">Wine</a> 下运行），也可以实现类似效果，详情见 <a class="reference external" href="http://www.overthere.co.uk/2013/07/22/improving-pypdf2-with-pdftk/">这里</a> 。但在该方法中，需要通过 <em>subprocess.Popen</em> 作为独立进程调用，并使用 stdin 和 stdout 进行通信。</p>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">英文</label><div class="tab-content docutils container">
<p>This shows a potential use of <cite>PyMuPDF</cite> with another Python PDF library (the excellent pure Python package <a class="reference external" href="https://pypi.python.org/pypi/pdfrw">pdfrw</a> is used here as an example).</p>
<p>If a clean, non-corrupt / decompressed PDF is needed, one could dynamically invoke PyMuPDF to recover from many problems like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pdfrw</span><span class="w"> </span><span class="kn">import</span> <span class="n">PdfReader</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="c1">#---------------------------------------</span>
<span class="c1"># &#39;Tolerant&#39; PDF reader</span>
<span class="c1">#---------------------------------------</span>
<span class="k">def</span><span class="w"> </span><span class="nf">reader</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">idata</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># read the PDF into memory and</span>
    <span class="n">ibuffer</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">idata</span><span class="p">)</span>  <span class="c1"># convert to stream</span>
    <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PdfReader</span><span class="p">(</span><span class="n">ibuffer</span><span class="p">)</span>  <span class="c1"># if this works: fine!</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="c1"># either we need a password or it is a problem-PDF</span>
    <span class="c1"># create a repaired / decompressed / decrypted version</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="n">ibuffer</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># decrypt if password provided</span>
        <span class="n">rc</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">authenticate</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;wrong password&quot;</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">tobytes</span><span class="p">(</span><span class="n">garbage</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">deflate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">doc</span>  <span class="c1"># close &amp; delete doc</span>
    <span class="k">return</span> <span class="n">PdfReader</span><span class="p">(</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>  <span class="c1"># let pdfrw retry</span>
<span class="c1">#---------------------------------------</span>
<span class="c1"># Main program</span>
<span class="c1">#---------------------------------------</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">reader</span><span class="p">(</span><span class="s2">&quot;pymupdf.pdf&quot;</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># include a password if necessary</span>
<span class="nb">print</span> <span class="n">pdf</span><span class="o">.</span><span class="n">Info</span>
<span class="c1"># do further processing</span>
</pre></div>
</div>
<p>With the command line utility <em>pdftk</em> (<a class="reference external" href="https://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/">available</a> for Windows only, but reported to also run under <a class="reference external" href="https://www.winehq.org/">Wine</a>) a similar result can be achieved, see <a class="reference external" href="http://www.overthere.co.uk/2013/07/22/improving-pypdf2-with-pdftk/">here</a>. However, you must invoke it as a separate process via <em>subprocess.Popen</em>, using stdin and stdout as communication vehicles.</p>
</div>
</div>
</section>
<section id="id5">
<h2>如何将任何文档转换为 <cite>PDF</cite><a class="headerlink" href="#id5" title="此标题的永久链接">#</a></h2>
<p>How to Convert Any Document to <cite>PDF</cite></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">中文</label><div class="tab-content docutils container">
<p>以下是一个脚本，它可以将 <cite>PyMuPDF</cite> <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">支持的文档</span></a> 转换为 <cite>PDF</cite>。支持的文件格式包括 XPS、EPUB、FB2、CBZ 以及图像格式（包括多页 TIFF）。</p>
<p>该脚本支持保留源文档的元数据、目录（书签）和链接:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">演示脚本：将输入文件转换为 PDF</span>
<span class="sd">-----------------------------------------</span>
<span class="sd">适用于 XPS、EPUB 等多页输入文件。</span>

<span class="sd">功能：</span>
<span class="sd">---------</span>
<span class="sd">1. 还原输入文件的目录（书签）和链接。</span>
<span class="sd">2. 目录的恢复通常较好，而链接仅在其类型不是 &quot;LINK_NAMED&quot; 时有效。</span>
<span class="sd">本脚本会跳过 &quot;LINK_NAMED&quot; 类型的链接。</span>
<span class="sd">3. XPS 和 EPUB 输入的内部链接通常属于 &quot;LINK_NAMED&quot; 类型，</span>
<span class="sd">由于 MuPDF 底层库不会自动解析这些链接到具体页码，因此无法直接恢复。</span>
<span class="sd">4. 了解这些文档格式结构的专家可以进一步解析和处理这些链接。</span>

<span class="sd">依赖项：</span>
<span class="sd">--------------</span>
<span class="sd">PyMuPDF v1.14.0+</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">VersionBind</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)))</span> <span class="o">&gt;=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">]):</span>
    <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="s2">&quot;需要 PyMuPDF v1.14.0+&quot;</span><span class="p">)</span>

<span class="n">fn</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;正在转换 &#39;</span><span class="si">%s</span><span class="s2">&#39; 为 &#39;</span><span class="si">%s</span><span class="s2">.pdf&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">fn</span><span class="p">))</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">convert_to_pdf</span><span class="p">()</span>  <span class="c1"># 转换为 PDF</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># 以 PDF 形式打开</span>

<span class="n">toc</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_toc</span><span class="p">()</span>  <span class="c1"># 读取输入文档的目录</span>
<span class="n">pdf</span><span class="o">.</span><span class="n">set_toc</span><span class="p">(</span><span class="n">toc</span><span class="p">)</span>  <span class="c1"># 直接应用到输出 PDF</span>
<span class="n">meta</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">metadata</span>  <span class="c1"># 读取并设置元数据</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;producer&quot;</span><span class="p">]:</span>
    <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;producer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PyMuPDF v&quot;</span> <span class="o">+</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">VersionBind</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;creator&quot;</span><span class="p">]:</span>
    <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;creator&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PyMuPDF PDF converter&quot;</span>

<span class="n">meta</span><span class="p">[</span><span class="s2">&quot;modDate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">get_pdf_now</span><span class="p">()</span>
<span class="n">meta</span><span class="p">[</span><span class="s2">&quot;creationDate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;modDate&quot;</span><span class="p">]</span>
<span class="n">pdf</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span>

<span class="c1"># 处理链接</span>
<span class="n">link_cnti</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">link_skip</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">pinput</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>  <span class="c1"># 遍历输入文档的每一页</span>
    <span class="n">links</span> <span class="o">=</span> <span class="n">pinput</span><span class="o">.</span><span class="n">get_links</span><span class="p">()</span>  <span class="c1"># 获取该页的所有链接</span>
    <span class="n">link_cnti</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">links</span><span class="p">)</span>  <span class="c1"># 统计链接总数</span>
    <span class="n">pout</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">[</span><span class="n">pinput</span><span class="o">.</span><span class="n">number</span><span class="p">]</span>  <span class="c1"># 获取对应的输出 PDF 页</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>  <span class="c1"># 遍历所有链接</span>
        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="s2">&quot;kind&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">LINK_NAMED</span><span class="p">:</span>  <span class="c1"># 不处理 &quot;LINK_NAMED&quot; 类型的链接</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;命名链接（跳过）: 页面&quot;</span><span class="p">,</span> <span class="n">pinput</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
            <span class="n">link_skip</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># 统计跳过的链接数量</span>
            <span class="k">continue</span>
        <span class="n">pout</span><span class="o">.</span><span class="n">insert_link</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>  <span class="c1"># 直接插入其他类型的链接</span>

<span class="c1"># 保存转换结果</span>
<span class="n">pdf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fn</span> <span class="o">+</span> <span class="s2">&quot;.pdf&quot;</span><span class="p">,</span> <span class="n">garbage</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">deflate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 输出跳过的命名链接数量</span>
<span class="k">if</span> <span class="n">link_cnti</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;在输入文件中，跳过了 </span><span class="si">%i</span><span class="s2"> 个命名链接，总计 </span><span class="si">%i</span><span class="s2"> 个链接。&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">link_skip</span><span class="p">,</span> <span class="n">link_cnti</span><span class="p">))</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">英文</label><div class="tab-content docutils container">
<p>Here is a script that converts any <cite>PyMuPDF</cite> <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">supported document</span></a> to a <cite>PDF</cite>. These include XPS, EPUB, FB2, CBZ and image formats, including multi-page TIFF images.</p>
<p>It features maintaining any metadata, table of contents and links contained in the source document:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Demo script: Convert input file to a PDF</span>
<span class="sd">-----------------------------------------</span>
<span class="sd">Intended for multi-page input files like XPS, EPUB etc.</span>

<span class="sd">Features:</span>
<span class="sd">---------</span>
<span class="sd">Recovery of table of contents and links of input file.</span>
<span class="sd">While this works well for bookmarks (outlines, table of contents),</span>
<span class="sd">links will only work if they are not of type &quot;LINK_NAMED&quot;.</span>
<span class="sd">This link type is skipped by the script.</span>

<span class="sd">For XPS and EPUB input, internal links however **are** of type &quot;LINK_NAMED&quot;.</span>
<span class="sd">Base library MuPDF does not resolve them to page numbers.</span>

<span class="sd">So, for anyone expert enough to know the internal structure of these</span>
<span class="sd">document types, can further interpret and resolve these link types.</span>

<span class="sd">Dependencies</span>
<span class="sd">--------------</span>
<span class="sd">PyMuPDF v1.14.0+</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>
<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">VersionBind</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)))</span> <span class="o">&gt;=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="s2">&quot;need PyMuPDF v1.14.0+&quot;</span><span class="p">)</span>
<span class="n">fn</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Converting &#39;</span><span class="si">%s</span><span class="s2">&#39; to &#39;</span><span class="si">%s</span><span class="s2">.pdf&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">fn</span><span class="p">))</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">convert_to_pdf</span><span class="p">()</span>  <span class="c1"># convert to pdf</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>  <span class="c1"># open as pdf</span>

<span class="n">toc</span><span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_toc</span><span class="p">()</span>  <span class="c1"># table of contents of input</span>
<span class="n">pdf</span><span class="o">.</span><span class="n">set_toc</span><span class="p">(</span><span class="n">toc</span><span class="p">)</span>  <span class="c1"># simply set it for output</span>
<span class="n">meta</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">metadata</span>  <span class="c1"># read and set metadata</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;producer&quot;</span><span class="p">]:</span>
    <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;producer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PyMuPDF v&quot;</span> <span class="o">+</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">VersionBind</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;creator&quot;</span><span class="p">]:</span>
    <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;creator&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;PyMuPDF PDF converter&quot;</span>
<span class="n">meta</span><span class="p">[</span><span class="s2">&quot;modDate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">get_pdf_now</span><span class="p">()</span>
<span class="n">meta</span><span class="p">[</span><span class="s2">&quot;creationDate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;modDate&quot;</span><span class="p">]</span>
<span class="n">pdf</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span>

<span class="c1"># now process the links</span>
<span class="n">link_cnti</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">link_skip</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">pinput</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>  <span class="c1"># iterate through input pages</span>
    <span class="n">links</span> <span class="o">=</span> <span class="n">pinput</span><span class="o">.</span><span class="n">get_links</span><span class="p">()</span>  <span class="c1"># get list of links</span>
    <span class="n">link_cnti</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">links</span><span class="p">)</span>  <span class="c1"># count how many</span>
    <span class="n">pout</span> <span class="o">=</span> <span class="n">pdf</span><span class="p">[</span><span class="n">pinput</span><span class="o">.</span><span class="n">number</span><span class="p">]</span>  <span class="c1"># read corresp. output page</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>  <span class="c1"># iterate though the links</span>
        <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="s2">&quot;kind&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">LINK_NAMED</span><span class="p">:</span>  <span class="c1"># we do not handle named links</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;named link page&quot;</span><span class="p">,</span> <span class="n">pinput</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
            <span class="n">link_skip</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># count them</span>
            <span class="k">continue</span>
        <span class="n">pout</span><span class="o">.</span><span class="n">insert_link</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>  <span class="c1"># simply output the others</span>

<span class="c1"># save the conversion result</span>
<span class="n">pdf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fn</span> <span class="o">+</span> <span class="s2">&quot;.pdf&quot;</span><span class="p">,</span> <span class="n">garbage</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">deflate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># say how many named links we skipped</span>
<span class="k">if</span> <span class="n">link_cnti</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Skipped </span><span class="si">%i</span><span class="s2"> named links of a total of </span><span class="si">%i</span><span class="s2"> in input.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">link_skip</span><span class="p">,</span> <span class="n">link_cnti</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h2>更改注释：意外行为<a class="headerlink" href="#id6" title="此标题的永久链接">#</a></h2>
<p>Changing Annotations: Unexpected Behaviour</p>
<section id="id7">
<h3>问题<a class="headerlink" href="#id7" title="此标题的永久链接">#</a></h3>
<p>Problem</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">中文</label><div class="tab-content docutils container">
<p>有两种情况可能会导致意外的注释变化：</p>
<ol class="arabic simple">
<li><p><strong>更新</strong> 由其他软件创建的注释时使用 PyMuPDF 进行修改。</p></li>
<li><p><strong>创建</strong> 注释时使用 PyMuPDF，然后稍后使用其他软件进行更改。</p></li>
</ol>
<p>在这两种情况下，您可能会遇到意外的变化，例如：</p>
<ul class="simple">
<li><p>注释图标或文本字体发生变化；</p></li>
<li><p>填充颜色或线条虚线样式丢失；</p></li>
<li><p>线条端点符号大小变化，甚至完全消失。</p></li>
</ul>
<p>这些问题可能是由于不同 PDF 处理软件对注释属性的解析方式不同所导致的。</p>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">英文</label><div class="tab-content docutils container">
<p>There are two scenarios:</p>
<ol class="arabic simple">
<li><p><strong>Updating</strong> an annotation with PyMuPDF which was created by some other software.</p></li>
<li><p><strong>Creating</strong> an annotation with PyMuPDF and later changing it with some other software.</p></li>
</ol>
<p>In both cases you may experience unintended changes, like a different annotation icon or text font, the fill color or line dashing have disappeared, line end symbols have changed their size or even have disappeared too, etc.</p>
</div>
</div>
</section>
<section id="id8">
<h3>原因<a class="headerlink" href="#id8" title="此标题的永久链接">#</a></h3>
<p>Cause</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">中文</label><div class="tab-content docutils container">
<p>不同的 PDF 维护应用程序对注释的处理方式各不相同。有些注释类型可能不受支持，或者某些细节的处理方式不同。<strong>没有统一的标准。</strong></p>
<p>通常，每个 PDF 应用程序都会有自己的图标（如文件附件、便笺和图章）以及一组受支持的文本字体。例如：</p>
<ul class="simple">
<li><p>(Py-) MuPDF 仅支持 5 种基本字体用于 ‘FreeText’ 注释：Helvetica、Times-Roman、Courier、ZapfDingbats 和 Symbol，不支持斜体或加粗变体。因此，在修改其他应用程序创建的 ‘FreeText’ 注释时，如果原始字体不被识别，它可能会被替换为 Helvetica。</p></li>
<li><p>PyMuPDF 支持所有 PDF 文本标注类型（高亮、下划线、删除线、波浪线），但这些标注类型无法在 Adobe Acrobat Reader 中更新。</p></li>
</ul>
<p>此外，对虚线样式的支持通常也有限，可能会导致原有的虚线被替换为实线。例如：</p>
<ul class="simple">
<li><p>PyMuPDF 完全支持所有虚线样式，而其他查看器可能仅支持有限的子集。</p></li>
</ul>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">英文</label><div class="tab-content docutils container">
<p>Annotation maintenance is handled differently by each PDF maintenance application. Some annotation types may not be supported, or not be supported fully or some details may be handled in a different way than in another application. <strong>There is no standard.</strong></p>
<p>Almost always a PDF application also comes with its own icons (file attachments, sticky notes and stamps) and its own set of supported text fonts. For example:</p>
<ul class="simple">
<li><p>(Py-) MuPDF only supports these 5 basic fonts for ‘FreeText’ annotations: Helvetica, Times-Roman, Courier, ZapfDingbats and Symbol – no italics / no bold variations. When changing a ‘FreeText’ annotation created by some other app, its font will probably not be recognized nor accepted and be replaced by Helvetica.</p></li>
<li><p>PyMuPDF supports all PDF text markers (highlight, underline, strikeout, squiggly), but these types cannot be updated with Adobe Acrobat Reader.</p></li>
</ul>
<p>In most cases there also exists limited support for line dashing which causes existing dashes to be replaced by straight lines. For example:</p>
<ul class="simple">
<li><p>PyMuPDF fully supports all line dashing forms, while other viewers only accept a limited subset.</p></li>
</ul>
</div>
</div>
</section>
<section id="id9">
<h3>解决方案<a class="headerlink" href="#id9" title="此标题的永久链接">#</a></h3>
<p>Solutions</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">中文</label><div class="tab-content docutils container">
<p>在大多数情况下，您可能无能为力，但可以尝试以下方法：</p>
<ol class="arabic simple">
<li><p><strong>始终使用相同的软件</strong> 来创建和修改注释。</p></li>
<li><p>在使用 PyMuPDF 修改“外部”软件创建的注释时，尽量 <strong>避免</strong> 调用 <a class="reference internal" href="annot.html#Annot.update" title="Annot.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.update()</span></code></a>。以下方法 <strong>无需调用它</strong> ，因此可以尽可能保持原始外观：</p></li>
</ol>
<ul class="simple">
<li><p><a class="reference internal" href="annot.html#Annot.set_rect" title="Annot.set_rect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_rect()</span></code></a> （更改位置）</p></li>
<li><p><a class="reference internal" href="annot.html#Annot.set_flags" title="Annot.set_flags"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_flags()</span></code></a> （更改注释行为）</p></li>
<li><p><a class="reference internal" href="annot.html#Annot.set_info" title="Annot.set_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_info()</span></code></a> （更改元信息，但不修改 <em>content</em>）</p></li>
<li><p><a class="reference internal" href="annot.html#Annot.set_popup" title="Annot.set_popup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_popup()</span></code></a> （创建弹出窗口或更改其矩形区域）</p></li>
<li><p><a class="reference internal" href="annot.html#Annot.set_oc" title="Annot.set_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_oc()</span></code></a> （添加 / 移除对可选内容的引用）</p></li>
<li><p><a class="reference internal" href="annot.html#Annot.set_open" title="Annot.set_open"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_open()</span></code></a> （设置注释的打开状态）</p></li>
<li><p><a class="reference internal" href="annot.html#Annot.update_file" title="Annot.update_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.update_file()</span></code></a> （修改附件文件）</p></li>
</ul>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">英文</label><div class="tab-content docutils container">
<p>Unfortunately there is not much you can do in most of these cases.</p>
<ol class="arabic simple">
<li><p>Stay with the same software for <strong>creating and changing</strong> an annotation.</p></li>
<li><p>When using PyMuPDF to change an “alien” annotation, try to <strong>avoid</strong> <a class="reference internal" href="annot.html#Annot.update" title="Annot.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.update()</span></code></a>. The following methods <strong>can be used without it,</strong> so that the original appearance should be maintained:</p></li>
</ol>
<ul class="simple">
<li><p><a class="reference internal" href="annot.html#Annot.set_rect" title="Annot.set_rect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_rect()</span></code></a> (location changes)</p></li>
<li><p><a class="reference internal" href="annot.html#Annot.set_flags" title="Annot.set_flags"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_flags()</span></code></a> (annotation behaviour)</p></li>
<li><p><a class="reference internal" href="annot.html#Annot.set_info" title="Annot.set_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_info()</span></code></a> (meta information, except changes to <em>content</em>)</p></li>
<li><p><a class="reference internal" href="annot.html#Annot.set_popup" title="Annot.set_popup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_popup()</span></code></a> (create popup or change its rect)</p></li>
<li><p><a class="reference internal" href="annot.html#Annot.set_oc" title="Annot.set_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_oc()</span></code></a> (add / remove reference to optional content information)</p></li>
<li><p><a class="reference internal" href="annot.html#Annot.set_open" title="Annot.set_open"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_open()</span></code></a></p></li>
<li><p><a class="reference internal" href="annot.html#Annot.update_file" title="Annot.update_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.update_file()</span></code></a> (file attachment changes)</p></li>
</ul>
</div>
</div>
</section>
</section>
<section id="id10">
<h2>提取的文本缺失或不可读<a class="headerlink" href="#id10" title="此标题的永久链接">#</a></h2>
<p>Missing or Unreadable Extracted Text</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">中文</label><div class="tab-content docutils container">
<p>很多时候，文本提取并不像您预期​​的那样：文本可能缺失，或者可能没有出现在屏幕上可见的阅读顺序中，或者包含乱码（例如？或“TOFU”符号）等。这可能是由许多不同的问题引起的。</p>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">英文</label><div class="tab-content docutils container">
<p>Fairly often, text extraction does not work text as you would expect: text may be missing, or may not appear in the reading sequence visible on your screen, or contain garbled characters (like a ? or a “TOFU” symbol), etc. This can be caused by a number of different problems.</p>
</div>
</div>
<section id="id11">
<h3>问题：未提取任何文本<a class="headerlink" href="#id11" title="此标题的永久链接">#</a></h3>
<p>Problem: no text is extracted</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">中文</label><div class="tab-content docutils container">
<p>您的 PDF 查看器确实显示文本，但您无法用光标选择它，并且文本提取没有任何效果。</p>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">英文</label><div class="tab-content docutils container">
<p>Your PDF viewer does display text, but you cannot select it with your cursor, and text extraction delivers nothing.</p>
</div>
</div>
</section>
<section id="id12">
<h3>原因<a class="headerlink" href="#id12" title="此标题的永久链接">#</a></h3>
<p>Cause</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">中文</label><div class="tab-content docutils container">
<ol class="arabic simple">
<li><p>您可能正在查看 PDF 页面中嵌入的图像（例如扫描的 PDF）。</p></li>
<li><p>PDF 创建者没有使用字体，而是通过使用小线条和曲线绘制文本来 <strong>模拟</strong> 文本。例如，大写字母“D”可以用直线“|”和左开半圆绘制，大写字母“o”可以用椭圆绘制，等等。</p></li>
</ol>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">英文</label><div class="tab-content docutils container">
<ol class="arabic simple">
<li><p>You may be looking at an image embedded in the PDF page (e.g. a scanned PDF).</p></li>
<li><p>The PDF creator used no font, but <strong>simulated</strong> text by painting it, using little lines and curves. E.g. a capital “D” could be painted by a line “|” and a left-open semi-circle, an “o” by an ellipse, and so on.</p></li>
</ol>
</div>
</div>
</section>
<section id="id13">
<h3>解决方案<a class="headerlink" href="#id13" title="此标题的永久链接">#</a></h3>
<p>Solution</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">中文</label><div class="tab-content docutils container">
<p>使用 OCR 软件（例如 <a class="reference external" href="https://pypi.org/project/ocrmypdf/">OCRmyPDF</a> ）在可见页面下方插入隐藏文本层。生成的 PDF 应按预期运行。</p>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">英文</label><div class="tab-content docutils container">
<p>Use an OCR software like <a class="reference external" href="https://pypi.org/project/ocrmypdf/">OCRmyPDF</a> to insert a hidden text layer underneath the visible page. The resulting PDF should behave as expected.</p>
</div>
</div>
</section>
<section id="id15">
<h3>问题：文本不可读<a class="headerlink" href="#id15" title="此标题的永久链接">#</a></h3>
<p>Problem: unreadable text</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">中文</label><div class="tab-content docutils container">
<p>文本提取未按可读顺序提供文本、重复某些文本或出现乱码。</p>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">英文</label><div class="tab-content docutils container">
<p>Text extraction does not deliver the text in readable order, duplicates some text, or is otherwise garbled.</p>
</div>
</div>
</section>
<section id="id16">
<h3>原因<a class="headerlink" href="#id16" title="此标题的永久链接">#</a></h3>
<p>Cause</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">中文</label><div class="tab-content docutils container">
<ol class="arabic simple">
<li><p>单个字符本身是可读的（没有“&lt;?&gt;”符号），但文本在 <strong>文件中的编码</strong> 顺序与阅读顺序不同。背后的动机可能是技术原因，或是为了保护数据免遭不必要的复制。</p></li>
<li><p>出现许多“&lt;?&gt;”符号，表明 MuPDF 无法解释这些字符。该字体可能确实不受 MuPDF 支持，或者 PDF 创建者可能使用了显示可读文本的字体，但故意混淆了原始的相应 unicode 字符。</p></li>
</ol>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">英文</label><div class="tab-content docutils container">
<ol class="arabic simple">
<li><p>The single characters are readable as such (no “&lt;?&gt;” symbols), but the sequence in which the text is <strong>coded in the file</strong> deviates from the reading order. The motivation behind may be technical or protection of data against unwanted copies.</p></li>
<li><p>Many “&lt;?&gt;” symbols occur, indicating MuPDF could not interpret these characters. The font may indeed be unsupported by MuPDF, or the PDF creator may haved used a font that displays readable text, but on purpose obfuscates the originating corresponding unicode character.</p></li>
</ol>
</div>
</div>
</section>
<section id="id17">
<h3>解决方案<a class="headerlink" href="#id17" title="此标题的永久链接">#</a></h3>
<p>Solution</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--11-input--1" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--1">中文</label><div class="tab-content docutils container">
<ol class="arabic simple">
<li><p>使用保留布局的文本提取： <code class="xref any docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">fitz</span> <span class="pre">gettext</span> <span class="pre">file.pdf</span></code> 。</p></li>
<li><p>如果其他文本提取工具也不起作用，那么唯一的解决方案就是对页面进行 OCR 处理。</p></li>
</ol>
</div>
<input class="tab-input" id="tab-set--11-input--2" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--2">英文</label><div class="tab-content docutils container">
<ol class="arabic simple">
<li><p>Use layout preserving text extraction: <code class="xref any docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">fitz</span> <span class="pre">gettext</span> <span class="pre">file.pdf</span></code>.</p></li>
<li><p>If other text extraction tools also don’t work, then the only solution again is OCRing the page.</p></li>
</ol>
</div>
</div>
<div class="feedbackLink"><a id="feedbackLinkBottom" target=_blank>您对此页面有任何反馈吗？</b></a></div><hr class="docutils" />
<script>

   var url_string = window.location.href;
   var a = document.getElementById('feedbackLinkBottom');
   a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link&url="+url_string);

</script>

<p style="color:#999" id="footerDisclaimer">本软件按原样提供，不作任何明示或暗示担保。本软件根据许可分发，除非根据该许可条款明确授权，否则不得复制、修改或分发。请参阅 <a href="https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link">artifex.com</a> 上的许可信息，或联系 Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States 了解更多信息。</p>



<script>

   let docLanguage = document.getElementsByTagName('html')[0].getAttribute('lang');

   function getHeaderAndFooterTranslation(str) {
       if (docLanguage == "ja") {
           if (str == "Do you have any feedback on this page?") {
               return "このページに関するご意見はありますか？";
           } else if (str == "Find <b>#pymupdf</b> on <b>Discord</b>") {
               return "<b>Discord</b>の <b>#pymupdf</b> を見つける";
           } else if (str == "This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.") {

               return "このソフトウェアは無保証で提供されており、明示または黙示を問わず、いかなる保証もありません。このソフトウェアはライセンスの下で配布され、ライセンスの条件に明示的に許可されている場合を除き、コピー、変更、または配布してはなりません。ライセンシング情報については、<a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a>でライセンス情報を参照するか、アメリカ合衆国カリフォルニア州サンフランシスコのArtifex Software Inc. までお問い合わせください。"

           }
       }

       return str;
   }

   document.getElementById("findOnDiscord").innerHTML = getHeaderAndFooterTranslation("Find <b>#pymupdf</b> on <b>Discord</b>");
   document.getElementById("feedbackLinkTop").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("feedbackLinkBottom").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("footerDisclaimer").innerHTML = getHeaderAndFooterTranslation("This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.");


   // more translation for admonition-title as the in-built translation isn't great, needs: 注釈 -> 注
   if (docLanguage == "ja") {
       const collection = document.getElementsByClassName("admonition-title");
       for (var i=0;i<collection.length;i++) {
           collection[i].innerHTML = "注";
       }
   }


</script><p class="footer-version">This documentation covers all versions up to 1.25.4.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="module.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">命令行界面</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="recipes-low-level-interfaces.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">低级接口</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2025, Artifex
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 19. 3月 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">常见问题及其解决方案</a><ul>
<li><a class="reference internal" href="#pdf">如何动态清理损坏的 <cite>PDF</cite></a></li>
<li><a class="reference internal" href="#id5">如何将任何文档转换为 <cite>PDF</cite></a></li>
<li><a class="reference internal" href="#id6">更改注释：意外行为</a><ul>
<li><a class="reference internal" href="#id7">问题</a></li>
<li><a class="reference internal" href="#id8">原因</a></li>
<li><a class="reference internal" href="#id9">解决方案</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id10">提取的文本缺失或不可读</a><ul>
<li><a class="reference internal" href="#id11">问题：未提取任何文本</a></li>
<li><a class="reference internal" href="#id12">原因</a></li>
<li><a class="reference internal" href="#id13">解决方案</a></li>
<li><a class="reference internal" href="#id15">问题：文本不可读</a></li>
<li><a class="reference internal" href="#id16">原因</a></li>
<li><a class="reference internal" href="#id17">解决方案</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/tabs.js"></script>
    <script src="_static/translations.js"></script>
    </body>
</html>