<!doctype html>
<html class="no-js" lang="zh-CN">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="Artifex" name="author" />
<meta content="PyMuPDF 是一个高性能 Python 库，用于 PDF（及其他）文档的数据提取、分析、转换和操作。" name="description" />
<meta content="PDF Text Extraction, PDF Image Extraction, PDF Conversion, PDF Tables, PDF Splitting, PDF Creation, Pyodide, PyScript" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZTN4VTL9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZTN4VTL9M');
    </script>
    <link rel="author" title="关于此文档" href="about.html" /><link rel="index" title="索引" href="genindex.html" /><link rel="search" title="搜索" href="search.html" /><link rel="next" title="类" href="classes.html" /><link rel="prev" title="常见问题及其解决方案" href="recipes-common-issues-and-their-solutions.html" />

    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/><!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>命令行界面 - PyMuPDF 1.25.4 文档</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMuPDF 1.25.4 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/sidebar-logo-dark.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/sidebar-logo-light.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyMuPDF 1.25.4 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">关于/About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">功能比较</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-performance">性能</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-license">许可和版权</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf4llm/index.html">PyMuPDF4LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf-pro.html">PyMuPDF Pro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">用户指南/User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-basics.html">基础用法</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">PyMuPDF、LLM 和 RAG</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">资源</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">教程/How to Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how-to-open-a-file.html">打开文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-text.html">文本</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-images.html">图片</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-annotations.html">注释</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-drawing-and-graphics.html">绘图和图形</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-stories.html">故事</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-journalling.html">日记</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-multiprocessing.html">多进程</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-ocr.html">OCR - 光学字符识别</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-optional-content.html">可选内容支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-low-level-interfaces.html">低级接口</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-common-issues-and-their-solutions.html">常见问题及其解决方案</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API参考/API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">命令行界面</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="classes.html">类</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="annot.html">Annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="archive-class.html">Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="colorspace.html">Colorspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="displaylist.html">DisplayList</a></li>
<li class="toctree-l2"><a class="reference internal" href="document.html">Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-writer-class.html">DocumentWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="font.html">Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="irect.html">IRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="link.html">Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkdest.html">linkDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="outline.html">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixmap.html">Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="point.html">Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="quad.html">Quad</a></li>
<li class="toctree-l2"><a class="reference internal" href="rect.html">Rect</a></li>
<li class="toctree-l2"><a class="reference internal" href="shape.html">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="story-class.html">Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="textpage.html">TextPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="textwriter.html">TextWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="widget.html">Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml-class.html">Xml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algebra.html">几何对象的运算符代数</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lowlevel.html">低级函数和类</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html">函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="device.html">设备</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop_low.html">协同工作: DisplayList 和 TextPage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">常量和枚举</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">颜色数据库</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">其他/Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app1.html">附录 1：文本提取详细信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app2.html">附录 2：嵌入式文件的注意事项</a></li>
<li class="toctree-l1"><a class="reference internal" href="app3.html">附录 3：各类技术信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app4.html">附录 4：性能比较方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">更新日志</a></li>
<li class="toctree-l1"><a class="reference internal" href="znames.html">已废弃名称</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div style="display:flex;justify-content:space-between;align-items: center;">
    <form class="sidebar-search-container top" method="get" action="search.html" role="search" style="width:75%">
      <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
    <div class="discordLink" style="display:flex;align-items:center;margin-top: -5px;">
        <a href="https://discord.gg/TSpYGBW4eq" id="findOnDiscord" target=_blank>Find <b>#pymupdf</b> on <b>Discord</b></a>
        <a href="https://discord.gg/TSpYGBW4eq" target=_blank>
            <div style="width:30px;height:30px;margin-left:5px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
                    <defs>
                        <style>.discordLogoFill{fill:#5865f2;}</style>
                    </defs>
                    <g id="Discord_Logo" data-name="Discord Logo">
                        <path class="discordLogoFill" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                    </g>
                </svg>
            </div>
        </a>
    </div>

</div><section id="module">
<span id="id1"></span><h1>命令行界面<a class="headerlink" href="#module" title="此标题的永久链接">#</a></h1>
<p>Command line interface</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">中文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p>1.16.8 版新增功能</p></li>
</ul>
<p>PyMuPDF 还可以从命令行使用，以执行实用功能。此功能应该会淘汰一些最基本的脚本。</p>
<p>不可否认，它与 MuPDF CLI <code class="xref any docutils literal notranslate"><span class="pre">mutool</span></code> 有一些功能重叠。另一方面，MuPDF 不再支持 PDF 嵌入文件，因此 PyMuPDF 在此提供了一些独特的功能。</p>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">英文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p>New in version 1.16.8</p></li>
</ul>
<p>PyMuPDF can also be used from the command line to perform utility functions. This feature should obsolete writing some of the most basic scripts.</p>
<p>Admittedly, there is some functional overlap with the MuPDF CLI <code class="xref any docutils literal notranslate"><span class="pre">mutool</span></code>. On the other hand, PDF embedded files are no longer supported by MuPDF, so PyMuPDF is offering something unique here.</p>
</div>
</div>
<section id="id2">
<h2>调用<a class="headerlink" href="#id2" title="此标题的永久链接">#</a></h2>
<p>Invocation</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">中文</label><div class="tab-content docutils container">
<p>命令行界面可以通过以下两种方式调用：</p>
<ul>
<li><p>使用已安装的 <code class="xref any docutils literal notranslate"><span class="pre">pymupdf</span></code> 命令:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pymupdf</span> <span class="o">&lt;</span><span class="n">command</span> <span class="ow">and</span> <span class="n">parameters</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>或者使用 Python 的 <code class="xref any docutils literal notranslate"><span class="pre">-m</span></code> 选项调用 PyMuPDF 的 <code class="xref any docutils literal notranslate"><span class="pre">pymupdf</span></code> 模块:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pymupdf</span> <span class="o">&lt;</span><span class="n">command</span> <span class="ow">and</span> <span class="n">parameters</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
</ul>
<p>通用说明：</p>
<ul>
<li><p>通过 <code class="xref any docutils literal notranslate"><span class="pre">&quot;-h&quot;</span></code> 请求帮助，或使用 <code class="xref any docutils literal notranslate"><span class="pre">&quot;command</span> <span class="pre">-h&quot;</span></code> 获取特定命令的帮助信息。</p></li>
<li><p>在不引起歧义的情况下，参数可以缩写。</p></li>
<li><p>若干命令支持 <code class="xref any docutils literal notranslate"><span class="pre">-pages</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">-xrefs</span></code> 参数，用于筛选处理对象。请注意：</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>页码</strong> 在此工具中必须采用 <strong>1-based</strong> （从 1 开始）。</p></li>
<li><p>有效的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 号码从 1 开始。</p></li>
<li><p>可以使用逗号分隔的列表来指定 <em>单个</em> 整数或整数 <em>范围</em> 。 <strong>范围</strong> 由两个整数组成，以连字符 <code class="xref any docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code> 连接。整数不得超过最大页码或最大 xref 号码。可以使用符号变量 <code class="xref any docutils literal notranslate"><span class="pre">&quot;N&quot;</span></code> 表示最大值。整数或范围可以多次出现，顺序不限，且可以重叠。如果范围的第一个数字大于第二个数字，则会按相反顺序处理这些项目。</p></li>
</ul>
</div></blockquote>
</li>
<li><p>如何在脚本中使用该模块:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf.__main__</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;clean input.pdf output.pdf -pages 1,N&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>  <span class="c1"># 准备命令行参数</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">saved_parms</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># 保存原始命令行参数</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">cmd</span>  <span class="c1"># 存储新命令行参数</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pymupdf</span><span class="o">.</span><span class="n">__main__</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>  <span class="c1"># 执行模块</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">saved_parms</span>  <span class="c1"># 还原原始命令行参数</span>
</pre></div>
</div>
</li>
<li><p>使用以下两行代码，并使用 <a class="reference external" href="https://pypi.org/project/Nuitka/">Nuitka</a> 以独立模式编译。这样可以生成一个 CLI 可执行文件，该文件可在所有兼容平台上运行，而无需安装 Python、PyMuPDF 或 MuPDF。</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pymupdf.__main__</span><span class="w"> </span><span class="kn">import</span> <span class="n">main</span>
<span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">英文</label><div class="tab-content docutils container">
<p>The command-line interface can be invoked in two ways.</p>
<ul>
<li><p>Use the installed <code class="xref any docutils literal notranslate"><span class="pre">pymupdf</span></code> command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pymupdf</span> <span class="o">&lt;</span><span class="n">command</span> <span class="ow">and</span> <span class="n">parameters</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>Or use Python’s <code class="xref any docutils literal notranslate"><span class="pre">-m</span></code> switch with PyMuPDF’s <code class="xref any docutils literal notranslate"><span class="pre">pymupdf</span></code> module:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pymupdf</span> <span class="o">&lt;</span><span class="n">command</span> <span class="ow">and</span> <span class="n">parameters</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
</ul>
<p>General remarks:</p>
<ul>
<li><p>Request help via <code class="xref any docutils literal notranslate"><span class="pre">&quot;-h&quot;</span></code>, resp. command-specific help via <code class="xref any docutils literal notranslate"><span class="pre">&quot;command</span> <span class="pre">-h&quot;</span></code>.</p></li>
<li><p>Parameters may be abbreviated where this does not introduce ambiguities.</p></li>
<li><p>Several commands support parameters <code class="xref any docutils literal notranslate"><span class="pre">-pages</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">-xrefs</span></code>. They are intended for down-selection. Please note that:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>page numbers</strong> for this utility must be given <strong>1-based</strong>.</p></li>
<li><p>valid <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> numbers start at 1.</p></li>
<li><p>Specify a comma-separated list of either <em>single</em> integers or integer <em>ranges</em>. A <strong>range</strong> is a pair of integers separated by one hyphen “-”. Integers must not exceed the maximum page, resp. xref number. To specify that maximum, the symbolic variable “N” may be used. Integers or ranges may occur several times, in any sequence and may overlap. If in a range the first number is greater than the second one, the respective items will be processed in reversed order.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>How to use the module inside your script:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf.__main__</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot;clean input.pdf output.pdf -pages 1,N&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>  <span class="c1"># prepare command line</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">saved_parms</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># save original command line</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">cmd</span>  <span class="c1"># store new command line</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pymupdf</span><span class="o">.</span><span class="n">__main__</span><span class="o">.</span><span class="p">()</span>  <span class="c1"># execute module</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">saved_parms</span>  <span class="c1"># restore original command line</span>
</pre></div>
</div>
</li>
<li><p>Use the following 2-liner and compile it with <a class="reference external" href="https://pypi.org/project/Nuitka/">Nuitka</a> in standalone mode. This will give you a CLI executable with all the module’s features, that can be used on all compatible platforms without Python, PyMuPDF or MuPDF being installed.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pymupdf.__main__</span><span class="w"> </span><span class="kn">import</span> <span class="n">main</span>
<span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h2>清理和复制<a class="headerlink" href="#id4" title="此标题的永久链接">#</a></h2>
<p>Cleaning and Copying</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">中文</label><div class="tab-content docutils container">
<p>此命令可优化 PDF 并将结果存储到新文件中。您还可以使用它进行加密、解密和创建子文档。它与 MuPDF 命令行工具 <em>“mutool clean”</em> 基本类似:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf clean -h
usage: pymupdf clean [-h] [-password PASSWORD]
                [-encryption {keep,none,rc4-40,rc4-128,aes-128,aes-256}]
                [-owner OWNER] [-user USER] [-garbage {0,1,2,3,4}]
                [-compress] [-ascii] [-linear] [-permission PERMISSION]
                [-sanitize] [-pretty] [-pages PAGES]
                input output

-------------- 优化 PDF 或创建子 PDF（若提供页码参数） --------------

位置参数:
input                 PDF 文件名
output                输出 PDF 文件名

可选参数:
-h, --help            显示帮助信息并退出
-password PASSWORD    密码
-encryption {keep,none,rc4-40,rc4-128,aes-128,aes-256}
                    加密方式
-owner OWNER          所有者密码
-user USER            用户密码
-garbage {0,1,2,3,4}  垃圾回收级别
-compress             对输出进行压缩（deflate）
-ascii                以 ASCII 编码二进制数据
-linear               以快速网页显示格式存储
-permission PERMISSION
                    权限级别（整数）
-sanitize             清理 / 规范化内容
-pretty               美化 PDF 结构
-pages PAGES          输出选定的页面，格式示例: 1,5-7,50-N
</pre></div>
</div>
<p>如果指定了 <code class="xref any docutils literal notranslate"><span class="pre">&quot;-pages&quot;</span></code>，请注意， <strong>仅会复制页面相关的对象</strong> ，不会包含文档级别的元素，例如嵌入文件等。</p>
<p>有关各参数的详细说明，请参考 <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a>。</p>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">英文</label><div class="tab-content docutils container">
<p>This command will optimize the PDF and store the result in a new file. You can use it also for encryption, decryption and creating sub documents. It is mostly similar to the MuPDF command line utility <em>“mutool clean”</em>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf clean -h
usage: pymupdf clean [-h] [-password PASSWORD]
                [-encryption {keep,none,rc4-40,rc4-128,aes-128,aes-256}]
                [-owner OWNER] [-user USER] [-garbage {0,1,2,3,4}]
                [-compress] [-ascii] [-linear] [-permission PERMISSION]
                [-sanitize] [-pretty] [-pages PAGES]
                input output

-------------- optimize PDF or create sub-PDF if pages given --------------

positional arguments:
input                 PDF filename
output                output PDF filename

optional arguments:
-h, --help            show this help message and exit
-password PASSWORD    password
-encryption {keep,none,rc4-40,rc4-128,aes-128,aes-256}
                    encryption method
-owner OWNER          owner password
-user USER            user password
-garbage {0,1,2,3,4}  garbage collection level
-compress             compress (deflate) output
-ascii                ASCII encode binary data
-linear               format for fast web display
-permission PERMISSION
                    integer with permission levels
-sanitize             sanitize / clean contents
-pretty               prettify PDF structure
-pages PAGES          output selected pages, format: 1,5-7,50-N
</pre></div>
</div>
<p>If you specify “-pages”, be aware that only page-related objects are copied, <strong>no document-level items</strong> like e.g. embedded files.</p>
<p>Please consult <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> for the parameter meanings.</p>
</div>
</div>
</section>
<section id="id5">
<h2>提取字体和图像<a class="headerlink" href="#id5" title="此标题的永久链接">#</a></h2>
<p>Extracting Fonts and Images</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">中文</label><div class="tab-content docutils container">
<p>从选定的 PDF 页面提取字体或图像，并保存到指定目录:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf extract -h
usage: pymupdf extract [-h] [-images] [-fonts] [-output OUTPUT] [-password PASSWORD]
                    [-pages PAGES]
                    input

--------------------- 将图像和字体提取到磁盘 --------------------

位置参数:
input                 PDF 文件名

可选参数:
-h, --help            显示帮助信息并退出
-images               提取图像
-fonts                提取字体
-output OUTPUT        输出目录，默认为当前目录
-password PASSWORD    密码
-pages PAGES          仅处理选定页面，格式示例: 1,5-7,50-N
</pre></div>
</div>
<p><strong>图像文件名</strong> 采用以下命名规则： <strong>“img-xref.ext”</strong> ，其中 <code class="xref any docutils literal notranslate"><span class="pre">&quot;ext&quot;</span></code> 是图像的文件扩展名， <code class="xref any docutils literal notranslate"><span class="pre">&quot;xref&quot;</span></code> 是图像 PDF 对象的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 号码。</p>
<p><strong>字体文件名</strong> 由字体名称和相应的文件扩展名组成。字体名称中的空格会被连字符 <code class="xref any docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code> 代替。</p>
<p>输出目录必须 <strong>已存在</strong> 。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>除了不会创建输出目录之外，该功能在 <strong>功能上等效于</strong> 并取代了 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/extract-images/extract-from-pages.py">此脚本</a>。</p>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">英文</label><div class="tab-content docutils container">
<p>Extract fonts or images from selected PDF pages to a desired directory:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf extract -h
usage: pymupdf extract [-h] [-images] [-fonts] [-output OUTPUT] [-password PASSWORD]
                    [-pages PAGES]
                    input

--------------------- extract images and fonts to disk --------------------

positional arguments:
input                 PDF filename

optional arguments:
-h, --help            show this help message and exit
-images               extract images
-fonts                extract fonts
-output OUTPUT        output directory, defaults to current
-password PASSWORD    password
-pages PAGES          only consider these pages, format: 1,5-7,50-N
</pre></div>
</div>
<p><strong>Image filenames</strong> are built according to the naming scheme: <strong>“img-xref.ext”</strong>, where “ext” is the extension associated with the image and “xref” the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the image PDF object.</p>
<p><strong>Font filenames</strong> consist of the fontname and the associated extension. Any spaces in the fontname are replaced with hyphens “-“.</p>
<p>The output directory must already exist.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Except for output directory creation, this feature is <strong>functionally equivalent</strong> to and obsoletes <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/extract-images/extract-from-pages.py">this script</a>.</p>
</div>
</div>
</div>
</section>
<section id="pdf">
<h2>合并 PDF 文档<a class="headerlink" href="#pdf" title="此标题的永久链接">#</a></h2>
<p>Joining PDF Documents</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">中文</label><div class="tab-content docutils container">
<p>要合并多个 PDF 文件，请使用以下命令:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf join -h
usage: pymupdf join [-h] -output OUTPUT [input [input ...]]

---------------------------- 合并 PDF 文档 ---------------------------

位置参数:
input           输入文件名

可选参数:
-h, --help      显示帮助信息并退出
-output OUTPUT  输出文件名

每个输入文件的格式: &#39;filename[,password[,pages]]&#39;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ol class="arabic simple">
<li><p>每个输入文件必须按 <strong>“filename,password,pages”</strong> 形式提供。<code class="xref any docutils literal notranslate"><span class="pre">password</span></code> 和 <a class="reference internal" href="document.html#Document.pages" title="Document.pages"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">pages</span></code></a> 为可选项。</p></li>
<li><p>如果使用 <code class="xref any docutils literal notranslate"><span class="pre">&quot;pages&quot;</span></code> 参数，则 <strong>必须提供密码</strong>。若 PDF 无需密码，请使用两个逗号 <code class="xref any docutils literal notranslate"><span class="pre">&quot;,,&quot;</span></code> 作为占位符。</p></li>
<li><p><strong>“pages”</strong> 参数的格式与本节开头说明的格式相同。</p></li>
<li><p>每个输入文件在使用后会立即关闭。因此，您可以将其中一个输入文件作为输出文件名，从而覆盖原文件。</p></li>
</ol>
</div>
<p>示例: 设要合并以下文件</p>
<ol class="arabic simple">
<li><p><strong>file1.pdf:</strong> 所有页面，逆序排列，无密码</p></li>
<li><p><strong>file2.pdf:</strong> 最后一页、第一页，密码: <code class="xref any docutils literal notranslate"><span class="pre">&quot;secret&quot;</span></code></p></li>
<li><p><strong>file3.pdf:</strong> 第 5 页至最后一页，无密码</p></li>
</ol>
<p>并将结果存储为 <strong>output.pdf</strong>，可使用以下命令:</p>
<p><em>pymupdf join -o output.pdf file1.pdf,,N-1 file2.pdf,secret,N,1 file3.pdf,,5-N</em></p>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">英文</label><div class="tab-content docutils container">
<p>To join several PDF files specify:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf join -h
usage: pymupdf join [-h] -output OUTPUT [input [input ...]]

---------------------------- join PDF documents ---------------------------

positional arguments:
input           input filenames

optional arguments:
-h, --help      show this help message and exit
-output OUTPUT  output filename

specify each input as &#39;filename[,password[,pages]]&#39;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ol class="arabic simple">
<li><p>Each input must be entered as <strong>“filename,password,pages”</strong>. Password and pages are optional.</p></li>
<li><p>The password entry <strong>is required</strong> if the “pages” entry is used. If the PDF needs no password, specify two commas.</p></li>
<li><p>The <strong>“pages”</strong> format is the same as explained at the top of this section.</p></li>
<li><p>Each input file is immediately closed after use. Therefore you can use one of them as output filename, and thus overwrite it.</p></li>
</ol>
</div>
<p>Example: To join the following files</p>
<ol class="arabic simple">
<li><p><strong>file1.pdf:</strong> all pages, back to front, no password</p></li>
<li><p><strong>file2.pdf:</strong> last page, first page, password: “secret”</p></li>
<li><p><strong>file3.pdf:</strong> pages 5 to last, no password</p></li>
</ol>
<p>and store the result as <strong>output.pdf</strong> enter this command:</p>
<p><em>pymupdf join -o output.pdf file1.pdf,,N-1 file2.pdf,secret,N,1 file3.pdf,,5-N</em></p>
</div>
</div>
</section>
<section id="id7">
<h2>低级信息<a class="headerlink" href="#id7" title="此标题的永久链接">#</a></h2>
<p>Low Level Information</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">中文</label><div class="tab-content docutils container">
<p>显示 PDF 内部信息。此命令与 <em>“mutool show”</em> 具有相似功能:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf show -h
usage: pymupdf show [-h] [-password PASSWORD] [-catalog] [-trailer] [-metadata]
                [-xrefs XREFS] [-pages PAGES]
                input

------------------------- 显示 PDF 信息 -------------------------

位置参数:
input               PDF 文件名

可选参数:
-h, --help          显示帮助信息并退出
-password PASSWORD  密码
-catalog            显示 PDF 目录（Catalog）
-trailer            显示 PDF 尾部信息（Trailer）
-metadata           显示 PDF 元数据（Metadata）
-xrefs XREFS        显示选定对象，格式示例: 1,5-7,N
-pages PAGES        显示选定页面，格式示例: 1,5-7,50-N
</pre></div>
</div>
<p>示例:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf show x.pdf
PDF 受密码保护

pymupdf show x.pdf -pass hugo
认证失败

pymupdf show x.pdf -pass jorjmckie
认证为所有者
文件 &#39;x.pdf&#39;，页数: 1，对象数: 19，大小: 58 MB，PDF 版本: 1.4，加密方式: Standard V5 R6 256-bit AES
文档包含 15 个嵌入文件。

pymupdf show FDA-1572_508_R6_FINAL.pdf -tr -m
&#39;FDA-1572_508_R6_FINAL.pdf&#39;，页数: 2，对象数: 1645，大小: 1.4 MB，PDF 版本: 1.6，加密方式: Standard V4 R4 128-bit AES
文档包含 740 个根表单字段，并已签名

------------------------------- PDF 元数据 ------------------------------
    格式: PDF 1.6
    标题: FORM FDA 1572
    作者: PSC Publishing Services
    主题: Statement of Investigator
    关键字: None
    创建者: PScript5.dll Version 5.2.2
    生成器: Acrobat Distiller 9.0.0 (Windows)
创建日期: D:20130522104413-04&#39;00&#39;
修改日期: D:20190718154905-07&#39;00&#39;
加密方式: Standard V4 R4 128-bit AES

------------------------------- PDF 尾部信息 -------------------------------
&lt;&lt;
/DecodeParms &lt;&lt;
    /Columns 5
    /Predictor 12
&gt;&gt;
/Encrypt 1389 0 R
/Filter /FlateDecode
/ID [ &lt;9252E9E39183F2A0B0C51BE557B8A8FC&gt; &lt;85227BE9B84B724E8F678E1529BA8351&gt; ]
/Index [ 1388 258 ]
/Info 1387 0 R
/Length 253
/Prev 1510559
/Root 1390 0 R
/Size 1646
/Type /XRef
/W [ 1 3 1 ]
&gt;&gt;
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">英文</label><div class="tab-content docutils container">
<p>Display PDF internal information. Again, there are similarities to <em>“mutool show”</em>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf show -h
usage: pymupdf show [-h] [-password PASSWORD] [-catalog] [-trailer] [-metadata]
                [-xrefs XREFS] [-pages PAGES]
                input

------------------------- display PDF information -------------------------

positional arguments:
input               PDF filename

optional arguments:
-h, --help          show this help message and exit
-password PASSWORD  password
-catalog            show PDF catalog
-trailer            show PDF trailer
-metadata           show PDF metadata
-xrefs XREFS        show selected objects, format: 1,5-7,N
-pages PAGES        show selected pages, format: 1,5-7,50-N
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf show x.pdf
PDF is password protected

pymupdf show x.pdf -pass hugo
authentication unsuccessful

pymupdf show x.pdf -pass jorjmckie
authenticated as owner
file &#39;x.pdf&#39;, pages: 1, objects: 19, 58 MB, PDF 1.4, encryption: Standard V5 R6 256-bit AES
Document contains 15 embedded files.

pymupdf show FDA-1572_508_R6_FINAL.pdf -tr -m
&#39;FDA-1572_508_R6_FINAL.pdf&#39;, pages: 2, objects: 1645, 1.4 MB, PDF 1.6, encryption: Standard V4 R4 128-bit AES
document contains 740 root form fields and is signed

------------------------------- PDF metadata ------------------------------
    format: PDF 1.6
        title: FORM FDA 1572
    author: PSC Publishing Services
    subject: Statement of Investigator
    keywords: None
    creator: PScript5.dll Version 5.2.2
    producer: Acrobat Distiller 9.0.0 (Windows)
creationDate: D:20130522104413-04&#39;00&#39;
    modDate: D:20190718154905-07&#39;00&#39;
encryption: Standard V4 R4 128-bit AES

------------------------------- PDF trailer -------------------------------
&lt;&lt;
/DecodeParms &lt;&lt;
    /Columns 5
    /Predictor 12
&gt;&gt;
/Encrypt 1389 0 R
/Filter /FlateDecode
/ID [ &lt;9252E9E39183F2A0B0C51BE557B8A8FC&gt; &lt;85227BE9B84B724E8F678E1529BA8351&gt; ]
/Index [ 1388 258 ]
/Info 1387 0 R
/Length 253
/Prev 1510559
/Root 1390 0 R
/Size 1646
/Type /XRef
/W [ 1 3 1 ]
&gt;&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="id8">
<h2>嵌入文件命令<a class="headerlink" href="#id8" title="此标题的永久链接">#</a></h2>
<p>Embedded Files Commands</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">中文</label><div class="tab-content docutils container">
<p>以下命令处理嵌入式文件 - 这是 MuPDF 在 v1.14 之后完全删除的功能，因此也从其所有命令行工具中删除。</p>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">英文</label><div class="tab-content docutils container">
<p>The following commands deal with embedded files – which is a feature completely removed from MuPDF after v1.14, and hence from all its command line tools.</p>
</div>
</div>
<section id="id9">
<h3>信息<a class="headerlink" href="#id9" title="此标题的永久链接">#</a></h3>
<p>Information</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">中文</label><div class="tab-content docutils container">
<p>显示嵌入文件的名称（长格式或短格式）:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-info -h
usage: pymupdf embed-info [-h] [-name NAME] [-detail] [-password PASSWORD] input

--------------------------- 列出嵌入文件 ---------------------------

位置参数:
input               PDF 文件名

可选参数:
-h, --help          显示帮助信息并退出
-name NAME          如果提供此参数，仅报告该文件
-detail             显示详细信息
-password PASSWORD  密码
</pre></div>
</div>
<p>示例:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-info some.pdf
&#39;some.pdf&#39; 包含以下 15 个嵌入文件。

20110813_180956_0002.jpg
20110813_181009_0003.jpg
20110813_181012_0004.jpg
20110813_181131_0005.jpg
20110813_181144_0006.jpg
20110813_181306_0007.jpg
20110813_181307_0008.jpg
20110813_181314_0009.jpg
20110813_181315_0010.jpg
20110813_181324_0011.jpg
20110813_181339_0012.jpg
20110813_181913_0013.jpg
insta-20110813_180944_0001.jpg
markiert-20110813_180944_0001.jpg
neue.datei
</pre></div>
</div>
<p>详细输出示例如下:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>     name: neue.datei
 filename: text-tester.pdf
ufilename: text-tester.pdf
     desc: nur zum Testen!
     size: 4639
   length: 1566
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">英文</label><div class="tab-content docutils container">
<p>Show the embedded file names (long or short format):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-info -h
usage: pymupdf embed-info [-h] [-name NAME] [-detail] [-password PASSWORD] input

--------------------------- list embedded files ---------------------------

positional arguments:
input               PDF filename

optional arguments:
-h, --help          show this help message and exit
-name NAME          if given, report only this one
-detail             show detail information
-password PASSWORD  password
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-info some.pdf
&#39;some.pdf&#39; contains the following 15 embedded files.

20110813_180956_0002.jpg
20110813_181009_0003.jpg
20110813_181012_0004.jpg
20110813_181131_0005.jpg
20110813_181144_0006.jpg
20110813_181306_0007.jpg
20110813_181307_0008.jpg
20110813_181314_0009.jpg
20110813_181315_0010.jpg
20110813_181324_0011.jpg
20110813_181339_0012.jpg
20110813_181913_0013.jpg
insta-20110813_180944_0001.jpg
markiert-20110813_180944_0001.jpg
neue.datei
</pre></div>
</div>
<p>Detailed output would look like this per entry:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>     name: neue.datei
 filename: text-tester.pdf
ufilename: text-tester.pdf
     desc: nur zum Testen!
     size: 4639
   length: 1566
</pre></div>
</div>
</div>
</div>
</section>
<section id="id10">
<h3>提取<a class="headerlink" href="#id10" title="此标题的永久链接">#</a></h3>
<p>Extraction</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">中文</label><div class="tab-content docutils container">
<p>提取嵌入文件的方法如下:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-extract -h
usage: pymupdf embed-extract [-h] -name NAME [-password PASSWORD] [-output OUTPUT]
                        input

---------------------- 将嵌入文件提取到磁盘 ----------------------

位置参数:
input                 PDF 文件名

可选参数:
-h, --help            显示帮助信息并退出
-name NAME            条目名称
-password PASSWORD    密码
-output OUTPUT        输出文件名，默认为存储的名称
</pre></div>
</div>
<p>详细信息请参考 <a class="reference internal" href="document.html#Document.embfile_get" title="Document.embfile_get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_get()</span></code></a>。示例（参见上一节）:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-extract some.pdf -name neue.datei
已将条目 &#39;neue.datei&#39; 保存为 &#39;text-tester.pdf&#39;
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">英文</label><div class="tab-content docutils container">
<p>Extract an embedded file like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-extract -h
usage: pymupdf embed-extract [-h] -name NAME [-password PASSWORD] [-output OUTPUT]
                        input

---------------------- extract embedded file to disk ----------------------

positional arguments:
input                 PDF filename

optional arguments:
-h, --help            show this help message and exit
-name NAME            name of entry
-password PASSWORD    password
-output OUTPUT        output filename, default is stored name
</pre></div>
</div>
<p>For details consult <a class="reference internal" href="document.html#Document.embfile_get" title="Document.embfile_get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_get()</span></code></a>. Example (refer to previous section):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-extract some.pdf -name neue.datei
Saved entry &#39;neue.datei&#39; as &#39;text-tester.pdf&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="id11">
<h3>删除<a class="headerlink" href="#id11" title="此标题的永久链接">#</a></h3>
<p>Deletion</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">中文</label><div class="tab-content docutils container">
<p>删除嵌入文件的方法如下:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-del -h
usage: pymupdf embed-del [-h] [-password PASSWORD] [-output OUTPUT] -name NAME input

--------------------------- 删除嵌入文件 ---------------------------

位置参数:
input                 PDF 文件名

可选参数:
-h, --help            显示帮助信息并退出
-password PASSWORD    密码
-output OUTPUT        输出 PDF 文件名，若未指定则进行增量保存
-name NAME            要删除的条目名称
</pre></div>
</div>
<p>详细信息请参考 <a class="reference internal" href="document.html#Document.embfile_del" title="Document.embfile_del"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_del()</span></code></a>。</p>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">英文</label><div class="tab-content docutils container">
<p>Delete an embedded file like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-del -h
usage: pymupdf embed-del [-h] [-password PASSWORD] [-output OUTPUT] -name NAME input

--------------------------- delete embedded file --------------------------

positional arguments:
input                 PDF filename

optional arguments:
-h, --help            show this help message and exit
-password PASSWORD    password
-output OUTPUT        output PDF filename, incremental save if none
-name NAME            name of entry to delete
</pre></div>
</div>
<p>For details consult <a class="reference internal" href="document.html#Document.embfile_del" title="Document.embfile_del"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_del()</span></code></a>.</p>
</div>
</div>
</section>
<section id="id12">
<h3>插入<a class="headerlink" href="#id12" title="此标题的永久链接">#</a></h3>
<p>Insertion</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">中文</label><div class="tab-content docutils container">
<p>使用以下命令添加嵌入文件:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-add -h
usage: pymupdf embed-add [-h] [-password PASSWORD] [-output OUTPUT] -name NAME -path
                    PATH [-desc DESC]
                    input

---------------------------- 添加嵌入文件 ----------------------------

位置参数:
input                 PDF 文件名

可选参数:
-h, --help            显示帮助信息并退出
-password PASSWORD    密码
-output OUTPUT        输出 PDF 文件名，若未指定则进行增量保存
-name NAME            新条目的名称
-path PATH            新条目的数据路径
-desc DESC            新条目的描述
</pre></div>
</div>
<p><em>“NAME”</em> <strong>不能</strong> 在 PDF 中已经存在。详细信息请参考 <a class="reference internal" href="document.html#Document.embfile_add" title="Document.embfile_add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_add()</span></code></a> 。</p>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">英文</label><div class="tab-content docutils container">
<p>Add a new embedded file using this command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-add -h
usage: pymupdf embed-add [-h] [-password PASSWORD] [-output OUTPUT] -name NAME -path
                    PATH [-desc DESC]
                    input

---------------------------- add embedded file ----------------------------

positional arguments:
input                 PDF filename

optional arguments:
-h, --help            show this help message and exit
-password PASSWORD    password
-output OUTPUT        output PDF filename, incremental save if none
-name NAME            name of new entry
-path PATH            path to data for new entry
-desc DESC            description of new entry
</pre></div>
</div>
<p><em>“NAME”</em> <strong>must not</strong> already exist in the PDF. For details consult <a class="reference internal" href="document.html#Document.embfile_add" title="Document.embfile_add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_add()</span></code></a>.</p>
</div>
</div>
</section>
<section id="id13">
<h3>更新<a class="headerlink" href="#id13" title="此标题的永久链接">#</a></h3>
<p>Updates</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--11-input--1" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--1">中文</label><div class="tab-content docutils container">
<p>使用以下命令更新现有的嵌入文件:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-upd -h
usage: pymupdf embed-upd [-h] -name NAME [-password PASSWORD] [-output OUTPUT]
                    [-path PATH] [-filename FILENAME] [-ufilename UFILENAME]
                    [-desc DESC]
                    input

--------------------------- 更新嵌入文件 --------------------------

位置参数:
input                 PDF 文件名

可选参数:
-h, --help            显示帮助信息并退出
-name NAME            条目的名称
-password PASSWORD    密码
-output OUTPUT        输出 PDF 文件名，若未指定则进行增量保存
-path PATH            新数据的路径
-filename FILENAME    存储在条目中的新文件名
-ufilename UFILENAME  存储在条目中的新 Unicode 文件名
-desc DESC            存储在条目中的新描述
</pre></div>
</div>
<p>除 <code class="xref any docutils literal notranslate"><span class="pre">-name</span></code> 外，所有参数均为可选项。</p>
<p>使用此方法可以更改文件的元信息——只需省略 <em>“PATH”</em> 。详细信息请参考 <a class="reference internal" href="document.html#Document.embfile_upd" title="Document.embfile_upd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_upd()</span></code></a>。</p>
</div>
<input class="tab-input" id="tab-set--11-input--2" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--2">英文</label><div class="tab-content docutils container">
<p>Update an existing embedded file using this command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-upd -h
usage: pymupdf embed-upd [-h] -name NAME [-password PASSWORD] [-output OUTPUT]
                    [-path PATH] [-filename FILENAME] [-ufilename UFILENAME]
                    [-desc DESC]
                    input

--------------------------- update embedded file --------------------------

positional arguments:
input                 PDF filename

optional arguments:
-h, --help            show this help message and exit
-name NAME            name of entry
-password PASSWORD    password
-output OUTPUT        Output PDF filename, incremental save if none
-path PATH            path to new data for entry
-filename FILENAME    new filename to store in entry
-ufilename UFILENAME  new unicode filename to store in entry
-desc DESC            new description to store in entry

except &#39;-name&#39; all parameters are optional
</pre></div>
</div>
<p>Use this method to change meta-information of the file – just omit the <em>“PATH”</em>. For details consult <a class="reference internal" href="document.html#Document.embfile_upd" title="Document.embfile_upd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_upd()</span></code></a>.</p>
</div>
</div>
</section>
<section id="id14">
<h3>复制<a class="headerlink" href="#id14" title="此标题的永久链接">#</a></h3>
<p>Copying</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--12-input--1" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--1">中文</label><div class="tab-content docutils container">
<p>在 PDF 之间复制嵌入文件的方法如下:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-copy -h
usage: pymupdf embed-copy [-h] [-password PASSWORD] [-output OUTPUT] -source
                    SOURCE [-pwdsource PWDSOURCE]
                    [-name [NAME [NAME ...]]]
                    input

--------------------- 在 PDF 之间复制嵌入文件 --------------------

位置参数:
input                 接收嵌入文件的 PDF

可选参数:
-h, --help            显示帮助信息并退出
-password PASSWORD    输入文件的密码
-output OUTPUT        输出 PDF 文件，若未指定则对 &#39;input&#39; 进行增量保存
-source SOURCE        从此 PDF 复制嵌入文件
-pwdsource PWDSOURCE  &#39;source&#39; PDF 的密码
-name [NAME [NAME ...]]
                    限制复制为这些条目
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--12-input--2" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--2">英文</label><div class="tab-content docutils container">
<p>Copy embedded files between PDFs:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf embed-copy -h
usage: pymupdf embed-copy [-h] [-password PASSWORD] [-output OUTPUT] -source
                    SOURCE [-pwdsource PWDSOURCE]
                    [-name [NAME [NAME ...]]]
                    input

--------------------- copy embedded files between PDFs --------------------

positional arguments:
input                 PDF to receive embedded files

optional arguments:
-h, --help            show this help message and exit
-password PASSWORD    password of input
-output OUTPUT        output PDF, incremental save to &#39;input&#39; if omitted
-source SOURCE        copy embedded files from here
-pwdsource PWDSOURCE  password of &#39;source&#39; PDF
-name [NAME [NAME ...]]
                    restrict copy to these entries
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id15">
<h2>文本提取<a class="headerlink" href="#id15" title="此标题的永久链接">#</a></h2>
<p>Text Extraction</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--13-input--1" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--1">中文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p>新增功能：v1.18.16版本</p></li>
</ul>
<p>从任意支持的文档中提取文本并保存为文本文件。目前，有三种输出格式模式可供选择：简单模式、块排序模式和物理布局复现模式。</p>
<ul class="simple">
<li><p><strong>简单模式</strong>：文本按其在文档页面中的显示顺序复制，不进行任何排列或重新排序。</p></li>
<li><p><strong>块排序模式</strong>：按垂直和水平方向的坐标对文本块进行排序，这通常能为基本文本页面建立“自然”阅读顺序。</p></li>
<li><p><strong>布局模式</strong>：尽量复现输入页面的原始外观。您可以预期类似以下的结果（由命令 <code class="xref any docutils literal notranslate"><span class="pre">pymupdf</span> <span class="pre">gettext</span> <span class="pre">-pages</span> <span class="pre">1</span> <span class="pre">demo1.pdf</span></code> 生成）：</p></li>
</ul>
<a class="reference internal image-reference" href="_images/img-layout-text.jpg"><img alt="_images/img-layout-text.jpg" src="_images/img-layout-text.jpg" style="width: 869.4px; height: 513.6px;" /></a>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>“gettext” 命令提供类似于 XPDF 软件的 CLI 工具 <code class="xref any docutils literal notranslate"><span class="pre">pdftotext</span></code> 的功能，尤其是在 “layout” 模式下，这与该工具的 <code class="xref any docutils literal notranslate"><span class="pre">-layout</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">-table</span></code> 选项结合使用非常相似。</p>
</div>
<p>每页输出文件后将写入一个换页符字符 <code class="xref any docutils literal notranslate"><span class="pre">hex(12)</span></code>，即使输入页面没有任何文本。此行为可以通过选项进行控制。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>对于 “layout” 模式，<strong>仅支持水平的从左到右、从上到下的文本</strong>，其他方向的文本将被忽略。在此模式下，若文本的 <a class="reference internal" href="glossary.html#fontsize" title="fontsize"><code class="xref py py-data docutils literal notranslate"><span class="pre">fontsize</span></code></a> 太小，则该文本也会被忽略。</p>
</div>
<p>相比之下，”simple” 和 “blocks” 模式会输出 <strong>所有文本</strong> ，无论其字体大小或方向如何。</p>
<p>命令:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf gettext -h
usage: pymupdf gettext [-h] [-password PASSWORD] [-mode {simple,blocks,layout}] [-pages PAGES] [-noligatures]
                    [-convert-white] [-extra-spaces] [-noformfeed] [-skip-empty] [-output OUTPUT] [-grid GRID]
                    [-fontsize FONTSIZE]
                    input

----------------- 在各种格式模式下提取文本 ----------------

位置参数:
input                 输入文档文件名

可选参数:
-h, --help            显示帮助信息并退出
-password PASSWORD    输入文档的密码
-mode {simple,blocks,layout}
                        模式：简单、块排序或布局（默认为布局）
-pages PAGES          选择页面，格式为：1,5-7,50-N
-noligatures          展开连字字符（默认为 False）
-convert-white        将空白字符转换为空格（默认为 False）
-extra-spaces         用空格填充字符间的空隙（默认为 False）
-noformfeed           写入换行符，而非换页符（默认为 False）
-skip-empty           跳过没有文本的页面（默认为 False）
-output OUTPUT        将文本存储到此文件（默认为输入文件名 .txt）
-grid GRID            如果行之间的垂直坐标差距小于此值，则合并为同一行（默认为 2）
-fontsize FONTSIZE    仅包括较大字体的文本（默认为 3）
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>命令选项可以缩写，只要不引起歧义。如下命令效果相同：</p>
<ul class="simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">...</span> <span class="pre">-output</span> <span class="pre">text.txt</span> <span class="pre">-noligatures</span> <span class="pre">-noformfeed</span> <span class="pre">-convert-white</span> <span class="pre">-grid</span> <span class="pre">3</span> <span class="pre">-extra-spaces</span> <span class="pre">...</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">...</span> <span class="pre">-o</span> <span class="pre">text.txt</span> <span class="pre">-nol</span> <span class="pre">-nof</span> <span class="pre">-c</span> <span class="pre">-g</span> <span class="pre">3</span> <span class="pre">-e</span> <span class="pre">...</span></code></p></li>
</ul>
<p>输出文件名默认为输入文件名，并将其扩展名替换为 <code class="xref any docutils literal notranslate"><span class="pre">.txt</span></code>。与其他命令一样，您可以按照上述格式选择页面范围 <strong>（请注意：从 1 开始计数！）</strong>。</p>
</div>
<ul class="simple">
<li><p><strong>mode:</strong> (str) 选择格式模式 – 默认为 “layout”。</p></li>
<li><p><strong>noligatures:</strong> (bool) 相当于 <strong>不</strong> <a class="reference internal" href="vars.html#TEXT_PRESERVE_LIGATURES" title="TEXT_PRESERVE_LIGATURES"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXT_PRESERVE_LIGATURES</span></code></a>。如果指定，连字（如 “fi”）将被分解为其组成字符（即 “f” 和 “i”）。默认保留连字。</p></li>
<li><p><strong>convert-white:</strong> (bool) 相当于 <strong>不</strong> <a class="reference internal" href="vars.html#TEXT_PRESERVE_WHITESPACE" title="TEXT_PRESERVE_WHITESPACE"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXT_PRESERVE_WHITESPACE</span></code></a>。如果指定，所有空白字符（如制表符）将被替换为一个或多个空格。默认保留空白字符。</p></li>
<li><p><strong>extra-spaces:</strong> (bool) 相当于 <strong>不</strong> <a class="reference internal" href="vars.html#TEXT_INHIBIT_SPACES" title="TEXT_INHIBIT_SPACES"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXT_INHIBIT_SPACES</span></code></a>。如果指定，大间隙将填充为一个或多个空格。默认关闭。</p></li>
<li><p><strong>noformfeed:</strong> (bool) 用换行符 <a class="reference internal" href="colorspace.html#Colorspace.n" title="Colorspace.n"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">n</span></code></a> 替代 <code class="xref any docutils literal notranslate"><span class="pre">hex(12)</span></code> （换页符），在输出页面的结尾添加换行符。</p></li>
<li><p><strong>skip-empty:</strong> (bool) 跳过没有文本的页面。</p></li>
<li><p><strong>grid:</strong> 行的垂直坐标差小于此值（以点为单位）时，将合并为同一输出行。仅对 “layout” 模式相关。<strong>请谨慎使用：</strong> 3 或默认值 2 在大多数情况下已足够。如果 <strong>设置过大</strong>，原本应为不同的行可能会合并，从而导致输出错误或不完整。如果 <strong>设置过小</strong>，某些输入行因字体属性略有不同而可能生成不必要的分离行。</p></li>
<li><p><strong>fontsize:</strong> 仅包括字体大小大于此值的文本（默认为 3）。仅对 “layout” 模式相关。</p></li>
</ul>
</div>
<input class="tab-input" id="tab-set--13-input--2" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--2">英文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p>New in v1.18.16</p></li>
</ul>
<p>Extract text from arbitrary <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">supported documents</span></a> to a textfile. Currently, there are three output formatting modes available: simple, block sorting and reproduction of physical layout.</p>
<ul class="simple">
<li><p><strong>Simple</strong> text extraction reproduces all text as it appears in the document pages – no effort is made to rearrange in any particular reading order.</p></li>
<li><p><strong>Block sorting</strong> sorts text blocks (as identified by MuPDF) by ascending vertical, then horizontal coordinates. This should be sufficient to establish a “natural” reading order for basic pages of text.</p></li>
<li><p><strong>Layout</strong> strives to reproduce the original appearance of the input pages. You can expect results like this (produced by the command <code class="xref any docutils literal notranslate"><span class="pre">pymupdf</span> <span class="pre">gettext</span> <span class="pre">-pages</span> <span class="pre">1</span> <span class="pre">demo1.pdf</span></code>):</p></li>
</ul>
<a class="reference internal image-reference" href="_images/img-layout-text.jpg"><img alt="_images/img-layout-text.jpg" src="_images/img-layout-text.jpg" style="width: 869.4px; height: 513.6px;" /></a>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>The “gettext” command offers a functionality similar to the CLI tool <code class="xref any docutils literal notranslate"><span class="pre">pdftotext</span></code> by XPDF software, <a class="reference external" href="http://www.foolabs.com/xpdf/">http://www.foolabs.com/xpdf/</a> – this is especially true for “layout” mode, which combines that tool’s <code class="xref any docutils literal notranslate"><span class="pre">-layout</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">-table</span></code> options.</p>
</div>
<p>After each page of the output file, a formfeed character, <code class="xref any docutils literal notranslate"><span class="pre">hex(12)</span></code> is written – even if the input page has no text at all. This behavior can be controlled via options.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>For “layout” mode, <strong>only horizontal, left-to-right, top-to bottom</strong> text is supported, other text is ignored. In this mode, text is also ignored, if its <a class="reference internal" href="glossary.html#fontsize" title="fontsize"><code class="xref py py-data docutils literal notranslate"><span class="pre">fontsize</span></code></a> is too small.</p>
</div>
<p>“Simple” and “blocks” mode in contrast output <strong>all text</strong> for any text size or orientation.</p>
<p>Command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pymupdf gettext -h
usage: pymupdf gettext [-h] [-password PASSWORD] [-mode {simple,blocks,layout}] [-pages PAGES] [-noligatures]
                    [-convert-white] [-extra-spaces] [-noformfeed] [-skip-empty] [-output OUTPUT] [-grid GRID]
                    [-fontsize FONTSIZE]
                    input

----------------- extract text in various formatting modes ----------------

positional arguments:
input                 input document filename

optional arguments:
-h, --help            show this help message and exit
-password PASSWORD    password for input document
-mode {simple,blocks,layout}
                        mode: simple, block sort, or layout (default)
-pages PAGES          select pages, format: 1,5-7,50-N
-noligatures          expand ligature characters (default False)
-convert-white        convert whitespace characters to space (default False)
-extra-spaces         fill gaps with spaces (default False)
-noformfeed           write linefeeds, no formfeeds (default False)
-skip-empty           suppress pages with no text (default False)
-output OUTPUT        store text in this file (default inputfilename.txt)
-grid GRID            merge lines if closer than this (default 2)
-fontsize FONTSIZE    only include text with a larger :data:`fontsize` (default 3)
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Command options may be abbreviated as long as no ambiguities are introduced. So the following do the same:</p>
<ul class="simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">...</span> <span class="pre">-output</span> <span class="pre">text.txt</span> <span class="pre">-noligatures</span> <span class="pre">-noformfeed</span> <span class="pre">-convert-white</span> <span class="pre">-grid</span> <span class="pre">3</span> <span class="pre">-extra-spaces</span> <span class="pre">...</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">...</span> <span class="pre">-o</span> <span class="pre">text.txt</span> <span class="pre">-nol</span> <span class="pre">-nof</span> <span class="pre">-c</span> <span class="pre">-g</span> <span class="pre">3</span> <span class="pre">-e</span> <span class="pre">...</span></code></p></li>
</ul>
<p>The output filename defaults to the input with its extension replaced by <code class="xref any docutils literal notranslate"><span class="pre">.txt</span></code>. As with other commands, you can select page ranges <strong>(caution: 1-based!)</strong> in <code class="xref any docutils literal notranslate"><span class="pre">mutool</span></code> format, as indicated above.</p>
</div>
<ul class="simple">
<li><p><strong>mode:</strong> (str) select a formatting mode – default is “layout”.</p></li>
<li><p><strong>noligatures:</strong> (bool) corresponds to <strong>not</strong> <a class="reference internal" href="vars.html#TEXT_PRESERVE_LIGATURES" title="TEXT_PRESERVE_LIGATURES"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXT_PRESERVE_LIGATURES</span></code></a>. If specified, ligatures (present in advanced fonts: glyphs combining multiple characters like “fi”) are split up into their components (i.e. “f”, “i”). Default is passing them through.</p></li>
<li><p><strong>convert-white:</strong> corresponds to <strong>not</strong> <a class="reference internal" href="vars.html#TEXT_PRESERVE_WHITESPACE" title="TEXT_PRESERVE_WHITESPACE"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXT_PRESERVE_WHITESPACE</span></code></a>. If specified, all white space characters (like tabs) are replaced with one or more spaces. Default is passing them through.</p></li>
<li><p><strong>extra-spaces:</strong>  (bool) corresponds to <strong>not</strong> <a class="reference internal" href="vars.html#TEXT_INHIBIT_SPACES" title="TEXT_INHIBIT_SPACES"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXT_INHIBIT_SPACES</span></code></a>. If specified, large gaps between adjacent characters will be filled with one or more spaces. Default is off.</p></li>
<li><p><strong>noformfeed:</strong>  (bool) instead of <code class="xref any docutils literal notranslate"><span class="pre">hex(12)</span></code> (formfeed), write linebreaks <code class="docutils literal notranslate"><span class="pre">\n</span></code> at end of output pages.</p></li>
<li><p><strong>skip-empty:</strong>  (bool) skip pages with no text.</p></li>
<li><p><strong>grid:</strong> lines with a vertical coordinate difference of no more than this value (in points) will be merged into the same output line. Only relevant for “layout” mode. <strong>Use with care:</strong> 3 or the default 2 should be adequate in most cases. If <strong>too large</strong>, lines that are <em>intended</em> to be different in the original may be merged and will result in garbled and / or incomplete output. If <strong>too low</strong>, artifact separate output lines may be generated for some spans in the input line, just because they are coded in a different font with slightly deviating properties.</p></li>
<li><p><strong>fontsize:</strong> include text with <a class="reference internal" href="glossary.html#fontsize" title="fontsize"><code class="xref py py-data docutils literal notranslate"><span class="pre">fontsize</span></code></a> larger than this value only (default 3). Only relevant for “layout” option.</p></li>
</ul>
</div>
</div>
<div class="feedbackLink"><a id="feedbackLinkBottom" target=_blank>您对此页面有任何反馈吗？</b></a></div><hr class="docutils" />
<script>

   var url_string = window.location.href;
   var a = document.getElementById('feedbackLinkBottom');
   a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link&url="+url_string);

</script>

<p style="color:#999" id="footerDisclaimer">本软件按原样提供，不作任何明示或暗示担保。本软件根据许可分发，除非根据该许可条款明确授权，否则不得复制、修改或分发。请参阅 <a href="https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link">artifex.com</a> 上的许可信息，或联系 Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States 了解更多信息。</p>



<script>

   let docLanguage = document.getElementsByTagName('html')[0].getAttribute('lang');

   function getHeaderAndFooterTranslation(str) {
       if (docLanguage == "ja") {
           if (str == "Do you have any feedback on this page?") {
               return "このページに関するご意見はありますか？";
           } else if (str == "Find <b>#pymupdf</b> on <b>Discord</b>") {
               return "<b>Discord</b>の <b>#pymupdf</b> を見つける";
           } else if (str == "This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.") {

               return "このソフトウェアは無保証で提供されており、明示または黙示を問わず、いかなる保証もありません。このソフトウェアはライセンスの下で配布され、ライセンスの条件に明示的に許可されている場合を除き、コピー、変更、または配布してはなりません。ライセンシング情報については、<a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a>でライセンス情報を参照するか、アメリカ合衆国カリフォルニア州サンフランシスコのArtifex Software Inc. までお問い合わせください。"

           }
       }

       return str;
   }

   document.getElementById("findOnDiscord").innerHTML = getHeaderAndFooterTranslation("Find <b>#pymupdf</b> on <b>Discord</b>");
   document.getElementById("feedbackLinkTop").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("feedbackLinkBottom").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("footerDisclaimer").innerHTML = getHeaderAndFooterTranslation("This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.");


   // more translation for admonition-title as the in-built translation isn't great, needs: 注釈 -> 注
   if (docLanguage == "ja") {
       const collection = document.getElementsByClassName("admonition-title");
       for (var i=0;i<collection.length;i++) {
           collection[i].innerHTML = "注";
       }
   }


</script><p class="footer-version">This documentation covers all versions up to 1.25.4.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="classes.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">类</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="recipes-common-issues-and-their-solutions.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">常见问题及其解决方案</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2025, Artifex
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 19. 3月 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">命令行界面</a><ul>
<li><a class="reference internal" href="#id2">调用</a></li>
<li><a class="reference internal" href="#id4">清理和复制</a></li>
<li><a class="reference internal" href="#id5">提取字体和图像</a></li>
<li><a class="reference internal" href="#pdf">合并 PDF 文档</a></li>
<li><a class="reference internal" href="#id7">低级信息</a></li>
<li><a class="reference internal" href="#id8">嵌入文件命令</a><ul>
<li><a class="reference internal" href="#id9">信息</a></li>
<li><a class="reference internal" href="#id10">提取</a></li>
<li><a class="reference internal" href="#id11">删除</a></li>
<li><a class="reference internal" href="#id12">插入</a></li>
<li><a class="reference internal" href="#id13">更新</a></li>
<li><a class="reference internal" href="#id14">复制</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id15">文本提取</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/tabs.js"></script>
    <script src="_static/translations.js"></script>
    </body>
</html>