<!doctype html>
<html class="no-js" lang="zh-CN">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="Artifex" name="author" />
<meta content="PyMuPDF 是一个高性能 Python 库，用于 PDF（及其他）文档的数据提取、分析、转换和操作。" name="description" />
<meta content="PDF Text Extraction, PDF Image Extraction, PDF Conversion, PDF Tables, PDF Splitting, PDF Creation, Pyodide, PyScript" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZTN4VTL9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZTN4VTL9M');
    </script>
    <link rel="author" title="关于此文档" href="about.html" /><link rel="index" title="索引" href="genindex.html" /><link rel="search" title="搜索" href="search.html" /><link rel="next" title="已废弃名称" href="znames.html" /><link rel="prev" title="附录 4：性能比较方法" href="app4.html" />

    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/><!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>更新日志 - PyMuPDF 1.25.4 文档</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMuPDF 1.25.4 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/sidebar-logo-dark.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/sidebar-logo-light.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyMuPDF 1.25.4 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">关于/About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">功能比较</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-performance">性能</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-license">许可和版权</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf4llm/index.html">PyMuPDF4LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf-pro.html">PyMuPDF Pro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">用户指南/User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-basics.html">基础用法</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">PyMuPDF、LLM 和 RAG</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">资源</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">教程/How to Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how-to-open-a-file.html">打开文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-text.html">文本</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-images.html">图片</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-annotations.html">注释</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-drawing-and-graphics.html">绘图和图形</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-stories.html">故事</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-journalling.html">日记</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-multiprocessing.html">多进程</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-ocr.html">OCR - 光学字符识别</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-optional-content.html">可选内容支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-low-level-interfaces.html">低级接口</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-common-issues-and-their-solutions.html">常见问题及其解决方案</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API参考/API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="module.html">命令行界面</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="classes.html">类</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="annot.html">Annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="archive-class.html">Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="colorspace.html">Colorspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="displaylist.html">DisplayList</a></li>
<li class="toctree-l2"><a class="reference internal" href="document.html">Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-writer-class.html">DocumentWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="font.html">Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="irect.html">IRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="link.html">Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkdest.html">linkDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="outline.html">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixmap.html">Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="point.html">Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="quad.html">Quad</a></li>
<li class="toctree-l2"><a class="reference internal" href="rect.html">Rect</a></li>
<li class="toctree-l2"><a class="reference internal" href="shape.html">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="story-class.html">Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="textpage.html">TextPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="textwriter.html">TextWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="widget.html">Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml-class.html">Xml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algebra.html">几何对象的运算符代数</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lowlevel.html">低级函数和类</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html">函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="device.html">设备</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop_low.html">协同工作: DisplayList 和 TextPage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">常量和枚举</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">颜色数据库</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">其他/Other</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="app1.html">附录 1：文本提取详细信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app2.html">附录 2：嵌入式文件的注意事项</a></li>
<li class="toctree-l1"><a class="reference internal" href="app3.html">附录 3：各类技术信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app4.html">附录 4：性能比较方法</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">更新日志</a></li>
<li class="toctree-l1"><a class="reference internal" href="znames.html">已废弃名称</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div style="display:flex;justify-content:space-between;align-items: center;">
    <form class="sidebar-search-container top" method="get" action="search.html" role="search" style="width:75%">
      <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
    <div class="discordLink" style="display:flex;align-items:center;margin-top: -5px;">
        <a href="https://discord.gg/TSpYGBW4eq" id="findOnDiscord" target=_blank>Find <b>#pymupdf</b> on <b>Discord</b></a>
        <a href="https://discord.gg/TSpYGBW4eq" target=_blank>
            <div style="width:30px;height:30px;margin-left:5px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
                    <defs>
                        <style>.discordLogoFill{fill:#5865f2;}</style>
                    </defs>
                    <g id="Discord_Logo" data-name="Discord Logo">
                        <path class="discordLogoFill" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                    </g>
                </svg>
            </div>
        </a>
    </div>

</div><section id="id1">
<h1>更新日志<a class="headerlink" href="#id1" title="此标题的永久链接">#</a></h1>
<p><strong>Changes in version 1.25.4 ()</strong></p>
<ul class="simple">
<li><p><strong>修复的问题</strong>:</p>
<ul>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4224">4224</a>: MuPDF 错误：格式错误：1d faxd 中的负码</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4303">4303</a>: page.get_image_info() 在替换图像后返回过时的缓存结果</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4309">4309</a>: 删除第一页时发生 FzErrorFormat 错误</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4336">4336</a>: 性能回退：pix.color_count 在版本 1.25.3 中比 1.23.8 慢 150 倍</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4341">4341</a>: 当 /Kids 是多个 /Nums 数组时获取无效标签</p></li>
</ul>
</li>
<li><p><strong>其他</strong>:</p>
<ul>
<li><p>修复了合并 PDF 时重复小部件名称的处理（PR #4347）。</p></li>
<li><p>改进了 Pyodide 构建。</p></li>
<li><p>通过禁用 PY_LIMITED_API 来避免 Python-3.13 中与 SWIG 相关的构建错误。</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.25.3 (2025-02-06)</strong></p>
<ul class="simple">
<li><p>使用 MuPDF-1.25.4.</p></li>
<li><p><strong>修复的问题</strong>:</p>
<ul>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4139">4139</a>: 文本颜色数字在 1.24.14 和 1.25.0 之间发生变化</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4141">4141</a>: 一些插入方法在没有 /Resources 对象的页面上失败</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4180">4180</a>: 搜索问题</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4182">4182</a>: 文本坐标提取错误</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4245">4245</a>: 高亮显示问题在最近版本中失真</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4254">4254</a>: add_freetext_annot 在注释框外绘制文本</p></li>
</ul>
</li>
<li><p><strong>其他</strong>:</p>
<ul>
<li><p>在注释方面:
* 添加对 FreeTextCallout 子类型的支持。
* 添加对富文本的支持。</p></li>
<li><p>为 insert_text*() 添加 miter_limit 参数，以便抑制长斜接线造成的尖角。</p></li>
<li><p>在 <a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a> 中添加小部件支持。</p></li>
<li><p>向 span 字典中添加 <code class="xref any docutils literal notranslate"><span class="pre">bibi</span></code>。</p></li>
<li><p>向字符字典中添加 <code class="xref any docutils literal notranslate"><span class="pre">synthetic</span></code>。</p></li>
<li><p>修复了 Pyodide 构建。</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.25.2 (2025-01-17)</strong></p>
<ul class="simple">
<li><p><strong>修复的问题</strong>:</p>
<ul>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4055">4055</a>: 所有复选框的“是”对于所有 PDF 渲染引擎不起作用</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4155">4155</a>: samples_mv 不安全</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4162">4162</a>: 尝试添加签名字段时出现 AttributeError</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4186">4186</a>: 错误处理带有 CMYK 色彩空间的 JPEG 图像提取</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4195">4195</a>: 倒置且具有 alpha 通道的 pixmap 无法正确渲染</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4225">4225</a>: pixmap.pil_save() 由于色彩空间定义失败</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4232">4232</a>: 错误的字体样式和大小</p></li>
</ul>
</li>
<li><p><strong>其他</strong>:</p>
<ul>
<li><p>使用 Python 内置的 glyphname &lt;&gt; unicode 转换。</p></li>
<li><p>提高 pixmap 色彩反转的速度。</p></li>
<li><p>向 span 字典添加新的 <code class="xref any docutils literal notranslate"><span class="pre">char_flags</span></code> 成员，允许检测不可见文本。</p></li>
<li><p>在 TextPage 输出中检测图像遮罩。</p></li>
<li><p>添加 <a class="reference internal" href="pixmap.html#Pixmap.pil_image" title="Pixmap.pil_image"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Pixmap.pil_image()</span></code></a>。</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.25.1 (2024-12-11)</strong></p>
<ul class="simple">
<li><p>使用 MuPDF-1.25.2。</p></li>
<li><p><strong>修复的问题</strong>:</p>
<ul>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4125">4125</a>: 转换 Pixmap 的色彩空间时内存泄漏</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4034">4034</a>: 保存时可能发生 PDF 清理回归问题</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.25.0 (2024-12-05)</strong></p>
<ul class="simple">
<li><p>使用 MuPDF-1.25.1。</p></li>
<li><p><strong>修复的问题</strong>:</p>
<ul>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4026">4026</a>: page.get_text(‘blocks’) 输出两个非常相似的文本，具有不同的边界框</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4004">4004</a>: 更新 PDF 表单字段值时发生段错误</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3887">3887</a>: 使用回退字体时的子集字体问题</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3886">3886</a>: 插入 HTML 时销毁 PDF 的另一个问题</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3751">3751</a>: apply_redactions 导致页面内容部分隐藏 / 透明</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.24.14 (2024-11-19)</strong></p>
<ul class="simple">
<li><p>使用 MuPDF-1.24.11。</p></li>
<li><p><strong>修复的问题</strong>:</p>
<ul>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3448">3448</a>: get_pixmap 函数移除了表格，仅留下内容</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3758">3758</a>: 使用 add_redact_annot/apply_redactions 时出现 “malloc(): unaligned tcache chunk detected Aborted (core dumped)” 错误</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3813">3813</a>: Stories: 嵌套无序列表时有序列表计数出错</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3933">3933</a>: font.valid_codepoints() - 故障</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4018">4018</a>: PyMuPDF 在反向遍历零页 PDF 页面时挂起</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4043">4043</a>: fullcopypage 错误</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4047">4047</a>: add_redact_annot 时的段错误</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/4050">4050</a>: doc.embfile_info() 返回的字典内容与文档不符</p></li>
</ul>
</li>
<li><p><strong>其他</strong>:</p>
<ul>
<li><p>确保 <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> 中的单词不包含 RTL/LTR 字符混合。</p></li>
<li><p>修复使用系统 MuPDF 时的构建问题。</p></li>
<li><p>为点和向量添加点积功能。</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.24.13 (2024-10-29)</strong></p>
<ul class="simple">
<li><p><strong>修复的问题</strong>:</p>
<ul>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3848">3848</a>: Pixmap 程序崩溃</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3950">3950</a>: 无法一致地从 PDF 中提取字段标签</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3981">3981</a>: PyMuPDF 1.24.12 与 pyinstaller 一起使用时抛出错误</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3994">3994</a>: pix.color_topusage 引发段错误 (core dumped)</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.24.12 (2024-10-21)</strong></p>
<ul class="simple">
<li><p><strong>修复的问题</strong>:</p>
<ul>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3914">3914</a>: 能够将 MuPDF 错误打印到日志中，而不是标准输出</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3916">3916</a>: insert_htmlbox 错误：整数过大无法转换为浮动</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3950">3950</a>: 无法一致地从 PDF 中提取字段标签</p></li>
</ul>
</li>
<li><p>支持的 Python 版本现在是 3.9 到 3.13。</p>
<ul>
<li><p>停止支持 Python-3.8，因为其已达到生命周期结束。</p></li>
<li><p>添加对 Python-3.13 的支持，因为该版本现已发布。</p></li>
<li><p>参考链接: <a class="reference external" href="https://devguide.python.org/versions/">https://devguide.python.org/versions/</a></p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.24.11 (2024-10-03)</strong></p>
<ul class="simple">
<li><p><strong>使用 MuPDF-1.24.10</strong>。</p></li>
<li><p><strong>修复的问题</strong>:</p>
<ul>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3624">3624</a>: 将 PDF 文件转换为图像时出现黑色块</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3859">3859</a>: doc.need_appearances() 报告 “AttributeError: module ‘pymupdf.mupdf’ has no attribute ‘PDF_TRUE’”</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3863">3863</a>: apply_redactions() 无法按预期工作</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3905">3905</a>: 打开流时，可能会抛出 FzErrorFormat 错误，而不是 FileDataError</p></li>
</ul>
</li>
<li><p>轮子现在使用 Python 稳定 ABI：</p>
<ul>
<li><p>每个平台都有一个 PyMuPDF 轮子。</p></li>
<li><p>每个轮子适用于所有受支持的 Python 版本。</p></li>
<li><p>每个轮子使用最旧的支持 Python 版本（目前为 3.8）构建。</p></li>
<li><p>不再提供 PyMuPDFb 轮子。</p></li>
</ul>
</li>
<li><p><strong>其他</strong>:</p>
<ul>
<li><p>对 <a class="reference internal" href="functions.html#Page.get_text_words" title="Page.get_text_words"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_text_words()</span></code></a> 进行了改进，<code class="xref any docutils literal notranslate"><span class="pre">sort=True</span></code>。</p></li>
<li><p>测试现在始终获取最新版本的所需 Python 包。</p></li>
<li><p>移除了对 setuptools 的依赖。</p></li>
<li><p>在 PyMuPDF-1.24.10 的变更中添加了修复 #3630。</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.24.10 (2024-09-02)</strong></p>
<ul class="simple">
<li><p><strong>使用 MuPDF-1.24.9</strong>。</p></li>
<li><p><strong>修复的问题</strong>:</p>
<ul>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3450">3450</a>: <a class="reference internal" href="annot.html#Annot.get_pixmap" title="Annot.get_pixmap"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_pixmap</span></code></a> 函数处理时间过长</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3569">3569</a>: SVG 图像创建时未忽略无效的 OCGs</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3603">3603</a>: ObjStm 压缩和 PDF 线性化不能一起工作</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3650">3650</a>: 每个字母之间插入了换行符</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3661">3661</a>: 更新 <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> 以检查 <code class="xref any docutils literal notranslate"><span class="pre">/XYZ</span></code> 长度</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3698">3698</a>: 文档问题 - 注释文档中的旧代码</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3705">3705</a>: 在某些特定类型的 PDF 文件中，<a class="reference internal" href="document.html#Document.select" title="Document.select"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a> 表现异常</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3706">3706</a>: 扩展 <code class="xref any docutils literal notranslate"><span class="pre">Document.__getitem__</span></code> 类型注解，以反映该方法也接受切片</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3727">3727</a>: <a class="reference internal" href="annot.html#Annot.get_pixmap" title="Annot.get_pixmap"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_pixmap()</span></code></a> 方法导致程序在没有任何异常或消息的情况下退出</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3767">3767</a>: 无法获取 Tesseract-OCR 5 的 Tessdata</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3773">3773</a>: <a class="reference internal" href="link.html#Link.set_border" title="Link.set_border"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Link.set_border</span></code></a> 报告 TypeError: <code class="xref any docutils literal notranslate"><span class="pre">'&lt;</span> <span class="pre">not</span> <span class="pre">supported</span> <span class="pre">between</span> <span class="pre">instances</span> <span class="pre">of</span> <span class="pre">'NoneType'</span> <span class="pre">and</span> <span class="pre">'int'</span></code></p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3774">3774</a>: <code class="xref any docutils literal notranslate"><span class="pre">fitz.__version__</span></code> 不再工作</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3789">3789</a>: 调用 <a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">insert_pdf</span></code></a> 时抛出 <code class="xref any docutils literal notranslate"><span class="pre">ValueError:</span> <span class="pre">not</span> <span class="pre">enough</span> <span class="pre">values</span> <span class="pre">to</span> <span class="pre">unpack</span> <span class="pre">(expected</span> <span class="pre">3,</span> <span class="pre">got</span> <span class="pre">2)</span></code></p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3820">3820</a>: 改进了 <code class="xref any docutils literal notranslate"><span class="pre">namedDest</span></code> 处理</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3630">3630</a>: <code class="xref any docutils literal notranslate"><span class="pre">page.apply_redactions</span></code> 给出了不需要的黑色矩形</p></li>
</ul>
</li>
<li><p><strong>其他</strong>:</p>
<ul>
<li><p>无法同时使用对象流和线性化；如果尝试这么做，将引发异常。 (#3603)</p></li>
<li><p>修复了对不存在的 <code class="xref any docutils literal notranslate"><span class="pre">/Contents</span></code> 对象的处理。</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.24.9 (2024-07-24)</strong></p>
<ul class="simple">
<li><p>使用 MuPDF-1.24.8.</p></li>
</ul>
<p><strong>Changes in version 1.24.8 (2024-07-22)</strong></p>
<ul class="simple">
<li><p><strong>修复的问题</strong>:</p>
<ul>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3636">3636</a>: <code class="xref any docutils literal notranslate"><span class="pre">open</span></code> 函数的 API 文档不容易找到。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3654">3654</a>: <code class="xref any docutils literal notranslate"><span class="pre">docx</span></code> 解析在 1.24.7 中已损坏。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3677">3677</a>: 无法在 PyMuPDF 1.24.6 和 1.24.7 中提取子集字体名称。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3687">3687</a>: <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Page.get_text</span></code></a> 在处理 EPUB 文件时导致 <code class="xref any docutils literal notranslate"><span class="pre">AssertionError</span></code>。</p></li>
</ul>
</li>
<li><p><strong>其他</strong>:</p>
<ul>
<li><p>修复了代码中由 codespell 检测到的各种拼写错误。</p></li>
<li><p>改进了我们在 Windows 上修改 MuPDF 默认配置的方式。</p></li>
<li><p>使文本搜索支持联字。</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.24.7 (2024-06-26)</strong></p>
<ul class="simple">
<li><p><strong>修复的问题</strong>:</p>
<ul>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3615">3615</a>: <a class="reference internal" href="document.html#Document.pagemode" title="Document.pagemode"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">Document.pagemode</span></code></a> 或 <a class="reference internal" href="document.html#Document.pagelayout" title="Document.pagelayout"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">Document.pagelayout</span></code></a> 在处理 EPUB 文件时崩溃。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3616">3616</a>: 未报告为最新版本。</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.24.6 (2024-06-25)</strong></p>
<p><strong>基于 MuPDF-1.24.4 的版本</strong></p>
<ul class="simple">
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3599">3599</a>：<a class="reference internal" href="story-class.html#Story.fit_width" title="Story.fit_width"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Story.fit_width()</span></code></a> 产生异常换行。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3594">3594</a>：Amazon 可持续发展报告的文本提取乱码问题。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3591">3591</a>：<a class="reference internal" href="page.html#Page.get_drawings" title="Page.get_drawings"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a> 返回的 <a class="reference internal" href="irect.html#IRect.width" title="IRect.width"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">width</span></code></a> 始终为 0。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3561">3561</a>：<code class="xref any docutils literal notranslate"><span class="pre">page.apply_redactions()</span></code> 可能导致 <code class="xref any docutils literal notranslate"><span class="pre">ZeroDivisionError:</span> <span class="pre">float</span> <span class="pre">division</span> <span class="pre">by</span> <span class="pre">zero</span></code>。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3559">3559</a>：<a class="reference internal" href="page.html#Page.insert_htmlbox" title="Page.insert_htmlbox"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">insert_htmlbox</span></code></a> 方法在 <code class="xref any docutils literal notranslate"><span class="pre">H1</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">H2</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">H3</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">H4</span></code> 等标签为空时引发 SegFault 11。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3539">3539</a>：表格识别中新增对虚线网格的检测支持。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3519">3519</a>：<code class="xref any docutils literal notranslate"><span class="pre">get_toc(simple=False)</span></code> 抛出 <code class="xref any docutils literal notranslate"><span class="pre">AttributeError:</span> <span class="pre">'Outline'</span> <span class="pre">object</span> <span class="pre">has</span> <span class="pre">no</span> <span class="pre">attribute</span> <span class="pre">'rect'</span></code>。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3510">3510</a>：<code class="xref any docutils literal notranslate"><span class="pre">page.get_label()</span></code> 可能在文档第一页返回错误标签。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3494">3494</a>：在 <a class="reference internal" href="document.html#Document.subset_fonts" title="Document.subset_fonts"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">subset_fonts</span></code></a> 与 <a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">insert_pdf</span></code></a> 结合使用时，1.24.2/1.24.3 版本可能会引入错误字符。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3470">3470</a>：<a class="reference internal" href="document.html#Document.subset_fonts" title="Document.subset_fonts"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">subset_fonts</span></code></a> 可能在发生错误时无异常或警告直接退出。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3400">3400</a>：在 PyMuPDF 1.24.2 版本中，<a class="reference internal" href="document.html#Document.set_toc" title="Document.set_toc"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">set_toc</span></code></a> 可能导致某些旋转页面的链接坐标被修改。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3347">3347</a>：当 PDF 页面的高度不同时，某些指向页面内部的链接可能不正确。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3237">3237</a>：<a class="reference internal" href="document.html#Document.set_metadata" title="Document.set_metadata"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">set_metadata()</span></code></a> 方法无法正常工作。</p></li>
<li><p><strong>修复</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/3493">3493</a>：隔离 PyMuPDF 与其他库的相互影响，解决 PyMuPDF 与 <code class="xref any docutils literal notranslate"><span class="pre">GdkPixbuf</span></code> 等其他库同时加载时的兼容性问题。</p></li>
</ul>
<p><strong>其他改动</strong></p>
<ul class="simple">
<li><p>解决了 PyMuPDF 在并发使用时由于临时文件名固定而导致</p></li>
</ul>
<p><strong>Changes in version 1.24.5 (2024-05-30)</strong></p>
<ul class="simple">
<li><p>Fixed issues:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3479">3479</a>: regression: fill_textbox: IndexError: pop from empty list</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3488">3488</a>: set_toc method error</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Some more fixes to use MuPDF floating formatting.</p></li>
<li><p>Removed/disabled some unnecessary diagnostics.</p></li>
<li><p>Fixed utils.do_links() crash.</p></li>
<li><p>Experimental new functions <code class="xref any docutils literal notranslate"><span class="pre">pymupdf.apply_pages()</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">pymupdf.get_text()</span></code>.</p></li>
<li><p>Addresses wrong label generation for label styles “a” and “A”.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.24.4 (2024-05-16)</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3418">3418</a>: Re-introduced bug, text align add_redact_annot</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3472">3472</a>: insert_pdf gives SystemError</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>Other:</p>
<ul>
<li><p>Fixed sysinstall test failing to remove all of prior installation before
new install.</p></li>
<li><p>Fixed <code class="xref any docutils literal notranslate"><span class="pre">utils.do_links()</span></code> crash.</p></li>
<li><p>Correct <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a> creation Code.</p></li>
<li><p>Unified various diagnostics.</p></li>
<li><p>Fix bug in <code class="xref any docutils literal notranslate"><span class="pre">page_merge()</span></code>.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.24.3 (2024-05-09)</strong></p>
<ul class="simple">
<li><p>The Python module is now called <code class="xref any docutils literal notranslate"><span class="pre">pymupdf</span></code>. <code class="xref any docutils literal notranslate"><span class="pre">fitz</span></code> is still supported for
backwards compatibility.</p></li>
<li><p>Use MuPDF-1.24.2.</p></li>
<li><p>Fixed issues:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3357">3357</a>: PyMuPDF==1.24.0 will hanging when using page.get_text(“text”)</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3376">3376</a>: Redacting results are not as expected in 1.24.x.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3379">3379</a>: Documentation mismatch for get_text_blocks return value order.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3381">3381</a>: Contents stream contains floats in scientific notation</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3402">3402</a>: Cannot add Widgets containing inter-field-calculation JavaScript</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3414">3414</a>: missing attribute set_dpi()</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3430">3430</a>: page.get_text() cause process freeze with certain pdf on v1.24.2</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>New/modified methods:</p>
<ul>
<li><p><a class="reference internal" href="page.html#Page.remove_rotation" title="Page.remove_rotation"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Page.remove_rotation()</span></code></a>: new, set page rotation to zero while keeping appearance.</p></li>
</ul>
</li>
<li><p>Fixed some problems when checking for PDF properties.</p></li>
<li><p>Fixed pip builds from sdist
(see discussion <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/3360">3360</a>:
Alpine linux docker build failing “No matching distribution found for pymupdfb==1.24.1”).</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.24.2 (2024-04-17)</strong></p>
<ul class="simple">
<li><p>Removed obsolete classic implementation from releases
(previously available as module <code class="xref any docutils literal notranslate"><span class="pre">fitz_old</span></code>).</p></li>
<li><p>Fixed issues:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3331">3331</a>: Document.pages() is incorrectly type-hinted</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3354">3354</a>: PyMuPDF==1.24.1: AttributeError: property ‘metadata’ of ‘Document’ object has no setter</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>New/modified methods:</p>
<ul>
<li><p><a class="reference internal" href="document.html#Document.bake" title="Document.bake"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Document.bake()</span></code></a>: new, make annotations / fields permanent content.</p></li>
<li><p><a class="reference internal" href="page.html#Page.cluster_drawings" title="Page.cluster_drawings"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Page.cluster_drawings()</span></code></a>: new, identifies drawing items
(i.e. vector graphics or line-art)
that belong together based on their geometrical vicinity.</p></li>
<li><p><a class="reference internal" href="page.html#Page.apply_redactions" title="Page.apply_redactions"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Page.apply_redactions()</span></code></a>: added new parameter <a class="reference internal" href="xml-class.html#Xml.text" title="Xml.text"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">text</span></code></a>.</p></li>
<li><p><a class="reference internal" href="document.html#Document.subset_fonts" title="Document.subset_fonts"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Document.subset_fonts()</span></code></a>: use MuPDF’s <code class="xref any docutils literal notranslate"><span class="pre">pdf_subset_fonts()</span></code> instead of PyMuPDF code.</p></li>
</ul>
</li>
<li><p>The <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> class now supports page numbers specified as slices.</p></li>
<li><p>Avoid causing MuPDF warnings.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.24.1 (2024-04-02)</strong></p>
<ul class="simple">
<li><p>Fixed issues:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3278">3278</a>: apply_redactions moves some unredacted text</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3301">3301</a>: Be more permissive when classifying links as kind LINK_URI</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3306">3306</a>: Text containing capital ‘ET’ not appearing as annotation</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Use MuPDF-1.24.1.</p></li>
<li><p>Support ObjStm Compression.
Methods <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a>, <a class="reference internal" href="document.html#Document.ez_save" title="Document.ez_save"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Document.ez_save()</span></code></a> and <code class="xref any docutils literal notranslate"><span class="pre">Document.write()</span></code>
now support new parameters <code class="xref any docutils literal notranslate"><span class="pre">use_objstm</span></code>, compression_effort` and
<code class="xref any docutils literal notranslate"><span class="pre">preserve_metadata</span></code>.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.24.0 (2024-03-21)</strong></p>
<ul>
<li><p>Fixed issues:</p>
<ul class="simple">
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3281">3281</a>: Preparing metadata (pyproject.toml) did not run successfully</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3279">3279</a>: PyMuPDF no longer builds in Alpine Linux</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3257">3257</a>: apply_redactions() deleting text outside of annoted box</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3216">3216</a>: AttributeError: ‘Annot’ object has no attribute ‘__del__’</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3207">3207</a>: get_drawings’s items is missing line from h path operator</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3201">3201</a>: Memory leaks when merging PDFs</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3197">3197</a>: page.get_text() returns hexadecimal text for some characters</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3196">3196</a>: Remove text not working in 1.23.25 version vs 1.20.2</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3172">3172</a>: PDF’s 45º lines dissapearing in png conversion</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3135">3135</a>: Do not log warnings to stdout</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3125">3125</a>: get_pixmap method stuck on one page and runs forever</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2964">2964</a>: There is an issue with the image generated by the page.get_pixmap() function</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Use MuPDF-1.24.0.</p></li>
<li><p>Add support for redacting vector graphics.</p></li>
<li><p>Several fixes for table module</p>
<ul>
<li><p>Add new method for outputting the table as a markdown string.</p></li>
<li><p>Address errors in computing the table header object:</p>
<p>We now allow None as the cell value, because this will be resolved where
needed (e.g. in the pandas DataFrame).</p>
<p>We previously tried to enforce rect-like tuples in all header cell
bboxes, however this fails for tables with all-None columns.  This fix
enables this and constructs an empty string in the corresponding cell
string.</p>
<p>We now correctly include start / stop points of lines in the bbox of the
clustered graphic.  We previously joined the line’s rectangle - which had
no effect because this is always empty.</p>
</li>
</ul>
</li>
<li><p>Improved exception text if we fail to open document.</p></li>
<li><p>Fixed build with new libclang 18.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.26 (2024-02-29)</strong></p>
<ul class="simple">
<li><p>Fixed issues:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3199">3199</a>: Add entry_points to setuptools configuration to provide command-line console scripts</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3209">3209</a>: Empty vertices in ink annotation</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Improvements to table detection:</p>
<ul>
<li><p>Improved check for empty tables, fixes bugs when determining table headers.</p></li>
<li><p>Improved computation of enveloping vector graphic rectangles.</p></li>
<li><p>Ignore more meaningless “pseudo” tables</p></li>
</ul>
</li>
<li><p>Install command-line ‘pymupdf’ command that runs fitz/__main__.py.</p></li>
<li><p>Don’t overwrite MuPDF’s config.h when building on non-Windows.</p></li>
<li><p>Fix <a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a> constructor’s <a class="reference internal" href="archive-class.html#archive"><span class="std std-ref">Archive</span></a> arg to match docs - now accepts a single <a class="reference internal" href="archive-class.html#archive"><span class="std std-ref">Archive</span></a> constructor arg.</p></li>
<li><p>Do not include MuPDF source in sdist; will be downloaded automatically when building.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.25 (2024-02-20)</strong></p>
<ul class="simple">
<li><p>Fixed issues:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3182">3182</a>: Pixmap.invert_irect argument type error</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3186">3186</a>: extractText() extracts broken text from pdf</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3191">3191</a>: Error on .find_tables()</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>When building, be able to specify python-config directly, with environment
variable <code class="xref any docutils literal notranslate"><span class="pre">PIPCL_PYTHON_CONFIG</span></code>.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.24 (2024-02-19)</strong></p>
<ul class="simple">
<li><p>Fixed issues:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3148">3148</a>: Table extraction - vertical text not handled correctly</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3179">3179</a>: Table Detection: Incorrect Separation of Vector Graphics Clusters</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3180">3180</a>: Cannot show optional content group: AttributeError: module ‘fitz.mupdf’ has no attribute ‘pdf_array_push_drop’</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Be able to test system install using <code class="xref any docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">pip</span> <span class="pre">install</span></code> instead of a venv.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.23 (2024-02-18)</strong></p>
<ul class="simple">
<li><p>Fixed issues:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3126">3126</a>: Initialising Archive with a pathlib.Path fails.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3131">3131</a>: Calling the next attribute of an Annot raises a “No attribute .parent” warning</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3134">3134</a>: Using an IRect as clip parameter in Page.get_pixmap no longer works since 1.23.9</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3140">3140</a>: PDF document stays in use after closing</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3150">3150</a>: doc.select() hangs on this doc.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3163">3163</a>: AssertionError on using fitz.IRect</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3177">3177</a>: fitz.Pixmap(None, pix) Unrecognised args for constructing Pixmap</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Improved <code class="xref any docutils literal notranslate"><span class="pre">Document.select()</span> <span class="pre">by</span> <span class="pre">using</span> <span class="pre">new</span> <span class="pre">MuPDF</span> <span class="pre">function</span>
<span class="pre">`pdf_rearrange_pages()</span></code>. This is a more complete (and faster)
implementation of what needs to be done here in that not only pages will
be rearranged, but also consequential changes will be made to the table
of contents, links to removed pages and affected entries in the Optional
Content definitions.</p></li>
<li><p><a class="reference internal" href="textwriter.html#TextWriter.appendv" title="TextWriter.appendv"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">TextWriter.appendv()</span></code></a>: added <code class="xref any docutils literal notranslate"><span class="pre">small_caps</span></code> arg.</p></li>
<li><p>Fixed some valgrind errors with MuPDF master.</p></li>
<li><p>Fixed <code class="xref any docutils literal notranslate"><span class="pre">Document.insert_image()</span></code> when build with MuPDF master.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.22 (2024-02-12)</strong></p>
<ul class="simple">
<li><p>Fixed issues:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3143">3143</a>: Difference in decoding of OCGs names between doc.get_ocgs() and page.get_drawings()</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3139">3139</a>: Pixmap resizing needs positional arg “clip” - even if None.</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Removed the use of MuPDF function <code class="xref any docutils literal notranslate"><span class="pre">fz_image_size()</span></code> from PyMuPDF.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.21 (2024-02-01)</strong></p>
<ul class="simple">
<li><p>Fixed issues:</p></li>
<li><p>Other:</p>
<ul>
<li><p>Fixed bug in set_xml_metadata(), PR <a href="#id462"><span class="problematic" id="id463">`3112 https://github.com/pymupdf/PyMuPDF/pull/3112&gt;`_</span></a>: Fix pdf_add_stream metadata error</p></li>
<li><p>Fixed lack of <code class="xref any docutils literal notranslate"><span class="pre">.parent</span></code> member in <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a> from <a class="reference internal" href="annot.html#Annot.get_textpage" title="Annot.get_textpage"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Annot.get_textpage()</span></code></a>.</p></li>
<li><p>Fixed bug in <a class="reference internal" href="page.html#Page.add_widget" title="Page.add_widget"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Page.add_widget()</span></code></a>.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.20 (2024-01-29)</strong></p>
<ul class="simple">
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3100">3100</a>: Wrong internal property accessed in get_xml_metadata</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Significantly improved speed of <a class="reference internal" href="document.html#Document.get_toc" title="Document.get_toc"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a>.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.19 (2024-01-25)</strong></p>
<ul class="simple">
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3087">3087</a>: Exception in insert_image with mask specified</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3094">3094</a>: TypeError: ‘&lt;’ not supported between instances of ‘FzLocation’ and ‘int’ in doc.delete_pages</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>When finding tables:</p>
<ul>
<li><p>Allow addition of user-defined “virtual” vector graphics when finding tables.</p></li>
<li><p>Confirm that the enveloping bboxes of vector graphics are inside the clip rectangle.</p></li>
<li><p>Avoid slow finding of rectangle intersections.</p></li>
</ul>
</li>
<li><p>Added <a class="reference internal" href="font.html#Font.bbox" title="Font.bbox"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">Font.bbox</span></code></a> property.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.18 (2024-01-23)</strong></p>
<ul class="simple">
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3081">3081</a>: doc.close() not closing the document</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Reduced size of sdist to fit on pypi.org (by reducing size of two test files).</p></li>
<li><p>Fix <a class="reference internal" href="annot.html#Annot.file_info" title="Annot.file_info"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">Annot.file_info()</span></code></a> if no <code class="xref any docutils literal notranslate"><span class="pre">Desc</span></code> item.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.17 (2024-01-22)</strong></p>
<ul class="simple">
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3062">3062</a>: page_rotation_reset does not return page to original rotation</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3070">3070</a>: update_link(): AttributeError: ‘Page’ object has no attribute ‘super’</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Fixed bug in <a class="reference internal" href="page.html#Page.links" title="Page.links"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Page.links()</span></code></a> (PR #3075).</p></li>
<li><p>Fixed bug in <a class="reference internal" href="functions.html#Page.get_bboxlog" title="Page.get_bboxlog"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Page.get_bboxlog()</span></code></a> with layers.</p></li>
<li><p>Add support for timeouts in scripts/ and tests/run_compound.py.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.16 (2024-01-18)</strong></p>
<ul class="simple">
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3058">3058</a>: Pixmap created from CMYK JPEG delivers RGB format</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>In table detection strategy “lines_strict”, exclude fill-only vector graphics.</p></li>
<li><p>Fixed sysinstall test failure.</p></li>
<li><p>In documentation, update feature matrix with item about text writing.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.15 (2024-01-16)</strong></p>
<ul class="simple">
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3050">3050</a>: python3.9 pix.set_pixel has something wrong in c.append( ord(i))</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Improved docs for Page.find_tables().</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.14 (2024-01-15)</strong></p>
<ul class="simple">
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3038">3038</a>: JM_pixmap_from_display_list &gt; Assertion Error : Checking for wrong type</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3039">3039</a>: Issue with doc.close() not closing the document in PyMuPDF</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Ensure valid “re” rectangles in <a class="reference internal" href="page.html#Page.get_drawings" title="Page.get_drawings"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a> with derotated pages.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.13 (2024-01-15)</strong></p>
<ul class="simple">
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2979">2979</a>: list index out of range in to_pandas()</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3001">3001</a>: Calling find_tables() on one document alters the bounding boxes of a subsequent document</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Fixed <code class="xref any docutils literal notranslate"><span class="pre">Rect.height</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">Rect.width</span></code> to never return negative values.</p></li>
<li><p>Fixed <code class="xref any docutils literal notranslate"><span class="pre">TextPage.extractIMGINFO()</span></code>’s returned <code class="xref any docutils literal notranslate"><span class="pre">dictkey_yres</span></code> value.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.12 (2024-01-12)</strong></p>
<ul class="simple">
<li><ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3027">3027</a>: Page.get_text throws Attribute Error for ‘parent’</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.11 (2024-01-12)</strong></p>
<ul class="simple">
<li><p>Fixed some Pixmap construction bugs.</p></li>
<li><p>Fixed Pixmap.yres().</p></li>
</ul>
<p><strong>Changes in version 1.23.10 (2024-01-12)</strong></p>
<ul class="simple">
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/3020">3020</a>: Can’t resize a PixMap</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Fixed Page.delete_image().</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.9 (2024-01-11)</strong></p>
<ul class="simple">
<li><p>Default to new “rebased” implementation.</p>
<ul>
<li><p>The old “classic” implementation is available with <code class="xref any docutils literal notranslate"><span class="pre">import</span> <span class="pre">fitz_old</span> <span class="pre">as</span> <span class="pre">fitz</span></code>.</p></li>
<li><p>For more information about why we are changing to the rebased implementation,
see: <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/2680">https://github.com/pymupdf/PyMuPDF/discussions/2680</a></p></li>
</ul>
</li>
<li><p>Use MuPDF-1.23.9.</p></li>
<li><p>Bug fixes (rebased implementation only):</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2911">2911</a>: Page.derotation_matrix returns a tuple instead of a Matrix with rebased implementation</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2919">2919</a>: Rebased version: KeyError in resolve_names when merging pdfs</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2922">2922</a>: New feature that allows inserting named-destination links doesn’t work</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2943">2943</a>: ZeroDivisionError: float division by zero when use apply_redactions()</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2950">2950</a>: Shelling out to pip during tests is problematic</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2954">2954</a>: Replacement unicode character in text extraction</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2957">2957</a>: apply_redactions() moving text</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2961">2961</a>: Passing a string as a page number raises IndexError instead of TypeError.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2969">2969</a>: annot.next throws AttributeError</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2978">2978</a>: 1.23.9rc1: module ‘fitz.mupdf’ has no attribute ‘fz_copy_pixmap_rect’</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2907">2907</a>: segfault trying to call clean_contents on certain pdfs with python 3.12</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2905">2905</a>: SystemError: &lt;built-in function TextPage_extractIMGINFO&gt; returned a result with an exception set</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2742">2742</a>: Segmentation Fault when inserting three (but not two) copies of the same source page into one destination page</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Add optional setting of opacity to <a class="reference internal" href="page.html#Page.insert_htmlbox" title="Page.insert_htmlbox"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Page.insert_htmlbox()</span></code></a>.</p></li>
<li><p>Fixed issue with add_redact_annot() mentioned in #2934.</p></li>
<li><p>Fixed <a class="reference internal" href="page.html#Page.rotation" title="Page.rotation"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">Page.rotation()</span></code></a> to return 0 for non-PDF documents instead of raising an exception.</p></li>
<li><p>Fixed internal quad detection to cope with any Python sequence.</p></li>
<li><p>Fixed rebased <code class="xref any docutils literal notranslate"><span class="pre">fitz.pymupdf_version_tuple</span></code> - was previously set to mupdf version.</p></li>
<li><p>Improved support for Linux system installs, including adding regular testing on Github.</p></li>
<li><p>Add missing <code class="xref any docutils literal notranslate"><span class="pre">flake8</span></code> to <code class="xref any docutils literal notranslate"><span class="pre">scripts/gh_release.py:test_packages</span></code>.</p></li>
<li><p>Use newly public functions in MuPDF-1.23.8.</p></li>
<li><p>Improved <code class="xref any docutils literal notranslate"><span class="pre">scripts/test.py</span></code> to help investigation of MuPDF issues.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.8 (2023-12-19)</strong></p>
<ul class="simple">
<li><p>Bug fixes (rebased implementation only):</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2634">2634</a>: get_toc and set_toc do not behave consistently for rotated pages</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2861">2861</a>: AttributeError in getLinkDict during PDF Merge</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2871">2871</a>: KeyError in getLinkDict during PDF merge</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2886">2886</a>: Error in Skeleton for Named Link Destinations</p></li>
</ul>
</li>
<li><p>Bug fixes (rebased and classic implementations):</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2885">2885</a>: pymupdf find tables too slow</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Rebased implementation:</p>
<ul>
<li><p><a class="reference internal" href="page.html#Page.insert_htmlbox" title="Page.insert_htmlbox"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Page.insert_htmlbox()</span></code></a>: new, much more powerful alternative to <a class="reference internal" href="page.html#Page.insert_textbox" title="Page.insert_textbox"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Page.insert_textbox()</span></code></a> or <a class="reference internal" href="textwriter.html#TextWriter.fill_textbox" title="TextWriter.fill_textbox"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">TextWriter.fill_textbox()</span></code></a>, using <a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a>.</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">Story.fit*()</span></code>: new methods for fitting a Story into an expanded rect.</p></li>
<li><p><a class="reference internal" href="story-class.html#Story.write_with_links" title="Story.write_with_links"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Story.write_with_links()</span></code></a>: add support for external links.</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">Document.language()</span></code>: fixed to use MuPDF’s new <code class="xref any docutils literal notranslate"><span class="pre">mupdf.fz_string_from_text_language2()</span></code>.</p></li>
<li><p><a class="reference internal" href="document.html#Document.subset_fonts" title="Document.subset_fonts"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Document.subset_fonts()</span></code></a> - fixed.</p></li>
<li><p>Fixed internal <code class="xref any docutils literal notranslate"><span class="pre">Archive._add_treeitem()</span></code> method.</p></li>
<li><p>Fixed <code class="xref any docutils literal notranslate"><span class="pre">fitz_new.__doc__</span></code> to contain PyMuPDF and Python version information, and OS name.</p></li>
<li><p>Removed use of <code class="xref any docutils literal notranslate"><span class="pre">(*args,</span> <span class="pre">**kwargs)</span></code> in API, we now specify keyword args explicitly.</p></li>
<li><p>Work with new MuPDF Python exception classes.</p></li>
</ul>
</li>
<li><p>Fixed bug where <a class="reference internal" href="widget.html#Widget.button_states" title="Widget.button_states"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">button_states()</span></code></a> returns None when <code class="xref any docutils literal notranslate"><span class="pre">/AP</span></code> points to an indirect object.</p></li>
<li><p>Fixed pillow test to not ignore all errors, and install pillow when testing.</p></li>
<li><p>Added test for <code class="xref any docutils literal notranslate"><span class="pre">fitz.css_for_pymupdf_font()</span></code> (uses package <code class="xref any docutils literal notranslate"><span class="pre">pymupdf-fonts</span></code>).</p></li>
<li><p>Simplified Github Actions test specifications.</p></li>
<li><p>Updated <code class="xref any docutils literal notranslate"><span class="pre">tests/README.md</span></code>.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.7 (2023-11-30)</strong></p>
<ul class="simple">
<li><p>Bug fixes in rebased implementation, not fixed in classic implementation:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2232">2232</a>: Geometry helper classes should support keyword arguments</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2788">2788</a>: Problem with get_toc in pymupdf 1.23.6</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2791">2791</a>: Experiencing small memory leak in save()</p></li>
</ul>
</li>
<li><p>Bug fixes (rebased and classic implementations):</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2736">2736</a>: Failure when set cropbox with mediabox negative value</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2749">2749</a>: RuntimeError: cycle in structure tree</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2753">2753</a>: Story.write_with_links will ignore everything after the first “page break” in the HTML.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2812">2812</a>: find_tables on landscape page generates reversed text</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2829">2829</a>: [cannot create /Annot for kind] is still printed despite #2345 is closed.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2841">2841</a>: Unexpected KeyError when using scrub with fitz_new</p></li>
</ul>
</li>
<li><p>Use MuPDF-1.23.7.</p></li>
<li><p>Other:</p>
<ul>
<li><p>Rebased implementation:</p>
<ul>
<li><p>Added flake8 code checking to test suite, and made various fixes.</p></li>
<li><p>Disable diagnostics during Document constructor to match classic implementation.</p></li>
</ul>
</li>
<li><p>Additional fix to <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2553">2553</a>: Invalid characters in versions &gt;= 1.22</p></li>
<li><p>Fixed <a class="reference external" href="https://bugs.ghostscript.com/show_bug.cgi?id=707324">MuPDF Bug 707324</a>: Story: HTML table row background color repeated incorrectly</p></li>
<li><p>Added <code class="xref any docutils literal notranslate"><span class="pre">scripts/test.py</span></code>, for simple build+test of PyMuPDF git checkout.</p></li>
<li><p>Added <code class="xref any docutils literal notranslate"><span class="pre">fitz.pymupdf_version_tuple</span></code>, e.g. <code class="xref any docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">23,</span> <span class="pre">6)</span></code>.</p></li>
<li><p>Restored mistakenly-reverted fix for <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2345">2345</a>: Turn off print statements in utils.py</p></li>
<li><p>Include any trailing <code class="xref any docutils literal notranslate"><span class="pre">...</span> <span class="pre">repeated</span> <span class="pre">&lt;N&gt;</span> <span class="pre">times...</span></code> text in warnings returned by <a class="reference internal" href="tools.html#Tools.mupdf_warnings" title="Tools.mupdf_warnings"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">mupdf_warnings()</span></code></a> (rebased only).</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.6 (2023-11-06)</strong></p>
<ul class="simple">
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2553">2553</a>: Invalid characters in versions &gt;= 1.22</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2608">2608</a>: Incorrect utf32 text extraction (high &amp; low surrogates are split)</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2710">2710</a>: page.rect and text location wrong / differing from older version</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2774">2774</a>: wrong encoding for “?” character when sort=True</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2775">2775</a>: fitz_new does not work with python3.10 or earlier</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2777">2777</a>: With fitz_new, wrong type for Page.mediabox</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Use MuPDF-1.23.5.</p></li>
<li><p>Added Document.resolve_names() (rebased implementation only).</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.5 (2023-10-11)</strong></p>
<ul class="simple">
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2341">2341</a>: Handling negative values in the zoom section for LINK_GOTO in linkDest</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2522">2522</a>: Typo in set_layer() - NameError: name ‘f’ is not defined</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2548">2548</a>: Fitz freezes on some PDFs when calling the fitz.Page.get_text_blocks method.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2596">2596</a>: save(garbage=3) breaks get_pixmap() with side effect</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2635">2635</a>: “clean=True” makes objects invisible in the pdf</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2637">2637</a>: Page.insert_textbox incorrectly handles the last word if it starts a new line</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2699">2699</a>: extract paragraph with below table</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2703">2703</a>: Wrong fontsize calculation in corner cases (“page.get_texttrace()”)</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2710">2710</a>: page.rect and text location wrong / differing from older version</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2723">2723</a>: When will a Python 3.12 wheel be available?</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2730">2730</a>: persistent get_text() formatting</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Use MuPDF-1.23.4.</p></li>
<li><p>Fix optimisation flags with system installs.</p></li>
<li><p>Fixed the problem that the clip parameter does not take effect during table recognition</p></li>
<li><p>Support Pillow mode “RGBa”</p></li>
<li><p>Support extra word delimiters</p></li>
<li><p>Support checking valid PDF name objects</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.4 (2023-09-26)</strong></p>
<ul class="simple">
<li><p>Improved build instructions.</p></li>
<li><p>Fixed Tesseract in rebased implementation.</p></li>
<li><p>Improvements to build/install with system MuPDF.</p></li>
<li><p>Fixed Pyodide builds.</p></li>
<li><p>Fixed rebased bug in _insert_image().</p></li>
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2556">2556</a>: Segmentation fault at caling get_cdrawings(extended=True)</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2637">2637</a>: Page.insert_textbox incorrectly handles the last word if it starts a new line</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2683">2683</a>: Windows sdist build failure - non-quoting of path and using UNIX which command</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2691">2691</a>: Page.get_textpage_ocr() bug in rebased fitz_new version</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2692">2692</a>: Page.get_pixmap(clip=Rect()) bug in rebased fitz_new version</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.23.3 (2023-08-31)</strong></p>
<ul class="simple">
<li><p>Fixed use of Tesseract for OCR.</p></li>
</ul>
<p><strong>Changes in version 1.23.2 (2023-08-28)</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2613">#2613</a>: release 1.23.0 not MacOS-arm64 compatible</p></li>
</ul>
<p><strong>Changes in version 1.23.1 (2023-08-24)</strong></p>
<ul class="simple">
<li><p>Updated README and package summary description.</p></li>
<li><p>Fixed a problem on some Linux installations with Python-3.10
(and possibly earlier versions) where <code class="xref any docutils literal notranslate"><span class="pre">import</span> <span class="pre">fitz</span></code> failed with
<code class="xref any docutils literal notranslate"><span class="pre">ImportError:</span> <span class="pre">libcrypt.so.2:</span> <span class="pre">cannot</span> <span class="pre">open</span> <span class="pre">shared</span> <span class="pre">object</span> <span class="pre">file:</span> <span class="pre">No</span> <span class="pre">such</span>
<span class="pre">file</span> <span class="pre">or</span> <span class="pre">directory</span></code>.</p></li>
<li><p>Fixed <code class="xref any docutils literal notranslate"><span class="pre">incompatible</span> <span class="pre">architecture</span></code> error on MacOS arm64.</p></li>
<li><p>Fixed installation warning from Poetry about missing entry in wheels’
RECORD files.</p></li>
</ul>
<p><strong>Changes in version 1.23.0 (2023-08-22)</strong></p>
<ul>
<li><p>Add method <a class="reference internal" href="page.html#Page.find_tables" title="Page.find_tables"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">find_tables()</span></code></a> to the <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> object.</p>
<p>This allows locating tables on any supported document page, and
extracting table content by cell.</p>
</li>
<li><p>New “rebased” implementation of PyMuPDF.</p>
<p>The rebased implementation is available as Python module
<code class="xref any docutils literal notranslate"><span class="pre">fitz_new</span></code>. It can be used as a drop-in replacement with <code class="xref any docutils literal notranslate"><span class="pre">import</span>
<span class="pre">fitz_new</span> <span class="pre">as</span> <span class="pre">fitz</span></code>.</p>
</li>
<li><p>Python-independent MuPDF libraries are now in a second wheel called
<code class="xref any docutils literal notranslate"><span class="pre">PyMuPDFb</span></code> that will be automatically installed by pip.</p>
<p>This is to save space on pypi.org - a full release only needs one
<code class="xref any docutils literal notranslate"><span class="pre">PyMuPDFb</span></code> wheel for each OS.</p>
</li>
<li><p>Bug fixes:</p>
<ul class="simple">
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2542">#2542</a>: fitz.utils.scrub AttributeError Annot object has no attribute fileUpd inside</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2533">#2533</a>: get_texttrace returned a incorrect character bbox</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2537">#2537</a>: Validation when setting a grouped RadioButton throws a RuntimeError: path to ‘V’ has indirects</p></li>
</ul>
</li>
<li><p>Other changes:</p>
<ul>
<li><p>Dropped support for Python-3.7.</p></li>
<li><p>Fix for wrong page / annot <code class="xref any docutils literal notranslate"><span class="pre">/Contents</span></code> cleaning.</p>
<p>We need to set <code class="xref any docutils literal notranslate"><span class="pre">pdf_filter_options::no_update</span></code> to zero.</p>
</li>
<li><p>Added new function get_tessdata().</p></li>
<li><p>Cope with problem <code class="xref any docutils literal notranslate"><span class="pre">/Annot</span></code> arrays.</p>
<p>When copying page annotations in method Document.insert_pdf we
previously did not check the validity of members of the <code class="xref any docutils literal notranslate"><span class="pre">/Annots</span></code>
array.  For faulty members (like null or non-dictionary items) this
could cause unnecessary exceptions. This fix implements more checks
and skips such array items.</p>
</li>
<li><p>Additional annotation type checks.</p>
<p>We did not previously check for annotation type when getting /
setting annotation border properties. This is now checked in
accordance with MuPDF.</p>
</li>
<li><p>Increase fault tolerance.</p>
<p>Avoid exceptions in method <a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">insert_pdf()</span></code></a> when source pages contains
invalid items in the <code class="xref any docutils literal notranslate"><span class="pre">/Annots</span></code> array.</p>
</li>
<li><p>Return empty border dict for applicable annots.</p>
<p>We previously were returning a non-empty border dictionary even for
non-applicable annotation types.  We now return the empty dictionary
<code class="xref any docutils literal notranslate"><span class="pre">{}</span></code> in these cases. This requires some corresponding changes in the
annotation <code class="xref any docutils literal notranslate"><span class="pre">.update()</span></code> method, namely for dashes and border width.</p>
</li>
<li><p>Restrict <a class="reference internal" href="annot.html#Annot.set_rect" title="Annot.set_rect"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">set_rect</span></code></a> to applicable annot types.</p>
<p>We were insufficiently excluding non-applicable annotation types
from <a class="reference internal" href="annot.html#Annot.set_rect" title="Annot.set_rect"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">set_rect()</span></code></a> method.  We now let MuPDF catch unsupported
annotations and return <code class="xref any docutils literal notranslate"><span class="pre">False</span></code> in these cases.</p>
</li>
<li><p>Wrong fontsize computation in <code class="xref any docutils literal notranslate"><span class="pre">page.get_texttrace()</span></code>.</p>
<p>When computing the font size we were using the final text
transformation matrix, where we should have taken <code class="xref any docutils literal notranslate"><span class="pre">span-&gt;trm</span></code>
instead.  This is corrected here.</p>
</li>
<li><p>Updates to cope with changes to latest MuPDF.</p>
<p><code class="xref any docutils literal notranslate"><span class="pre">pdf_lookup_anchor()</span></code> has been removed.</p>
</li>
<li><p>Update fill_textbox to better respect rect.width</p>
<p>The function norm_words in fill_textbox had a bug in its last
loop, appending n+1 characters when actually measuring width of n
characters.  It led to a bug in fill_texbox when you tried to write
a single word mostly composed of “wide” letters (M,m, W, w…),
causing the written text to exceed the given rect.</p>
<p>The fix was just to replace n+1 by n.</p>
</li>
<li><p>Add <a class="reference internal" href="widget.html#Widget.script_focus" title="Widget.script_focus"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">script_focus</span></code></a> and <a class="reference internal" href="widget.html#Widget.script_blur" title="Widget.script_blur"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">script_blur</span></code></a> options to widget.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.22.5 (2023-06-21)</strong></p>
<ul class="simple">
<li><p>This release uses <code class="docutils literal notranslate"><span class="pre">MuPDF-1.22.2</span></code>.</p></li>
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2365">#2365</a>: Incorrect dictionary values for type “fs” drawings.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2391">#2391</a>: Check box automatically uncheck when we update same checkbox more than 1 times.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2400">#2400</a>: Gaps within text of same line not filled with spaces.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2404">#2404</a>: Blacklining an image in PDF won’t remove underlying content in version 1.22.X.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2430">#2430</a>: Incorrectly reducing ref count of Py_None.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2450">#2450</a>: Empty fill color and fill opacity for paths with fill and stroke operations with 1.22.*</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2462">#2462</a>: Error at “get_drawing(extended=True )”</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2468">#2468</a>: Decode error when trying to get drawings</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2710">#2710</a>: page.rect and text location wrong / differing from older version</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2723">#2723</a>: When will a Python 3.12 wheel be available?</p></li>
</ul>
</li>
<li><p>New features:</p>
<ul>
<li><p><strong>Changed</strong> Annotations now support “cloudy” borders.
The <a class="reference internal" href="annot.html#Annot.border" title="Annot.border"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.border</span></code></a> property has the new item <code class="xref any docutils literal notranslate"><span class="pre">clouds</span></code>,
and method <a class="reference internal" href="annot.html#Annot.set_border" title="Annot.set_border"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_border()</span></code></a> supports the corresponding <code class="xref any docutils literal notranslate"><span class="pre">clouds</span></code> argument.</p></li>
<li><p><strong>Changed</strong> Radio button widgets in the same RB group
are now consistently updated <strong>if the group is defined in the standard way</strong>.</p></li>
<li><p><strong>Added</strong> Support for the <code class="xref any docutils literal notranslate"><span class="pre">/Locked</span></code> key in PDF Optional Content.
This array inside the catalog entry <code class="xref any docutils literal notranslate"><span class="pre">/OCProperties</span></code> can now be extracted and set.</p></li>
<li><p><strong>Added</strong> Support for new parameter <code class="xref any docutils literal notranslate"><span class="pre">tessdata</span></code> in OCR functions.
New function <a class="reference internal" href="functions.html#get_tessdata" title="get_tessdata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_tessdata()</span></code></a> locates the language support folder if Tesseract is installed.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.22.3 (2023-05-10)</strong></p>
<ul class="simple">
<li><p>This release uses <code class="docutils literal notranslate"><span class="pre">MuPDF-1.22.0</span></code>.</p></li>
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2333">#2333</a>: Unable to set any of button radio group in form</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.22.2 (2023-04-26)</strong></p>
<ul class="simple">
<li><p>This release uses <code class="docutils literal notranslate"><span class="pre">MuPDF-1.22.0</span></code>.</p></li>
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2369">#2369</a>: Image extraction bugs with newer versions</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.22.1 (2023-04-18)</strong></p>
<ul class="simple">
<li><p>This release uses <code class="docutils literal notranslate"><span class="pre">MuPDF-1.22.0</span></code>.</p></li>
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2345">#2345</a>: Turn off print statements in utils.py</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2348">#2348</a>: extract_image returns an extension “flate” instead of “png”</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2350">#2350</a>: Can not make widget (checkbox) to read-only by adding flags PDF_FIELD_IS_READ_ONLY</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2355">#2355</a>: 1.22.0 error when using get_toc (AttributeError: ‘SwigPyObject’ object has no attribute)</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in version 1.22.0 (2023-04-14)</strong></p>
<ul class="simple">
<li><p>This release uses <code class="docutils literal notranslate"><span class="pre">MuPDF-1.22.0</span></code>.</p></li>
<li><p>Behavioural changes:</p>
<ul>
<li><p>Text extraction now includes glyphs that overlap with clip rect; previously
they were included only if they were entirely contained within the clip
rect.</p></li>
</ul>
</li>
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1763">#1763</a>: Interactive(smartform) form PDF calculation not working in pymupdf</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1995">#1995</a>: RuntimeError: image is too high for a long paged pdf file when trying</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2093">#2093</a>: Image in pdf changes color after applying redactions</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2108">#2108</a>: Redaction removing more text than expected</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2141">#2141</a>: Failed to read JPX header when trying to get blocks</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2144">#2144</a>: Replace image throws an error</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2146">#2146</a>: Wrong Handling of Reference Count of “None” Object</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2161">#2161</a>: Support adding images as pages directly</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2168">#2168</a>: <code class="docutils literal notranslate"><span class="pre">page.add_highlight_annot(start=pointa,</span> <span class="pre">stop=pointb)</span></code> not working</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2173">#2173</a>: Double free of <code class="docutils literal notranslate"><span class="pre">Colorspace</span></code> used in <code class="docutils literal notranslate"><span class="pre">Pixmap</span></code></p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2179">#2179</a>: Incorrect documentation for <code class="docutils literal notranslate"><span class="pre">pixmap.tint_with()</span></code></p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2208">#2208</a>: Pushbutton widget appears as check box</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2210">#2210</a>: <code class="docutils literal notranslate"><span class="pre">apply_redactions()</span></code> move pdf text to right after redaction</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2220">#2220</a>: <code class="docutils literal notranslate"><span class="pre">Page.delete_image()</span></code> | object has no attribute <code class="docutils literal notranslate"><span class="pre">is_image</span></code></p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2228">#2228</a>: open some pdf cost too much time</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2238">#2238</a>: Bug - can not extract data from file in the newest version 1.21.1</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2242">#2242</a>: Python quits silently in <code class="docutils literal notranslate"><span class="pre">Story.element_positions()</span></code> if callback function prototype is wrong</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2246">#2246</a>: TextWriter write text in a wrong position</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2248">#2248</a>: After redacting the content, the position of the remaining text changes</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2250">#2250</a>: docs: unclear or broken link in page.rst</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2251">#2251</a>: mupdf_display_errors does not apply to Pixmap when loading broken image</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2270">#2270</a>: <code class="docutils literal notranslate"><span class="pre">Annot.get_text(&quot;words&quot;)</span></code> - doesn’t return the first line of words</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2275">#2275</a>: insert_image: document that rotations are counterclockwise</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2278">#2278</a>: Can not make widget (checkbox) to read-only by adding flags PDF_FIELD_IS_READ_ONLY</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2290">#2290</a>: Different image format/data from Page.get_text(“dict”) and Fitz.get_page_images()</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2293">#2293</a>: 68 failed tests when installing from sdist on my box</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2300">#2300</a>: Too much recursion in tree (parents), makes program terminate</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2322">#2322</a>: add_highlight_annot using clip generates “A Number is Out of Range” error in PDF</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Add key “/AS (Yes)” to the underlying annot object of a selected button form field.</p></li>
<li><p>Remove unused <code class="docutils literal notranslate"><span class="pre">Document</span></code> methods <code class="docutils literal notranslate"><span class="pre">has_xref_streams()</span></code> and
<code class="docutils literal notranslate"><span class="pre">has_old_style_xrefs()</span></code> as MuPDF equivalents have been removed.</p></li>
<li><p>Add new <code class="docutils literal notranslate"><span class="pre">Document</span></code> methods and properties for getting/setting
<code class="docutils literal notranslate"><span class="pre">/PageMode</span></code>, <code class="docutils literal notranslate"><span class="pre">/PageLayout</span></code> and <code class="docutils literal notranslate"><span class="pre">/MarkInfo</span></code>.</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">Document</span></code> property <code class="docutils literal notranslate"><span class="pre">version_count</span></code>, which contains the number of
incremental saves plus one.</p></li>
<li><p>New <code class="docutils literal notranslate"><span class="pre">Document</span></code> property <code class="docutils literal notranslate"><span class="pre">is_fast_webaccess</span></code> which tells whether the
document is linearized.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DocumentWriter</span></code> is now a context manager.</p></li>
<li><p>Add support for <code class="docutils literal notranslate"><span class="pre">Pixmap</span></code> JPEG output.</p></li>
<li><p>Add support for drawing rectangles with rounded corners.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_drawings()</span></code>: added optional <code class="docutils literal notranslate"><span class="pre">extended</span></code> arg.</p></li>
<li><p>Fixed issue where trace devices’ state was not being initialised
correctly; data returned from things like <code class="docutils literal notranslate"><span class="pre">fitz.Page.get_texttrace()</span></code>
might be slightly altered, e.g. <code class="docutils literal notranslate"><span class="pre">linewidth</span></code> values.</p></li>
<li><p>Output warning to <code class="docutils literal notranslate"><span class="pre">stderr</span></code> if it looks like we are being used with
current directory containing an invalid <code class="docutils literal notranslate"><span class="pre">fitz/</span></code> directory, because
this can break import of <code class="docutils literal notranslate"><span class="pre">fitz</span></code> module. For example this happens
if one attempts to use <code class="docutils literal notranslate"><span class="pre">fitz</span></code> when current directory is a PyMuPDF
checkout.</p></li>
</ul>
</li>
<li><p>Documentation:</p>
<ul>
<li><p>General rework:</p>
<ul>
<li><p>Introduces a new home page and new table of contents.</p></li>
<li><p>Structural update to include new About section.</p></li>
<li><p>Comparison &amp; performance graphing.</p></li>
<li><p>Includes performance methodology in appendix.</p></li>
<li><p>Updates conf.py to understand single back-ticks as code.</p></li>
<li><p>Converts double back-ticks to single back-ticks.</p></li>
<li><p>Removes redundant files.</p></li>
</ul>
</li>
<li><p>Improve <code class="docutils literal notranslate"><span class="pre">insert_file()</span></code> documentation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_bboxlog()</span></code>: aded optional <code class="docutils literal notranslate"><span class="pre">layers</span></code> to <code class="docutils literal notranslate"><span class="pre">get_bboxlog()</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Page.get_texttrace()</span></code>: add new dictionary key <code class="docutils literal notranslate"><span class="pre">layer</span></code>, name of Optional Content Group.</p></li>
<li><p>Mention use of Python venv in installation documentation.</p></li>
<li><p>Added missing fix for #2057 to release 1.21.1’s changelog.</p></li>
<li><p>Fixes many links to the PyMuPDF-Utilities repo scripts.</p></li>
<li><p>Avoid duplication of <code class="docutils literal notranslate"><span class="pre">changes.txt</span></code> and <code class="docutils literal notranslate"><span class="pre">docs/changes.rst</span></code>.</p></li>
</ul>
</li>
<li><p>Build</p>
<ul>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file to improve builds using pip etc.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in Version 1.21.1 (2022-12-13)</strong></p>
<ul class="simple">
<li><p>This release uses <code class="docutils literal notranslate"><span class="pre">MuPDF-1.21.1</span></code>.</p></li>
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2110">#2110</a>: Fully embedded font is extracted only partially if it occupies more than one object</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2094">#2094</a>: Rectangle Detection Logic</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2088">#2088</a>: Destination point not set for named links in toc</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2087">#2087</a>: Image with Filter “[/FlateDecode/JPXDecode]” not extracted</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2086">#2086</a>: Document.save() owner_pw &amp; user_pw has buffer overflow bug</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2076">#2076</a>: Segfault in fitz.py</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2057">#2057</a>: Document.save garbage parameter not working in PyMuPDF 1.21.0</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2051">#2051</a>: Missing DPI Parameter</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2048">#2048</a>: Invalid size of TextPage and bbox with newest version 1.21.0</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2045">#2045</a>: SystemError: &lt;built-in function Page_get_texttrace&gt; returned a result with an error set</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2039">#2039</a>: 1.21.0 fails to build against system libmupdf</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2036">#2036</a>: Archive::Archive defined twice</p></li>
</ul>
</li>
<li><p>Other</p>
<ul>
<li><p>Swallow “&amp;zoom=nan” in link uri strings.</p></li>
<li><p>Add new Page utility methods <code class="docutils literal notranslate"><span class="pre">Page.replace_image()</span></code> and <code class="docutils literal notranslate"><span class="pre">Page.delete_image()</span></code>.</p></li>
</ul>
</li>
<li><p>Documentation:</p>
<ul>
<li><p><a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2040">#2040</a>: Added note about test failure with non-default build of MuPDF, to <code class="docutils literal notranslate"><span class="pre">tests/README.md</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2037">#2037</a>: In <code class="docutils literal notranslate"><span class="pre">docs/installation.rst</span></code>, mention incompatibility with chocolatey.org on Windows.</p></li>
<li><p><a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2061">#2061</a>: Fixed description of <code class="docutils literal notranslate"><span class="pre">Annot.file_info</span></code>.</p></li>
<li><p><a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2065">#2065</a>: Show how to insert internal PDF link.</p></li>
<li><p>Improved description of building from source without an sdist.</p></li>
<li><p>Added information about running tests.</p></li>
<li><p><a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2084">#2084</a>: Fixed broken link to PyMuPDF-Utilities.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in Version 1.21.0 (2022-11-8)</strong></p>
<ul class="simple">
<li><p>This release uses <code class="docutils literal notranslate"><span class="pre">MuPDF-1.21.0</span></code>.</p></li>
<li><p>New feature: Stories.</p></li>
<li><p>Added wheels for Python-3.11.</p></li>
<li><p>Bug fixes:</p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1701">#1701</a>: Broken custom image insertion.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1854">#1854</a>: <a class="reference internal" href="document.html#Document.delete_pages" title="Document.delete_pages"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Document.delete_pages()</span></code></a> declines keyword arguments.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1868">#1868</a>: Access Violation Error at <code class="xref any docutils literal notranslate"><span class="pre">page.apply_redactions()</span></code>.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1909">#1909</a>: Adding text with <code class="xref any docutils literal notranslate"><span class="pre">fontname=&quot;Helvetica&quot;</span></code> can silently fail.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1913">#1913</a>: <a class="reference internal" href="page.html#Page.draw_rect" title="Page.draw_rect"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">draw_rect()</span></code></a>: does not respect width if color is not specified.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1917">#1917</a>: <a class="reference internal" href="document.html#Document.subset_fonts" title="Document.subset_fonts"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">subset_fonts()</span></code></a>: make it possible to silence the stdout.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1936">#1936</a>: Rectangle detection can be incorrect producing wrong output.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1945">#1945</a>: Segmentation fault when saving with <code class="xref any docutils literal notranslate"><span class="pre">clean=True</span></code>.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1965">#1965</a>: <a class="reference internal" href="pixmap.html#Pixmap.pdfocr_save" title="Pixmap.pdfocr_save"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">pdfocr_save()</span></code></a> Hard Crash.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1971">#1971</a>: Segmentation fault when using <a class="reference internal" href="page.html#Page.get_drawings" title="Page.get_drawings"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_drawings()</span></code></a>.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1946">#1946</a>: <code class="xref any docutils literal notranslate"><span class="pre">block_no</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">block_type</span></code> switched in <a class="reference internal" href="annot.html#Annot.get_text" title="Annot.get_text"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_text()</span></code></a> docs.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/2013">#2013</a>: AttributeError: ‘Widget’ object has no attribute ‘_annot’ in delete widget.</p></li>
</ul>
</li>
<li><p>Misc changes to core code:</p>
<ul>
<li><p>Fixed various compiler warnings and a sequence-point bug.</p></li>
<li><p>Added support for Memento builds.</p></li>
<li><p>Fixed leaks detected by Memento in test suite.</p></li>
<li><p>Fixed handling of exceptions in set_name() and set_rect().</p></li>
<li><p>Allow build with latest MuPDF, for regular testing of PyMuPDF master.</p></li>
<li><p>Cope with new MuPDF exceptions when setting rect for some Annot types.</p></li>
<li><p>Reduced cosmetic differences between MuPDF’s config.h and PyMuPDF’s _config.h.</p></li>
<li><p>Cope with various changes to MuPDF API.</p></li>
</ul>
</li>
<li><p>Other:</p>
<ul>
<li><p>Fixed various broken links and typos in docs.</p></li>
<li><p>Mention install of <code class="xref any docutils literal notranslate"><span class="pre">swig-python</span></code> on MacOS for #875.</p></li>
<li><p>Added (untested) wheels for macos-arm64.</p></li>
</ul>
</li>
</ul>
<p><strong>Changes in Version 1.20.2</strong></p>
<ul class="simple">
<li><p>This release uses <code class="docutils literal notranslate"><span class="pre">MuPDF-1.20.3</span></code>.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1787">#1787</a>.
Fix linking issues on Unix systems.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1824">#1824</a>.
SegFault when applying redactions overlapping a transparent image. (Fixed
in <code class="docutils literal notranslate"><span class="pre">MuPDF-1.20.3</span></code>.)</p></li>
<li><p>Improvements to documentation:</p>
<ul>
<li><p>Improved information about building from source in <code class="docutils literal notranslate"><span class="pre">docs/installation.rst</span></code>.</p></li>
<li><p>Clarified memory allocation setting <code class="docutils literal notranslate"><span class="pre">JM_MEMORY`</span> <span class="pre">in</span> <span class="pre">``docs/tools.rst</span></code>.</p></li>
<li><p>Fixed link to PDF Reference manual in <code class="docutils literal notranslate"><span class="pre">docs/app3.rst</span></code>.</p></li>
<li><p>Fixed building of html documentation on OpenBSD.</p></li>
<li><p>Moved old <code class="docutils literal notranslate"><span class="pre">docs/faq.rst</span></code> into separate <code class="docutils literal notranslate"><span class="pre">docs/recipes-*</span></code> files.</p></li>
</ul>
</li>
<li><p>Removed some unused files and directories:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">installation/</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">docs/wheelnames.txt</span></code></p></li>
</ul>
</li>
</ul>
<p><strong>Changes in Version 1.20.1</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1724">#1724</a>.
Fix for building on FreeBSD.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1771">#1771</a>.
<a class="reference internal" href="linkdest.html#linkDest" title="linkDest"><code class="xref any py py-class docutils literal notranslate"><span class="pre">linkDest()</span></code></a> had a broken call to <code class="xref any docutils literal notranslate"><span class="pre">re.match()</span></code>, introduced in 1.20.0.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1751">#1751</a>.
<a class="reference internal" href="page.html#Page.get_drawings" title="Page.get_drawings"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_drawings()</span></code></a> and <a class="reference internal" href="page.html#Page.get_cdrawings" title="Page.get_cdrawings"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_cdrawings()</span></code></a> previously always returned with <code class="xref any docutils literal notranslate"><span class="pre">closePath=False</span></code>.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1645">#1645</a>.
Default FreeText annotation text color is now black.</p></li>
<li><p>Improvements to sphinx-generated documentation:</p>
<ul>
<li><p>Use readthedocs theme with enhancements.</p></li>
<li><p>Renamed the <code class="xref any docutils literal notranslate"><span class="pre">.txt</span></code> files to have <code class="xref any docutils literal notranslate"><span class="pre">.rst</span></code> suffixes.</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.20.0</strong></p>
<p>This release uses <code class="docutils literal notranslate"><span class="pre">MuPDF-1.20.0</span></code>, released 2022-06-15.</p>
<ul class="simple">
<li><p>Cope with new MuPDF link uri format, changed from <code class="docutils literal notranslate"><span class="pre">#&lt;int&gt;,&lt;int&gt;,&lt;int&gt;</span></code> to <code class="docutils literal notranslate"><span class="pre">#page=&lt;int&gt;&amp;zoom=&lt;float&gt;,&lt;float&gt;,&lt;float&gt;</span></code>.</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>In <code class="docutils literal notranslate"><span class="pre">tests/test_insertpdf.py</span></code>, use new reference output <code class="docutils literal notranslate"><span class="pre">joined-1.20.pdf</span></code>. We also check that new output values are approximately the same as the old ones.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1738">#1738</a>. Leak of <code class="xref any docutils literal notranslate"><span class="pre">pdf_graft_map</span></code>.
Also fixed a SEGV issue that this seemed to expose, caused by incorrect freeing of underlying fz_document.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1733">#1733</a>. Fixed ownership of <code class="xref any docutils literal notranslate"><span class="pre">Annotation.get_pixmap()</span></code>.</p></li>
</ul>
<p>Changes to build/release process:</p>
<ul class="simple">
<li><p>If pip builds from source because an appropriate wheel is not available, we no longer require MuPDF to be pre-installed. Instead the required MuPDF source is embedded in the sdist and automatically built into PyMuPDF.</p></li>
<li><p>Various changes to <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> to download the required MuPDF release as required. See comments at start of setup.py for details.</p></li>
<li><p>Added <code class="docutils literal notranslate"><span class="pre">.github/workflows/build_wheels.yml</span></code> to control building of wheels on Github.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.19.6</strong></p>
<ul>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1620">#1620</a>. The <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a> created by <a class="reference internal" href="page.html#Page.get_textpage" title="Page.get_textpage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_textpage()</span></code></a> will now be freed correctly (removed memory leak).</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1601">#1601</a>. Document open errors should now be more concise and easier to interpret. In the course of this, two PyMuPDF-specific Python exceptions have been <strong>added:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">EmptyFileError</span></code> – raised when trying to create a <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> (<code class="docutils literal notranslate"><span class="pre">fitz.open()</span></code>) from an empty file or zero-length memory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FileDataError</span></code> – raised when MuPDF encounters irrecoverable document structure issues.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>Added</strong> <a class="reference internal" href="page.html#Page.load_widget" title="Page.load_widget"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.load_widget()</span></code></a> given a PDF field’s xref.</p></li>
<li><p><strong>Added</strong> Dictionary <a class="reference internal" href="functions.html#pdfcolor" title="pdfcolor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pdfcolor</span></code></a> which provide the about 500 colors defined as PDF color values with the lower case color name as key.</p></li>
<li><p><strong>Added</strong> algebra functionality to the <a class="reference internal" href="quad.html#quad"><span class="std std-ref">Quad</span></a> class. These objects can now also be added and subtracted among themselves, and be multiplied by numbers and matrices.</p></li>
<li><p><strong>Added</strong> new constants defining the default text extraction flags for more comfortable handling. Their naming convention is like <a class="reference internal" href="vars.html#TEXTFLAGS_WORDS" title="TEXTFLAGS_WORDS"><code class="xref py py-data docutils literal notranslate"><span class="pre">TEXTFLAGS_WORDS</span></code></a> for <code class="docutils literal notranslate"><span class="pre">page.get_text(&quot;words&quot;)</span></code>. See <a class="reference internal" href="app1.html#text-extraction-flags"><span class="std std-ref">文本提取标志默认值</span></a>.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="page.html#Page.annots" title="Page.annots"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.annots()</span></code></a> and <a class="reference internal" href="page.html#Page.widgets" title="Page.widgets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.widgets()</span></code></a> to detect and prevent reloading the page (illegally) inside the iterator loops via <a class="reference internal" href="document.html#Document.reload_page" title="Document.reload_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.reload_page()</span></code></a>. Doing this brings down the interpretor. Documented clean ways to do annotation and widget mass updates within properly designed loops.</p></li>
<li><p><strong>Changed</strong> several internal utility functions to become standalone (“SWIG inline”) as opposed to be part of the <a class="reference internal" href="tools.html#tools"><span class="std std-ref">Tools</span></a> class. This, among other things, increases the performance of geometry object creation.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#Document.update_stream" title="Document.update_stream"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.update_stream()</span></code></a> to always accept stream updates - whether or not the dictionary object behind the xref already is a stream. Thus the former <code class="docutils literal notranslate"><span class="pre">new</span></code> parameter is now ignored and will be removed in v1.20.0.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.19.5</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1518">#1518</a>. A limited “fix”: in some cases, rectangles and quadrupels were not correctly encoded to support re-drawing by <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a>.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1521">#1521</a>. This had the same ultimate reason behind issue #1510.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1513">#1513</a>. Some Optional Content functions did not support non-ASCII characters.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1510">#1510</a>. Support more soft-mask image subtypes.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1507">#1507</a>. Immunize against items in the outlines chain, that are <code class="docutils literal notranslate"><span class="pre">&quot;null&quot;</span></code> objects.</p></li>
<li><p><strong>Fixed</strong> re-opened <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1417">#1417</a>. (“too many open files”). This was due to insufficient calls to MuPDF’s <code class="docutils literal notranslate"><span class="pre">fz_drop_document()</span></code>. This also fixes <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1550">#1550</a>.</p></li>
<li><p><strong>Fixed</strong> several undocumented issues in relation to incorrectly setting the text span origin <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a>.</p></li>
<li><p><strong>Fixed</strong> undocumented error computing the character bbox in method <a class="reference internal" href="functions.html#Page.get_texttrace" title="Page.get_texttrace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_texttrace()</span></code></a> when text is <strong>flipped</strong> (as opposed to just rotated).</p></li>
<li><p><strong>Added</strong> items to the dictionary returned by <code class="xref py py-meth docutils literal notranslate"><span class="pre">image_properties()</span></code>: <code class="docutils literal notranslate"><span class="pre">orientation</span></code> and <code class="docutils literal notranslate"><span class="pre">transform</span></code> report the natural image orientation (EXIF data).</p></li>
<li><p><strong>Added</strong> method <a class="reference internal" href="document.html#Document.xref_copy" title="Document.xref_copy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_copy()</span></code></a>. It will make a given target PDF object an exact copy of a source object.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.19.4</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1505">#1505</a>. Immunize against circular outline items.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1484">#1484</a>. Correct CropBox coordinates are now returned in all situations.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1479">#1479</a>.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1474">#1474</a>. TextPage objects are now properly deleted again.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> methods and attributes for PDF <code class="docutils literal notranslate"><span class="pre">/ArtBox</span></code>, <code class="docutils literal notranslate"><span class="pre">/BleedBox</span></code>, <code class="docutils literal notranslate"><span class="pre">/TrimBox</span></code>.</p></li>
<li><p><strong>Added</strong> global attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">TESSDATA_PREFIX</span></code> for easy checking of OCR support.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#Document.xref_set_key" title="Document.xref_set_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_set_key()</span></code></a> such that dictionary keys will physically be removed if set to value <code class="docutils literal notranslate"><span class="pre">&quot;null&quot;</span></code>.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#Document.extract_font" title="Document.extract_font"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extract_font()</span></code></a> to optionally return a dictionary (instead of a tuple).</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.19.3</strong></p>
<p>This patch version implements minor improvements for <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> and also some important fixes.</p>
<ul class="simple">
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/1351">#1351</a>. Reverted code that introduced the memory growth in v1.18.15.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/1417">#1417</a>. Developped circumvention for growth of open file handles using <a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a>.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/1418">#1418</a>. Developped circumvention for memory growth using <a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a>.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/1430">#1430</a>. Developped circumvention for mass pixmap generations of document pages.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/1433">#1433</a>. Solves a bbox error for some Type 3 font in PyMuPDF text processing.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="pixmap.html#Pixmap.color_topusage" title="Pixmap.color_topusage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.color_topusage()</span></code></a> to determine the share of the most frequently used color. Solves <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/1397">#1397</a>.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="pixmap.html#Pixmap.warp" title="Pixmap.warp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.warp()</span></code></a> which makes a new pixmap from a given arbitrary convex quad inside the pixmap.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="annot.html#Annot.irt_xref" title="Annot.irt_xref"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.irt_xref</span></code></a> and <a class="reference internal" href="annot.html#Annot.set_irt_xref" title="Annot.set_irt_xref"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_irt_xref()</span></code></a> to inquire or set the <code class="xref any docutils literal notranslate"><span class="pre">/IRT</span></code> (“In Responde To”) property of an annotation. Implements <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/1450">#1450</a>.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Rect.torect()</span></code> and <a class="reference internal" href="irect.html#IRect.torect" title="IRect.torect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">IRect.torect()</span></code></a> which compute a matrix that transforms to a given other rectangle.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="pixmap.html#Pixmap.color_count" title="Pixmap.color_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.color_count()</span></code></a> to also return the count of each color.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="functions.html#Page.get_texttrace" title="Page.get_texttrace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_texttrace()</span></code></a> to also return correct span and character bboxes if <code class="docutils literal notranslate"><span class="pre">span[&quot;dir&quot;]</span> <span class="pre">!=</span> <span class="pre">(1,</span> <span class="pre">0)</span></code>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.19.2</strong></p>
<p>This patch version implements minor improvements for <a class="reference internal" href="page.html#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a> and also some important fixes.</p>
<ul class="simple">
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/1388">#1388</a>. Fixed intermittent memory corruption when insert or updating annotations.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/1375">#1375</a>. Inconsistencies between line numbers as returned by the “words” and the “dict” options of <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> have been corrected.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1342">#1364</a>. The check for being a <code class="docutils literal notranslate"><span class="pre">&quot;rawdict&quot;</span></code> span in <a class="reference internal" href="functions.html#recover_span_quad" title="recover_span_quad"><code class="xref py py-meth docutils literal notranslate"><span class="pre">recover_span_quad()</span></code></a> now works correctly.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1364">#1342</a>. Corrected the check for rectangle infiniteness in <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a>.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="page.html#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a>, <a class="reference internal" href="page.html#Page.get_cdrawings" title="Page.get_cdrawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_cdrawings()</span></code></a> to return an indicator on the area orientation covered by a rectangle. This implements <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1355">#1355</a>. Also, the recognition rate for rectangles and quads has been significantly improved.</p></li>
<li><p><strong>Changed</strong> all text search and extraction methods to set the new <code class="docutils literal notranslate"><span class="pre">flags</span></code> option <code class="docutils literal notranslate"><span class="pre">TEXT_MEDIABOX_CLIP</span></code> to ON by default. That bit causes the automatic suppression of all characters that are completely outside a page’s mediabox (in as far as that notion is supported for a document type). This eliminates the need for using <code class="docutils literal notranslate"><span class="pre">clip=page.rect</span></code> or similar for omitting text outside the visible area.</p></li>
<li><p><strong>Added</strong> parameter <code class="docutils literal notranslate"><span class="pre">&quot;dpi&quot;</span></code> to <a class="reference internal" href="page.html#Page.get_pixmap" title="Page.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_pixmap()</span></code></a> and <a class="reference internal" href="annot.html#Annot.get_pixmap" title="Annot.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.get_pixmap()</span></code></a>. When given, parameter <code class="docutils literal notranslate"><span class="pre">&quot;matrix&quot;</span></code> is ignored, and a <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> with the desired dots per inch is created.</p></li>
<li><p><strong>Added</strong> attributes <a class="reference internal" href="pixmap.html#Pixmap.is_monochrome" title="Pixmap.is_monochrome"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Pixmap.is_monochrome</span></code></a> and <a class="reference internal" href="pixmap.html#Pixmap.is_unicolor" title="Pixmap.is_unicolor"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Pixmap.is_unicolor</span></code></a> allowing fast checks of pixmap properties. Addresses <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/1397">#1397</a>.</p></li>
<li><p><strong>Added</strong> method <a class="reference internal" href="pixmap.html#Pixmap.color_count" title="Pixmap.color_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.color_count()</span></code></a> to determine the unique colors in the pixmap.</p></li>
<li><p><strong>Added</strong> boolean parameter <code class="docutils literal notranslate"><span class="pre">&quot;compress&quot;</span></code> to PDF document method <a class="reference internal" href="document.html#Document.update_stream" title="Document.update_stream"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.update_stream()</span></code></a>. Addresses / enables solution for <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/1408">#1408</a>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.19.1</strong></p>
<p>This is the first patch version to support MuPDF v1.19.0. Apart from one bug fix, it includes important improvements for OCR support and the option to <strong>sort extracted text</strong> to the standard reading order “from top-left to bottom-right”.</p>
<ul class="simple">
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1328">#1328</a>. “words” text extraction again returns correct <code class="docutils literal notranslate"><span class="pre">(x0,</span> <span class="pre">y0)</span></code> coordinates.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="page.html#Page.get_textpage_ocr" title="Page.get_textpage_ocr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_textpage_ocr()</span></code></a>: it now supports parameter <code class="docutils literal notranslate"><span class="pre">dpi</span></code> to control OCR quality. It is also possible to choose whether the <strong>full page</strong> should be OCRed or <strong>only the images displayed</strong> by the page.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="page.html#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a> and <a class="reference internal" href="page.html#Page.get_cdrawings" title="Page.get_cdrawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_cdrawings()</span></code></a> to automatically convert colors to RGB color tuples. Implements <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/1332">#1332</a>. Similar change was applied to <a class="reference internal" href="functions.html#Page.get_texttrace" title="Page.get_texttrace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_texttrace()</span></code></a>.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> to support a parameter <code class="docutils literal notranslate"><span class="pre">sort</span></code>. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code> the output is conveniently sorted.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.19.0</strong></p>
<p>This is the first version supporting MuPDF 1.19.*, published 2021-10-05. It introduces many new features compared to the previous version 1.18.*.</p>
<p>PyMuPDF has now picked up integrated Tesseract OCR support, which was already present in MuPDF v1.18.0.</p>
<ul class="simple">
<li><p>Supported images can be OCRed via their <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> which results in a 1-page PDF with a text layer.</p></li>
<li><p>All supported document pages (i.e. not only PDFs), can be OCRed using specialized text extraction methods. The result is a mixture of standard and OCR text (depending on which part of the page was deemed to require OCRing) that can be searched and extracted without restrictions.</p></li>
<li><p>All this requires an independent installation of Tesseract. MuPDF actually (only) needs the location of Tesseract’s <code class="docutils literal notranslate"><span class="pre">&quot;tessdata&quot;</span></code> folder, where its language support data are stored. This location must be available as environment variable <code class="docutils literal notranslate"><span class="pre">TESSDATA_PREFIX</span></code>.</p></li>
</ul>
<p>A new MuPDF feature is <strong>journalling PDF updates</strong>, which is also supported by this PyMuPDF version. Changes may be logged, rolled back or replayed, allowing to implement a whole new level of control over PDF document integrity – similar to functions present in modern database systems.</p>
<p>A third feature (unrelated to the new MuPDF version) includes the ability to detect when page <strong>objects cover or hide each other</strong>. It is now e.g. possible to see that text is covered by a drawing or an image.</p>
<ul class="simple">
<li><p><strong>Changed</strong> terminology and meaning of important geometry concepts: Rectangles are now characterized as <em>finite</em>, <em>valid</em> or <em>empty</em>, while the definitions of these terms have also changed. Rectangles specifically are now thought of being “open”: not all corners and sides are considered part of the retangle. Please do read the <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> section for details.</p></li>
<li><p><strong>Added</strong> new parameter <code class="xref any docutils literal notranslate"><span class="pre">&quot;no_new_id&quot;</span></code> to <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> / <a class="reference internal" href="document.html#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a> methods. Use it to suppress updating the second item of the document <code class="docutils literal notranslate"><span class="pre">/ID</span></code> which in PDF indicates that the original file has been updated. If the PDF has no <code class="docutils literal notranslate"><span class="pre">/ID</span></code> at all yet, then no new one will be created either.</p></li>
<li><p><strong>Added</strong> a <strong>journalling facility</strong> for PDF updates. This allows logging changes, undoing or redoing them, or saving the journal for later use. Refer to <a class="reference internal" href="document.html#Document.journal_enable" title="Document.journal_enable"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_enable()</span></code></a> and friends.</p></li>
<li><p><strong>Added</strong> new <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> methods <a class="reference internal" href="pixmap.html#Pixmap.pdfocr_save" title="Pixmap.pdfocr_save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.pdfocr_save()</span></code></a> and <a class="reference internal" href="pixmap.html#Pixmap.pdfocr_tobytes" title="Pixmap.pdfocr_tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.pdfocr_tobytes()</span></code></a>, which generate a 1-page PDF containing the pixmap as PNG image with OCR text layer.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="page.html#Page.get_textpage_ocr" title="Page.get_textpage_ocr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_textpage_ocr()</span></code></a> which executes optical character recognition for the page, then extracts the results and stores them together with “normal” page content in a <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a>. Use or reuse this object in subsequent text extractions and text searches to avoid multiple efforts. The existing text search and text extraction methods have been extended to support a separately created textpage – see next item.</p></li>
<li><p><strong>Added</strong> a new parameter <code class="docutils literal notranslate"><span class="pre">textpage</span></code> to text extraction and text search methods. This allows reuse of a previously created <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a> and thus achieves significant runtime benefits – which is especially important for the new OCR features. But “normal” text extractions can definitely also benefit.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="functions.html#Page.get_texttrace" title="Page.get_texttrace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_texttrace()</span></code></a>, a technical method delivering low-level text character properties. It was present before as a private method, but the author felt it now is mature enough to be officially available. It specifically includes a “sequence number” which indicates the page appearance build operation that painted the text.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="functions.html#Page.get_bboxlog" title="Page.get_bboxlog"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_bboxlog()</span></code></a> which delivers the list of rectangles of page objects like text, images or drawings. Its significance lies in its sequence: rectangles intersecting areas with a lower index are covering or hiding them.</p></li>
<li><p><strong>Changed</strong> methods <a class="reference internal" href="page.html#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a> and <a class="reference internal" href="page.html#Page.get_cdrawings" title="Page.get_cdrawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_cdrawings()</span></code></a> to include a “sequence number” indicating the page appearance build operation that created the drawing.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1311">#1311</a>. Field values in comboboxes should now be handled correctly.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1290">#1290</a>. Error was caused by incorrect rectangle emptiness check, which is fixed due to new geometry logic of this version.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1286">#1286</a>. Text alignment for redact annotations is working again.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1287">#1287</a>. Infinite loop issue for non-Windows systems when applying some redactions has been resolved.</p></li>
<li><p><strong>Fixed</strong> <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1284">#1284</a>. Text layout destruction after applying redactions in some cases has been resolved.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.18 / 1.18.19</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1266">#1266</a>. Failure to set <a class="reference internal" href="pixmap.html#Pixmap.samples" title="Pixmap.samples"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Pixmap.samples</span></code></a> in important cases, was hotfixed in a new version 1.18.19.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1257">#1257</a>. Removing the read-only flag from PDF fields is now possible.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1252">#1252</a>. Now correctly specifying the <code class="docutils literal notranslate"><span class="pre">zoom</span></code> value for PDF link annotations.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1244">#1244</a>. Now correctly computing the transform matrix in <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image__bbox()</span></code>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1241">#1241</a>. Prevent returning artifact characters in <a class="reference internal" href="page.html#Page.get_textbox" title="Page.get_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_textbox()</span></code></a>, which happened in certain constellations.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1234">#1234</a>. Avoid creating infinite rectangles in corner cases – <a class="reference internal" href="page.html#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a>, <a class="reference internal" href="page.html#Page.get_cdrawings" title="Page.get_cdrawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_cdrawings()</span></code></a>.</p></li>
<li><p><strong>Added</strong> test data and test scripts to the source PyPI source distribution.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.17</strong></p>
<p>Focus of this version are major performance improvements of selected functions.</p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1199">#1199</a>. Using a non-existing page number in <a class="reference internal" href="document.html#Document.get_page_images" title="Document.get_page_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_images()</span></code></a> and friends will no longer lead to segfaults.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="page.html#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a> to now differentiate between “stroke”, “fill” and combined paths. Paths containing more than one rectangle (i.e. “re” items) are now supported. Extracting “clipped” paths is now available as an option.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="page.html#Page.get_cdrawings" title="Page.get_cdrawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_cdrawings()</span></code></a>, performance-optimized version of <a class="reference internal" href="page.html#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a>.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="pixmap.html#Pixmap.samples_mv" title="Pixmap.samples_mv"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Pixmap.samples_mv</span></code></a>, <em>memoryview</em> of a pixmap’s pixel area. Does not copy and thus always accesses the current state of that area.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="pixmap.html#Pixmap.samples_ptr" title="Pixmap.samples_ptr"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Pixmap.samples_ptr</span></code></a>, Python “pointer” to a pixmap’s pixel area. Allows much faster creation (factor 800+) of Qt images.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.16</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1184">#1184</a>. Existing PDF widget fonts in a PDF are now accepted (i.e. not forcedly changed to a Base-14 font).</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1154">#1154</a>. Text search hits should now be correct when <code class="docutils literal notranslate"><span class="pre">clip</span></code> is specified.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1152">#1152</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1146">#1146</a>.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="link.html#Link.flags" title="Link.flags"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Link.flags</span></code></a> and <a class="reference internal" href="link.html#Link.set_flags" title="Link.set_flags"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Link.set_flags()</span></code></a> to the <a class="reference internal" href="link.html#link"><span class="std std-ref">Link</span></a> class. Implements enhancement requests <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1187">#1187</a>.</p></li>
<li><p><strong>Added</strong> option to <em>simulate</em> <a class="reference internal" href="textwriter.html#TextWriter.fill_textbox" title="TextWriter.fill_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.fill_textbox()</span></code></a> output for predicting the number of lines, that a given text would occupy in the textbox.</p></li>
<li><p><strong>Added</strong> text output support as subcommand <code class="xref any docutils literal notranslate"><span class="pre">gettext</span></code> to the <code class="docutils literal notranslate"><span class="pre">fitz</span></code> CLI module. Most importantly, original <strong>physical text layout</strong> reproduction is now supported.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.15</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1088">#1088</a>. Removing an annotation’s fill color should now work again both ways, using the <code class="docutils literal notranslate"><span class="pre">fill_color=[]</span></code> argument in <a class="reference internal" href="annot.html#Annot.update" title="Annot.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.update()</span></code></a> as well as <code class="docutils literal notranslate"><span class="pre">fill=[]</span></code> in <a class="reference internal" href="annot.html#Annot.set_colors" title="Annot.set_colors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_colors()</span></code></a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1081">#1081</a>. <a class="reference internal" href="document.html#Document.subset_fonts" title="Document.subset_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.subset_fonts()</span></code></a>: fixed an error which created wrong character widths for some fonts.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1078">#1078</a>. <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> and other methods related to text extraction: changed the default value of the <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a> <code class="docutils literal notranslate"><span class="pre">flags</span></code> parameter. All whitespace and <code class="xref py py-data docutils literal notranslate"><span class="pre">ligatures</span></code> are now preserved.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1085">#1085</a>. The old <em>snake_cased</em> alias of <code class="docutils literal notranslate"><span class="pre">fitz.detTextlength</span></code> is now defined correctly.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#Document.subset_fonts" title="Document.subset_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.subset_fonts()</span></code></a> will now correctly prefix font subsets with an appropriate six letter uppercase tag, complying with the PDF specification.</p></li>
<li><p><strong>Added</strong> new method <a class="reference internal" href="widget.html#Widget.button_states" title="Widget.button_states"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Widget.button_states()</span></code></a> which returns the possible values that a button-type field can have when being set to “on” or “off”.</p></li>
<li><p><strong>Added</strong> support of text with <strong>Small Capital</strong> letters to the <a class="reference internal" href="font.html#font"><span class="std std-ref">Font</span></a> and <a class="reference internal" href="textwriter.html#textwriter"><span class="std std-ref">TextWriter</span></a> classes. This is reflected by an additional bool parameter <code class="docutils literal notranslate"><span class="pre">small_caps</span></code> in various of their methods.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.14</strong></p>
<ul class="simple">
<li><p><strong>Finished</strong> implementing new, “snake_cased” names for methods and properties, that were “camelCased” and awkward in many aspects. At the end of this documentation, there is section <a class="reference internal" href="znames.html#deprecated"><span class="std std-ref">已废弃名称</span></a> with more background and a mapping of old to new names.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1053">#1053</a>. <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a>: when given, include image mask in the hash computation.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1043">#1043</a>. Added <code class="docutils literal notranslate"><span class="pre">Pixmap.getPNGdata</span></code> to the aliases of <a class="reference internal" href="pixmap.html#Pixmap.tobytes" title="Pixmap.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.tobytes()</span></code></a>.</p></li>
<li><p><strong>Fixed</strong> an internal error when computing the enveloping rectangle of drawn paths as returned by <a class="reference internal" href="page.html#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a>.</p></li>
<li><p><strong>Fixed</strong> an internal error occasionally causing loops when outputting text via <a class="reference internal" href="textwriter.html#TextWriter.fill_textbox" title="TextWriter.fill_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.fill_textbox()</span></code></a>.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="font.html#Font.char_lengths" title="Font.char_lengths"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Font.char_lengths()</span></code></a>, which returns a tuple of character widths of a string.</p></li>
<li><p><strong>Added</strong> more ways to specify pages in <a class="reference internal" href="document.html#Document.delete_pages" title="Document.delete_pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_pages()</span></code></a>. Now a sequence (list, tuple or range) can be specified, and the Python <code class="docutils literal notranslate"><span class="pre">del</span></code> statement can be used. In the latter case, Python <code class="docutils literal notranslate"><span class="pre">slices</span></code> are also accepted.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#Document.del_toc_item" title="Document.del_toc_item"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.del_toc_item()</span></code></a>, which disables a single item of the TOC: previously, the title text was removed. Instead, now the complete item will be shown grayed-out by supporting viewers.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.13</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1014">#1014</a>.</p></li>
<li><p><strong>Fixed</strong> an internal memory leak when computing image bboxes – <a class="reference internal" href="page.html#Page.get_image_bbox" title="Page.get_image_bbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_bbox()</span></code></a>.</p></li>
<li><p><strong>Added</strong> support for low-level access and modification of the PDF trailer. Applies to <a class="reference internal" href="document.html#Document.xref_get_keys" title="Document.xref_get_keys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_keys()</span></code></a>, <a class="reference internal" href="document.html#Document.xref_get_key" title="Document.xref_get_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_key()</span></code></a>, and <a class="reference internal" href="document.html#Document.xref_set_key" title="Document.xref_set_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_set_key()</span></code></a>.</p></li>
<li><p><strong>Added</strong> documentation for maintaining private entries in PDF metadata.</p></li>
<li><p><strong>Added</strong> documentation for handling transparent image insertions, <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a>.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="page.html#Page.get_image_rects" title="Page.get_image_rects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_rects()</span></code></a>, an improved version of <a class="reference internal" href="page.html#Page.get_image_bbox" title="Page.get_image_bbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_bbox()</span></code></a>.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#Document.delete_pages" title="Document.delete_pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_pages()</span></code></a> to support various ways of specifying pages to delete. Implements <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/1042">#1042</a>.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a> to also accept the xref of an existing image in the file. This allows “copying” images between pages, and extremely fast mutiple insertions.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a> to also accept the integer parameter <code class="docutils literal notranslate"><span class="pre">alpha</span></code>. To be used for performance improvements.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="pixmap.html#Pixmap.set_alpha" title="Pixmap.set_alpha"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.set_alpha()</span></code></a> to support new parameters for pre-multiplying colors with their alpha values and setting a specific color to fully transparent (e.g. white).</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#Document.embfile_add" title="Document.embfile_add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_add()</span></code></a> to automatically set creation and modification date-time. Correspondingly, <a class="reference internal" href="document.html#Document.embfile_upd" title="Document.embfile_upd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_upd()</span></code></a> automatically maintains modification date-time (<code class="docutils literal notranslate"><span class="pre">/ModDate</span></code> PDF key), and <a class="reference internal" href="document.html#Document.embfile_info" title="Document.embfile_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_info()</span></code></a> correspondingly reports these data. In addition, the embedded file’s associated “collection item” is included via its <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>. This supports the development of PDF portfolio applications.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.11 / 1.18.12</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/972">#972</a>. Improved layout of source distribution material.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/962">#962</a>. Stabilized Linux distribution detection for generating PyMuPDF from sources.</p></li>
<li><p><strong>Added:</strong> <a class="reference internal" href="page.html#Page.get_xobjects" title="Page.get_xobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_xobjects()</span></code></a> delivers the result of <a class="reference internal" href="document.html#Document.get_page_xobjects" title="Document.get_page_xobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_xobjects()</span></code></a>.</p></li>
<li><p><strong>Added:</strong> <a class="reference internal" href="page.html#Page.get_image_info" title="Page.get_image_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_info()</span></code></a> delivers meta information for all images shown on the page.</p></li>
<li><p><strong>Added:</strong> <a class="reference internal" href="tools.html#Tools.mupdf_display_warnings" title="Tools.mupdf_display_warnings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Tools.mupdf_display_warnings()</span></code></a> allows setting on / off the display of MuPDF-generated warnings. The default is off.</p></li>
<li><p><strong>Added:</strong> <a class="reference internal" href="document.html#Document.ez_save" title="Document.ez_save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.ez_save()</span></code></a> convenience alias of <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> with some different defaults.</p></li>
<li><p><strong>Changed:</strong> Image extractions of document pages now also contain the image’s <strong>transformation matrix</strong>. This concerns <a class="reference internal" href="page.html#Page.get_image_bbox" title="Page.get_image_bbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_bbox()</span></code></a> and the DICT, JSON, RAWDICT, and RAWJSON variants of <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.10</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/941">#941</a>. Added old aliases for <a class="reference internal" href="displaylist.html#DisplayList.get_pixmap" title="DisplayList.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DisplayList.get_pixmap()</span></code></a> and <a class="reference internal" href="displaylist.html#DisplayList.get_textpage" title="DisplayList.get_textpage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DisplayList.get_textpage()</span></code></a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/929">#929</a>. Stabilized removal of JavaScript objects with <a class="reference internal" href="document.html#Document.scrub" title="Document.scrub"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.scrub()</span></code></a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/927">#927</a>. Removed a loop in the reworked <a class="reference internal" href="textwriter.html#TextWriter.fill_textbox" title="TextWriter.fill_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.fill_textbox()</span></code></a>.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#Document.xref_get_keys" title="Document.xref_get_keys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_keys()</span></code></a> and <a class="reference internal" href="document.html#Document.xref_get_key" title="Document.xref_get_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_key()</span></code></a> to also allow accessing the PDF trailer dictionary. This can be done by using <code class="xref any docutils literal notranslate"><span class="pre">-1</span></code> as the xref number argument.</p></li>
<li><p><strong>Added</strong> a number of functions for reconstructing the quads for text lines, spans and characters extracted by <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> options “dict” and “rawdict”. See <a class="reference internal" href="functions.html#recover_quad" title="recover_quad"><code class="xref py py-meth docutils literal notranslate"><span class="pre">recover_quad()</span></code></a> and friends.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="tools.html#Tools.unset_quad_corrections" title="Tools.unset_quad_corrections"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Tools.unset_quad_corrections()</span></code></a> to suppress character quad corrections (occasionally required for erroneous fonts).</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.9</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/888">#888</a>. Removed ambiguous statements concerning PyMuPDF’s license, which is now clearly stated to be GNU AGPL V3.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/895">#895</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/896">#896</a>. Since v1.17.6 PyMuPDF suppresses the font subset tags and only reports the base fontname in text extraction outputs “dict” / “json” / “rawdict” / “rawjson”. Now a new global parameter can request the old behaviour, <a class="reference internal" href="tools.html#Tools.set_subset_fontnames" title="Tools.set_subset_fontnames"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Tools.set_subset_fontnames()</span></code></a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/885">#885</a>. Pixmap creation now also works with filenames given as <code class="docutils literal notranslate"><span class="pre">pathlib.Paths</span></code>.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#Document.subset_fonts" title="Document.subset_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.subset_fonts()</span></code></a>: Text is <strong>not rewritten</strong> any more and should therefore <strong>retain all its origial properties</strong> – like being hidden or being controlled by Optional Content mechanisms.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="textwriter.html#textwriter"><span class="std std-ref">TextWriter</span></a> output to also accept text in right to left mode (Arabian, Hebrew): <a class="reference internal" href="textwriter.html#TextWriter.fill_textbox" title="TextWriter.fill_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.fill_textbox()</span></code></a>, <a class="reference internal" href="textwriter.html#TextWriter.append" title="TextWriter.append"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.append()</span></code></a>. These methods now accept a new boolean parameter <code class="xref any docutils literal notranslate"><span class="pre">right_to_left</span></code>, which is <em>False</em> by default. Implements <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/897">#897</a>.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="textwriter.html#TextWriter.fill_textbox" title="TextWriter.fill_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.fill_textbox()</span></code></a> to return all lines of text, that did not fit in the given rectangle. Also changed the default of the <code class="docutils literal notranslate"><span class="pre">warn</span></code> parameter to no longer print a warning message in overflow situations.</p></li>
<li><p><strong>Added</strong> a utility function <a class="reference internal" href="functions.html#recover_quad" title="recover_quad"><code class="xref py py-meth docutils literal notranslate"><span class="pre">recover_quad()</span></code></a>, which computes the quadrilateral of a span. This function can be used for correctly marking text extracted with the “dict” or “rawdict” options of <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.8</strong></p>
<p>This is a bug fix version only. We are publishing early because of the potentially widely used functions.</p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/881">#881</a>. Fixed a memory leak in <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a> when inserting images from files or memory.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/878">#878</a>. <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code> objects should now correctly handle file path hierarchies.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.7</strong></p>
<ul class="simple">
<li><p><strong>Added</strong> an experimental <a class="reference internal" href="document.html#Document.subset_fonts" title="Document.subset_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.subset_fonts()</span></code></a> which reduces the size of eligible fonts based on their use by text in the PDF. Implements <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/discussions/855">#855</a>.</p></li>
<li><p><strong>Implemented</strong> request <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/pull/870">#870</a>: <a class="reference internal" href="document.html#Document.convert_to_pdf" title="Document.convert_to_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.convert_to_pdf()</span></code></a> now also supports PDF documents.</p></li>
<li><p><strong>Renamed</strong> <code class="docutils literal notranslate"><span class="pre">Document.write</span></code> to <a class="reference internal" href="document.html#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a> for greater clarity. But the deprecated name remains available for some time.</p></li>
<li><p><strong>Implemented</strong> request <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/Discussions/843">#843</a>: <a class="reference internal" href="document.html#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a> now supports linearized PDF output. <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> now also supports writing to Python <strong>file objects</strong>. In addition, the open function now also supports Python file objects.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/844">#844</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/838">#838</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/823">#823</a>. More logic for better support of OCRed text output (Tesseract, ABBYY).</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/818">#818</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/814">#814</a>.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="document.html#Document.get_page_labels" title="Document.get_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_labels()</span></code></a> which returns a list of page label definitions of a PDF.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="document.html#Document.has_annots" title="Document.has_annots"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.has_annots()</span></code></a> and <a class="reference internal" href="document.html#Document.has_links" title="Document.has_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.has_links()</span></code></a> to check whether these object types are present anywhere in a PDF.</p></li>
<li><p><strong>Added</strong> expert low-level functions to simplify inquiry and modification of PDF object sources: <a class="reference internal" href="document.html#Document.xref_get_keys" title="Document.xref_get_keys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_keys()</span></code></a> lists the keys of object <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>, <a class="reference internal" href="document.html#Document.xref_get_key" title="Document.xref_get_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_key()</span></code></a> returns type and content of a key, and <a class="reference internal" href="document.html#Document.xref_set_key" title="Document.xref_set_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_set_key()</span></code></a> modifies the key’s value.</p></li>
<li><p><strong>Added</strong> parameter <code class="docutils literal notranslate"><span class="pre">thumbnails</span></code> to <a class="reference internal" href="document.html#Document.scrub" title="Document.scrub"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.scrub()</span></code></a> to also allow removing page thumbnail images.</p></li>
<li><p><strong>Improved</strong> documentation for how to add valid text marker annotations for non-horizontal text.</p></li>
</ul>
<p>We continued the process of renaming methods and properties from <em>“mixedCase”</em> to <em>“snake_case”</em>. Documentation usually mentions the new names only, but old, deprecated names remain available for some time.</p>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.6</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/812">#812</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/793">#793</a>. Invalid document metadata previously prevented opening some documents at all. This error has been removed.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/792">#792</a>. Text search and text extraction will make no rectangle containment checks at all if the default <code class="docutils literal notranslate"><span class="pre">clip=None</span></code> is used.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/785">#785</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/780">#780</a>. Corrected a parameter check error.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/779">#779</a>. Fixed typo</p></li>
<li><p><strong>Added</strong> an option to set the desired line height for text boxes. Implements <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/804">#804</a>.</p></li>
<li><p><strong>Changed</strong> text position retrieval to better cope with Tesseract’s glyphless font. Implements <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/803">#803</a>.</p></li>
<li><p><strong>Added</strong> an option to choose the prefix of new annotations, fields and links for providing unique annotation ids. Implements request <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/807">#807</a>.</p></li>
<li><p><strong>Added</strong> getting and setting color and text properties for Table of Contents items for PDFs. Implements <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/779">#779</a>.</p></li>
<li><p><strong>Added</strong> PDF page label handling: <a class="reference internal" href="page.html#Page.get_label" title="Page.get_label"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_label()</span></code></a> returns the page label, <a class="reference internal" href="document.html#Document.get_page_numbers" title="Document.get_page_numbers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_numbers()</span></code></a> return all page numbers having a specified label, and <a class="reference internal" href="document.html#Document.set_page_labels" title="Document.set_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_page_labels()</span></code></a> adds or updates a PDF’s page label definition.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>This version introduces <strong>Python type hinting</strong>. The goal is to provide each parameter and the return value of all functions and methods with type information. This still is work in progress although the majority of functions has already been handled.</p>
</div>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.5</strong></p>
<p>Apart from several fixes, this version also focusses on several minor, but important feature improvements. Among the latter is a more precise computation of proper line heights and insertion points for writing / inserting text. As opposed to using font-agnostic constants, these values are now taken from the font’s properties.</p>
<p>Also note that this is the first version which does no longer provide pregenerated wheels for Python versions older than 3.6. PIP also discontinues support for these by end of this year 2020.</p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/771">#771</a>. By using “small glyph heights” option, the full page text can be extracted.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/768">#768</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/750">#750</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/739">#739</a>. The “dict”, “rawdict” and corresponding JSON output variants now have two new <em>span</em> keys: <code class="docutils literal notranslate"><span class="pre">&quot;ascender&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;descender&quot;</span></code>. These floats represent special font properties which can be used to compute bboxes of spans or characters of <strong>exactly fontsize height</strong> (as opposed to the default line height). An example algorithm is shown in section “Span Dictionary” <a class="reference external" href="https://pymupdf.readthedocs.io/en/latest/textpage.html#dictionary-structure-of-extractdict-and-extractrawdict">here</a>. Also improved the detection and correction of ill-specified ascender / descender values encountered in some fonts.</p></li>
<li><p><strong>Added</strong> a new, experimental <a class="reference internal" href="tools.html#Tools.set_small_glyph_heights" title="Tools.set_small_glyph_heights"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Tools.set_small_glyph_heights()</span></code></a> – also in response to issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/739">#739</a>. This method sets or unsets a global parameter to <strong>always compute bboxes with fontsize height</strong>. If “on”, text searching and all text extractions will returned rectangles, bboxes and quads with a smaller height.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/728">#728</a>.</p></li>
<li><p><strong>Changed</strong> fill color logic of ‘Polyline’ annotations: this parameter now only pertains to line end symbols – the annotation itself can no longer have a fill color. Also addresses issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/727">#727</a>.</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getImageBbox()</span></code> to also compute the bbox if the image is contained in an XObject.</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insertTextbox()</span></code>, resp. <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insertTextbox()</span></code>, resp. <code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.fillTextbox()</span></code> to respect font’s properties “ascender” / “descender” when computing line height and insertion point. This should no longer lead to line overlaps for multi-line output. These methods used to ignore font specifics and used constant values instead.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.4</strong></p>
<p>This version adds several features to support PDF Optional Content. Among other things, this includes OCMDs (Optional Content Membership Dictionaries) with the full scope of <em>“visibility expressions”</em> (PDF key <code class="docutils literal notranslate"><span class="pre">/VE</span></code>), text insertions (including the <a class="reference internal" href="textwriter.html#textwriter"><span class="std std-ref">TextWriter</span></a> class) and drawings.</p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/727">#727</a>. Freetext annotations now support an uncolored rectangle when <code class="docutils literal notranslate"><span class="pre">fill_color=None</span></code>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/726">#726</a>. UTF-8 encoding errors are now handled for HTML / XML <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getText()</span></code> output.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/724">#724</a>. Empty values are no longer stored in the PDF /Info metadata dictionary.</p></li>
<li><p><strong>Added</strong> new methods <a class="reference internal" href="document.html#Document.set_oc" title="Document.set_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_oc()</span></code></a> and <a class="reference internal" href="document.html#Document.get_oc" title="Document.get_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_oc()</span></code></a> to set or get optional content references for <strong>existing</strong> image and form XObjects. These methods are similar to the same-named methods of <a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a>.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="document.html#Document.set_ocmd" title="Document.set_ocmd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_ocmd()</span></code></a>, <a class="reference internal" href="document.html#Document.get_ocmd" title="Document.get_ocmd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_ocmd()</span></code></a> for handling OCMDs.</p></li>
<li><p><strong>Added</strong> <strong>Optional Content</strong> support for text insertion and drawing.</p></li>
<li><p><strong>Added</strong> new method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.deleteWidget()</span></code>, which deletes a form field from a page. This is analogous to deleting annotations.</p></li>
<li><p><strong>Added</strong> support for Popup annotations. This includes defining the Popup rectangle and setting the Popup to open or closed. Methods / attributes <a class="reference internal" href="annot.html#Annot.set_popup" title="Annot.set_popup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_popup()</span></code></a>, <a class="reference internal" href="annot.html#Annot.set_open" title="Annot.set_open"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_open()</span></code></a>, <a class="reference internal" href="annot.html#Annot.has_popup" title="Annot.has_popup"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.has_popup</span></code></a>, <a class="reference internal" href="annot.html#Annot.is_open" title="Annot.is_open"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.is_open</span></code></a>, <a class="reference internal" href="annot.html#Annot.popup_rect" title="Annot.popup_rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.popup_rect</span></code></a>, <a class="reference internal" href="annot.html#Annot.popup_xref" title="Annot.popup_xref"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.popup_xref</span></code></a>.</p></li>
</ul>
<p>Other changes:</p>
<ul>
<li><p>The <strong>naming of methods and attributes</strong> in PyMuPDF is far from being satisfactory: we have <em>CamelCases</em>, <em>mixedCases</em> and <em>lower_case_with_underscores</em> all over the place. With the <a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a> as the first candidate, we have started an activity to clean this up step by step, converting to lower case with underscores for methods and attributes while keeping UPPERCASE for the constants.</p>
<blockquote>
<div><ul class="simple">
<li><p>Old names will remain available to prevent code breaks, but they will no longer be mentioned in the documentation.</p></li>
<li><p>New methods and attributes of all classes will be named according to the new standard.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.3</strong></p>
<p>As a major new feature, this version introduces support for PDF’s <strong>Optional Content</strong> concept.</p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/714">#714</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/711">#711</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/707">#707</a>: if a PDF user password, but no owner password is supplied nor present, then the user password is also used as the owner password.</p></li>
<li><p><strong>Fixed</strong> <code class="docutils literal notranslate"><span class="pre">expand</span></code> and <code class="docutils literal notranslate"><span class="pre">deflate</span></code> parameters of methods <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.write()</span></code>. Individual image and font compression should now finally work. Addresses issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/713">#713</a>.</p></li>
<li><p><strong>Added</strong> a support of PDF optional content. This includes several new <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> methods for inquiring and setting optional content status and adding optional content configurations and groups. In addition, images, form XObjects and annotations now can be bound to optional content specifications. <strong>Resolved</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/709">#709</a>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.2</strong></p>
<p>This version contains some interesting improvements for text searching: any number of search hits is now returned and the <strong>hit_max</strong> parameter was removed. The new <strong>clip</strong> parameter in addition allows to restrict the search area. Searching now detects hyphenations at line breaks and accordingly finds hyphenated words.</p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/575">#575</a>: if using <code class="docutils literal notranslate"><span class="pre">quads=False</span></code> in text searching, then overlapping rectangles on the same line are joined. Previously, parts of the search string, which belonged to different “marked content” items, each generated their own rectangle – just as if occurring on separate lines.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.isRepaired</span></code>, which is true if the PDF was repaired on open.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.setXmlMetadata()</span></code> which either updates or creates PDF XML metadata. Implements issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/691">#691</a>.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.getXmlMetadata()</span></code> returns PDF XML metadata.</p></li>
<li><p><strong>Changed</strong> creation of PDF documents: they will now always carry a PDF identification (<code class="docutils literal notranslate"><span class="pre">/ID</span></code> field) in the document trailer. Implements issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/691">#691</a>.</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.searchFor()</span></code>: a new parameter <code class="docutils literal notranslate"><span class="pre">clip</span></code> is accepted to restrict the search to this rectangle. Correspondingly, the attribute <a class="reference internal" href="textpage.html#TextPage.rect" title="TextPage.rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TextPage.rect</span></code></a> is now respected by <a class="reference internal" href="textpage.html#TextPage.search" title="TextPage.search"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.search()</span></code></a>.</p></li>
<li><p><strong>Changed</strong> parameter <code class="docutils literal notranslate"><span class="pre">hit_max</span></code> in <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.searchFor()</span></code> and <a class="reference internal" href="textpage.html#TextPage.search" title="TextPage.search"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.search()</span></code></a> is now obsolete: methods will return all hits.</p></li>
<li><p><strong>Changed</strong> character <strong>selection criteria</strong> in <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getText()</span></code>: a character is now considered to be part of a <code class="docutils literal notranslate"><span class="pre">clip</span></code> if its bbox is fully contained. Before this, a non-empty intersection was sufficient.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#Document.scrub" title="Document.scrub"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.scrub()</span></code></a> to support a new option <code class="xref any docutils literal notranslate"><span class="pre">redact_images</span></code>. This addresses issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/697">#697</a>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.1</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/692">#692</a>. PyMuPDF now detects and recovers from more cyclic resource dependencies in PDF pages and for the first time reports them in the MuPDF warnings store.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/686">#686</a>.</p></li>
<li><p><strong>Added</strong> opacity options for the <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a> class: Stroke and fill colors can now be set to some transparency value. This means that all <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> draw methods, methods <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insertText()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insertTextbox()</span></code>, <a class="reference internal" href="shape.html#Shape.finish" title="Shape.finish"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.finish()</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insertText()</span></code>, and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insertTextbox()</span></code> support two new parameters: <em>stroke_opacity</em> and <em>fill_opacity</em>.</p></li>
<li><p><strong>Added</strong> new parameter <code class="docutils literal notranslate"><span class="pre">mask</span></code> to <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insertImage()</span></code> for optionally providing an external image mask. Resolves issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/685">#685</a>.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.soundGet()</span></code> for extracting the sound of an audio annotation.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.18.0</strong></p>
<p>This is the first PyMuPDF version supporting MuPDF v1.18. The focus here is on extending PyMuPDF’s own functionality – apart from bug fixing. Subsequent PyMuPDF patches may address features new in MuPDF.</p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/519">#519</a>. This upstream bug occurred occasionally for some pages only and seems to be fixed now: page layout should no longer be ruined in these cases.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/675">#675</a>.</p>
<ul>
<li><p>Unsuccessful storage allocations should now always lead to exceptions (circumvention of an upstream bug intermittently crashing the interpreter).</p></li>
<li><p><a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> size is now based on <code class="docutils literal notranslate"><span class="pre">size_t</span></code> instead of <code class="docutils literal notranslate"><span class="pre">int</span></code> in C and should be correct even for extremely large pixmaps.</p></li>
</ul>
</li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/668">#668</a>. Specification of dashes for PDF drawing insertion should now correctly reflect the PDF spec.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/669">#669</a>. A major source of memory leakage in <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_pdf()</span></code> has been removed.</p></li>
<li><p><strong>Added</strong> keyword <em>“images”</em> to <a class="reference internal" href="page.html#Page.apply_redactions" title="Page.apply_redactions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.apply_redactions()</span></code></a> for fine-controlling the handling of images.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.getText()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.getTextbox()</span></code>, which offer the same functionality as the <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> versions.</p></li>
<li><p><strong>Added</strong> key <em>“number”</em> to the block dictionaries of <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getText()</span></code> / <code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.getText()</span></code> for options “dict” and “rawdict”.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="functions.html#glyph_name_to_unicode" title="glyph_name_to_unicode"><code class="xref py py-meth docutils literal notranslate"><span class="pre">glyph_name_to_unicode()</span></code></a> and <a class="reference internal" href="functions.html#unicode_to_glyph_name" title="unicode_to_glyph_name"><code class="xref py py-meth docutils literal notranslate"><span class="pre">unicode_to_glyph_name()</span></code></a>. Both functions do not really connect to a specific font and are now independently available, too. The data are now based on the <a class="reference external" href="https://github.com/adobe-type-tools/agl-aglfn/blob/master/glyphlist.txt">Adobe Glyph List</a>.</p></li>
<li><p><strong>Added</strong> convenience functions <a class="reference internal" href="functions.html#adobe_glyph_names" title="adobe_glyph_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">adobe_glyph_names()</span></code></a> and <a class="reference internal" href="functions.html#adobe_glyph_unicodes" title="adobe_glyph_unicodes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">adobe_glyph_unicodes()</span></code></a> which return the respective available data.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getDrawings()</span></code> which returns details of drawing operations on a document page. Works for all document types.</p></li>
<li><p>Improved performance of <a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a>. Multiple object copies are now also suppressed across multiple separate insertions from the same source. This saves time, memory and target file size. Previously this mechanism was only active within each single method execution. The feature can also be suppressed with the new method bool parameter <em>final=1</em>, which is the default.</p></li>
<li><p>For PNG images created from pixmaps, the resolution (dpi) is now automatically set from the respective <a class="reference internal" href="pixmap.html#Pixmap.xres" title="Pixmap.xres"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Pixmap.xres</span></code></a> and <a class="reference internal" href="pixmap.html#Pixmap.yres" title="Pixmap.yres"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Pixmap.yres</span></code></a> values.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.17.7</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/651">#651</a>. An upstream bug causing interpreter crashes in corner case redaction processings was fixed by backporting MuPDF changes from their development repo.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/645">#645</a>. Pixmap top-left coordinates can be set (again) by their own method, <a class="reference internal" href="pixmap.html#Pixmap.set_origin" title="Pixmap.set_origin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.set_origin()</span></code></a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/622">#622</a>. <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insertImage()</span></code> again accepts a <a class="reference internal" href="glossary.html#rect_like" title="rect_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">rect_like</span></code></a> parameter.</p></li>
<li><p><strong>Added</strong> severeal new methods to improve and speed-up table of contents (TOC) handling. Among other things, TOC items can now changed or deleted individually – without always replacing the complete TOC. Furthermore, access to some PDF page attributes is now possible without first <strong>loading</strong> the page. This has a very significant impact on the performance of TOC manipulation.</p></li>
<li><p><strong>Added</strong> an option to <a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a> which allows displaying progress messages. Adresses <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/640">#640</a>.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getTextbox()</span></code> which extracts text contained in a rectangle. In many cases, this should obsolete writing your own script for this type of thing.</p></li>
<li><p><strong>Added</strong> new <code class="docutils literal notranslate"><span class="pre">clip</span></code> parameter to <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getText()</span></code> to simplify and speed up text extraction of page sub areas.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="textwriter.html#TextWriter.appendv" title="TextWriter.appendv"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.appendv()</span></code></a> to add text in <strong>vertical write mode</strong>. Addresses issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/653">#653</a></p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.17.6</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/605">#605</a></p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/600">#600</a> – text should now be correctly positioned also for pages with a CropBox smaller than MediaBox.</p></li>
<li><p><strong>Added</strong> text span dictionary key <code class="docutils literal notranslate"><span class="pre">origin</span></code> which contains the lower left coordinate of the first character in that span.</p></li>
<li><p><strong>Added</strong> attribute <a class="reference internal" href="font.html#Font.buffer" title="Font.buffer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Font.buffer</span></code></a>, a <em>bytes</em> copy of the font file.</p></li>
<li><p><strong>Added</strong> parameter <em>sanitize</em> to <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.cleanContents()</span></code>. Allows switching of sanitization, so only syntax cleaning will be done.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.17.5</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/561">#561</a> – second go: certain <a class="reference internal" href="textwriter.html#textwriter"><span class="std std-ref">TextWriter</span></a> usages with many alternating fonts did not work correctly.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/566">#566</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/568">#568</a>.</p></li>
<li><p><strong>Fixed</strong> – opacity is now correctly taken from the <a class="reference internal" href="textwriter.html#textwriter"><span class="std std-ref">TextWriter</span></a> object, if not given in <code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.writeText()</span></code>.</p></li>
<li><p><strong>Added</strong> a new global attribute <a class="reference internal" href="functions.html#fitz_fontdescriptors" title="fitz_fontdescriptors"><code class="xref py py-attr docutils literal notranslate"><span class="pre">fitz_fontdescriptors</span></code></a>. Contains information about usable fonts from repository <a class="reference external" href="https://github.com/pymupdf/pymupdf-fonts">pymupdf-fonts</a>.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="font.html#Font.valid_codepoints" title="Font.valid_codepoints"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Font.valid_codepoints()</span></code></a> which returns an array of unicode codepoints for which the font has a glyph.</p></li>
<li><p><strong>Added</strong> option <code class="docutils literal notranslate"><span class="pre">text_as_path</span></code> to <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getSVGimage()</span></code>. this implements <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/580">#580</a>. Generates much smaller SVG files with parseable text if set to <em>False</em>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.17.4</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/561">#561</a>. Handling of more than 10 <a class="reference internal" href="font.html#font"><span class="std std-ref">Font</span></a> objects on one page should now work correctly.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/562">#562</a>. Annotation pixmaps are no longer derived from the page pixmap, thus avoiding unintended inclusion of page content.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/559">#559</a>. This <strong>MuPDF</strong> bug is being temporarily fixed with a pre-version of MuPDF’s next release.</p></li>
<li><p><strong>Added</strong> utility function <code class="xref py py-meth docutils literal notranslate"><span class="pre">repair_mono_font()</span></code> for correcting displayed character spacing for some mono-spaced fonts.</p></li>
<li><p><strong>Added</strong> utility method <a class="reference internal" href="document.html#Document.need_appearances" title="Document.need_appearances"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.need_appearances()</span></code></a> for fine-controlling Form PDF behavior. Addresses issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/563">#563</a>.</p></li>
<li><p><strong>Added</strong> utility function <a class="reference internal" href="functions.html#sRGB_to_pdf" title="sRGB_to_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sRGB_to_pdf()</span></code></a> to recover the PDF color triple for a given color integer in sRGB format.</p></li>
<li><p><strong>Added</strong> utility function <a class="reference internal" href="functions.html#sRGB_to_rgb" title="sRGB_to_rgb"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sRGB_to_rgb()</span></code></a> to recover the (R, G, B) color triple for a given color integer in sRGB format.</p></li>
<li><p><strong>Added</strong> utility function <a class="reference internal" href="functions.html#make_table" title="make_table"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_table()</span></code></a> which delivers table cells for a given rectangle and desired numbers of columns and rows.</p></li>
<li><p><strong>Added</strong> support for optional fonts in repository <a class="reference external" href="https://github.com/pymupdf/pymupdf-fonts">pymupdf-fonts</a>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.17.3</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> an undocumented issue, which prevented fully cleaning a PDF page when using <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.cleanContents()</span></code>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/540">#540</a>. Text extraction for EPUB should again work correctly.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/548">#548</a>. Documentation now includes <code class="docutils literal notranslate"><span class="pre">LINK_NAMED</span></code>.</p></li>
<li><p><strong>Added</strong> new parameter to control start of text in <code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.fillTextbox()</span></code>. Implements <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/549">#549</a>.</p></li>
<li><p><strong>Changed</strong> documentation of <a class="reference internal" href="page.html#Page.add_redact_annot" title="Page.add_redact_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_redact_annot()</span></code></a> to explain the usage of non-builtin fonts.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.17.2</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/533">#533</a>.</p></li>
<li><p><strong>Added</strong> options to modify ‘Redact’ annotation appearance. Implements <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/535">#535</a>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.17.1</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/520">#520</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/525">#525</a>. Vertices for ‘Ink’ annots should now be correct.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/524">#524</a>. It is now possible to query and set rotation for applicable annotation types.</p></li>
</ul>
<p>Also significantly improved inline documentation for better support of interactive help.</p>
<hr class="docutils" />
<p><strong>Changes in Version 1.17.0</strong></p>
<p>This version is based on MuPDF v1.17. Following are highlights of new and changed features:</p>
<ul class="simple">
<li><p><strong>Added</strong> extended language support for annotations and widgets: a mixture of Latin, Greece, Russian, Chinese, Japanese and Korean characters can now be used in ‘FreeText’ annotations and text widgets. No special arrangement is required to use it.</p></li>
<li><p>Faster page access is implemented for documents supporting a “chapter” structure. This applies to EPUB documents currently. This comes with several new <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> methods and changes for <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.loadPage()</span></code> and the “indexed” page access <em>doc[n]</em>: In addition to specifying a page number as before, a tuple <em>(chaper, pno)</em> can be specified to identify the desired page.</p></li>
<li><p><strong>Changed:</strong> Improved support of redaction annotations: images overlapped by redactions are <strong>permanantly modified</strong> by erasing the overlap areas. Also links are removed if overlapped by redactions. This is now fully in sync with PDF specifications.</p></li>
</ul>
<p>Other changes:</p>
<ul class="simple">
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.writeText()</span></code> to support the <em>“morph”</em> parameter.</p></li>
<li><p><strong>Added</strong> methods <code class="xref py py-meth docutils literal notranslate"><span class="pre">Rect.morph()</span></code>, <a class="reference internal" href="irect.html#IRect.morph" title="IRect.morph"><code class="xref py py-meth docutils literal notranslate"><span class="pre">IRect.morph()</span></code></a>, and <a class="reference internal" href="quad.html#Quad.morph" title="Quad.morph"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Quad.morph()</span></code></a>, which return a new <a class="reference internal" href="quad.html#quad"><span class="std std-ref">Quad</span></a>.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="page.html#Page.add_freetext_annot" title="Page.add_freetext_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_freetext_annot()</span></code></a> to support text alignment via a new <em>“align”</em> parameter.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/508">#508</a>. Improved image rectangle calculation to hopefully deliver correct values in most if not all cases.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/502">#502</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/500">#500</a>. <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.convertToPDF()</span></code> should no longer cause memory leaks.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/496">#496</a>. Annotations and widgets / fields are now added or modified using the coordinates of the <strong>unrotated page</strong>. This behavior is now in sync with other methods modifying PDF pages.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rotationMatrix</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.derotationMatrix</span></code> to support coordinate transformations between the rotated and the original versions of a PDF page.</p></li>
</ul>
<p>Potential code breaking changes:</p>
<ul class="simple">
<li><p>The private method <code class="docutils literal notranslate"><span class="pre">Page._getTransformation()</span></code> has been removed. Use the public <code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.transformationMattrix</span></code> instead.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.18</strong></p>
<p>This version introduces several new features around PDF text output. The motivation is to simplify this task, while at the same time offering extending features.</p>
<p>One major achievement is using MuPDF’s capabilities to dynamically choosing fallback fonts whenever a character cannot be found in the current one. This seemlessly works for Base-14 fonts in combination with CJK fonts (China, Japan, Korea). So a text may contain <strong>any combination of characters</strong> from the Latin, Greek, Russian, Chinese, Japanese and Korean languages.</p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/493">#493</a>. <code class="docutils literal notranslate"><span class="pre">Pixmap(doc,</span> <span class="pre">xref)</span></code> should now again correctly resemble the loaded image object.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/488">#488</a>. Widget names are now modifiable.</p></li>
<li><p><strong>Added</strong> new class <a class="reference internal" href="font.html#font"><span class="std std-ref">Font</span></a> which represents a font.</p></li>
<li><p><strong>Added</strong> new class <a class="reference internal" href="textwriter.html#textwriter"><span class="std std-ref">TextWriter</span></a> which serves as a container for text to be written on a page.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.writeText()</span></code> to write one or more <a class="reference internal" href="textwriter.html#textwriter"><span class="std std-ref">TextWriter</span></a> objects to the page.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.17</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/479">#479</a>. PyMuPDF should now more correctly report image resolutions. This applies to both, images (either from images files or extracted from PDF documents) and pixmaps created from images.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="pixmap.html#Pixmap.set_dpi" title="Pixmap.set_dpi"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.set_dpi()</span></code></a> which sets the image resolution in x and y directions.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.16</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/477">#477</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/476">#476</a>.</p></li>
<li><p><strong>Changed</strong> annotation line end symbol coloring and fixed an error coloring the interior of ‘Polyline’ /’Polygon’ annotations.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.14</strong></p>
<ul class="simple">
<li><p><strong>Changed</strong> text marker annotations to accept parameters beyond just quadrilaterals such that now <strong>text lines between two given points can be marked</strong>.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="document.html#Document.scrub" title="Document.scrub"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.scrub()</span></code></a> which <strong>removes potentially sensitive data</strong> from a PDF. Implements <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/453">#453</a>.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.blendMode()</span></code> which returns the <strong>blend mode</strong> of annotations.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.setBlendMode()</span></code> to set the annotation’s blend mode. This resolves issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/416">#416</a>.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="annot.html#Annot.update" title="Annot.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.update()</span></code></a> to accept additional parameters for setting blend mode and opacity.</p></li>
<li><p><strong>Added</strong> advanced graphics features to <strong>control the anti-aliasing values</strong>, <a class="reference internal" href="tools.html#Tools.set_aa_level" title="Tools.set_aa_level"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Tools.set_aa_level()</span></code></a>. Resolves <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/467">#467</a></p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/474">#474</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/466">#466</a>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.13</strong></p>
<ul class="simple">
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.getPageXObjectList()</span></code> which returns a list of <strong>Form XObjects</strong> of the page.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.setMediaBox()</span></code> for changing the physical PDF page size.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> methods which have been internal before: <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.cleanContents()</span></code> (= <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page._cleanContents()</span></code>), <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getContents()</span></code> (= <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page._getContents()</span></code>), <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getTransformation()</span></code> (= <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page._getTransformation()</span></code>).</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.12</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/447">#447</a></p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/461">#461</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/397">#397</a>.</p></li>
<li><p><strong>Fixed</strong> issue <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/463">#463</a>.</p></li>
<li><p><strong>Added</strong> JavaScript support to PDF form fields, thereby fixing <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/454">#454</a>.</p></li>
<li><p><strong>Added</strong> a new annotation method <a class="reference internal" href="annot.html#Annot.delete_responses" title="Annot.delete_responses"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.delete_responses()</span></code></a>, which removes ‘Popup’ and response annotations referring to the current one. Mainly serves data protection purposes.</p></li>
<li><p><strong>Added</strong> a new form field method <a class="reference internal" href="widget.html#Widget.reset" title="Widget.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Widget.reset()</span></code></a>, which resets the field value to its default.</p></li>
<li><p><strong>Changed</strong> and extended handling of redactions: images and XObjects are removed if <em>contained</em> in a redaction rectangle. Any partial only overlaps will just be covered by the redaction background color. Now an <em>overlay</em> text can be specified to be inserted in the rectangle area to <strong>take the place the deleted original</strong> text. This resolves <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/434">#434</a>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.11</strong></p>
<ul class="simple">
<li><p><strong>Added</strong> Support for redaction annotations via method <a class="reference internal" href="page.html#Page.add_redact_annot" title="Page.add_redact_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_redact_annot()</span></code></a> and <a class="reference internal" href="page.html#Page.apply_redactions" title="Page.apply_redactions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.apply_redactions()</span></code></a>.</p></li>
<li><p><strong>Fixed</strong> issue #426 (“PolygonAnnotation in 1.16.10 version”).</p></li>
<li><p><strong>Fixed</strong> documentation only issues <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/443">#443</a> and <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/444">#444</a>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.10</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue #421 (“annot.set_rect(rect) has no effect on text Annotation”)</p></li>
<li><p><strong>Fixed</strong> issue #417 (“Strange behavior for page.deleteAnnot on 1.16.9 compare to 1.13.20”)</p></li>
<li><p><strong>Fixed</strong> issue #415 (“Annot.setOpacity throws mupdf warnings”)</p></li>
<li><p><strong>Changed</strong> all “add annotation / widget” methods to store a unique name in the <em>/NM</em> PDF key.</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.setInfo()</span></code> to also accept direct parameters in addition to a dictionary.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="annot.html#Annot.info" title="Annot.info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.info</span></code></a> to now also show the annotation’s unique id (<em>/NM</em> PDF key) if present.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="page.html#Page.annot_names" title="Page.annot_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.annot_names()</span></code></a> which returns a list of all annotation names (<em>/NM</em> keys).</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="page.html#Page.load_annot" title="Page.load_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.load_annot()</span></code></a> which loads an annotation given its unique id (<em>/NM</em> key).</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="document.html#Document.reload_page" title="Document.reload_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.reload_page()</span></code></a> which provides a new copy of a page after finishing any pending updates to it.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.9</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> #412 (“Feature Request: Allow controlling whether TOC entries should be collapsed”)</p></li>
<li><p><strong>Fixed</strong> #411 (“Seg Fault with page.firstWidget”)</p></li>
<li><p><strong>Fixed</strong> #407 (“Annot.setOpacity trouble”)</p></li>
<li><p><strong>Changed</strong> methods <code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.setBorder()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.setColors()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Link.setBorder()</span></code>, and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Link.setColors()</span></code> to also accept direct parameters, and not just cumbersome dictionaries.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.8</strong></p>
<ul class="simple">
<li><p><strong>Added</strong> several new methods to the <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> class, which make dealing with PDF low-level structures easier. I also decided to provide them as “normal” methods (as opposed to private ones starting with an underscore “_”). These are <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xrefObject()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xrefStream()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xrefStreamRaw()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.PDFTrailer()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.PDFCatalog()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.metadataXML()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.updateObject()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.updateStream()</span></code>.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Tools.mupdf_disply_errors()</span></code> which sets the display of mupdf errors on <em>sys.stderr</em>.</p></li>
<li><p><strong>Added</strong> a commandline facility. This a major new feature: you can now invoke several utility functions via <em>“python -m fitz …”</em>. It should obsolete the need for many of the most trivial scripts. Please refer to <a class="reference internal" href="module.html#module"><span class="std std-ref">命令行界面</span></a>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.7</strong></p>
<p>Minor changes to better synchronize the binary image streams of <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a> image blocks and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extractImage()</span></code> images.</p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue #394 (“PyMuPDF Segfaults when using TOOLS.mupdf_warnings()”).</p></li>
<li><p><strong>Changed</strong> redirection of MuPDF error messages: apart from writing them to Python <em>sys.stderr</em>, they are now also stored with the MuPDF warnings.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="tools.html#Tools.mupdf_warnings" title="Tools.mupdf_warnings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Tools.mupdf_warnings()</span></code></a> to automatically empty the store (if not deactivated via a parameter).</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getImageBbox()</span></code> to return an <strong>infinite rectangle</strong> if the image could not be located on the page – instead of raising an exception.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.6</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue #390 (“Incomplete deletion of annotations”).</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.searchFor()</span></code> / <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.searchPageFor()</span></code> to also support the <em>flags</em> parameter, which controls the data included in a <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a>.</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.getPageImageList()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.getPageFontList()</span></code> and their <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> counterparts to support a new parameter <em>full</em>. If true, the returned items will contain the <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the <em>Form XObject</em> where the font or image is referenced.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.5</strong></p>
<p>More performance improvements for text extraction.</p>
<ul class="simple">
<li><p><strong>Fixed</strong> second part of issue #381 (see item in v1.16.4).</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getTextPage()</span></code>, so it is no longer required to create an intermediate display list for text extractions. Page level wrappers for text extraction and text searching are now based on this, which should improve performance by ca. 5%.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.4</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue #381 (“TextPage.extractDICT … failed … after upgrading … to 1.16.3”)</p></li>
<li><p><strong>Added</strong> method <a class="reference internal" href="document.html#Document.pages" title="Document.pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pages()</span></code></a> which delivers a generator iterator over a page range.</p></li>
<li><p><strong>Added</strong> method <a class="reference internal" href="page.html#Page.links" title="Page.links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.links()</span></code></a> which delivers a generator iterator over the links of a page.</p></li>
<li><p><strong>Added</strong> method <a class="reference internal" href="page.html#Page.annots" title="Page.annots"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.annots()</span></code></a> which delivers a generator iterator over the annotations of a page.</p></li>
<li><p><strong>Added</strong> method <a class="reference internal" href="page.html#Page.widgets" title="Page.widgets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.widgets()</span></code></a> which delivers a generator iterator over the form fields of a page.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#Document.is_form_pdf" title="Document.is_form_pdf"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_form_pdf</span></code></a> to now contain the number of widgets, and <em>False</em> if not a PDF or this number is zero.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.3</strong></p>
<p>Minor changes compared to version 1.16.2. The code of the “dict” and “rawdict” variants of <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getText()</span></code> has been ported to C which has greatly improved their performance. This improvement is mostly noticeable with text-oriented documents, where they now should execute almost two times faster.</p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue #369 (“mupdf: cmsCreateTransform failed”) by removing ICC colorspace support.</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getText()</span></code> to accept additional keywords “blocks” and “words”. These will deliver the results of <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getTextBlocks()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getTextWords()</span></code>, respectively. So all text extraction methods are now available via a uniform API. Correspondingly, there are now new methods <a class="reference internal" href="textpage.html#TextPage.extractBLOCKS" title="TextPage.extractBLOCKS"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractBLOCKS()</span></code></a> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractWords()</span></code>.</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getText()</span></code> to default bit indicator <em>TEXT_INHIBIT_SPACES</em> to <strong>off</strong>. Insertion of additional spaces is <strong>not suppressed</strong> by default.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.2</strong></p>
<ul class="simple">
<li><p><strong>Changed</strong> text extraction methods of <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> to allow detail control of the amount of extracted data.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="functions.html#planish_line" title="planish_line"><code class="xref py py-meth docutils literal notranslate"><span class="pre">planish_line()</span></code></a> which maps a given line (defined as a pair of points) to the x-axis.</p></li>
<li><p><strong>Fixed</strong> an issue (w/o Github number) which brought down the interpreter when encountering certain non-UTF-8 encodable characters while using <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getText()</span></code> with te “dict” option.</p></li>
<li><p><strong>Fixed</strong> issue #362 (“Memory Leak with getText(‘rawDICT’)”).</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.1</strong></p>
<ul class="simple">
<li><p><strong>Added</strong> property <a class="reference internal" href="quad.html#Quad.is_convex" title="Quad.is_convex"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Quad.is_convex</span></code></a> which checks whether a line is contained in the quad if it connects two points of it.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a> to now allow dropping or including links and annotations independently during the copy. Fixes issue #352 (“Corrupt PDF data and …”), which seemed to intermittently occur when using the method for some problematic PDF files.</p></li>
<li><p><strong>Fixed</strong> a bug which, in matrix division using the syntax <em>“m1/m2”</em>, caused matrix <em>“m1”</em> to be <strong>replaced</strong> by the result instead of delivering a new matrix.</p></li>
<li><p><strong>Fixed</strong> issue #354 (“SyntaxWarning with Python 3.8”). We now always use <em>“==”</em> for literals (instead of the <em>“is”</em> Python keyword).</p></li>
<li><p><strong>Fixed</strong> issue #353 (“mupdf version check”), to no longer refuse the import when there are only patch level deviations from MuPDF.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.16.0</strong></p>
<p>This major new version of MuPDF comes with several nice new or changed features. Some of them imply programming API changes, however. This is a synopsis of what has changed:</p>
<ul class="simple">
<li><p>PDF document encryption and decryption is now <strong>fully supported</strong>. This includes setting <strong>permissions</strong>, <strong>passwords</strong> (user and owner passwords) and the desired encryption method.</p></li>
<li><p>In response to the new encryption features, PyMuPDF returns an integer (ie. a combination of bits) for document permissions, and no longer a dictionary.</p></li>
<li><p>Redirection of MuPDF errors and warnings is now natively supported. PyMuPDF redirects error messages from MuPDF to <em>sys.stderr</em> and no longer buffers them. Warnings continue to be buffered and will not be displayed. Functions exist to access and reset the warnings buffer.</p></li>
<li><p>Annotations are now <strong>only supported for PDF</strong>.</p></li>
<li><p>Annotations and widgets (form fields) are now <strong>separate object chains</strong> on a page (although widgets technically still <strong>are</strong> PDF annotations). This means, that you will <strong>never encounter widgets</strong> when using <code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.firstAnnot</span></code> or <a class="reference internal" href="annot.html#Annot.next" title="Annot.next"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.next()</span></code></a>. You must use <code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.firstWidget</span></code> and <a class="reference internal" href="widget.html#Widget.next" title="Widget.next"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Widget.next()</span></code></a> to access form fields.</p></li>
<li><p>As part of MuPDF’s changes regarding widgets, only the following four fonts are supported, when <strong>adding</strong> or <strong>changing</strong> form fields: <strong>Courier, Helvetica, Times-Roman</strong> and <strong>ZapfDingBats</strong>.</p></li>
</ul>
<p>List of change details:</p>
<ul class="simple">
<li><p><strong>Added</strong> <a class="reference internal" href="document.html#Document.can_save_incrementally" title="Document.can_save_incrementally"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.can_save_incrementally()</span></code></a> which checks conditions that are preventing use of option <em>incremental=True</em> of <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a>.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.firstWidget</span></code> which points to the first field on a page.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getImageBbox()</span></code> which returns the rectangle occupied by an image shown on the page.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.setName()</span></code> which lets you change the (icon) name field.</p></li>
<li><p><strong>Added</strong> outputting the text color in <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getText()</span></code>: the <em>“dict”</em>, <em>“rawdict”</em> and <em>“xml”</em> options now also show the color in sRGB format.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#Document.permissions" title="Document.permissions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.permissions</span></code></a> to now contain an integer of bool indicators – was a dictionary before.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.write()</span></code>, which now fully support password-based decryption and encryption of PDF files.</p></li>
<li><p><strong>Changed the names of all Python constants</strong> related to annotations and widgets. Please make sure to consult the <strong>Constants and Enumerations</strong> chapter if your script is dealing with these two classes. This decision goes back to the dropped support for non-PDF annotations. The <strong>old names</strong> (starting with “ANNOT_*” or “WIDGET_*”) will be available as deprecated synonyms.</p></li>
<li><p><strong>Changed</strong> font support for widgets: only <em>Cour</em> (Courier), <em>Helv</em> (Helvetica, default), <em>TiRo</em> (Times-Roman) and <em>ZaDb</em> (ZapfDingBats) are accepted when <strong>adding or changing</strong> form fields. Only the plain versions are possible – not their italic or bold variations. <strong>Reading</strong> widgets, however will show its original font.</p></li>
<li><p><strong>Changed</strong> the name of the warnings buffer to <a class="reference internal" href="tools.html#Tools.mupdf_warnings" title="Tools.mupdf_warnings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Tools.mupdf_warnings()</span></code></a> and the function to empty this buffer is now called <a class="reference internal" href="tools.html#Tools.reset_mupdf_warnings" title="Tools.reset_mupdf_warnings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Tools.reset_mupdf_warnings()</span></code></a>.</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getPixmap()</span></code>, <a class="reference internal" href="document.html#Document.get_page_pixmap" title="Document.get_page_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_pixmap()</span></code></a>: a new bool argument <em>annots</em> can now be used to <strong>suppress the rendering of annotations</strong> on the page.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="page.html#Page.add_file_annot" title="Page.add_file_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_file_annot()</span></code></a> and <a class="reference internal" href="page.html#Page.add_text_annot" title="Page.add_text_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_text_annot()</span></code></a> to enable setting an icon.</p></li>
<li><p><strong>Removed</strong> widget-related methods and attributes from the <a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a> object.</p></li>
<li><p><strong>Removed</strong> <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> attributes <em>openErrCode</em>, <em>openErrMsg</em>, and <a class="reference internal" href="tools.html#tools"><span class="std std-ref">Tools</span></a> attributes / methods <em>stderr</em>, <em>reset_stderr</em>, <em>stdout</em>, and <em>reset_stdout</em>.</p></li>
<li><p><strong>Removed</strong> <strong>thirdparty zlib</strong> dependency in PyMuPDF: there are now compression functions available in MuPDF. Source installers of PyMuPDF may now omit this extra installation step.</p></li>
</ul>
<p><strong>No version published for MuPDF v1.15.0</strong></p>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.20 / 1.14.21</strong></p>
<ul class="simple">
<li><p><strong>Changed</strong> text marker annotations to support multiple rectangles / quadrilaterals. This fixes issue #341 (“Question : How to addhighlight so that a string spread across more than a line is covered by one highlight?”) and similar (#285).</p></li>
<li><p><strong>Fixed</strong> issue #331 (“Importing PyMuPDF changes warning filtering behaviour globally”).</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.19</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue #319 (“InsertText function error when use custom font”).</p></li>
<li><p><strong>Added</strong> new method <a class="reference internal" href="document.html#Document.get_sigflags" title="Document.get_sigflags"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_sigflags()</span></code></a> which returns information on whether a PDF is signed. Resolves issue #326 (“How to detect signature in a form pdf?”).</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.17</strong></p>
<ul class="simple">
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.fullcopyPage()</span></code> to make full page copies within a PDF (not just copied references as <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.copyPage()</span></code> does).</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getPixmap()</span></code>, <a class="reference internal" href="document.html#Document.get_page_pixmap" title="Document.get_page_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_pixmap()</span></code></a> now use <em>alpha=False</em> as default.</p></li>
<li><p><strong>Changed</strong> text extraction: the span dictionary now (again) contains its rectangle under the <em>bbox</em> key.</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.movePage()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.copyPage()</span></code> to use direct functions instead of wrapping <a class="reference internal" href="document.html#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a> – similar to <a class="reference internal" href="document.html#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_page()</span></code></a> in v1.14.16.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.16</strong></p>
<ul class="simple">
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> methods around PDF <em>/EmbeddedFiles</em> to no longer use MuPDF’s “portfolio” functions. That support will be dropped in MuPDF v1.15 – therefore another solution was required.</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_Count()</span></code> to be a function (was an attribute).</p></li>
<li><p><strong>Added</strong> new method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_Names()</span></code> which returns a list of names of embedded files.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="document.html#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_page()</span></code></a> and <a class="reference internal" href="document.html#Document.delete_pages" title="Document.delete_pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_pages()</span></code></a> to internally no longer use <a class="reference internal" href="document.html#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a>, but instead use functions to perform the deletion directly. As it has turned out, the <a class="reference internal" href="document.html#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a> method yields invalid outline trees (tables of content) for very complex PDFs and sophisticated use of annotations.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.15</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issues #301 (“Line cap and Line join”), #300 (“How to draw a shape without outlines”) and #298 (“utils.updateRect exception”). These bugs pertain to drawing shapes with PyMuPDF. Drawing shapes without any border is fully supported. Line cap styles and line line join style are now differentiated and support all possible PDF values (0, 1, 2) instead of just being a bool. The previous parameter <em>roundCap</em> is deprecated in favor of <em>lineCap</em> and <em>lineJoin</em> and will be deleted in the next release.</p></li>
<li><p><strong>Fixed</strong> issue #290 (“Memory Leak with getText(‘rawDICT’)”). This bug caused memory not being (completely) freed after invoking the “dict”, “rawdict” and “json” versions of <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getText()</span></code>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.14</strong></p>
<ul class="simple">
<li><p><strong>Added</strong> new low-level function <code class="xref py py-meth docutils literal notranslate"><span class="pre">ImageProperties()</span></code> to determine a number of characteristics for an image.</p></li>
<li><p><strong>Added</strong> new low-level function <a class="reference internal" href="functions.html#Document.is_stream" title="Document.is_stream"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.is_stream()</span></code></a>, which checks whether an object is of stream type.</p></li>
<li><p><strong>Changed</strong> low-level functions <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document._getXrefString()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document._getTrailerString()</span></code> now by default return object definitions in a formatted form which makes parsing easy.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.13</strong></p>
<ul class="simple">
<li><p><strong>Changed</strong> methods working with binary input: while ever supporting bytes and bytearray objects, they now also accept <em>io.BytesIO</em> input, using their <em>getvalue()</em> method. This pertains to document creation, embedded files, FileAttachment annotations, pixmap creation and others. Fixes issue #274 (“Segfault when using BytesIO as a stream for insertImage”).</p></li>
<li><p><strong>Fixed</strong> issue #278 (“Is insertImage(keep_proportion=True) broken?”). Images are now correctly presented when keeping aspect ratio.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.12</strong></p>
<ul class="simple">
<li><p><strong>Changed</strong> the draw methods of <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> and <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a> to support not only RGB, but also GRAY and CMYK colorspaces. This solves issue #270 (“Is there a way to use CMYK color to draw shapes?”). This change also applies to text insertion methods of <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a>, resp. <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a>.</p></li>
<li><p><strong>Fixed</strong> issue #269 (“AttributeError in Document.insert_page()”), which occurred when using <a class="reference internal" href="document.html#Document.insert_page" title="Document.insert_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a> with text insertion.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.11</strong></p>
<ul class="simple">
<li><p><strong>Changed</strong> <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> to always position the source rectangle centered in the target. This method now also supports <strong>rotation by arbitrary angles</strong>. The argument <em>reuse_xref</em> has been deprecated: prevention of duplicates is now <strong>handled internally</strong>.</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insertImage()</span></code> to support rotated display of the image and keeping the aspect ratio. Only rotations by multiples of 90 degrees are supported here.</p></li>
<li><p><strong>Fixed</strong> issue #265 (“TypeError: insertText() got an unexpected keyword argument ‘idx’”). This issue only occurred when using <a class="reference internal" href="document.html#Document.insert_page" title="Document.insert_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a> with also inserting text.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.10</strong></p>
<ul class="simple">
<li><p><strong>Changed</strong> <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> to support rotation of the source rectangle. Fixes #261 (“Cannot rotate insterted pages”).</p></li>
<li><p><strong>Fixed</strong> a bug in <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insertImage()</span></code> which prevented insertion of multiple images provided as streams.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.9</strong></p>
<ul class="simple">
<li><p><strong>Added</strong> new low-level method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document._getTrailerString()</span></code>, which returns the trailer object of a PDF. This is much like <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document._getXrefString()</span></code> except that the PDF trailer has no / needs no <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> to identify it.</p></li>
<li><p><strong>Added</strong> new parameters for text insertion methods. You can now set stroke and fill colors of glyphs (text characters) independently, as well as the thickness of the glyph border. A new parameter <em>render_mode</em> controls the use of these colors, and whether the text should be visible at all.</p></li>
<li><p><strong>Fixed</strong> issue #258 (“Copying image streams to new PDF without size increase”): For JPX images embedded in a PDF, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extractImage()</span></code> will now return them in their original format. Previously, the MuPDF base library was used, which returns them in PNG format (entailing a massive size increase).</p></li>
<li><p><strong>Fixed</strong> issue #259 (“Morphing text to fit inside rect”). Clarified use of <a class="reference internal" href="functions.html#get_text_length" title="get_text_length"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_text_length()</span></code></a> and removed extra line breaks for long words.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.8</strong></p>
<ul class="simple">
<li><p><strong>Added</strong> <a class="reference internal" href="pixmap.html#Pixmap.set_rect" title="Pixmap.set_rect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.set_rect()</span></code></a> to change the pixel values in a rectangle. This is also an alternative to setting the color of a complete pixmap (<a class="reference internal" href="pixmap.html#Pixmap.clear_with" title="Pixmap.clear_with"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.clear_with()</span></code></a>).</p></li>
<li><p><strong>Fixed</strong> an image extraction issue with JBIG2 (monochrome) encoded PDF images. The issue occurred in <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getText()</span></code> (parameters “dict” and “rawdict”) and in <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extractImage()</span></code> methods.</p></li>
<li><p><strong>Fixed</strong> an issue with not correctly clearing a non-alpha <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> (<a class="reference internal" href="pixmap.html#Pixmap.clear_with" title="Pixmap.clear_with"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.clear_with()</span></code></a>).</p></li>
<li><p><strong>Fixed</strong> an issue with not correctly inverting colors of a non-alpha <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> (<a class="reference internal" href="pixmap.html#Pixmap.invert_irect" title="Pixmap.invert_irect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.invert_irect()</span></code></a>).</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.7</strong></p>
<ul class="simple">
<li><p><strong>Added</strong> <a class="reference internal" href="pixmap.html#Pixmap.set_pixel" title="Pixmap.set_pixel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.set_pixel()</span></code></a> to change one pixel value.</p></li>
<li><p><strong>Added</strong> documentation for image conversion in the <a class="reference internal" href="faq.html#faq"><span class="std std-ref">FAQ</span></a>.</p></li>
<li><p><strong>Added</strong> new function <a class="reference internal" href="functions.html#get_text_length" title="get_text_length"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_text_length()</span></code></a> to determine the string length for a given font.</p></li>
<li><p><strong>Added</strong> Postscript image output (changed <a class="reference internal" href="pixmap.html#Pixmap.save" title="Pixmap.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.save()</span></code></a> and <a class="reference internal" href="pixmap.html#Pixmap.tobytes" title="Pixmap.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.tobytes()</span></code></a>).</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="pixmap.html#Pixmap.save" title="Pixmap.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.save()</span></code></a> and <a class="reference internal" href="pixmap.html#Pixmap.tobytes" title="Pixmap.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.tobytes()</span></code></a> to ensure valid combinations of colorspace, alpha and output format.</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="pixmap.html#Pixmap.save" title="Pixmap.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.save()</span></code></a>: the desired format is now inferred from the filename.</p></li>
<li><p><strong>Changed</strong> FreeText annotations can now have a transparent background - see <a class="reference internal" href="annot.html#Annot.update" title="Annot.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.update()</span></code></a>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.5</strong></p>
<ul class="simple">
<li><p><strong>Changed:</strong> <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a> methods now strictly use the transformation matrix of the <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> – instead of “manually” calculating locations.</p></li>
<li><p><strong>Added</strong> method <a class="reference internal" href="pixmap.html#Pixmap.pixel" title="Pixmap.pixel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.pixel()</span></code></a> which returns the pixel value (a list) for given pixel coordinates.</p></li>
<li><p><strong>Added</strong> method <a class="reference internal" href="pixmap.html#Pixmap.tobytes" title="Pixmap.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.tobytes()</span></code></a> which returns a bytes object representing the pixmap in a variety of formats. Previously, this could be done for PNG outputs only (<a class="reference internal" href="pixmap.html#Pixmap.tobytes" title="Pixmap.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.tobytes()</span></code></a>).</p></li>
<li><p><strong>Changed:</strong> output of methods <a class="reference internal" href="pixmap.html#Pixmap.save" title="Pixmap.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.save()</span></code></a> and (the new) <a class="reference internal" href="pixmap.html#Pixmap.tobytes" title="Pixmap.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.tobytes()</span></code></a> may now also be PSD (Adobe Photoshop Document).</p></li>
<li><p><strong>Added</strong> method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.drawQuad()</span></code> which draws a <a class="reference internal" href="quad.html#quad"><span class="std std-ref">Quad</span></a>. This actually is a shorthand for a <code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.drawPolyline()</span></code> with the edges of the quad.</p></li>
<li><p><strong>Changed</strong> method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.drawOval()</span></code>: the argument can now be <strong>either</strong> a rectangle (<a class="reference internal" href="glossary.html#rect_like" title="rect_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">rect_like</span></code></a>) <strong>or</strong> a quadrilateral (<a class="reference internal" href="glossary.html#quad_like" title="quad_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">quad_like</span></code></a>).</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.4</strong></p>
<ul class="simple">
<li><p><strong>Fixes</strong> issue #239 “Annotation coordinate consistency”.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.3</strong></p>
<p>This patch version contains minor bug fixes and CJK font output support.</p>
<ul class="simple">
<li><p><strong>Added</strong> support for the four CJK fonts as PyMuPDF generated text output. This pertains to methods <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insertFont()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insertText()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insertTextbox()</span></code>, and corresponding <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> methods. The new fonts are available under “reserved” fontnames “china-t” (traditional Chinese), “china-s” (simplified Chinese), “japan” (Japanese), and “korea” (Korean).</p></li>
<li><p><strong>Added</strong> full support for the built-in fonts ‘Symbol’ and ‘Zapfdingbats’.</p></li>
<li><p><strong>Changed:</strong> The 14 standard fonts can now each be referenced by a 4-letter abbreviation.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.1</strong></p>
<p>This patch version contains minor performance improvements.</p>
<ul class="simple">
<li><p><strong>Added</strong> support for <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> filenames given as <em>pathlib</em> object by using the Python <em>str()</em> function.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.14.0</strong></p>
<p>To support MuPDF v1.14.0, massive changes were required in PyMuPDF – most of them purely technical, with little visibility to developers. But there are also quite a lot of interesting new and improved features. Following are the details:</p>
<ul class="simple">
<li><p><strong>Added</strong> “ink” annotation.</p></li>
<li><p><strong>Added</strong> “rubber stamp” annotation.</p></li>
<li><p><strong>Added</strong> “squiggly” text marker annotation.</p></li>
<li><p><strong>Added</strong> new class <a class="reference internal" href="quad.html#quad"><span class="std std-ref">Quad</span></a> (quadrilateral or tetragon) – which represents a general four-sided shape in the plane. The special subtype of rectangular, non-empty tetragons is used in text marker annotations and as returned objects in text search methods.</p></li>
<li><p><strong>Added</strong> a new option “decrypt” to <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.write()</span></code>. Now you can <strong>keep encryption</strong> when saving a password protected PDF.</p></li>
<li><p><strong>Added</strong> suppression and redirection of unsolicited messages issued by the underlying C-library MuPDF. Consult <a class="reference internal" href="app3.html#redirectmessages"><span class="std std-ref">诊断</span></a> for details.</p></li>
<li><p><strong>Changed:</strong> Changes to annotations now <strong>always require</strong> <a class="reference internal" href="annot.html#Annot.update" title="Annot.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.update()</span></code></a> to become effective.</p></li>
<li><p><strong>Changed</strong> free text annotations to support the full Latin character set and range of appearance options.</p></li>
<li><p><strong>Changed</strong> text searching, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.searchFor()</span></code>, to optionally return <a class="reference internal" href="quad.html#quad"><span class="std std-ref">Quad</span></a> instead <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> objects surrounding each search hit.</p></li>
<li><p><strong>Changed</strong> plain text output: we now add a <em>n</em> to each line if it does not itself end with this character.</p></li>
<li><p><strong>Fixed</strong> issue 211 (“Something wrong in the doc”).</p></li>
<li><p><strong>Fixed</strong> issue 213 (“Rewritten outline is displayed only by mupdf-based applications”).</p></li>
<li><p><strong>Fixed</strong> issue 214 (“PDF decryption GONE!”).</p></li>
<li><p><strong>Fixed</strong> issue 215 (“Formatting of links added with pyMuPDF”).</p></li>
<li><p><strong>Fixed</strong> issue 217 (“extraction through json is failing for my pdf”).</p></li>
</ul>
<p>Behind the curtain, we have changed the implementation of geometry objects: they now purely exist in Python and no longer have “shadow” twins on the C-level (in MuPDF). This has improved processing speed in that area by more than a factor of two.</p>
<p>Because of the same reason, most methods involving geometry parameters now also accept the corresponding Python sequence. For example, in method <em>“page.show_pdf_page(rect, …)”</em> parameter <em>rect</em> may now be any <a class="reference internal" href="glossary.html#rect_like" title="rect_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">rect_like</span></code></a> sequence.</p>
<p>We also invested considerable effort to further extend and improve the <a class="reference internal" href="faq.html#faq"><span class="std std-ref">FAQ</span></a> chapter.</p>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.19</strong></p>
<p>This version contains some technical / performance improvements and bug fixes.</p>
<ul class="simple">
<li><p><strong>Changed</strong> memory management: for Python 3 builds, Python memory management is exclusively used across all C-level code (i.e. no more native <em>malloc()</em> in MuPDF code or PyMuPDF interface code). This leads to improved memory usage profiles and also some runtime improvements: we have seen &gt; 2% shorter runtimes for text extractions and pixmap creations (on Windows machines only to date).</p></li>
<li><p><strong>Fixed</strong> an error occurring in Python 2.7, which crashed the interpreter when using <a class="reference internal" href="textpage.html#TextPage.extractRAWDICT" title="TextPage.extractRAWDICT"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractRAWDICT()</span></code></a> (= <em>Page.getText(“rawdict”)</em>).</p></li>
<li><p><strong>Fixed</strong> an error occurring in Python 2.7, when creating link destinations.</p></li>
<li><p><strong>Extended</strong> the <a class="reference internal" href="faq.html#faq"><span class="std std-ref">FAQ</span></a> chapter with more examples.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.18</strong></p>
<ul class="simple">
<li><p><strong>Added</strong> method <a class="reference internal" href="textpage.html#TextPage.extractRAWDICT" title="TextPage.extractRAWDICT"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractRAWDICT()</span></code></a>, and a corresponding new string parameter “rawdict” to method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getText()</span></code>. It extracts text and images from a page in Python <em>dict</em> form like <a class="reference internal" href="textpage.html#TextPage.extractDICT" title="TextPage.extractDICT"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractDICT()</span></code></a>, but with the detail level of <a class="reference internal" href="textpage.html#TextPage.extractXML" title="TextPage.extractXML"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractXML()</span></code></a>, which is position information down to each single character.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.17</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> an error that intermittently caused an exception in <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a>, when pages from many different source PDFs were shown.</p></li>
<li><p><strong>Changed</strong> method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extractImage()</span></code> to now return more meta information about the extracted imgage. Also, its performance has been greatly improved. Several demo scripts have been changed to make use of this method.</p></li>
<li><p><strong>Changed</strong> method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document._getXrefStream()</span></code> to now return <em>None</em> if the object is no stream and no longer raise an exception if otherwise.</p></li>
<li><p><strong>Added</strong> method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document._deleteObject()</span></code> which deletes a PDF object identified by its <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>. Only to be used by the experienced PDF expert.</p></li>
<li><p><strong>Added</strong> a method <a class="reference internal" href="functions.html#paper_rect" title="paper_rect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">paper_rect()</span></code></a> which returns a <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> for a supplied paper format string. Example: <em>fitz.paper_rect(“letter”) = fitz.Rect(0.0, 0.0, 612.0, 792.0)</em>.</p></li>
<li><p><strong>Added</strong> a <a class="reference internal" href="faq.html#faq"><span class="std std-ref">FAQ</span></a> chapter to this document.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.16</strong></p>
<ul class="simple">
<li><p><strong>Added</strong> support for correctly setting transparency (opacity) for certain annotation types.</p></li>
<li><p><strong>Added</strong> a tool property (<a class="reference internal" href="tools.html#Tools.fitz_config" title="Tools.fitz_config"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Tools.fitz_config</span></code></a>) showing the configuration of this PyMuPDF version.</p></li>
<li><p><strong>Fixed</strong> issue #193 (‘insertText(overlay=False) gives “cannot resize a buffer with shared storage” error’) by avoiding read-only buffers.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.15</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue #189 (“cannot find builtin CJK font”), so we are supporting builtin CJK fonts now (CJK = China, Japan, Korea). This should lead to correctly generated pixmaps for documents using these languages. This change has consequences for our binary file size: it will now range between 8 and 10 MB, depending on the OS.</p></li>
<li><p><strong>Fixed</strong> issue #191 (“Jupyter notebook kernel dies after ca. 40 pages”), which occurred when modifying the contents of an annotation.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.14</strong></p>
<p>This patch version contains several improvements, mainly for annotations.</p>
<ul class="simple">
<li><p><strong>Changed</strong> <code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.lineEnds</span></code> is now a list of two integers representing the line end symbols. Previously was a <em>dict</em> of strings.</p></li>
<li><p><strong>Added</strong> support of line end symbols for applicable annotations. PyMuPDF now can generate these annotations including the line end symbols.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.setLineEnds()</span></code> adds line end symbols to applicable annotation types (‘Line’, ‘PolyLine’, ‘Polygon’).</p></li>
<li><p><strong>Changed</strong> technical implementation of <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insertImage()</span></code> and <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a>: they now create there own contents objects, thereby avoiding changes of potentially large streams with consequential compression / decompression efforts and high change volumes with incremental updates.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.13</strong></p>
<p>This patch version contains several improvements for embedded files and file attachment annotations.</p>
<ul class="simple">
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_Upd()</span></code> which allows changing <strong>file content and metadata</strong> of an embedded file. It supersedes the old method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_SetInfo()</span></code> (which will be deleted in a future version). Content is automatically compressed and metadata may be unicode.</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_Add()</span></code> to now automatically compress file content. Accompanying metadata can now be unicode (had to be ASCII in the past).</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_Del()</span></code> to now automatically delete <strong>all entries</strong> having the supplied identifying name. The return code is now an integer count of the removed entries (was <em>None</em> previously).</p></li>
<li><p><strong>Changed</strong> embedded file methods to now also accept or show the PDF unicode filename as additional parameter <em>ufilename</em>.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="page.html#Page.add_file_annot" title="Page.add_file_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_file_annot()</span></code></a> which adds a new file attachment annotation.</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.fileUpd()</span></code> (file attachment annot) to now also accept the PDF unicode <em>ufilename</em> parameter. The description parameter <em>desc</em> correctly works with unicode. Furthermore, <strong>all</strong> parameters are optional, so metadata may be changed without also replacing the file content.</p></li>
<li><p><strong>Changed</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.fileInfo()</span></code> (file attachment annot) to now also show the PDF unicode filename as parameter <em>ufilename</em>.</p></li>
<li><p><strong>Fixed</strong> issue #180 (“page.getText(output=’dict’) return invalid bbox”) to now also work for vertical text.</p></li>
<li><p><strong>Fixed</strong> issue #185 (“Can’t render the annotations created by PyMuPDF”). The issue’s cause was the minimalistic MuPDF approach when creating annotations. Several annotation types have no <em>/AP</em> (“appearance”) object when created by MuPDF functions. MuPDF, SumatraPDF and hence also PyMuPDF cannot render annotations without such an object. This fix now ensures, that an appearance object is always created together with the annotation itself. We still do not support line end styles.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.12</strong></p>
<ul class="simple">
<li><p><strong>Fixed</strong> issue #180 (“page.getText(output=’dict’) return invalid bbox”). Note that this is a circumvention of an MuPDF error, which generates zero-height character rectangles in some cases. When this happens, this fix ensures a bbox height of at least fontsize.</p></li>
<li><p><strong>Changed</strong> for ListBox and ComboBox widgets, the attribute list of selectable values has been renamed to <a class="reference internal" href="widget.html#Widget.choice_values" title="Widget.choice_values"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Widget.choice_values</span></code></a>.</p></li>
<li><p><strong>Changed</strong> when adding widgets, any missing of the <a class="reference internal" href="app3.html#base-14-fonts"><span class="std std-ref">PDF Base 14 字体</span></a> is automatically added to the PDF. Widget text fonts can now also be chosen from existing widget fonts. Any specified field values are now honored and lead to a field with a preset value.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.updateWidget()</span></code> which allows changing existing form fields – including the field value.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.11</strong></p>
<p>While the preceeding patch subversions only contained various fixes, this version again introduces major new features:</p>
<ul class="simple">
<li><p><strong>Added</strong> basic support for PDF widget annotations. You can now add PDF form fields of types Text, CheckBox, ListBox and ComboBox. Where necessary, the PDF is tranformed to a Form PDF with the first added widget.</p></li>
<li><p><strong>Fixed</strong> issues #176 (“wrong file embedding”), #177 (“segment fault when invoking page.getText()”)and #179 (“Segmentation fault using page.getLinks() on encrypted PDF”).</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.7</strong></p>
<ul class="simple">
<li><p><strong>Added</strong> support of variable page sizes for reflowable documents (e-books, HTML, etc.): new parameters <em>rect</em> and <em>fontsize</em> in <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> creation (open), and as a separate method <a class="reference internal" href="document.html#Document.layout" title="Document.layout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layout()</span></code></a>.</p></li>
<li><p><strong>Added</strong> <a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a> creation of many annotations types: sticky notes, free text, circle, rectangle, line, polygon, polyline and text markers.</p></li>
<li><p><strong>Added</strong> support of annotation transparency (<a class="reference internal" href="annot.html#Annot.opacity" title="Annot.opacity"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.opacity</span></code></a>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.setOpacity()</span></code>).</p></li>
<li><p><strong>Changed</strong> <a class="reference internal" href="annot.html#Annot.vertices" title="Annot.vertices"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.vertices</span></code></a>: point coordinates are now grouped as pairs of floats (no longer as separate floats).</p></li>
<li><p><strong>Changed</strong> annotation colors dictionary: the two keys are now named <em>“stroke”</em> (formerly <em>“common”</em>) and <em>“fill”</em>.</p></li>
<li><p><strong>Added</strong> <code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.isDirty</span></code> which is <em>True</em> if a PDF has been changed in this session. Reset to <em>False</em> on each <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> or <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.write()</span></code>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.6</strong></p>
<ul class="simple">
<li><p>Fix #173: for memory-resident documents, ensure the stream object will not be garbage-collected by Python before document is closed.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.5</strong></p>
<ul class="simple">
<li><p>New low-level method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page._setContents()</span></code> defines an object given by its <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> to serve as the <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a> object.</p></li>
<li><p>Changed and extended PDF form field support: the attribute <em>widget_text</em> has been renamed to <code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.widget_value</span></code>. Values of all form field types (except signatures) are now supported. A new attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.widget_choices</span></code> contains the selectable values of listboxes and comboboxes. All these attributes now contain <em>None</em> if no value is present.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.4</strong></p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.convertToPDF()</span></code> now supports page ranges, reverted page sequences and page rotation. If the document already is a PDF, an exception is raised.</p></li>
<li><p>Fixed a bug (introduced with v1.13.0) that prevented <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insertImage()</span></code> for transparent images.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.3</strong></p>
<p>Introduces a way to convert <strong>any MuPDF supported document</strong> to a PDF. If you ever wanted PDF versions of your XPS, EPUB, CBZ or FB2 files – here is a way to do this.</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.convertToPDF()</span></code> returns a Python <em>bytes</em> object in PDF format. Can be opened like normal in PyMuPDF, or be written to disk with the <em>“.pdf”</em> extension.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.2</strong></p>
<p>The major enhancement is PDF form field support. Form fields are annotations of type <em>(19, ‘Widget’)</em>. There is a new document method to check whether a PDF is a form. The <a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a> class has new properties describing field details.</p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.is_form_pdf" title="Document.is_form_pdf"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_form_pdf</span></code></a> is true if object type <em>/AcroForm</em> and at least one form field exists.</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.widget_type</span></code>, <code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.widget_text</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.widget_name</span></code> contain the details of a form field (i.e. a “Widget” annotation).</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.1</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="textpage.html#TextPage.extractDICT" title="TextPage.extractDICT"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractDICT()</span></code></a> is a new method to extract the contents of a document page (text and images). All document types are supported as with the other <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a> <em>extract*()</em> methods. The returned object is a dictionary of nested lists and other dictionaries, and <strong>exactly equal</strong> to the JSON-deserialization of the old <a class="reference internal" href="textpage.html#TextPage.extractJSON" title="TextPage.extractJSON"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractJSON()</span></code></a>. The difference is that the result is created directly – no JSON module is used. Because the user needs no JSON module to interpet the information, it should be easier to use, and also have a better performance, because it contains images in their original <strong>binary format</strong> – they need not be base64-decoded.</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getText()</span></code> correspondingly supports the new parameter value <em>“dict”</em> to invoke the above method.</p></li>
<li><p><a class="reference internal" href="textpage.html#TextPage.extractJSON" title="TextPage.extractJSON"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractJSON()</span></code></a> (resp. <em>Page.getText(“json”)</em>) is still supported for convenience, but its use is expected to decline.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.13.0</strong></p>
<p>This version is based on MuPDF v1.13.0. This release is “primarily a bug fix release”.</p>
<p>In PyMuPDF, we are also doing some bug fixes while introducing minor enhancements. There only very minimal changes to the user’s API.</p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> construction is more flexible: the new <em>filetype</em> parameter allows setting the document type. If specified, any extension in the filename will be ignored. More completely addresses <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/156">issue #156</a>. As part of this, the documentation has been reworked.</p></li>
<li><dl class="simple">
<dt>Changes to <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> constructors:</dt><dd><ul>
<li><p>Colorspace conversion no longer allows dropping the alpha channel: source and target <strong>alpha will now always be the same</strong>. We have seen exceptions and even interpreter crashes when using <em>alpha = 0</em>.</p></li>
<li><p>As a replacement, the simple pixmap copy lets you choose the target alpha.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> again offers the full garbage collection range 0 thru 4. Because of a bug in <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> maintenance, we had to temporarily enforce <em>garbage &gt; 1</em>. Finally resolves <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/148">issue #148</a>.</p></li>
<li><p><a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> now offers to “prettify” PDF source via an additional argument.</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insertImage()</span></code> has the additional <em>stream</em> -parameter, specifying a memory area holding an image.</p></li>
<li><p>Issue with garbled PNGs on Linux systems has been resolved (<a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/133">“Problem writing PNG” #133)</a>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.12.4</strong></p>
<p>This is an extension of 1.12.3.</p>
<ul class="simple">
<li><p>Fix of <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/147">issue #147</a>: methods <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.getPageFontlist()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.getPageImagelist()</span></code> now also show fonts and images contained in <a class="reference internal" href="glossary.html#resources" title="resources"><code class="xref py py-data docutils literal notranslate"><span class="pre">resources</span></code></a> nested via “Form XObjects”.</p></li>
<li><p>Temporary fix of <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/issues/148">issue #148</a>: Saving to new PDF files will now automatically use <em>garbage = 2</em> if a lower value is given. Final fix is to be expected with MuPDF’s next version. At that point we will remove this circumvention.</p></li>
<li><p>Preventive fix of illegally using stencil / image mask pixmaps in some methods.</p></li>
<li><p>Method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.getPageFontlist()</span></code> now includes the encoding name for each font in the list.</p></li>
<li><p>Method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.getPageImagelist()</span></code> now includes the decode method name for each image in the list.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.12.3</strong></p>
<p>This is an extension of 1.12.2.</p>
<ul class="simple">
<li><p>Many functions now return <em>None</em> instead of <em>0</em>, if the result has no other meaning than just indicating successful execution (<a class="reference internal" href="document.html#Document.close" title="Document.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.close()</span></code></a>, <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a>, <a class="reference internal" href="document.html#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a>, <a class="reference internal" href="pixmap.html#Pixmap.save" title="Pixmap.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.save()</span></code></a> and many others).</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.12.2</strong></p>
<p>This is an extension of 1.12.1.</p>
<ul class="simple">
<li><p>Method <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> now accepts the new <em>clip</em> argument. This specifies an area of the source page to which the display should be restricted.</p></li>
<li><p>New <code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.CropBox</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.MediaBox</span></code> have been included for convenience.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.12.1</strong></p>
<p>This is an extension of version 1.12.0.</p>
<ul class="simple">
<li><p>New method <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> displays another’s PDF page. This is a <strong>vector</strong> image and therefore remains precise across zooming. Both involved documents must be PDF.</p></li>
<li><p>New method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getSVGimage()</span></code> creates an SVG image from the page. In contrast to the raster image of a pixmap, this is a vector image format. The return is a unicode text string, which can be saved in a <em>.svg</em> file.</p></li>
<li><p>Method <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getTextBlocks()</span></code> now accepts an additional bool parameter “images”. If set to true (default is false), image blocks (metadata only) are included in the produced list and thus allow detecting areas with rendered images.</p></li>
<li><p>Minor bug fixes.</p></li>
<li><p>“text” result of <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getText()</span></code> concatenates all lines within a block using a single space character. MuPDF’s original uses “\n” instead, producing a rather ragged output.</p></li>
<li><p>New properties of <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> objects <code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.MediaBoxSize</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.CropBoxPosition</span></code> provide more information about a page’s dimensions. For non-PDF files (and for most PDF files, too) these will be equal to <code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rect.bottom_right</span></code>, resp. <code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rect.top_left</span></code>. For example, class <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a> makes use of them to correctly position its items.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.12.0</strong></p>
<p>This version is based on and requires MuPDF v1.12.0. The new MuPDF version contains quite a number of changes – most of them around text extraction. Some of the changes impact the programmer’s API.</p>
<ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Outline.saveText()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">Outline.saveXML()</span></code> have been deleted without replacement. You probably haven’t used them much anyway. But if you are looking for a replacement: the output of <a class="reference internal" href="document.html#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a> can easily be used to produce something equivalent.</p></li>
<li><p>Class <em>TextSheet</em> does no longer exist.</p></li>
<li><p>Text “spans” (one of the hierarchy levels of <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a>) no longer contain positioning information (i.e. no “bbox” key). Instead, spans now provide the font information for its text. This impacts our JSON output variant.</p></li>
<li><p>HTML output has improved very much: it now creates valid documents which can be displayed by browsers to produce a similar view as the original document.</p></li>
<li><p>There is a new output format XHTML, which provides text and images in a browser-readable format. The difference to HTML output is, that no effort is made to reproduce the original layout.</p></li>
<li><p>All output formats of <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getText()</span></code> now support creating complete, valid documents, by wrapping them with appropriate header and trailer information. If you are interested in using the HTML output, please make sure to read <a class="reference internal" href="app1.html#htmlquality"><span class="std std-ref">控制 HTML 输出的质量</span></a>.</p></li>
<li><p>To support finding text positions, we have added special methods that don’t need detours like <a class="reference internal" href="textpage.html#TextPage.extractJSON" title="TextPage.extractJSON"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractJSON()</span></code></a> or <a class="reference internal" href="textpage.html#TextPage.extractXML" title="TextPage.extractXML"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractXML()</span></code></a>: use <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getTextBlocks()</span></code> or resp. <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.getTextWords()</span></code> to create lists of text blocks or resp. words, which are accompanied by their rectangles. This should be much faster than the standard text extraction methods and also avoids using additional packages for interpreting their output.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.11.2</strong></p>
<p>This is an extension of v1.11.1.</p>
<ul>
<li><p>New <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insertFont()</span></code> creates a PDF <em>/Font</em> object and returns its object number.</p></li>
<li><p>New <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extractFont()</span></code> extracts the content of an embedded font given its object number.</p></li>
<li><p>Methods <strong>FontList(…)</strong> items no longer contain the PDF generation number. This value never had any significance. Instead, the font file extension is included (e.g. “pfa” for a “PostScript Font for ASCII”), which is more valuable information.</p></li>
<li><p>Fonts other than “simple fonts” (Type1) are now also supported.</p></li>
<li><p>New options to change <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> size:</p>
<blockquote>
<div><ul class="simple">
<li><p>Method <a class="reference internal" href="pixmap.html#Pixmap.shrink" title="Pixmap.shrink"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pixmap.shrink()</span></code></a> reduces the pixmap proportionally in place.</p></li>
<li><p>A new <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> copy constructor allows scaling via setting target width and height.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.11.1</strong></p>
<p>This is an extension of v1.11.0.</p>
<ul class="simple">
<li><p>New class <em>Shape</em>. It facilitates and extends the creation of image shapes on PDF pages. It contains multiple methods for creating elementary shapes like lines, rectangles or circles, which can be combined into more complex ones and be given common properties like line width or colors. Combined shapes are handled as a unit and e.g. be “morphed” together. The class can accumulate multiple complex shapes and put them all in the page’s foreground or background – thus also reducing the number of updates to the page’s <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a> object.</p></li>
<li><p>All <em>Page</em> draw methods now use the new <em>Shape</em> class.</p></li>
<li><p>Text insertion methods <em>insertText()</em> and <em>insertTextBox()</em> now support morphing in addition to text rotation. They have become part of the <em>Shape</em> class and thus allow text to be freely combined with graphics.</p></li>
<li><p>A new <em>Pixmap</em> constructor allows creating pixmap copies with an added alpha channel. A new method also allows directly manipulating alpha values.</p></li>
<li><p>Binary algebraic operations with geometry objects (matrices, rectangles and points) now generally also support lists or tuples as the second operand. You can add a tuple <em>(x, y)</em> of numbers to a <a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a>. In this context, such sequences are called “<a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a>” (resp. <a class="reference internal" href="glossary.html#matrix_like" title="matrix_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">matrix_like</span></code></a>, <a class="reference internal" href="glossary.html#rect_like" title="rect_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">rect_like</span></code></a>).</p></li>
<li><p>Geometry objects now fully support in-place operators. For example, <em>p /= m</em> replaces point p with <em>p * 1/m</em> for a number, or <em>p * ~m</em> for a <a class="reference internal" href="glossary.html#matrix_like" title="matrix_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">matrix_like</span></code></a> object <em>m</em>. Similarly, if <em>r</em> is a rectangle, then <em>r |= (3, 4)</em> is the new rectangle that also includes <em>fitz.Point(3, 4)</em>, and <em>r &amp;= (1, 2, 3, 4)</em> is its intersection with <em>fitz.Rect(1, 2, 3, 4)</em>.</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.11.0</strong></p>
<p><strong>基于 MuPDF v1.11 的版本</strong></p>
<p>尽管 MuPDF 将该版本声明为主要是修复错误的版本，但它确实包含了一个重要的新特性：<a href="#id434"><span class="problematic" id="id435">**</span></a>支持嵌入文件**（亦称为“作品集”或“集合”）。我们扩展了 PyMuPDF 的功能，使其在这一方面的能力略超 <em>mutool</em> 实用程序，具体如下：</p>
<ul>
<li><p><em>Document</em> 类新增多个方法和一个新属性，用于处理嵌入文件：</p>
<ul class="simple">
<li><p><em>embfile_Info()</em>：返回嵌入文件列表中某个条目的元数据信息。相比 <em>mutool</em>，它提供了更详细的信息，包括用于嵌入文件的所有相关数据（不仅仅是文件名）。</p></li>
<li><p><em>embfile_Get()</em>：将嵌入文件的内容解压到 <em>bytes</em> 缓冲区中。</p></li>
<li><p><em>embfile_Add(…)</em>：向 PDF 作品集中插入新文件。与 <em>mutool</em> 不同，我们 <strong>限制</strong> 该方法只能添加 <strong>新名称</strong> 的文件（不允许重复文件名）。</p></li>
<li><p><em>embfile_Del(…)</em>：从作品集中删除某个嵌入文件（此功能未在 MuPDF 中提供）。</p></li>
<li><p><em>embfile_SetInfo()</em>：修改嵌入文件的名称或描述信息。</p></li>
<li><p><em>embfile_Count</em>：包含嵌入文件的数量。</p></li>
</ul>
</li>
<li><p>我们进行了多项优化，以简化几何对象的处理。这些更改与新 MuPDF 版本无关，其中大多数在 PyMuPDF v1.10.0 中也已实现。这些优化包括：</p>
<ul>
<li><p>通过新的属性以名称识别矩形的角，例如：<em>Rect.bottom_right</em>。</p></li>
<li><p>新增多个方法来处理集合论相关的问题，例如：
- <em>Rect.contains(x)</em>：判断矩形是否包含点 <em>x</em>。
- <em>IRect.intersects(x)</em>：判断矩形是否与 <em>x</em> 相交。</p></li>
<li><p>加强了对 Pythonic 语言风格的支持。例如:</p>
<p>if x in rect:  # 现在等价于 rect.contains(x)</p>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> 章节新增了关于**空矩形**和**无限矩形**的背景介绍，并改进了相关的处理方式，以提高一致性。</p></li>
<li><p>我们开始支持 <strong>生成</strong> PDF 内容，包括以下方法：</p>
<ul class="simple">
<li><p><em>Document.insert_page()</em>：向 PDF 中添加一个新页面，可选地包含一些文本。</p></li>
<li><p><em>Page.insertImage()</em>：在 PDF 页面上插入一张新图片。</p></li>
<li><p><em>Page.insertText()</em>：在现有页面上添加新文本。</p></li>
</ul>
</li>
<li><p>现在可以提取和修改**文件附件**注释的内容及其名称。</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.10.0</strong></p>
<p><strong>MuPDF v1.10 影响</strong></p>
<p>MuPDF 版本 1.10 对我们的绑定产生了重大影响。其中一些变更也影响了 API —— 换句话说，<strong>作为 PyMuPDF 用户的您</strong> 可能需要注意这些更改。</p>
<ul class="simple">
<li><p><strong>链接目标信息已减少</strong>。<em>linkDest</em> 类的多个属性不再包含有价值的信息。事实上，该类已从 MuPDF 库中删除，PyMuPDF 仅保留它以确保与现有代码兼容。</p></li>
<li><p><strong>为了最小化内存占用，MuPDF v1.10 进行了多项优化</strong>：</p>
<ul>
<li><p>新增的 <em>config.h</em> 文件允许在 C 代码中禁用不需要的功能。利用此功能，我们将二进制文件 <em>_fitz.o</em> / <em>_fitz.pyd</em> 的大小从 9 MB 缩小到 4.5 MB。使用 UPX 压缩后，文件大小甚至可降至 2.3 MB。</p></li>
<li><p>Pixmap 现在的 alpha（透明度）通道是可选的。默认情况下，<em>alpha=False</em>，这大大减少了 Pixmap 大小（CMYK 约 20%，RGB 约 25%，GRAY 约 50%）。因此，许多 <em>Pixmap</em> 构造函数现在接受一个 <em>alpha</em> 布尔参数，以控制是否包含透明通道。而其他构造函数（如文件和图像输入）创建的 Pixmap 默认不包含 alpha 通道。需要注意的是，Pixmap 的保存方法不再支持 <em>savealpha</em> 选项：如果 alpha 通道存在，则始终会保存它。为尽量减少代码破坏，我们保留了该参数，但它将被忽略。</p></li>
</ul>
</li>
<li><p><a href="#id436"><span class="problematic" id="id437">**</span></a>DisplayList 和 TextPage 现在需要提供 mediabox**（即 <em>page.bound()</em> 矩形）。这一信息无法从其他来源推导，因此需要修改源代码。我们预计，大多数用户不会直接使用这些较低级的类，因此该更改的影响应较小。</p></li>
</ul>
<p>—</p>
<p><strong>与 1.9.3 版本相比的其他更改</strong></p>
<ul>
<li><p>新增 <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> 方法 <em>write()</em>，可将打开的 PDF 写入内存（而 <em>save()</em> 方法则是写入文件）。</p></li>
<li><p>现在可以缩放和移动注释（annotations），方法是修改其矩形属性。</p></li>
<li><p>现在可以删除注释。<a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> 类新增方法 <em>deleteAnnot()</em>。</p></li>
<li><p>现在可以修改各种注释属性，例如内容、日期、标题（作者）、边框、颜色等。</p></li>
<li><p>方法 <em>Document.insert_pdf()</em> 现在也会复制源页面的注释。</p></li>
<li><p><em>Pages</em> 类已删除。由于文档现在可以通过索引访问页面（如 <em>doc[n] = doc.loadPage(n)</em>），并且文档对象本身可用作迭代器，因此该类的维护价值过低，故被移除。</p></li>
<li><p><em>loadPage(n)</em> / <em>doc[n]</em> 现在支持任意整数作为页面编号，只要满足 <em>n &lt; pageCount</em>。例如，<em>doc[-500]</em> 仍然是有效的，并会加载页面 <em>(-500) % pageCount</em>。</p></li>
<li><p>现在文档对象可直接作为迭代器，例如:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
    <span class="o">...</span>  <span class="c1"># 对 &quot;page&quot; 进行处理</span>
</pre></div>
</div>
<p>这将遍历文档中的所有页面。</p>
</li>
<li><p><a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> 方法 <em>getSize()</em> 已被属性 <em>size</em> 取代。与以前一样，<em>Pixmap.size == len(Pixmap)</em> 仍然成立。</p></li>
<li><p>由于透明度（alpha）变为可选，<a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> 和 <a class="reference internal" href="colorspace.html#colorspace"><span class="std std-ref">Colorspace</span></a> 类新增多个参数和属性，以支持查询相关特性。</p></li>
<li><p><a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> 类新增属性 <em>firstAnnot</em> 和 <em>firstLink</em>，分别提供注释链和链接链的起始点。其中，<em>firstLink</em> 只是方法 <em>loadLinks()</em> 的一个助记符，后者仍然可用。同样，<em>rect</em> 是方法 <em>bound()</em> 的同义词，后者仍然可用。</p></li>
<li><p>由于 Pixmap 现在可以不包含透明通道，<a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> 的方法 <em>samplesRGB()</em> 和 <em>samplesAlpha()</em> 已被删除。</p></li>
<li><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> 现在有一个属性 <em>irect</em>，它是方法 <em>round()</em> 的同义词。同样，<a class="reference internal" href="irect.html#irect"><span class="std std-ref">IRect</span></a> 现在有一个属性 <em>rect</em>，用于返回具有相同坐标但浮点数值的 <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a>。</p></li>
<li><p>文档新增方法 <em>searchPageFor()</em>，用于搜索文本字符串。其工作方式与 <em>Page.searchFor()</em> 相同，但额外接受页面编号作为参数。</p></li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.9.3</strong></p>
<ul class="simple">
<li><p><strong>此版本同样基于 MuPDF v1.9a。与 1.9.2 版本相比，主要变更如下</strong>：</p>
<ul>
<li><p><strong>主要增强</strong>：现在支持注释（annotations），方式类似于链接（links）。可以显示注释（作为 pixmap），并访问其属性。</p></li>
<li><p>除了文档的 <em>select()</em> 方法外，现在可以使用一些更简单的方法来操作 PDF：</p>
<ul>
<li><p><em>copyPage()</em> 复制文档中的某个页面。</p></li>
<li><p><em>movePage()</em> 功能类似，但会删除原始页面。</p></li>
<li><p><em>delete_page()</em> 删除指定页面。</p></li>
<li><p><em>delete_pages()</em> 删除一个页面范围。</p></li>
</ul>
</li>
<li><p><em>rotation</em> 或 <em>setRotation()</em> 分别用于访问或更改 PDF 页面旋转角度。</p></li>
<li><p>之前已存在但未记录的功能：<a class="reference internal" href="irect.html#irect"><span class="std std-ref">IRect</span></a>、<a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a>、<a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a> 和 <a class="reference internal" href="matrix.html#matrix"><span class="std std-ref">Matrix</span></a> 现在支持 <em>len()</em> 方法，并且其坐标属性可通过索引访问，例如 <em>IRect.x1 == IRect[2]</em>。</p></li>
<li><p>为方便起见，现在文档支持简单的索引访问：<em>doc.loadPage(n) == doc[n]</em>。索引范围可以是 <em>-pageCount &lt; n &lt; pageCount</em>，例如 <em>doc[-1]</em> 代表文档的最后一页。</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.9.2</strong></p>
<ul>
<li><p><strong>此版本同样基于 MuPDF v1.9a。与 1.9.1 版本相比，主要变更如下</strong>：</p>
<ul>
<li><p><em>fitz.open()*（无参数）现在会创建一个新的空 **PDF*</em> 文档，即如果随后保存，则必须指定 <em>.pdf</em> 扩展名。</p></li>
<li><p><a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> 现在接受以下所有格式（<em>Document</em> 和 <em>open</em> 是同义词）：</p>
<ul class="simple">
<li><p><em>open()</em>，</p></li>
<li><p><em>open(filename)*（等效于 *open(filename, None)</em>），</p></li>
<li><p><em>open(filetype, area)*（等效于 *open(filetype, stream=area)</em>）。</p></li>
</ul>
<p>其中，<em>stream</em> 的类型可以是 <em>bytes</em> 或 <em>bytearray</em>。因此，例如可以直接使用 <a href="#id438"><span class="problematic" id="id439">`</span></a>area = open(“file.pdf”, “rb”).read()`（无需先转换为 bytearray）。</p>
</li>
<li><p>新方法 <a href="#id440"><span class="problematic" id="id441">*</span></a>Document.insert_pdf()*（仅适用于 PDF）可以从另一个 PDF 中插入一系列页面。</p></li>
<li><p>现在 <em>Document</em> 对象支持 <em>len()</em> 函数：<code class="docutils literal notranslate"><span class="pre">len(doc)</span> <span class="pre">==</span> <span class="pre">doc.pageCount</span></code>。</p></li>
<li><p>新方法 <em>Document.getPageImageList()</em> 创建一个页面所使用的图像列表。</p></li>
<li><p>新方法 <em>Document.getPageFontList()</em> 创建一个页面所引用的字体列表。</p></li>
<li><p>新的 Pixmap 构造函数 <em>fitz.Pixmap(doc, xref)</em> 允许基于已打开的 PDF 文档和图像的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 号创建 Pixmap。</p></li>
<li><p>新的 Pixmap 构造函数 <em>fitz.Pixmap(cspace, spix)</em> 允许基于已有 Pixmap <em>spix</em>，将其颜色空间转换为 <em>cspace</em>，支持所有颜色空间转换组合。</p></li>
<li><p>Pixmap 构造函数 <em>fitz.Pixmap(colorspace, width, height, samples)</em> 现在允许 <em>samples</em> 既可以是 <em>bytes</em>，也可以是 <em>bytearray</em>。</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
<p><strong>Changes in Version 1.9.1</strong></p>
<ul>
<li><p><strong>此版本的 PyMuPDF 基于 MuPDF 库源代码版本 1.9a，该版本发布于 2016 年 4 月 21 日</strong>。</p>
<p>请访问 MuPDF 的官方网站查看其中包含的更改和增强功能。</p>
</li>
<li><p><strong>版本 1.9.1 相较于版本 1.8.0 的变化</strong>:</p>
<ul class="simple">
<li><p>新方法 <em>get_area()</em> 适用于 <em>fitz.Rect</em> 和 <em>fitz.IRect</em>。</p></li>
<li><p>现在可以直接从文件创建 Pixmap，使用新的构造函数 <em>fitz.Pixmap(filename)</em>。</p></li>
<li><p>Pixmap 构造函数 <em>fitz.Pixmap(image)</em> 已相应扩展。</p></li>
<li><p>现在可以使用所有可能的点和坐标组合来创建 <em>fitz.Rect</em>。</p></li>
<li><p>PyMuPDF 的所有类和方法现在都包含 __doc__ 字符串，大多数由 SWIG 自动创建。虽然 PyMuPDF 的文档更加详细，但此功能应该有助于在支持 Python 的 IDE 中进行编程。</p></li>
<li><p>新的文档方法 <em>getPermits()</em> 返回与当前访问文档相关的权限（打印、编辑、注释、复制），作为 Python 字典。</p></li>
<li><p>身份矩阵 <em>fitz.Identity</em> 现在是 <strong>不可变</strong> 的。</p></li>
<li><p>新的文档方法 <em>select(list)</em> 会从文档中删除不在列表中的所有页面。页面也可以被复制和重新排列。</p></li>
<li><p>演示和示例集合中的各种改进和新成员。最显著的是：<em>PDF_display</em> 现在支持使用鼠标滚轮滚动，此外还有一个新的示例程序 <em>wxTableExtract</em>，可以图形化识别和提取文档中的表格数据。</p></li>
<li><p><em>fitz.open()</em> 现在是 <em>fitz.Document()</em> 的别名。</p></li>
<li><p>新的 Pixmap 方法 <em>tobytes()</em> 将返回一个以 PNG 图像格式表示的 pixmap 的 bytearray。</p></li>
<li><p>新的 Pixmap 方法 <em>samplesRGB()</em> 提供一个 <em>samples</em> 版本，去除了 alpha 字节（仅限 RGB 颜色空间）。</p></li>
<li><p>新的 Pixmap 方法 <em>samplesAlpha()</em> 提供 <em>samples</em> 区域的 alpha 字节。</p></li>
<li><p>新的迭代器 <em>fitz.Pages(doc)</em> 用于遍历文档的页面集合。</p></li>
<li><p>新的矩阵方法 <a href="#id442"><span class="problematic" id="id443">*</span></a>invert()*（计算反转矩阵）、<a href="#id444"><span class="problematic" id="id445">*</span></a>concat()*（计算矩阵乘积）、<a href="#id446"><span class="problematic" id="id447">*</span></a>pretranslate()*（执行平移操作）。</p></li>
<li><p>新的 <em>IRect</em> 方法 <a href="#id448"><span class="problematic" id="id449">*</span></a>intersect()*（与另一个矩形的交集）、<a href="#id450"><span class="problematic" id="id451">*</span></a>translate()*（执行平移操作）。</p></li>
<li><p>新的 <em>Rect</em> 方法 <a href="#id452"><span class="problematic" id="id453">*</span></a>intersect()*（与另一个矩形的交集）、<a href="#id454"><span class="problematic" id="id455">*</span></a>transform()*（使用矩阵进行转换）、<a href="#id456"><span class="problematic" id="id457">*</span></a>include_point()*（扩大矩形以包含一个点）、<a href="#id458"><span class="problematic" id="id459">*</span></a>include_rect()*（扩大矩形以包含另一个矩形）。</p></li>
<li><p>文档了 <a href="#id460"><span class="problematic" id="id461">*</span></a>Point.transform()*（使用矩阵转换点）。</p></li>
<li><p><em>Matrix</em>、<em>IRect</em>、<em>Rect</em> 和 <em>Point</em> 类现在支持紧凑的代数表达式来操作这些对象。</p></li>
<li><p>现在可以使用调用模式 <em>doc.save(doc.name, incremental=True)</em> 实现增量保存更改。</p></li>
<li><p>现在可以使用文档方法 <em>set_metadata()</em> 删除、设置或更改 PDF 的元数据。支持增量保存。</p></li>
<li><p>现在可以使用文档方法 <em>set_toc(list)</em> 删除、设置或更改 PDF 的书签（或目录）。支持增量保存。</p></li>
</ul>
</li>
</ul>
<div class="feedbackLink"><a id="feedbackLinkBottom" target=_blank>您对此页面有任何反馈吗？</b></a></div><hr class="docutils" />
<script>

   var url_string = window.location.href;
   var a = document.getElementById('feedbackLinkBottom');
   a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link&url="+url_string);

</script>

<p style="color:#999" id="footerDisclaimer">本软件按原样提供，不作任何明示或暗示担保。本软件根据许可分发，除非根据该许可条款明确授权，否则不得复制、修改或分发。请参阅 <a href="https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link">artifex.com</a> 上的许可信息，或联系 Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States 了解更多信息。</p>



<script>

   let docLanguage = document.getElementsByTagName('html')[0].getAttribute('lang');

   function getHeaderAndFooterTranslation(str) {
       if (docLanguage == "ja") {
           if (str == "Do you have any feedback on this page?") {
               return "このページに関するご意見はありますか？";
           } else if (str == "Find <b>#pymupdf</b> on <b>Discord</b>") {
               return "<b>Discord</b>の <b>#pymupdf</b> を見つける";
           } else if (str == "This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.") {

               return "このソフトウェアは無保証で提供されており、明示または黙示を問わず、いかなる保証もありません。このソフトウェアはライセンスの下で配布され、ライセンスの条件に明示的に許可されている場合を除き、コピー、変更、または配布してはなりません。ライセンシング情報については、<a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a>でライセンス情報を参照するか、アメリカ合衆国カリフォルニア州サンフランシスコのArtifex Software Inc. までお問い合わせください。"

           }
       }

       return str;
   }

   document.getElementById("findOnDiscord").innerHTML = getHeaderAndFooterTranslation("Find <b>#pymupdf</b> on <b>Discord</b>");
   document.getElementById("feedbackLinkTop").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("feedbackLinkBottom").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("footerDisclaimer").innerHTML = getHeaderAndFooterTranslation("This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.");


   // more translation for admonition-title as the in-built translation isn't great, needs: 注釈 -> 注
   if (docLanguage == "ja") {
       const collection = document.getElementsByClassName("admonition-title");
       for (var i=0;i<collection.length;i++) {
           collection[i].innerHTML = "注";
       }
   }


</script><p class="footer-version">This documentation covers all versions up to 1.25.4.</p>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="znames.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">已废弃名称</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="app4.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">附录 4：性能比较方法</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2025, Artifex
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 19. 3月 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/tabs.js"></script>
    <script src="_static/translations.js"></script>
    </body>
</html>