<!doctype html>
<html class="no-js" lang="zh-CN">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="Artifex" name="author" />
<meta content="PyMuPDF 是一个高性能 Python 库，用于 PDF（及其他）文档的数据提取、分析、转换和操作。" name="description" />
<meta content="PDF Text Extraction, PDF Image Extraction, PDF Conversion, PDF Tables, PDF Splitting, PDF Creation, Pyodide, PyScript" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZTN4VTL9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZTN4VTL9M');
    </script>
    <link rel="author" title="关于此文档" href="about.html" /><link rel="index" title="索引" href="genindex.html" /><link rel="search" title="搜索" href="search.html" /><link rel="next" title="教程" href="tutorial.html" /><link rel="prev" title="安装" href="installation.html" />

    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/><!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>基础用法 - PyMuPDF 1.25.4 文档</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMuPDF 1.25.4 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/sidebar-logo-dark.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/sidebar-logo-light.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyMuPDF 1.25.4 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">关于/About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">功能比较</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-performance">性能</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-license">许可和版权</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf4llm/index.html">PyMuPDF4LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf-pro.html">PyMuPDF Pro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">用户指南/User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">安装</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">基础用法</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">PyMuPDF、LLM 和 RAG</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">资源</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">教程/How to Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how-to-open-a-file.html">打开文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-text.html">文本</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-images.html">图片</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-annotations.html">注释</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-drawing-and-graphics.html">绘图和图形</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-stories.html">故事</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-journalling.html">日记</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-multiprocessing.html">多进程</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-ocr.html">OCR - 光学字符识别</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-optional-content.html">可选内容支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-low-level-interfaces.html">低级接口</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-common-issues-and-their-solutions.html">常见问题及其解决方案</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API参考/API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="module.html">命令行界面</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="classes.html">类</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="annot.html">Annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="archive-class.html">Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="colorspace.html">Colorspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="displaylist.html">DisplayList</a></li>
<li class="toctree-l2"><a class="reference internal" href="document.html">Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-writer-class.html">DocumentWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="font.html">Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="irect.html">IRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="link.html">Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkdest.html">linkDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="outline.html">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixmap.html">Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="point.html">Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="quad.html">Quad</a></li>
<li class="toctree-l2"><a class="reference internal" href="rect.html">Rect</a></li>
<li class="toctree-l2"><a class="reference internal" href="shape.html">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="story-class.html">Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="textpage.html">TextPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="textwriter.html">TextWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="widget.html">Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml-class.html">Xml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algebra.html">几何对象的运算符代数</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lowlevel.html">低级函数和类</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html">函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="device.html">设备</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop_low.html">协同工作: DisplayList 和 TextPage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">常量和枚举</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">颜色数据库</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">其他/Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app1.html">附录 1：文本提取详细信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app2.html">附录 2：嵌入式文件的注意事项</a></li>
<li class="toctree-l1"><a class="reference internal" href="app3.html">附录 3：各类技术信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app4.html">附录 4：性能比较方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">更新日志</a></li>
<li class="toctree-l1"><a class="reference internal" href="znames.html">已废弃名称</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div style="display:flex;justify-content:space-between;align-items: center;">
    <form class="sidebar-search-container top" method="get" action="search.html" role="search" style="width:75%">
      <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
    <div class="discordLink" style="display:flex;align-items:center;margin-top: -5px;">
        <a href="https://discord.gg/TSpYGBW4eq" id="findOnDiscord" target=_blank>Find <b>#pymupdf</b> on <b>Discord</b></a>
        <a href="https://discord.gg/TSpYGBW4eq" target=_blank>
            <div style="width:30px;height:30px;margin-left:5px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
                    <defs>
                        <style>.discordLogoFill{fill:#5865f2;}</style>
                    </defs>
                    <g id="Discord_Logo" data-name="Discord Logo">
                        <path class="discordLogoFill" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                    </g>
                </svg>
            </div>
        </a>
    </div>

</div><section id="thebasics">
<span id="id1"></span><h1>基础用法<a class="headerlink" href="#thebasics" title="此标题的永久链接">#</a></h1>
<p>The Basics</p>
<section id="the-basics-opening-files">
<span id="id2"></span><h2>打开文件<a class="headerlink" href="#the-basics-opening-files" title="此标题的永久链接">#</a></h2>
<p>Opening a File</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">中文</label><div class="tab-content docutils container">
<p>要打开文件，请执行以下操作:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;a.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<blockquote>
<div><p><strong>进一步</strong></p>
</div></blockquote>
<p>有关更多高级选项，请参阅 <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">支持的文件类型列表</span></a> 和 <a class="reference internal" href="how-to-open-a-file.html#howtoopenafile"><span class="std std-ref">如何打开文件的指南</span></a>。</p>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">英文</label><div class="tab-content docutils container">
<p>To open a file, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;a.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Taking it further</strong></p>
<p>See the <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">list of supported file types</span></a> and <a class="reference internal" href="how-to-open-a-file.html#howtoopenafile"><span class="std std-ref">The How to Guide on Opening Files</span></a> for more advanced options.</p>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="pdf">
<span id="the-basics-extracting-text"></span><h2>从 <cite>PDF</cite> 中提取文本<a class="headerlink" href="#pdf" title="此标题的永久链接">#</a></h2>
<p>Extract text from a <cite>PDF</cite></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">中文</label><div class="tab-content docutils container">
<p>要从 <cite>PDF</cite> 文件中提取所有文本，请执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;a.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开 PDF 文档</span>
<span class="n">out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;output.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="c1"># 创建文本输出文件</span>
<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span> <span class="c1"># 遍历文档页面</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span> <span class="c1"># 获取纯文本（UTF-8 编码）</span>
    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="c1"># 写入页面文本</span>
    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">((</span><span class="mi">12</span><span class="p">,)))</span> <span class="c1"># 写入页面分隔符（换页符 0x0C）</span>
<span class="n">out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>当然，不仅仅是 <cite>PDF</cite> 可以提取文本，所有 <a class="reference internal" href="about.html#about-feature-matrix"><span class="std std-ref">支持的文档文件格式</span></a>，如 <cite>MOBI</cite>、 <cite>EPUB</cite>、 <cite>TXT</cite>，都可以提取文本。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>进一步提升</strong></p>
<p>如果您的文档包含基于图像的文本内容，可以对页面使用 OCR 进行文本提取：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tp</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_textpage_ocr</span><span class="p">()</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">textpage</span><span class="o">=</span><span class="n">tp</span><span class="p">)</span>
</pre></div>
</div>
<p>还有许多示例讲解了如何从特定区域提取文本，或者如何从文档中提取表格。请参考 <a class="reference internal" href="recipes-text.html#recipestext"><span class="std std-ref">文本处理指南</span></a>。</p>
<p>现在，您还可以 <a class="reference internal" href="rag.html#rag-outputting-as-md"><span class="std std-ref">以 Markdown 格式提取文本</span></a>。</p>
<p><strong>API 参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">英文</label><div class="tab-content docutils container">
<p>To extract all the text from a <cite>PDF</cite> file, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;a.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>
<span class="n">out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;output.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="c1"># create a text output</span>
<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span> <span class="c1"># iterate the document pages</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf8&quot;</span><span class="p">)</span> <span class="c1"># get plain text (is in UTF-8)</span>
    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="c1"># write text of page</span>
    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytes</span><span class="p">((</span><span class="mi">12</span><span class="p">,)))</span> <span class="c1"># write page delimiter (form feed 0x0C)</span>
<span class="n">out</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Of course it is not just <cite>PDF</cite> which can have text extracted - all the <a class="reference internal" href="about.html#about-feature-matrix"><span class="std std-ref">supported document file formats</span></a> such as <cite>MOBI</cite>, <cite>EPUB</cite>, <cite>TXT</cite> can have their text extracted.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Taking it further</strong></p>
<p>If your document contains image based text content the use OCR on the page for subsequent text extraction:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tp</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_textpage_ocr</span><span class="p">()</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">textpage</span><span class="o">=</span><span class="n">tp</span><span class="p">)</span>
</pre></div>
</div>
<p>There are many more examples which explain how to extract text from specific areas or how to extract tables from documents. Please refer to the <a class="reference internal" href="recipes-text.html#recipestext"><span class="std std-ref">How to Guide for Text</span></a>.</p>
<p>You can now also <a class="reference internal" href="rag.html#rag-outputting-as-md"><span class="std std-ref">extract text in Markdown format</span></a>.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-extracting-images">
<span id="id3"></span><h2>从 <cite>PDF</cite> 中提取图像<a class="headerlink" href="#the-basics-extracting-images" title="此标题的永久链接">#</a></h2>
<p>Extract images from a <cite>PDF</cite></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">中文</label><div class="tab-content docutils container">
<p>要从 <cite>PDF</cite> 文件中提取所有图像，请执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开 PDF 文档</span>

<span class="k">for</span> <span class="n">page_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)):</span> <span class="c1"># 遍历 PDF 页面</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">page_index</span><span class="p">]</span> <span class="c1"># 获取页面</span>
    <span class="n">image_list</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_images</span><span class="p">()</span>

    <span class="c1"># 输出当前页面找到的图像数量</span>
    <span class="k">if</span> <span class="n">image_list</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;在第 </span><span class="si">{</span><span class="n">page_index</span><span class="si">}</span><span class="s2"> 页找到 </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">image_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> 张图片&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;第 </span><span class="si">{</span><span class="n">page_index</span><span class="si">}</span><span class="s2"> 页未找到图片&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">image_index</span><span class="p">,</span> <span class="n">img</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">image_list</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span> <span class="c1"># 遍历图像列表</span>
        <span class="n">xref</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># 获取图像的 XREF</span>
        <span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">xref</span><span class="p">)</span> <span class="c1"># 创建 Pixmap 对象</span>

        <span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span> <span class="c1"># 如果是 CMYK 模式，则先转换为 RGB</span>
            <span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">csRGB</span><span class="p">,</span> <span class="n">pix</span><span class="p">)</span>

        <span class="n">pix</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;page_</span><span class="si">%s</span><span class="s2">-image_</span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">page_index</span><span class="p">,</span> <span class="n">image_index</span><span class="p">))</span> <span class="c1"># 以 PNG 格式保存图片</span>
        <span class="n">pix</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>进一步提升</strong></p>
<p>还有许多示例讲解了如何从特定区域提取文本，或者如何从文档中提取表格。请参考 <a class="reference internal" href="recipes-text.html#recipestext"><span class="std std-ref">文本处理指南</span></a>。</p>
<p><strong>API 参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.get_images" title="Page.get_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_images()</span></code></a></p></li>
<li><p><a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">英文</label><div class="tab-content docutils container">
<p>To extract all the images from a <cite>PDF</cite> file, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>

<span class="k">for</span> <span class="n">page_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)):</span> <span class="c1"># iterate over pdf pages</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">page_index</span><span class="p">]</span> <span class="c1"># get the page</span>
    <span class="n">image_list</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_images</span><span class="p">()</span>

    <span class="c1"># print the number of images found on the page</span>
    <span class="k">if</span> <span class="n">image_list</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">image_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> images on page </span><span class="si">{</span><span class="n">page_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No images found on page&quot;</span><span class="p">,</span> <span class="n">page_index</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">image_index</span><span class="p">,</span> <span class="n">img</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">image_list</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span> <span class="c1"># enumerate the image list</span>
        <span class="n">xref</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># get the XREF of the image</span>
        <span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">xref</span><span class="p">)</span> <span class="c1"># create a Pixmap</span>

        <span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span> <span class="c1"># CMYK: convert to RGB first</span>
            <span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">csRGB</span><span class="p">,</span> <span class="n">pix</span><span class="p">)</span>

        <span class="n">pix</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;page_</span><span class="si">%s</span><span class="s2">-image_</span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">page_index</span><span class="p">,</span> <span class="n">image_index</span><span class="p">))</span> <span class="c1"># save the image as png</span>
        <span class="n">pix</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Taking it further</strong></p>
<p>There are many more examples which explain how to extract text from specific areas or how to extract tables from documents. Please refer to the <a class="reference internal" href="recipes-text.html#recipestext"><span class="std std-ref">How to Guide for Text</span></a>.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.get_images" title="Page.get_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_images()</span></code></a></p></li>
<li><p><a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a></p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="the-basics-extracting-vector-graphics">
<span id="id4"></span><h2>提取矢量图形<a class="headerlink" href="#the-basics-extracting-vector-graphics" title="此标题的永久链接">#</a></h2>
<p>Extract vector graphics</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">中文</label><div class="tab-content docutils container">
<p>要从文档页面中提取所有矢量图形，请执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;some.file&quot;</span><span class="p">)</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">paths</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_drawings</span><span class="p">()</span>
</pre></div>
</div>
<p>这将返回一个包含页面上所有矢量绘图路径的字典。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>进一步提升</strong></p>
<p>请参考: <a class="reference internal" href="recipes-drawing-and-graphics.html#recipesdrawingandgraphics-extract-drawings"><span class="std std-ref">如何提取绘图</span></a>。</p>
<p><strong>API 参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">英文</label><div class="tab-content docutils container">
<p>To extract all the vector graphics from a document page, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;some.file&quot;</span><span class="p">)</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">paths</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_drawings</span><span class="p">()</span>
</pre></div>
</div>
<p>This will return a dictionary of paths for any vector drawings found on the page.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Taking it further</strong></p>
<p>Please refer to: <a class="reference internal" href="recipes-drawing-and-graphics.html#recipesdrawingandgraphics-extract-drawings"><span class="std std-ref">How to Extract Drawings</span></a>.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="join-pdf">
<span id="merge-pdf"></span><span id="the-basics-merging-pdf"></span><span id="id5"></span><h2>合并 <cite>PDF</cite> 文件<a class="headerlink" href="#join-pdf" title="此标题的永久链接">#</a></h2>
<p>Merging <cite>PDF</cite> files</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">中文</label><div class="tab-content docutils container">
<p>要合并 <cite>PDF</cite> 文件，请执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc_a</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;a.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开第一个文档</span>
<span class="n">doc_b</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;b.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开第二个文档</span>

<span class="n">doc_a</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc_b</span><span class="p">)</span> <span class="c1"># 合并文档</span>
<span class="n">doc_a</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;a+b.pdf&quot;</span><span class="p">)</span> <span class="c1"># 以新文件名保存合并后的文档</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">英文</label><div class="tab-content docutils container">
<p>To merge <cite>PDF</cite> files, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc_a</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;a.pdf&quot;</span><span class="p">)</span> <span class="c1"># open the 1st document</span>
<span class="n">doc_b</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;b.pdf&quot;</span><span class="p">)</span> <span class="c1"># open the 2nd document</span>

<span class="n">doc_a</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc_b</span><span class="p">)</span> <span class="c1"># merge the docs</span>
<span class="n">doc_a</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;a+b.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the merged document with a new filename</span>
</pre></div>
</div>
</div>
</div>
<section id="id6">
<h3>将 <cite>PDF</cite> 文件与其他类型的文件合并<a class="headerlink" href="#id6" title="此标题的永久链接">#</a></h3>
<p>Merging <cite>PDF</cite> files with other types of file</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">中文</label><div class="tab-content docutils container">
<p>使用 <a class="reference internal" href="document.html#Document.insert_file" title="Document.insert_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_file()</span></code></a>，您可以调用该方法将 <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">支持的文件</span></a> 与 <cite>PDF</cite> 合并。例如：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc_a</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;a.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开第一个文档</span>
<span class="n">doc_b</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;b.svg&quot;</span><span class="p">)</span> <span class="c1"># 打开第二个文档</span>

<span class="n">doc_a</span><span class="o">.</span><span class="n">insert_file</span><span class="p">(</span><span class="n">doc_b</span><span class="p">)</span> <span class="c1"># 合并文档</span>
<span class="n">doc_a</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;a+b.pdf&quot;</span><span class="p">)</span> <span class="c1"># 以新文件名保存合并后的文档</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>深入探索</strong></p>
<p>使用 <a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a> 和 <a class="reference internal" href="document.html#Document.insert_file" title="Document.insert_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_file()</span></code></a> 轻松合并 PDF。对于已打开的 <cite>PDF</cite> 文档，您可以将一个文档中的页面范围复制到另一个文档中。您可以选择插入位置、翻转页面顺序以及更改页面旋转角度。</p>
<p>GUI 脚本 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py">join.py</a> 采用此方法合并文件列表，并同时合并相应的目录结构。界面如下所示：</p>
<img alt="_images/img-pdfjoiner.jpg" src="_images/img-pdfjoiner.jpg" />
<dl class="field-list simple">
<dt class="field-odd">scale<span class="colon">:</span></dt>
<dd class="field-odd"><p>60</p>
</dd>
</dl>
<p><strong>API 参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a></p></li>
<li><p><a class="reference internal" href="document.html#Document.insert_file" title="Document.insert_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_file()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">英文</label><div class="tab-content docutils container">
<p>With <a class="reference internal" href="document.html#Document.insert_file" title="Document.insert_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_file()</span></code></a> you can invoke the method to merge <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">supported files</span></a> with <cite>PDF</cite>. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc_a</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;a.pdf&quot;</span><span class="p">)</span> <span class="c1"># open the 1st document</span>
<span class="n">doc_b</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;b.svg&quot;</span><span class="p">)</span> <span class="c1"># open the 2nd document</span>

<span class="n">doc_a</span><span class="o">.</span><span class="n">insert_file</span><span class="p">(</span><span class="n">doc_b</span><span class="p">)</span> <span class="c1"># merge the docs</span>
<span class="n">doc_a</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;a+b.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the merged document with a new filename</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Taking it further</strong></p>
<p>It is easy to join PDFs with <a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a> &amp; <a class="reference internal" href="document.html#Document.insert_file" title="Document.insert_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_file()</span></code></a>. Given open <cite>PDF</cite> documents, you can copy page ranges from one to the other. You can select the point where the copied pages should be placed, you can revert the page sequence and also change page rotation.</p>
<p>The GUI script <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py">join.py</a> uses this method to join a list of files while also joining the respective table of contents segments. It looks like this:</p>
<img alt="_images/img-pdfjoiner.jpg" src="_images/img-pdfjoiner.jpg" />
<dl class="field-list simple">
<dt class="field-odd">scale<span class="colon">:</span></dt>
<dd class="field-odd"><p>60</p>
</dd>
</dl>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a></p></li>
<li><p><a class="reference internal" href="document.html#Document.insert_file" title="Document.insert_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_file()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id8">
<h2>使用坐标<a class="headerlink" href="#id8" title="此标题的永久链接">#</a></h2>
<p>Working with Coordinates</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">中文</label><div class="tab-content docutils container">
<p>在使用 <strong>PyMuPDF</strong> 时，有一个 <em>数学术语</em> 您需要熟悉—— <strong>“坐标”</strong> 。请快速浏览 <a class="reference internal" href="app3.html#coordinates"><span class="std std-ref">坐标</span></a> 部分，以了解坐标系统。这将帮助您准确定位对象，并更好地理解您的文档空间。</p>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">英文</label><div class="tab-content docutils container">
<p>There is one <em>mathematical term</em> that you should feel comfortable with when using <strong>PyMuPDF</strong> -  <strong>“coordinates”</strong>. Please have a quick look at the <a class="reference internal" href="app3.html#coordinates"><span class="std std-ref">坐标</span></a> section to understand the coordinate system to help you with positioning objects and understand your document space.</p>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-watermarks">
<span id="id9"></span><h2>向 <cite>PDF</cite> 添加水印<a class="headerlink" href="#the-basics-watermarks" title="此标题的永久链接">#</a></h2>
<p>Adding a watermark to a <cite>PDF</cite></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">中文</label><div class="tab-content docutils container">
<p>要向 <cite>PDF</cite> 文件添加水印，请执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;document.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开 PDF 文档</span>

<span class="k">for</span> <span class="n">page_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)):</span> <span class="c1"># 遍历 PDF 页</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">page_index</span><span class="p">]</span> <span class="c1"># 获取页面</span>

    <span class="c1"># 从文件插入图像水印，使其适应页面边界</span>
    <span class="n">page</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">bound</span><span class="p">(),</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;watermark.png&quot;</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;watermarked-document.pdf&quot;</span><span class="p">)</span> <span class="c1"># 以新文件名保存水印后的文档</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>更进一步</strong></p>
<p>添加水印的本质就是在每个 <cite>PDF</cite> 页面底部添加一个图像。您应该确保该图像具有所需的不透明度和纵横比，以使其呈现符合需求的效果。</p>
<p>在上面的示例中，每次引用文件时都会创建一个新的图像。但为了提高性能（减少内存占用和文件大小），应仅引用一次此图像数据。请参考 <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a> 的代码示例和解释，了解具体实现方式。</p>
<p><strong>API 参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.bound" title="Page.bound"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.bound()</span></code></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">英文</label><div class="tab-content docutils container">
<p>To add a watermark to a <cite>PDF</cite> file, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;document.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>

<span class="k">for</span> <span class="n">page_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)):</span> <span class="c1"># iterate over pdf pages</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">page_index</span><span class="p">]</span> <span class="c1"># get the page</span>

    <span class="c1"># insert an image watermark from a file name to fit the page bounds</span>
    <span class="n">page</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">bound</span><span class="p">(),</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;watermark.png&quot;</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;watermarked-document.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document with a new filename</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Taking it further</strong></p>
<p>Adding watermarks is essentially as simple as adding an image at the base of each <cite>PDF</cite> page. You should ensure that the image has the required opacity and aspect ratio to make it look the way you need it to.</p>
<p>In the example above a new image is created from each file reference, but to be more performant (by saving memory and file size) this image data should be referenced only once - see the code example and explanation on <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a> for the implementation.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.bound" title="Page.bound"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.bound()</span></code></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-images">
<span id="id10"></span><h2>向 <cite>PDF</cite> 添加图像<a class="headerlink" href="#the-basics-images" title="此标题的永久链接">#</a></h2>
<p>Adding an image to a <cite>PDF</cite></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">中文</label><div class="tab-content docutils container">
<p>要向 <cite>PDF</cite> 文件添加图像（例如 Logo），请执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;document.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开 PDF 文档</span>

<span class="k">for</span> <span class="n">page_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)):</span> <span class="c1"># 遍历 PDF 页</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">page_index</span><span class="p">]</span> <span class="c1"># 获取页面</span>

    <span class="c1"># 从文件插入 Logo 图像，放置在文档左上角</span>
    <span class="n">page</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;my-logo.png&quot;</span><span class="p">)</span>

<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;logo-document.pdf&quot;</span><span class="p">)</span> <span class="c1"># 以新文件名保存文档</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>更进一步</strong></p>
<p>与水印示例类似，为了提高性能，应尽可能仅引用一次图像数据。请参考 <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a> 的代码示例和解释，了解具体实现方式。</p>
<p><strong>API 参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">英文</label><div class="tab-content docutils container">
<p>To add an image to a <cite>PDF</cite> file, for example a logo, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;document.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>

<span class="k">for</span> <span class="n">page_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)):</span> <span class="c1"># iterate over pdf pages</span>
    <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">page_index</span><span class="p">]</span> <span class="c1"># get the page</span>

    <span class="c1"># insert an image logo from a file name at the top left of the document</span>
    <span class="n">page</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;my-logo.png&quot;</span><span class="p">)</span>

<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;logo-document.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document with a new filename</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Taking it further</strong></p>
<p>As with the watermark example you should ensure to be more performant by only referencing the image once if possible - see the code example and explanation on <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a>.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-rotating">
<span id="id11"></span><h2>旋转 <cite>PDF</cite><a class="headerlink" href="#the-basics-rotating" title="此标题的永久链接">#</a></h2>
<p>Rotating a <cite>PDF</cite></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">中文</label><div class="tab-content docutils container">
<p>要旋转 PDF 页面，请执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开 PDF 文档</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># 获取文档的第一页</span>
<span class="n">page</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="c1"># 旋转页面 90 度</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;rotated-page-1.pdf&quot;</span><span class="p">)</span> <span class="c1"># 以新文件名保存文档</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API 参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.set_rotation" title="Page.set_rotation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_rotation()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">英文</label><div class="tab-content docutils container">
<p>To add a rotation to a page, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open document</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># get the 1st page of the document</span>
<span class="n">page</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="c1"># rotate the page</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;rotated-page-1.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.set_rotation" title="Page.set_rotation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_rotation()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-cropping">
<span id="id12"></span><h2>裁剪 <cite>PDF</cite><a class="headerlink" href="#the-basics-cropping" title="此标题的永久链接">#</a></h2>
<p>Cropping a <cite>PDF</cite></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">中文</label><div class="tab-content docutils container">
<p>要裁剪 PDF 页面到指定的 <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> 区域，请执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开 PDF 文档</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># 获取文档的第一页</span>
<span class="n">page</span><span class="o">.</span><span class="n">set_cropbox</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">))</span> <span class="c1"># 设置裁剪区域</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;cropped-page-1.pdf&quot;</span><span class="p">)</span> <span class="c1"># 以新文件名保存裁剪后的文档</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API 参考</strong></p>
<ul class="simple">
<li><p>:</p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">英文</label><div class="tab-content docutils container">
<p>To crop a page to a defined <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a>, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open document</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># get the 1st page of the document</span>
<span class="n">page</span><span class="o">.</span><span class="n">set_cropbox</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">))</span> <span class="c1"># set a cropbox for the page</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;cropped-page-1.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.set_cropbox" title="Page.set_cropbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_cropbox()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-attaching-files">
<span id="id13"></span><h2><span class="target" id="index-0"></span>附加文件<a class="headerlink" href="#the-basics-attaching-files" title="此标题的永久链接">#</a></h2>
<p><span class="target" id="index-1"></span>Attaching Files</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--11-input--1" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--1">中文</label><div class="tab-content docutils container">
<p>要将另一个文件附加到页面中，请执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开主文档</span>
<span class="n">attachment</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-attachment.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开要附加的文档</span>

<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># 获取文档的第一页</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># 创建添加附件的位置</span>
<span class="n">attachment_data</span> <span class="o">=</span> <span class="n">attachment</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span> <span class="c1"># 获取文档的字节数据作为缓冲区</span>

<span class="c1"># 添加文件注释，指定位置、数据和文件名</span>
<span class="n">file_annotation</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">add_file_annot</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">attachment_data</span><span class="p">,</span> <span class="s2">&quot;attachment.pdf&quot;</span><span class="p">)</span>

<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;document-with-attachment.pdf&quot;</span><span class="p">)</span> <span class="c1"># 保存包含附件的文档</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>进一步操作</strong></p>
<p>在使用 <a class="reference internal" href="page.html#Page.add_file_annot" title="Page.add_file_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_file_annot()</span></code></a> 添加文件时，注意 <code class="xref any docutils literal notranslate"><span class="pre">filename</span></code> 的第三个参数应包含实际的文件扩展名。没有扩展名，附件可能无法被识别为可打开的文件。例如，如果 <code class="xref any docutils literal notranslate"><span class="pre">filename</span></code> 只是 <em>“attachment”</em>，在查看结果 PDF 并尝试打开附件时，可能会收到错误。但如果是 <em>“attachment.pdf”</em>，PDF 查看器就能识别并成功打开附件。</p>
<p>附件的默认图标是 “推针”，但可以通过设置 <code class="xref any docutils literal notranslate"><span class="pre">icon</span></code> 参数来更改它。</p>
<p><strong>API 参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p></li>
<li><p><a class="reference internal" href="document.html#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.add_file_annot" title="Page.add_file_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_file_annot()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--11-input--2" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--2">英文</label><div class="tab-content docutils container">
<p>To attach another file to a page, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open main document</span>
<span class="n">attachment</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-attachment.pdf&quot;</span><span class="p">)</span> <span class="c1"># open document you want to attach</span>

<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># get the 1st page of the document</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># create the point where you want to add the attachment</span>
<span class="n">attachment_data</span> <span class="o">=</span> <span class="n">attachment</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span> <span class="c1"># get the document byte data as a buffer</span>

<span class="c1"># add the file annotation with the point, data and the file name</span>
<span class="n">file_annotation</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">add_file_annot</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">attachment_data</span><span class="p">,</span> <span class="s2">&quot;attachment.pdf&quot;</span><span class="p">)</span>

<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;document-with-attachment.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Taking it further</strong></p>
<p>When adding the file with <a class="reference internal" href="page.html#Page.add_file_annot" title="Page.add_file_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_file_annot()</span></code></a> note that the third parameter for the <code class="xref any docutils literal notranslate"><span class="pre">filename</span></code> should include the actual file extension. Without this the attachment possibly will not be able to be recognized as being something which can be opened. For example, if the <code class="xref any docutils literal notranslate"><span class="pre">filename</span></code> is just <em>“attachment”</em> when view the resulting PDF and attempting to open the attachment you may well get an error. However, with <em>“attachment.pdf”</em> this can be recognized and opened by PDF viewers as a valid file type.</p>
<p>The default icon for the attachment is by default a “push pin”, however you can change this by setting the <code class="xref any docutils literal notranslate"><span class="pre">icon</span></code> parameter.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p></li>
<li><p><a class="reference internal" href="document.html#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.add_file_annot" title="Page.add_file_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_file_annot()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-embedding-files">
<span id="id14"></span><h2><span class="target" id="index-2"></span>嵌入文件<a class="headerlink" href="#the-basics-embedding-files" title="此标题的永久链接">#</a></h2>
<p><span class="target" id="index-3"></span>Embedding Files</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--12-input--1" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--1">中文</label><div class="tab-content docutils container">
<p>要将文件嵌入到文档中，请执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开主文档</span>
<span class="n">embedded_doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-embed.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开要嵌入的文档</span>

<span class="n">embedded_data</span> <span class="o">=</span> <span class="n">embedded_doc</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span> <span class="c1"># 获取文档的字节数据作为缓冲区</span>

<span class="c1"># 使用文件名和数据进行嵌入</span>
<span class="n">doc</span><span class="o">.</span><span class="n">embfile_add</span><span class="p">(</span><span class="s2">&quot;my-embedded_file.pdf&quot;</span><span class="p">,</span> <span class="n">embedded_data</span><span class="p">)</span>

<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;document-with-embed.pdf&quot;</span><span class="p">)</span> <span class="c1"># 保存包含嵌入文件的文档</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>进一步操作</strong></p>
<p>与 <a class="reference internal" href="#the-basics-attaching-files"><span class="std std-ref">附加文件</span></a> 类似，使用 <a class="reference internal" href="document.html#Document.embfile_add" title="Document.embfile_add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_add()</span></code></a> 添加文件时，请注意 <code class="xref any docutils literal notranslate"><span class="pre">filename</span></code> 的第一个参数应包含实际的文件扩展名。</p>
<p><strong>API 参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a></p></li>
<li><p><a class="reference internal" href="document.html#Document.embfile_add" title="Document.embfile_add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_add()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--12-input--2" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--2">英文</label><div class="tab-content docutils container">
<p>To embed a file to a document, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open main document</span>
<span class="n">embedded_doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;my-embed.pdf&quot;</span><span class="p">)</span> <span class="c1"># open document you want to embed</span>

<span class="n">embedded_data</span> <span class="o">=</span> <span class="n">embedded_doc</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span> <span class="c1"># get the document byte data as a buffer</span>

<span class="c1"># embed with the file name and the data</span>
<span class="n">doc</span><span class="o">.</span><span class="n">embfile_add</span><span class="p">(</span><span class="s2">&quot;my-embedded_file.pdf&quot;</span><span class="p">,</span> <span class="n">embedded_data</span><span class="p">)</span>

<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;document-with-embed.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Taking it further</strong></p>
<p>As with <a class="reference internal" href="#the-basics-attaching-files"><span class="std std-ref">attaching files</span></a>, when adding the file with <a class="reference internal" href="document.html#Document.embfile_add" title="Document.embfile_add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_add()</span></code></a> note that the first parameter for the <code class="xref any docutils literal notranslate"><span class="pre">filename</span></code> should include the actual file extension.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a></p></li>
<li><p><a class="reference internal" href="document.html#Document.embfile_add" title="Document.embfile_add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_add()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-deleting-pages">
<span id="id15"></span><h2>删除页面<a class="headerlink" href="#the-basics-deleting-pages" title="此标题的永久链接">#</a></h2>
<p>Deleting Pages</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--13-input--1" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--1">中文</label><div class="tab-content docutils container">
<p>要从文档中删除页面，请执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开文档</span>
<span class="n">doc</span><span class="o">.</span><span class="n">delete_page</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># 删除文档中的第1页</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test-deleted-page-one.pdf&quot;</span><span class="p">)</span> <span class="c1"># 保存文档</span>
</pre></div>
</div>
<p>要从文档中删除多个页面，请执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开文档</span>
<span class="n">doc</span><span class="o">.</span><span class="n">delete_pages</span><span class="p">(</span><span class="n">from_page</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> <span class="c1"># 删除文档中的页面范围</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test-deleted-pages.pdf&quot;</span><span class="p">)</span> <span class="c1"># 保存文档</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--13-input--2" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--2">英文</label><div class="tab-content docutils container">
<p>To delete a page from a document, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">delete_page</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># delete the 1st page of the document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test-deleted-page-one.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
<p>To delete a multiple pages from a document, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">delete_pages</span><span class="p">(</span><span class="n">from_page</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> <span class="c1"># delete a page range from the document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test-deleted-pages.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
</div>
</div>
<section id="id16">
<h3>如果我删除书签或超链接引用的页面会发生什么？<a class="headerlink" href="#id16" title="此标题的永久链接">#</a></h3>
<p>What happens if I delete a page referred to by bookmarks or hyperlinks?</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--14-input--1" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--1">中文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p>书签（目录中的条目）将变为无效，并且将不再导航到任何页面。</p></li>
<li><p>超链接将从包含它的页面中删除。该页面上的可见内容将不会以其他方式更改。</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>进一步操作</strong></p>
<p>页面索引是从零开始的，因此要删除文档中的第10页，您可以执行以下操作 <code class="xref any docutils literal notranslate"><span class="pre">doc.delete_page(9)</span></code>。</p>
<p>同样，<code class="xref any docutils literal notranslate"><span class="pre">doc.delete_pages(from_page=9,</span> <span class="pre">to_page=14)</span></code> 将删除第10到第15页（包括这两页）。</p>
<p><strong>API参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_page()</span></code></a></p></li>
<li><p><a class="reference internal" href="document.html#Document.delete_pages" title="Document.delete_pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_pages()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--14-input--2" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--2">英文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p>A bookmark (entry in the Table of Contents) will become inactive and will no longer navigate to any page.</p></li>
<li><p>A hyperlink will be removed from the page that contains it. The visible content on that page will not otherwise be changed in any way.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Taking it further</strong></p>
<p>The page index is zero-based, so to delete page 10 of a document you would do the following <code class="xref any docutils literal notranslate"><span class="pre">doc.delete_page(9)</span></code>.</p>
<p>Similarly, <code class="xref any docutils literal notranslate"><span class="pre">doc.delete_pages(from_page=9,</span> <span class="pre">to_page=14)</span></code> will delete pages 10 - 15 inclusive.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_page()</span></code></a></p></li>
<li><p><a class="reference internal" href="document.html#Document.delete_pages" title="Document.delete_pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_pages()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
</section>
<section id="the-basics-rearrange-pages">
<span id="id17"></span><h2>重新排列页面<a class="headerlink" href="#the-basics-rearrange-pages" title="此标题的永久链接">#</a></h2>
<p>Re-Arranging Pages</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--15-input--1" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--1">中文</label><div class="tab-content docutils container">
<p>要更改页面的顺序，即重新排列页面，可以执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开文档</span>
<span class="n">doc</span><span class="o">.</span><span class="n">move_page</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># 将文档中的第2页移到文档的开头</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test-page-moved.pdf&quot;</span><span class="p">)</span> <span class="c1"># 保存文档</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.move_page" title="Document.move_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.move_page()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--15-input--2" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--2">英文</label><div class="tab-content docutils container">
<p>To change the sequence of pages, i.e. re-arrange pages, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">move_page</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># move the 2nd page of the document to the start of the document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test-page-moved.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.move_page" title="Document.move_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.move_page()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-copying-pages">
<span id="id18"></span><h2>复制页面<a class="headerlink" href="#the-basics-copying-pages" title="此标题的永久链接">#</a></h2>
<p>Copying Pages</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--16-input--1" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--1">中文</label><div class="tab-content docutils container">
<p>要复制页面，可以执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开文档</span>
<span class="n">doc</span><span class="o">.</span><span class="n">copy_page</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># 复制第1页并将其放置在文档的末尾</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test-page-copied.pdf&quot;</span><span class="p">)</span> <span class="c1"># 保存文档</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.copy_page()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--16-input--2" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--2">英文</label><div class="tab-content docutils container">
<p>To copy pages, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">copy_page</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># copy the 1st page and puts it at the end of the document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test-page-copied.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.copy_page()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-selecting-pages">
<span id="id19"></span><h2>选择页面<a class="headerlink" href="#the-basics-selecting-pages" title="此标题的永久链接">#</a></h2>
<p>Selecting Pages</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--17-input--1" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--1">中文</label><div class="tab-content docutils container">
<p>要选择页面，可以执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开文档</span>
<span class="n">doc</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1"># 选择文档的第1页和第2页</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;just-page-one-and-two.pdf&quot;</span><span class="p">)</span> <span class="c1"># 保存文档</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>进一步说明</strong></p>
<p>使用 <cite>PyMuPDF</cite>，您可以轻松地复制、移动、删除或重新排列 <cite>PDF</cite> 的页面。直观的方法允许您按页面级别进行操作，如 <a class="reference internal" href="document.html#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.copy_page()</span></code></a> 方法。</p>
<p>或者，您可以准备一个包含您想要的页面顺序的完整新页面布局，并按所需的顺序和次数重复每个页面。以下示例说明了使用 <a class="reference internal" href="document.html#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a> 可以做什么：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>现在让我们为双面打印（在不直接支持此功能的打印机上）准备一个 PDF：</p>
<p>页数由 <code class="xref any docutils literal notranslate"><span class="pre">len(doc)</span></code> （等于 <code class="xref any docutils literal notranslate"><span class="pre">doc.page_count</span></code>）给出。以下分别表示偶数页和奇数页的页码：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p_even</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">page_count</span><span class="p">)</span> <span class="k">if</span> <span class="n">p</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">p_odd</span>  <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">page_count</span><span class="p">)</span> <span class="k">if</span> <span class="n">p</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>这个代码片段创建了相应的子文档，然后可以用于打印文档：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">p_even</span><span class="p">)</span> <span class="c1"># 仅保留偶数页</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;even.pdf&quot;</span><span class="p">)</span> <span class="c1"># 保存“偶数”PDF</span>
<span class="n">doc</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># 回收文件</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="c1"># 重新打开</span>
<span class="n">doc</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">p_odd</span><span class="p">)</span> <span class="c1"># 对奇数页执行相同操作</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;odd.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>有关更多信息，请查看此 Wiki <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/wiki/Rearranging-Pages-of-a-PDF">文章</a>。</p>
<p>以下示例将反转所有页面的顺序（<strong>非常快速</strong>：在 756 页的 <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a> 上不到一秒钟）：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lastPage</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">page_count</span> <span class="o">-</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lastPage</span><span class="p">):</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">move_page</span><span class="p">(</span><span class="n">lastPage</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="c1"># 将当前最后一页移到前面</span>
</pre></div>
</div>
<p>这个代码片段将 PDF 自身复制，以便它将包含页面 <em>0, 1, …, n, 0, 1, …, n</em> （<strong>非常快速且几乎不增加文件大小！</strong>）：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">page_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">page_count</span><span class="p">):</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">copy_page</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="c1"># 将此页面复制到最后一页后面</span>
</pre></div>
</div>
<p><strong>API参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--17-input--2" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--2">英文</label><div class="tab-content docutils container">
<p>To select pages, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open a document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1"># select the 1st &amp; 2nd page of the document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;just-page-one-and-two.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Taking it further</strong></p>
<p>With <cite>PyMuPDF</cite> you have all options to copy, move, delete or re-arrange the pages of a <cite>PDF</cite>. Intuitive methods exist that allow you to do this on a page-by-page level, like the <a class="reference internal" href="document.html#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.copy_page()</span></code></a> method.</p>
<p>Or you alternatively prepare a complete new page layout in form of a <cite>Python</cite> sequence, that contains the page numbers you want, in the sequence you want, and as many times as you want each page. The following may illustrate what can be done with <a class="reference internal" href="document.html#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Now let’s prepare a PDF for double-sided printing (on a printer not directly supporting this):</p>
<p>The number of pages is given by <code class="xref any docutils literal notranslate"><span class="pre">len(doc)</span></code> (equal to <code class="xref any docutils literal notranslate"><span class="pre">doc.page_count</span></code>). The following lists represent the even and the odd page numbers, respectively:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p_even</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">page_count</span><span class="p">)</span> <span class="k">if</span> <span class="n">p</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">p_odd</span>  <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">page_count</span><span class="p">)</span> <span class="k">if</span> <span class="n">p</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>This snippet creates the respective sub documents which can then be used to print the document:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">p_even</span><span class="p">)</span> <span class="c1"># only the even pages left over</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;even.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the &quot;even&quot; PDF</span>
<span class="n">doc</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># recycle the file</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="c1"># re-open</span>
<span class="n">doc</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">p_odd</span><span class="p">)</span> <span class="c1"># and do the same with the odd pages</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;odd.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>For more information also have a look at this Wiki <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/wiki/Rearranging-Pages-of-a-PDF">article</a>.</p>
<p>The following example will reverse the order of all pages (<strong>extremely fast:</strong> sub-second time for the 756 pages of the <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lastPage</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">page_count</span> <span class="o">-</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lastPage</span><span class="p">):</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">move_page</span><span class="p">(</span><span class="n">lastPage</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="c1"># move current last page to the front</span>
</pre></div>
</div>
<p>This snippet duplicates the PDF with itself so that it will contain the pages <em>0, 1, …, n, 0, 1, …, n</em> <strong>(extremely fast and without noticeably increasing the file size!)</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">page_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">page_count</span><span class="p">):</span>
    <span class="n">doc</span><span class="o">.</span><span class="n">copy_page</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="c1"># copy this page to after last page</span>
</pre></div>
</div>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-adding-blank-pages">
<span id="id21"></span><h2>添加空白页<a class="headerlink" href="#the-basics-adding-blank-pages" title="此标题的永久链接">#</a></h2>
<p>Adding Blank Pages</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--18-input--1" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--1">中文</label><div class="tab-content docutils container">
<p>要添加一个空白页，可以执行以下操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="c1"># 打开一个新的或现有的PDF文档</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># 插入点：文档末尾</span>
                    <span class="n">width</span> <span class="o">=</span> <span class="mi">595</span><span class="p">,</span> <span class="c1"># 页面尺寸：A4纵向</span>
                    <span class="n">height</span> <span class="o">=</span> <span class="mi">842</span><span class="p">)</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;doc-with-new-blank-page.pdf&quot;</span><span class="p">)</span> <span class="c1"># 保存文档</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>进一步说明</strong></p>
<p>使用此方法创建页面时，可以选择其他预定义的纸张格式：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">paper_size</span><span class="p">(</span><span class="s2">&quot;letter-l&quot;</span><span class="p">)</span>  <span class="c1"># &#39;Letter&#39;横向</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="n">w</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
<p>方便的函数 <a class="reference internal" href="functions.html#paper_size" title="paper_size"><code class="xref py py-meth docutils literal notranslate"><span class="pre">paper_size()</span></code></a> 支持选择超过40种行业标准的纸张格式。要查看它们，请检查字典 <code class="xref py py-attr docutils literal notranslate"><span class="pre">paperSizes</span></code>。将所需的字典键传递给 <a class="reference internal" href="functions.html#paper_size" title="paper_size"><code class="xref py py-meth docutils literal notranslate"><span class="pre">paper_size()</span></code></a> 以获取纸张尺寸。支持大小写。如果在格式名称后附加 “-L”，则返回横向版本。</p>
<p>这是一个创建包含一个空白页的 <cite>PDF</cite> 的三行代码。其文件大小为460字节：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;A4.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>API参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.new_page" title="Document.new_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.new_page()</span></code></a></p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">paperSizes</span></code></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--18-input--2" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--2">英文</label><div class="tab-content docutils container">
<p>To add a blank page, do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="c1"># some new or existing PDF document</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># insertion point: end of document</span>
                    <span class="n">width</span> <span class="o">=</span> <span class="mi">595</span><span class="p">,</span> <span class="c1"># page dimension: A4 portrait</span>
                    <span class="n">height</span> <span class="o">=</span> <span class="mi">842</span><span class="p">)</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;doc-with-new-blank-page.pdf&quot;</span><span class="p">)</span> <span class="c1"># save the document</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Taking it further</strong></p>
<p>Use this to create the page with another pre-defined paper format:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">paper_size</span><span class="p">(</span><span class="s2">&quot;letter-l&quot;</span><span class="p">)</span>  <span class="c1"># &#39;Letter&#39; landscape</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="n">w</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
<p>The convenience function <a class="reference internal" href="functions.html#paper_size" title="paper_size"><code class="xref py py-meth docutils literal notranslate"><span class="pre">paper_size()</span></code></a> knows over 40 industry standard paper formats to choose from. To see them, inspect dictionary <code class="xref py py-attr docutils literal notranslate"><span class="pre">paperSizes</span></code>. Pass the desired dictionary key to <a class="reference internal" href="functions.html#paper_size" title="paper_size"><code class="xref py py-meth docutils literal notranslate"><span class="pre">paper_size()</span></code></a> to retrieve the paper dimensions. Upper and lower case is supported. If you append “-L” to the format name, the landscape version is returned.</p>
<p>Here is a 3-liner that creates a <cite>PDF</cite>: with one empty page. Its file size is 460 bytes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;A4.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.new_page" title="Document.new_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.new_page()</span></code></a></p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">paperSizes</span></code></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-inserting-pages">
<span id="id22"></span><h2>插入带有文本内容的页面<a class="headerlink" href="#the-basics-inserting-pages" title="此标题的永久链接">#</a></h2>
<p>Inserting Pages with Text Content</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--19-input--1" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--1">中文</label><div class="tab-content docutils container">
<p>使用 <a class="reference internal" href="document.html#Document.insert_page" title="Document.insert_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a> 方法也可以插入一个新页面，并接受相同的 <a class="reference internal" href="irect.html#IRect.width" title="IRect.width"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">width</span></code></a> 和 <a class="reference internal" href="irect.html#IRect.height" title="IRect.height"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">height</span></code></a> 参数。此方法还允许在新页面中插入任意文本，并返回插入的行数。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># 打开一个新的或现有的PDF文档</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">insert_page</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># 默认插入位置</span>
                    <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;The quick brown fox jumped over the lazy dog&quot;</span><span class="p">,</span>
                    <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
                    <span class="n">width</span> <span class="o">=</span> <span class="mi">595</span><span class="p">,</span>
                    <span class="n">height</span> <span class="o">=</span> <span class="mi">842</span><span class="p">,</span>
                    <span class="n">fontname</span> <span class="o">=</span> <span class="s2">&quot;Helvetica&quot;</span><span class="p">,</span> <span class="c1"># 默认字体</span>
                    <span class="n">fontfile</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="c1"># 可选的字体文件名</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1"># 文字颜色 (RGB)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>进一步说明</strong></p>
<p><a class="reference internal" href="xml-class.html#Xml.text" title="Xml.text"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">text</span></code></a> 参数可以是一个（序列）字符串（假设使用UTF-8编码）。插入将从 <a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a> (50, 72) 开始，即页面顶部下方一英寸，距离页面左侧50点的位置。返回值为插入的文本行数。</p>
<p><strong>API参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.insert_page" title="Document.insert_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--19-input--2" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--2">英文</label><div class="tab-content docutils container">
<p>Using the <a class="reference internal" href="document.html#Document.insert_page" title="Document.insert_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a> method also inserts a new page and accepts the same <a class="reference internal" href="irect.html#IRect.width" title="IRect.width"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">width</span></code></a> and <a class="reference internal" href="irect.html#IRect.height" title="IRect.height"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">height</span></code></a> parameters. But it lets you also insert arbitrary text into the new page and returns the number of inserted lines.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># some new or existing PDF document</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">insert_page</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># default insertion point</span>
                    <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;The quick brown fox jumped over the lazy dog&quot;</span><span class="p">,</span>
                    <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
                    <span class="n">width</span> <span class="o">=</span> <span class="mi">595</span><span class="p">,</span>
                    <span class="n">height</span> <span class="o">=</span> <span class="mi">842</span><span class="p">,</span>
                    <span class="n">fontname</span> <span class="o">=</span> <span class="s2">&quot;Helvetica&quot;</span><span class="p">,</span> <span class="c1"># default font</span>
                    <span class="n">fontfile</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="c1"># any font file name</span>
                    <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="c1"># text color (RGB)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Taking it further</strong></p>
<p>The text parameter can be a (sequence of) string (assuming UTF-8 encoding). Insertion will start at <a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a> (50, 72), which is one inch below top of page and 50 points from the left. The number of inserted text lines is returned.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.insert_page" title="Document.insert_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-spliting-single-pages">
<span id="id23"></span><h2>拆分单页<a class="headerlink" href="#the-basics-spliting-single-pages" title="此标题的永久链接">#</a></h2>
<p>Splitting Single Pages</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--20-input--1" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--1">中文</label><div class="tab-content docutils container">
<p>这涉及到将 <cite>PDF</cite> 页分割成任意的多个部分。例如，您可能有一个 <cite>PDF</cite> 文件，页面格式为 <em>Letter</em>，并希望以四倍放大因子打印：每一页分割成四个部分，每个部分将单独成为一个新的 <cite>PDF</cite> 页，格式仍为 <em>Letter</em>。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">src</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>  <span class="c1"># 创建一个空的输出PDF</span>

<span class="k">for</span> <span class="n">spage</span> <span class="ow">in</span> <span class="n">src</span><span class="p">:</span>  <span class="c1"># 遍历输入文档中的每一页</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">spage</span><span class="o">.</span><span class="n">rect</span>  <span class="c1"># 输入页面的矩形区域</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">spage</span><span class="o">.</span><span class="n">cropbox_position</span><span class="p">,</span>  <span class="c1"># 如果有裁剪框偏移，使用该偏移量</span>
                <span class="n">spage</span><span class="o">.</span><span class="n">cropbox_position</span><span class="p">)</span>  <span class="c1"># 从 (0, 0) 开始</span>
    <span class="c1">#--------------------------------------------------------------------------</span>
    <span class="c1"># 示例：将输入页面切割成 2 x 2 的部分</span>
    <span class="c1">#--------------------------------------------------------------------------</span>
    <span class="n">r1</span> <span class="o">=</span> <span class="n">r</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># 左上矩形区域</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># 右上矩形区域</span>
    <span class="n">r3</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>  <span class="c1"># 左下矩形区域</span>
    <span class="n">r4</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">br</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">br</span><span class="p">)</span>  <span class="c1"># 右下矩形区域</span>
    <span class="n">rect_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="n">r4</span><span class="p">]</span>  <span class="c1"># 将它们放入列表中</span>

    <span class="k">for</span> <span class="n">rx</span> <span class="ow">in</span> <span class="n">rect_list</span><span class="p">:</span>  <span class="c1"># 遍历矩形列表</span>
        <span class="n">rx</span> <span class="o">+=</span> <span class="n">d</span>  <span class="c1"># 加上裁剪框偏移</span>
        <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># 使用 rx 尺寸创建新的输出页面</span>
                        <span class="n">width</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                        <span class="n">height</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="n">page</span><span class="o">.</span><span class="n">show_pdf_page</span><span class="p">(</span>
                <span class="n">page</span><span class="o">.</span><span class="n">rect</span><span class="p">,</span>  <span class="c1"># 填充整个新页面</span>
                <span class="n">src</span><span class="p">,</span>  <span class="c1"># 输入文档</span>
                <span class="n">spage</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>  <span class="c1"># 输入页面的页码</span>
                <span class="n">clip</span> <span class="o">=</span> <span class="n">rx</span><span class="p">,</span>  <span class="c1"># 使用输入页面的哪部分</span>
            <span class="p">)</span>

<span class="c1"># 完成后保存输出文件</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;poster-&quot;</span> <span class="o">+</span> <span class="n">src</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">garbage</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># 去除重复对象</span>
        <span class="n">deflate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># 尽可能压缩文件</span>
<span class="p">)</span>
</pre></div>
</div>
<p>示例：</p>
<img alt="_images/img-posterize.png" src="_images/img-posterize.png" />
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.cropbox_position" title="Page.cropbox_position"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.cropbox_position()</span></code></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--20-input--2" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--2">英文</label><div class="tab-content docutils container">
<p>This deals with splitting up pages of a <cite>PDF</cite> in arbitrary pieces. For example, you may have a <cite>PDF</cite> with <em>Letter</em> format pages which you want to print with a magnification factor of four: each page is split up in 4 pieces which each going to a separate <cite>PDF</cite> page in <em>Letter</em> format again.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">src</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>  <span class="c1"># empty output PDF</span>

<span class="k">for</span> <span class="n">spage</span> <span class="ow">in</span> <span class="n">src</span><span class="p">:</span>  <span class="c1"># for each page in input</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">spage</span><span class="o">.</span><span class="n">rect</span>  <span class="c1"># input page rectangle</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">spage</span><span class="o">.</span><span class="n">cropbox_position</span><span class="p">,</span>  <span class="c1"># CropBox displacement if not</span>
                <span class="n">spage</span><span class="o">.</span><span class="n">cropbox_position</span><span class="p">)</span>  <span class="c1"># starting at (0, 0)</span>
    <span class="c1">#--------------------------------------------------------------------------</span>
    <span class="c1"># example: cut input page into 2 x 2 parts</span>
    <span class="c1">#--------------------------------------------------------------------------</span>
    <span class="n">r1</span> <span class="o">=</span> <span class="n">r</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># top left rect</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># top right rect</span>
    <span class="n">r3</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>  <span class="c1"># bottom left rect</span>
    <span class="n">r4</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">br</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">br</span><span class="p">)</span>  <span class="c1"># bottom right rect</span>
    <span class="n">rect_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="n">r4</span><span class="p">]</span>  <span class="c1"># put them in a list</span>

    <span class="k">for</span> <span class="n">rx</span> <span class="ow">in</span> <span class="n">rect_list</span><span class="p">:</span>  <span class="c1"># run thru rect list</span>
        <span class="n">rx</span> <span class="o">+=</span> <span class="n">d</span>  <span class="c1"># add the CropBox displacement</span>
        <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># new output page with rx dimensions</span>
                        <span class="n">width</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                        <span class="n">height</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="n">page</span><span class="o">.</span><span class="n">show_pdf_page</span><span class="p">(</span>
                <span class="n">page</span><span class="o">.</span><span class="n">rect</span><span class="p">,</span>  <span class="c1"># fill all new page with the image</span>
                <span class="n">src</span><span class="p">,</span>  <span class="c1"># input document</span>
                <span class="n">spage</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>  <span class="c1"># input page number</span>
                <span class="n">clip</span> <span class="o">=</span> <span class="n">rx</span><span class="p">,</span>  <span class="c1"># which part to use of input page</span>
            <span class="p">)</span>

<span class="c1"># that&#39;s it, save output file</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;poster-&quot;</span> <span class="o">+</span> <span class="n">src</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">garbage</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># eliminate duplicate objects</span>
        <span class="n">deflate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># compress stuff where possible</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Example:</p>
<img alt="_images/img-posterize.png" src="_images/img-posterize.png" />
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.cropbox_position" title="Page.cropbox_position"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.cropbox_position()</span></code></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-combining-single-pages">
<span id="id24"></span><h2>合并单页<a class="headerlink" href="#the-basics-combining-single-pages" title="此标题的永久链接">#</a></h2>
<p>Combining Single Pages</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--21-input--1" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--1">中文</label><div class="tab-content docutils container">
<p>这涉及到将 <cite>PDF</cite> 页面合并形成一个新的 <cite>PDF</cite>，其中每一页合并了两个或四个原始页面（也叫“2-up”，“4-up”等）。这可以用于创建小册子或缩略图式的概览。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">src</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>  <span class="c1"># 创建一个空的输出PDF</span>

<span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">paper_size</span><span class="p">(</span><span class="s2">&quot;a4&quot;</span><span class="p">)</span>  <span class="c1"># A4 竖版输出页面格式</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>

<span class="c1"># 定义每页的 4 个矩形区域</span>
<span class="n">r1</span> <span class="o">=</span> <span class="n">r</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># 左上矩形区域</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># 右上矩形区域</span>
<span class="n">r3</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>  <span class="c1"># 左下矩形区域</span>
<span class="n">r4</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">br</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">br</span><span class="p">)</span>  <span class="c1"># 右下矩形区域</span>

<span class="c1"># 将它们放入一个列表中</span>
<span class="n">r_tab</span> <span class="o">=</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="n">r4</span><span class="p">]</span>

<span class="c1"># 现在将输入页面复制到输出文档</span>
<span class="k">for</span> <span class="n">spage</span> <span class="ow">in</span> <span class="n">src</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">spage</span><span class="o">.</span><span class="n">number</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># 创建新的输出页面</span>
        <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">width</span> <span class="o">=</span> <span class="n">width</span><span class="p">,</span>
                    <span class="n">height</span> <span class="o">=</span> <span class="n">height</span><span class="p">)</span>
    <span class="c1"># 将输入页面插入到正确的矩形区域</span>
    <span class="n">page</span><span class="o">.</span><span class="n">show_pdf_page</span><span class="p">(</span><span class="n">r_tab</span><span class="p">[</span><span class="n">spage</span><span class="o">.</span><span class="n">number</span> <span class="o">%</span> <span class="mi">4</span><span class="p">],</span>  <span class="c1"># 选择输出矩形</span>
                    <span class="n">src</span><span class="p">,</span>  <span class="c1"># 输入文档</span>
                    <span class="n">spage</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>  <span class="c1"># 输入页面的页码</span>

<span class="c1"># 使用垃圾回收和压缩保存新文件</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;4up.pdf&quot;</span><span class="p">,</span> <span class="n">garbage</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">deflate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>示例：</p>
<img alt="_images/img-4up.png" src="_images/img-4up.png" />
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.cropbox_position" title="Page.cropbox_position"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.cropbox_position()</span></code></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--21-input--2" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--2">英文</label><div class="tab-content docutils container">
<p>This deals with joining <cite>PDF</cite> pages to form a new <cite>PDF</cite> with pages each combining two or four original ones (also called “2-up”, “4-up”, etc.). This could be used to create booklets or thumbnail-like overviews.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">src</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>  <span class="c1"># empty output PDF</span>

<span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">paper_size</span><span class="p">(</span><span class="s2">&quot;a4&quot;</span><span class="p">)</span>  <span class="c1"># A4 portrait output page format</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>

<span class="c1"># define the 4 rectangles per page</span>
<span class="n">r1</span> <span class="o">=</span> <span class="n">r</span> <span class="o">/</span> <span class="mi">2</span>  <span class="c1"># top left rect</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># top right</span>
<span class="n">r3</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r1</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>  <span class="c1"># bottom left</span>
<span class="n">r4</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="n">r1</span><span class="o">.</span><span class="n">br</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">br</span><span class="p">)</span>  <span class="c1"># bottom right</span>

<span class="c1"># put them in a list</span>
<span class="n">r_tab</span> <span class="o">=</span> <span class="p">[</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span><span class="p">,</span> <span class="n">r4</span><span class="p">]</span>

<span class="c1"># now copy input pages to output</span>
<span class="k">for</span> <span class="n">spage</span> <span class="ow">in</span> <span class="n">src</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">spage</span><span class="o">.</span><span class="n">number</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># create new output page</span>
        <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">width</span> <span class="o">=</span> <span class="n">width</span><span class="p">,</span>
                    <span class="n">height</span> <span class="o">=</span> <span class="n">height</span><span class="p">)</span>
    <span class="c1"># insert input page into the correct rectangle</span>
    <span class="n">page</span><span class="o">.</span><span class="n">show_pdf_page</span><span class="p">(</span><span class="n">r_tab</span><span class="p">[</span><span class="n">spage</span><span class="o">.</span><span class="n">number</span> <span class="o">%</span> <span class="mi">4</span><span class="p">],</span>  <span class="c1"># select output rect</span>
                    <span class="n">src</span><span class="p">,</span>  <span class="c1"># input document</span>
                    <span class="n">spage</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>  <span class="c1"># input page number</span>

<span class="c1"># by all means, save new file using garbage collection and compression</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;4up.pdf&quot;</span><span class="p">,</span> <span class="n">garbage</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">deflate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Example:</p>
<img alt="_images/img-4up.png" src="_images/img-4up.png" />
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.cropbox_position" title="Page.cropbox_position"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.cropbox_position()</span></code></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-encryption-and-decryption">
<span id="id25"></span><h2><cite>PDF</cite> 加密和解密<a class="headerlink" href="#the-basics-encryption-and-decryption" title="此标题的永久链接">#</a></h2>
<p><cite>PDF</cite> Encryption &amp; Decryption</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--22-input--1" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--1">中文</label><div class="tab-content docutils container">
<p>从版本 1.16.0 开始， <cite>PDF</cite> 解密和加密（使用密码）得到了完全支持。您可以执行以下操作：</p>
<ul>
<li><p>检查文档是否受密码保护 /（仍然）加密 (<a class="reference internal" href="document.html#Document.needs_pass" title="Document.needs_pass"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.needs_pass</span></code></a>, <a class="reference internal" href="document.html#Document.is_encrypted" title="Document.is_encrypted"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_encrypted</span></code></a>)。</p></li>
<li><p>获取对文档的访问授权 (<a class="reference internal" href="document.html#Document.authenticate" title="Document.authenticate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.authenticate()</span></code></a>)。</p></li>
<li><p>使用 <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> 或 <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.write()</span></code> 设置 PDF 文件的加密详情：</p>
<blockquote>
<div><ul class="simple">
<li><p>解密或加密内容</p></li>
<li><p>设置密码</p></li>
<li><p>设置加密方法</p></li>
<li><p>设置权限详情</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>一个 PDF 文档可能有两个不同的密码：</p>
</div>
<ul class="simple">
<li><p><strong>所有者密码</strong> 提供完全访问权限，包括更改密码、加密方法或权限详情。</p></li>
<li><p><strong>用户密码</strong> 提供根据已设置的权限详情访问文档内容。如果存在，在查看器中打开 <cite>PDF</cite> 时需要提供该密码。</p></li>
</ul>
<p>方法 <a class="reference internal" href="document.html#Document.authenticate" title="Document.authenticate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.authenticate()</span></code></a> 将自动根据使用的密码建立访问权限。</p>
<p>以下代码片段创建一个新的 <cite>PDF</cite> 并使用不同的用户和所有者密码进行加密。权限被授予打印、复制和注释，但使用用户密码的人员无法进行更改。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;some secret information&quot;</span> <span class="c1"># 保持该数据为秘密</span>
<span class="n">perm</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
    <span class="n">pymupdf</span><span class="o">.</span><span class="n">PDF_PERM_ACCESSIBILITY</span> <span class="c1"># 始终使用此选项</span>
    <span class="o">|</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">PDF_PERM_PRINT</span> <span class="c1"># 允许打印</span>
    <span class="o">|</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">PDF_PERM_COPY</span> <span class="c1"># 允许复制</span>
    <span class="o">|</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">PDF_PERM_ANNOTATE</span> <span class="c1"># 允许注释</span>
<span class="p">)</span>
<span class="n">owner_pass</span> <span class="o">=</span> <span class="s2">&quot;owner&quot;</span> <span class="c1"># 所有者密码</span>
<span class="n">user_pass</span> <span class="o">=</span> <span class="s2">&quot;user&quot;</span> <span class="c1"># 用户密码</span>
<span class="n">encrypt_meth</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">PDF_ENCRYPT_AES_256</span> <span class="c1"># 最强加密算法</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="c1"># 空的 PDF</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span> <span class="c1"># 空白页面</span>
<span class="n">page</span><span class="o">.</span><span class="n">insert_text</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">72</span><span class="p">),</span> <span class="n">text</span><span class="p">)</span> <span class="c1"># 插入数据</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
    <span class="s2">&quot;secret.pdf&quot;</span><span class="p">,</span>
    <span class="n">encryption</span><span class="o">=</span><span class="n">encrypt_meth</span><span class="p">,</span> <span class="c1"># 设置加密方法</span>
    <span class="n">owner_pw</span><span class="o">=</span><span class="n">owner_pass</span><span class="p">,</span> <span class="c1"># 设置所有者密码</span>
    <span class="n">user_pw</span><span class="o">=</span><span class="n">user_pass</span><span class="p">,</span> <span class="c1"># 设置用户密码</span>
    <span class="n">permissions</span><span class="o">=</span><span class="n">perm</span><span class="p">,</span> <span class="c1"># 设置权限</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>进一步说明</strong></p>
<p>使用某些查看器（如 Nitro Reader 5）打开此文档将反映这些设置：</p>
<img alt="_images/img-encrypting.jpg" src="_images/img-encrypting.jpg" />
<p><strong>解密</strong> 将在保存时自动发生，如之前一样，如果没有提供加密参数。</p>
<p>要 <strong>保持 PDF 的加密方法</strong>，请使用 <code class="xref any docutils literal notranslate"><span class="pre">encryption=pymupdf.PDF_ENCRYPT_KEEP</span></code> 来保存。如果 <code class="xref any docutils literal notranslate"><span class="pre">doc.can_save_incrementally()</span> <span class="pre">==</span> <span class="pre">True</span></code>，也可以进行增量保存。</p>
<p>要 <strong>更改加密方法</strong>，请指定上述选项的完整范围（<code class="xref any docutils literal notranslate"><span class="pre">encryption</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">owner_pw</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">user_pw</span></code>、<a class="reference internal" href="document.html#Document.permissions" title="Document.permissions"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">permissions</span></code></a>）。在这种情况下，<strong>不可能进行增量保存</strong>。</p>
<p><strong>API 参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--22-input--2" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--2">英文</label><div class="tab-content docutils container">
<p>Starting with version 1.16.0, <cite>PDF</cite> decryption and encryption (using passwords) are fully supported. You can do the following:</p>
<ul>
<li><p>Check whether a document is password protected / (still) encrypted (<a class="reference internal" href="document.html#Document.needs_pass" title="Document.needs_pass"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.needs_pass</span></code></a>, <a class="reference internal" href="document.html#Document.is_encrypted" title="Document.is_encrypted"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_encrypted</span></code></a>).</p></li>
<li><p>Gain access authorization to a document (<a class="reference internal" href="document.html#Document.authenticate" title="Document.authenticate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.authenticate()</span></code></a>).</p></li>
<li><p>Set encryption details for PDF files using <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> or <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.write()</span></code> and</p>
<blockquote>
<div><ul class="simple">
<li><p>decrypt or encrypt the content</p></li>
<li><p>set password(s)</p></li>
<li><p>set the encryption method</p></li>
<li><p>set permission details</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>A PDF document may have two different passwords:</p>
</div>
<ul class="simple">
<li><p>The <strong>owner password</strong> provides full access rights, including changing passwords, encryption method, or permission detail.</p></li>
<li><p>The <strong>user password</strong> provides access to document content according to the established permission details. If present, opening the <cite>PDF</cite> in a viewer will require providing it.</p></li>
</ul>
<p>Method <a class="reference internal" href="document.html#Document.authenticate" title="Document.authenticate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.authenticate()</span></code></a> will automatically establish access rights according to the password used.</p>
<p>The following snippet creates a new <cite>PDF</cite> and encrypts it with separate user and owner passwords. Permissions are granted to print, copy and annotate, but no changes are allowed to someone authenticating with the user password.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;some secret information&quot;</span> <span class="c1"># keep this data secret</span>
<span class="n">perm</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
    <span class="n">pymupdf</span><span class="o">.</span><span class="n">PDF_PERM_ACCESSIBILITY</span> <span class="c1"># always use this</span>
    <span class="o">|</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">PDF_PERM_PRINT</span> <span class="c1"># permit printing</span>
    <span class="o">|</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">PDF_PERM_COPY</span> <span class="c1"># permit copying</span>
    <span class="o">|</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">PDF_PERM_ANNOTATE</span> <span class="c1"># permit annotations</span>
<span class="p">)</span>
<span class="n">owner_pass</span> <span class="o">=</span> <span class="s2">&quot;owner&quot;</span> <span class="c1"># owner password</span>
<span class="n">user_pass</span> <span class="o">=</span> <span class="s2">&quot;user&quot;</span> <span class="c1"># user password</span>
<span class="n">encrypt_meth</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">PDF_ENCRYPT_AES_256</span> <span class="c1"># strongest algorithm</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="c1"># empty pdf</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span> <span class="c1"># empty page</span>
<span class="n">page</span><span class="o">.</span><span class="n">insert_text</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">72</span><span class="p">),</span> <span class="n">text</span><span class="p">)</span> <span class="c1"># insert the data</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
    <span class="s2">&quot;secret.pdf&quot;</span><span class="p">,</span>
    <span class="n">encryption</span><span class="o">=</span><span class="n">encrypt_meth</span><span class="p">,</span> <span class="c1"># set the encryption method</span>
    <span class="n">owner_pw</span><span class="o">=</span><span class="n">owner_pass</span><span class="p">,</span> <span class="c1"># set the owner password</span>
    <span class="n">user_pw</span><span class="o">=</span><span class="n">user_pass</span><span class="p">,</span> <span class="c1"># set the user password</span>
    <span class="n">permissions</span><span class="o">=</span><span class="n">perm</span><span class="p">,</span> <span class="c1"># set permissions</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Taking it further</strong></p>
<p>Opening this document with some viewer (Nitro Reader 5) reflects these settings:</p>
<img alt="_images/img-encrypting.jpg" src="_images/img-encrypting.jpg" />
<p><strong>Decrypting</strong> will automatically happen on save as before when no encryption parameters are provided.</p>
<p>To <strong>keep the encryption method</strong> of a PDF save it using <code class="xref any docutils literal notranslate"><span class="pre">encryption=pymupdf.PDF_ENCRYPT_KEEP</span></code>. If <code class="xref any docutils literal notranslate"><span class="pre">doc.can_save_incrementally()</span> <span class="pre">==</span> <span class="pre">True</span></code>, an incremental save is also possible.</p>
<p>To <strong>change the encryption method</strong> specify the full range of options above (<code class="xref any docutils literal notranslate"><span class="pre">encryption</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">owner_pw</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">user_pw</span></code>, <a class="reference internal" href="document.html#Document.permissions" title="Document.permissions"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">permissions</span></code></a>). An incremental save is <strong>not possible</strong> in this case.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-extracting-tables">
<span id="id26"></span><h2>从 <cite>页面</cite> 中提取表格<a class="headerlink" href="#the-basics-extracting-tables" title="此标题的永久链接">#</a></h2>
<p>Extracting Tables from a <cite>Page</cite></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--23-input--1" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--1">中文</label><div class="tab-content docutils container">
<p>可以从任何文档 <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> 中查找和提取表格。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pprint</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># 打开文档</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># 获取文档的第一页</span>
<span class="n">tabs</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">find_tables</span><span class="p">()</span> <span class="c1"># 定位并提取页面上的表格</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tabs</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span><span class="si">}</span><span class="s2"> found on </span><span class="si">{</span><span class="n">page</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># 显示找到的表格数量</span>

<span class="k">if</span> <span class="n">tabs</span><span class="o">.</span><span class="n">tables</span><span class="p">:</span>  <span class="c1"># 至少找到一个表格？</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">tabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">extract</span><span class="p">())</span>  <span class="c1"># 打印第一个表格的内容</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API 参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.find_tables" title="Page.find_tables"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.find_tables()</span></code></a></p></li>
</ul>
</div>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>还有 <a class="reference external" href="https://pdf2docx.readthedocs.io/en/latest/quickstart.table.html">pdf2docx extract tables method</a>，如果你更喜欢的话，它也可以提取表格。</p>
</div>
</div>
<input class="tab-input" id="tab-set--23-input--2" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--2">英文</label><div class="tab-content docutils container">
<p>Tables can be found and extracted from any document <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pprint</span>

<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span> <span class="c1"># open document</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># get the 1st page of the document</span>
<span class="n">tabs</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">find_tables</span><span class="p">()</span> <span class="c1"># locate and extract any tables on page</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tabs</span><span class="o">.</span><span class="n">tables</span><span class="p">)</span><span class="si">}</span><span class="s2"> found on </span><span class="si">{</span><span class="n">page</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># display number of found tables</span>

<span class="k">if</span> <span class="n">tabs</span><span class="o">.</span><span class="n">tables</span><span class="p">:</span>  <span class="c1"># at least one table found?</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">tabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">extract</span><span class="p">())</span>  <span class="c1"># print content of first table</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.find_tables" title="Page.find_tables"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.find_tables()</span></code></a></p></li>
</ul>
</div>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>There is also the <a class="reference external" href="https://pdf2docx.readthedocs.io/en/latest/quickstart.table.html">pdf2docx extract tables method</a> which is capable of table extraction if you prefer.</p>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-get-page-links">
<span id="id27"></span><h2>获取页面链接<a class="headerlink" href="#the-basics-get-page-links" title="此标题的永久链接">#</a></h2>
<p>Getting Page Links</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--24-input--1" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--1">中文</label><div class="tab-content docutils container">
<p>可以从 <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> 中提取链接，返回 <a class="reference internal" href="link.html#link"><span class="std std-ref">Link</span></a> 对象。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span> <span class="c1"># 遍历文档页面</span>
    <span class="n">link</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">first_link</span>  <span class="c1"># 一个 `Link` 对象或 `None`</span>

    <span class="k">while</span> <span class="n">link</span><span class="p">:</span> <span class="c1"># 遍历页面上的链接</span>
        <span class="c1"># 对链接进行操作，然后：</span>
        <span class="n">link</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">next</span> <span class="c1"># 获取下一个链接，最后一个链接的 `next` 为 `None`</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API 参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.first_link" title="Page.first_link"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.first_link()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--24-input--2" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--2">英文</label><div class="tab-content docutils container">
<p>Links can be extracted from a <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> to return <a class="reference internal" href="link.html#link"><span class="std std-ref">Link</span></a> objects.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span> <span class="c1"># iterate the document pages</span>
    <span class="n">link</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">first_link</span>  <span class="c1"># a `Link` object or `None`</span>

    <span class="k">while</span> <span class="n">link</span><span class="p">:</span> <span class="c1"># iterate over the links on page</span>
        <span class="c1"># do something with the link, then:</span>
        <span class="n">link</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">next</span> <span class="c1"># get next link, last one has `None` in its `next`</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.first_link" title="Page.first_link"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.first_link()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-get-all-annotations">
<span id="id28"></span><h2>从文档中获取所有注释<a class="headerlink" href="#the-basics-get-all-annotations" title="此标题的永久链接">#</a></h2>
<p>Getting All Annotations from a Document</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--25-input--1" name="tab-set--25" type="radio"><label class="tab-label" for="tab-set--25-input--1">中文</label><div class="tab-content docutils container">
<p>页面上的注释 (<a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a>) 可以通过 <code class="xref any docutils literal notranslate"><span class="pre">page.annots()</span></code> 方法获取。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">annot</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">annots</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;页面 </span><span class="si">{</span><span class="n">page</span><span class="o">.</span><span class="n">number</span><span class="si">}</span><span class="s1"> 上的注释，类型: </span><span class="si">{</span><span class="n">annot</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s1"> 和矩形区域: </span><span class="si">{</span><span class="n">annot</span><span class="o">.</span><span class="n">rect</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API 参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.annots" title="Page.annots"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.annots()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--25-input--2" name="tab-set--25" type="radio"><label class="tab-label" for="tab-set--25-input--2">英文</label><div class="tab-content docutils container">
<p>Annotations (<a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a>) on pages can be retrieved with the <code class="xref any docutils literal notranslate"><span class="pre">page.annots()</span></code> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">annot</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">annots</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Annotation on page: </span><span class="si">{</span><span class="n">page</span><span class="o">.</span><span class="n">number</span><span class="si">}</span><span class="s1"> with type: </span><span class="si">{</span><span class="n">annot</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s1"> and rect: </span><span class="si">{</span><span class="n">annot</span><span class="o">.</span><span class="n">rect</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.annots" title="Page.annots"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.annots()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-redacting">
<span id="id29"></span><h2>从 <strong>PDF</strong> 中删除内容<a class="headerlink" href="#the-basics-redacting" title="此标题的永久链接">#</a></h2>
<p>Redacting content from a <strong>PDF</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--26-input--1" name="tab-set--26" type="radio"><label class="tab-label" for="tab-set--26-input--1">中文</label><div class="tab-content docutils container">
<p>删除标记是特殊类型的注释，可以标记在文档页面上，表示页面中应安全删除的区域。在标记区域后，该区域将被标记为 <em>删除标记</em> ，一旦删除标记被*应用*，内容将被安全删除。</p>
<p>例如，如果我们想删除文档中所有“Jane Doe”出现的实例，可以按如下方式操作：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="c1"># 打开PDF文档</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;test.pdf&#39;</span><span class="p">)</span>

<span class="c1"># 遍历文档中的每一页</span>
<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
    <span class="c1"># 查找当前页中所有“Jane Doe”的实例</span>
    <span class="n">instances</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">search_for</span><span class="p">(</span><span class="s2">&quot;Jane Doe&quot;</span><span class="p">)</span>

    <span class="c1"># 删除当前页中每个“Jane Doe”的实例</span>
    <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
        <span class="n">page</span><span class="o">.</span><span class="n">add_redact_annot</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>

    <span class="c1"># 对当前页应用删除标记</span>
    <span class="n">page</span><span class="o">.</span><span class="n">apply_redactions</span><span class="p">()</span>

<span class="c1"># 保存修改后的文档</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;redacted_document.pdf&#39;</span><span class="p">)</span>

<span class="c1"># 关闭文档</span>
<span class="n">doc</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>另一个例子是对页面的某个区域进行删除标记，但不删除该区域内的任何线条艺术（即矢量图形），通过设置参数标志，如下所示：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="c1"># 打开PDF文档</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;test.pdf&#39;</span><span class="p">)</span>

<span class="c1"># 获取第一页</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># 添加一个要删除标记的区域</span>
<span class="n">rect</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">]</span>

<span class="c1"># 添加删除标记注释，使用红色填充</span>
<span class="n">page</span><span class="o">.</span><span class="n">add_redact_annot</span><span class="p">(</span><span class="n">rect</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># 对当前页应用删除标记，但忽略矢量图形</span>
<span class="n">page</span><span class="o">.</span><span class="n">apply_redactions</span><span class="p">(</span><span class="n">graphics</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># 保存修改后的文档</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;redactied_document.pdf&#39;</span><span class="p">)</span>

<span class="c1"># 关闭文档</span>
<span class="n">doc</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>一旦保存了删除标记版本的文档， <strong>PDF</strong> 中的删除内容将 <em>无法恢复</em> 。因此，文档中的删除区域将完全移除该区域的文本和图形内容。</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>进一步了解</strong></p>
<p>有几个选项可以在页面上创建和应用删除标记，关于这些选项的完整API详细信息以及控制这些选项的参数，请参考API文档。</p>
<p><strong>API参考</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.add_redact_annot" title="Page.add_redact_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_redact_annot()</span></code></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.apply_redactions" title="Page.apply_redactions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.apply_redactions()</span></code></a></p></li>
</ul>
</div>
</div>
<input class="tab-input" id="tab-set--26-input--2" name="tab-set--26" type="radio"><label class="tab-label" for="tab-set--26-input--2">英文</label><div class="tab-content docutils container">
<p>Redactions are special types of annotations which can be marked onto a document page to denote an area on the page which should be securely removed. After marking an area with a rectangle then this area will be marked for <em>redaction</em>, once the redaction is <em>applied</em> then the content is securely removed.</p>
<p>For example if we wanted to redact all instances of the name “Jane Doe” from a document we could do the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="c1"># Open the PDF document</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;test.pdf&#39;</span><span class="p">)</span>

<span class="c1"># Iterate over each page of the document</span>
<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
    <span class="c1"># Find all instances of &quot;Jane Doe&quot; on the current page</span>
    <span class="n">instances</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">search_for</span><span class="p">(</span><span class="s2">&quot;Jane Doe&quot;</span><span class="p">)</span>

    <span class="c1"># Redact each instance of &quot;Jane Doe&quot; on the current page</span>
    <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
        <span class="n">page</span><span class="o">.</span><span class="n">add_redact_annot</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>

    <span class="c1"># Apply the redactions to the current page</span>
    <span class="n">page</span><span class="o">.</span><span class="n">apply_redactions</span><span class="p">()</span>

<span class="c1"># Save the modified document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;redacted_document.pdf&#39;</span><span class="p">)</span>

<span class="c1"># Close the document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Another example could be redacting an area of a page, but not to redact any line art (i.e. vector graphics) within the defined area, by setting a parameter flag as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>

<span class="c1"># Open the PDF document</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;test.pdf&#39;</span><span class="p">)</span>

<span class="c1"># Get the first page</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Add an area to redact</span>
<span class="n">rect</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">]</span>

<span class="c1"># Add a redacction annotation which will have a red fill color</span>
<span class="n">page</span><span class="o">.</span><span class="n">add_redact_annot</span><span class="p">(</span><span class="n">rect</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Apply the redactions to the current page, but ignore vector graphics</span>
<span class="n">page</span><span class="o">.</span><span class="n">apply_redactions</span><span class="p">(</span><span class="n">graphics</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Save the modified document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;redactied_document.pdf&#39;</span><span class="p">)</span>

<span class="c1"># Close the document</span>
<span class="n">doc</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>Once a redacted version of a document is saved then the redacted content in the <strong>PDF</strong> is <em>irretrievable</em>. Thus, a redacted area in a document removes text and graphics completely from that area.</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>Taking it further</strong></p>
<p>The are a few options for creating and applying redactions to a page, for the full API details to understand the parameters to control these options refer to the API reference.</p>
<p><strong>API reference</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#Page.add_redact_annot" title="Page.add_redact_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_redact_annot()</span></code></a></p></li>
<li><p><a class="reference internal" href="page.html#Page.apply_redactions" title="Page.apply_redactions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.apply_redactions()</span></code></a></p></li>
</ul>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<section id="the-basics-coverting-pdf-documents">
<span id="id30"></span><h2>转换 PDF 文档<a class="headerlink" href="#the-basics-coverting-pdf-documents" title="此标题的永久链接">#</a></h2>
<p>Converting PDF Documents</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--27-input--1" name="tab-set--27" type="radio"><label class="tab-label" for="tab-set--27-input--1">中文</label><div class="tab-content docutils container">
<p>我们推荐使用 <strong>PyMuPDF</strong> 和 <strong>python-docx</strong> 库的 <a class="reference external" href="https://pdf2docx.readthedocs.io/en/latest/">pdf2docx</a> 库来提供从 <strong>PDF</strong> 到 <strong>DOCX</strong> 格式的简单文档转换。</p>
</div>
<input class="tab-input" id="tab-set--27-input--2" name="tab-set--27" type="radio"><label class="tab-label" for="tab-set--27-input--2">英文</label><div class="tab-content docutils container">
<p>We recommend the <a class="reference external" href="https://pdf2docx.readthedocs.io/en/latest/">pdf2docx</a> library which uses <strong>PyMuPDF</strong> and the <strong>python-docx</strong> library to provide simple document conversion from <strong>PDF</strong> to <strong>DOCX</strong> format.</p>
</div>
</div>
<div class="feedbackLink"><a id="feedbackLinkBottom" target=_blank>您对此页面有任何反馈吗？</b></a></div><hr class="docutils" />
<script>

   var url_string = window.location.href;
   var a = document.getElementById('feedbackLinkBottom');
   a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link&url="+url_string);

</script>

<p style="color:#999" id="footerDisclaimer">本软件按原样提供，不作任何明示或暗示担保。本软件根据许可分发，除非根据该许可条款明确授权，否则不得复制、修改或分发。请参阅 <a href="https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link">artifex.com</a> 上的许可信息，或联系 Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States 了解更多信息。</p>



<script>

   let docLanguage = document.getElementsByTagName('html')[0].getAttribute('lang');

   function getHeaderAndFooterTranslation(str) {
       if (docLanguage == "ja") {
           if (str == "Do you have any feedback on this page?") {
               return "このページに関するご意見はありますか？";
           } else if (str == "Find <b>#pymupdf</b> on <b>Discord</b>") {
               return "<b>Discord</b>の <b>#pymupdf</b> を見つける";
           } else if (str == "This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.") {

               return "このソフトウェアは無保証で提供されており、明示または黙示を問わず、いかなる保証もありません。このソフトウェアはライセンスの下で配布され、ライセンスの条件に明示的に許可されている場合を除き、コピー、変更、または配布してはなりません。ライセンシング情報については、<a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a>でライセンス情報を参照するか、アメリカ合衆国カリフォルニア州サンフランシスコのArtifex Software Inc. までお問い合わせください。"

           }
       }

       return str;
   }

   document.getElementById("findOnDiscord").innerHTML = getHeaderAndFooterTranslation("Find <b>#pymupdf</b> on <b>Discord</b>");
   document.getElementById("feedbackLinkTop").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("feedbackLinkBottom").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("footerDisclaimer").innerHTML = getHeaderAndFooterTranslation("This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.");


   // more translation for admonition-title as the in-built translation isn't great, needs: 注釈 -> 注
   if (docLanguage == "ja") {
       const collection = document.getElementsByClassName("admonition-title");
       for (var i=0;i<collection.length;i++) {
           collection[i].innerHTML = "注";
       }
   }


</script><p class="footer-version">This documentation covers all versions up to 1.25.4.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="tutorial.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">教程</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="installation.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">安装</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2025, Artifex
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 19. 3月 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">基础用法</a><ul>
<li><a class="reference internal" href="#the-basics-opening-files">打开文件</a></li>
<li><a class="reference internal" href="#pdf">从 <cite>PDF</cite> 中提取文本</a></li>
<li><a class="reference internal" href="#the-basics-extracting-images">从 <cite>PDF</cite> 中提取图像</a></li>
<li><a class="reference internal" href="#the-basics-extracting-vector-graphics">提取矢量图形</a></li>
<li><a class="reference internal" href="#join-pdf">合并 <cite>PDF</cite> 文件</a><ul>
<li><a class="reference internal" href="#id6">将 <cite>PDF</cite> 文件与其他类型的文件合并</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id8">使用坐标</a></li>
<li><a class="reference internal" href="#the-basics-watermarks">向 <cite>PDF</cite> 添加水印</a></li>
<li><a class="reference internal" href="#the-basics-images">向 <cite>PDF</cite> 添加图像</a></li>
<li><a class="reference internal" href="#the-basics-rotating">旋转 <cite>PDF</cite></a></li>
<li><a class="reference internal" href="#the-basics-cropping">裁剪 <cite>PDF</cite></a></li>
<li><a class="reference internal" href="#the-basics-attaching-files">附加文件</a></li>
<li><a class="reference internal" href="#the-basics-embedding-files">嵌入文件</a></li>
<li><a class="reference internal" href="#the-basics-deleting-pages">删除页面</a><ul>
<li><a class="reference internal" href="#id16">如果我删除书签或超链接引用的页面会发生什么？</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-basics-rearrange-pages">重新排列页面</a></li>
<li><a class="reference internal" href="#the-basics-copying-pages">复制页面</a></li>
<li><a class="reference internal" href="#the-basics-selecting-pages">选择页面</a></li>
<li><a class="reference internal" href="#the-basics-adding-blank-pages">添加空白页</a></li>
<li><a class="reference internal" href="#the-basics-inserting-pages">插入带有文本内容的页面</a></li>
<li><a class="reference internal" href="#the-basics-spliting-single-pages">拆分单页</a></li>
<li><a class="reference internal" href="#the-basics-combining-single-pages">合并单页</a></li>
<li><a class="reference internal" href="#the-basics-encryption-and-decryption"><cite>PDF</cite> 加密和解密</a></li>
<li><a class="reference internal" href="#the-basics-extracting-tables">从 <cite>页面</cite> 中提取表格</a></li>
<li><a class="reference internal" href="#the-basics-get-page-links">获取页面链接</a></li>
<li><a class="reference internal" href="#the-basics-get-all-annotations">从文档中获取所有注释</a></li>
<li><a class="reference internal" href="#the-basics-redacting">从 <strong>PDF</strong> 中删除内容</a></li>
<li><a class="reference internal" href="#the-basics-coverting-pdf-documents">转换 PDF 文档</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/tabs.js"></script>
    <script src="_static/translations.js"></script>
    </body>
</html>