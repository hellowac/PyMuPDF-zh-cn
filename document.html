<!doctype html>
<html class="no-js" lang="zh-CN">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="Artifex" name="author" />
<meta content="PyMuPDF 是一个高性能 Python 库，用于 PDF（及其他）文档的数据提取、分析、转换和操作。" name="description" />
<meta content="PDF Text Extraction, PDF Image Extraction, PDF Conversion, PDF Tables, PDF Splitting, PDF Creation, Pyodide, PyScript" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZTN4VTL9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZTN4VTL9M');
    </script>
    <link rel="author" title="关于此文档" href="about.html" /><link rel="index" title="索引" href="genindex.html" /><link rel="search" title="搜索" href="search.html" /><link rel="next" title="DocumentWriter" href="document-writer-class.html" /><link rel="prev" title="DisplayList" href="displaylist.html" />

    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/><!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>Document - PyMuPDF 1.25.4 文档</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMuPDF 1.25.4 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/sidebar-logo-dark.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/sidebar-logo-light.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyMuPDF 1.25.4 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">关于/About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">功能比较</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-performance">性能</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-license">许可和版权</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf4llm/index.html">PyMuPDF4LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf-pro.html">PyMuPDF Pro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">用户指南/User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-basics.html">基础用法</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">PyMuPDF、LLM 和 RAG</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">资源</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">教程/How to Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how-to-open-a-file.html">打开文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-text.html">文本</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-images.html">图片</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-annotations.html">注释</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-drawing-and-graphics.html">绘图和图形</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-stories.html">故事</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-journalling.html">日记</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-multiprocessing.html">多进程</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-ocr.html">OCR - 光学字符识别</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-optional-content.html">可选内容支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-low-level-interfaces.html">低级接口</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-common-issues-and-their-solutions.html">常见问题及其解决方案</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API参考/API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="module.html">命令行界面</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="classes.html">类</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="annot.html">Annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="archive-class.html">Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="colorspace.html">Colorspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="displaylist.html">DisplayList</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-writer-class.html">DocumentWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="font.html">Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="irect.html">IRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="link.html">Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkdest.html">linkDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="outline.html">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixmap.html">Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="point.html">Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="quad.html">Quad</a></li>
<li class="toctree-l2"><a class="reference internal" href="rect.html">Rect</a></li>
<li class="toctree-l2"><a class="reference internal" href="shape.html">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="story-class.html">Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="textpage.html">TextPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="textwriter.html">TextWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="widget.html">Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml-class.html">Xml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algebra.html">几何对象的运算符代数</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lowlevel.html">低级函数和类</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html">函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="device.html">设备</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop_low.html">协同工作: DisplayList 和 TextPage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">常量和枚举</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">颜色数据库</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">其他/Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app1.html">附录 1：文本提取详细信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app2.html">附录 2：嵌入式文件的注意事项</a></li>
<li class="toctree-l1"><a class="reference internal" href="app3.html">附录 3：各类技术信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app4.html">附录 4：性能比较方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">更新日志</a></li>
<li class="toctree-l1"><a class="reference internal" href="znames.html">已废弃名称</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div style="display:flex;justify-content:space-between;align-items: center;">
    <form class="sidebar-search-container top" method="get" action="search.html" role="search" style="width:75%">
      <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
    <div class="discordLink" style="display:flex;align-items:center;margin-top: -5px;">
        <a href="https://discord.gg/TSpYGBW4eq" id="findOnDiscord" target=_blank>Find <b>#pymupdf</b> on <b>Discord</b></a>
        <a href="https://discord.gg/TSpYGBW4eq" target=_blank>
            <div style="width:30px;height:30px;margin-left:5px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
                    <defs>
                        <style>.discordLogoFill{fill:#5865f2;}</style>
                    </defs>
                    <g id="Discord_Logo" data-name="Discord Logo">
                        <path class="discordLogoFill" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                    </g>
                </svg>
            </div>
        </a>
    </div>

</div><section id="document">
<span id="id1"></span><h1>Document<a class="headerlink" href="#document" title="此标题的永久链接">#</a></h1>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">中文</label><div class="tab-content docutils container">
<p>该类表示一个文档。它可以从文件或内存中构造。</p>
<p>该类的别名为 <em>open</em>，即 <code class="xref any docutils literal notranslate"><span class="pre">pymupdf.Document(...)</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">pymupdf.open(...)</span></code> 的功能完全相同。</p>
<p>有关 <strong>嵌入文件</strong> 的详细信息，请参阅附录 3。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>从 v1.17.0 开始，<strong>仅针对 EPUB 文件</strong> 引入了一种新的页面寻址机制。此类文档在内部按章节组织，因此最有效的页面查找方式是使用所谓的 “location”（位置）。该位置是一个元组 <em>(chapter, pno)</em>，其中：</p>
<ul class="simple">
<li><p><em>chapter</em> 表示章节编号</p></li>
<li><p><em>pno</em> 表示该章节中的页面编号</p></li>
</ul>
<p>这两个编号均从 0 开始。</p>
<p>尽管仍然可以使用页面的（绝对）编号进行定位，但这样可能会导致完整的 EPUB 文档在定位前必须完全布局。如果文档非常大，这可能会对性能产生显著影响。而使用 <em>(chapter, pno)</em> 进行定位可以避免这一问题。</p>
<p>为了保持一致的 API，PyMuPDF 支持对 <strong>所有文件类型</strong> 使用页面 <em>location</em> 语法——对于不具备此功能的文档，其内容仅包含一个章节。<a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a> 以及等效的索引访问现在也支持 <em>location</em> 参数。</p>
<p>此外，还提供了一些方法用于在页面编号和位置之间进行转换，获取章节数、每个章节的页面数，以及计算文档的下一页、上一页和最后一页的位置。</p>
</div>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>方法 / 属性</strong></p></th>
<th class="head"><p><strong>简要说明</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.add_layer" title="Document.add_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.add_layer()</span></code></a></p></td>
<td><p>仅限 PDF：创建新的可选内容配置</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.add_ocg" title="Document.add_ocg"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.add_ocg()</span></code></a></p></td>
<td><p>仅限 PDF：添加新的可选内容组</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.authenticate" title="Document.authenticate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.authenticate()</span></code></a></p></td>
<td><p>访问加密文档</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.bake" title="Document.bake"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.bake()</span></code></a></p></td>
<td><p>仅限 PDF：使注释 / 表单字段成为永久内容</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.can_save_incrementally" title="Document.can_save_incrementally"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.can_save_incrementally()</span></code></a></p></td>
<td><p>检查是否可以增量保存</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.chapter_page_count" title="Document.chapter_page_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.chapter_page_count()</span></code></a></p></td>
<td><p>章节中的页数</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.close" title="Document.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.close()</span></code></a></p></td>
<td><p>关闭文档</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.convert_to_pdf" title="Document.convert_to_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.convert_to_pdf()</span></code></a></p></td>
<td><p>将文档转换为 PDF 并存储到内存</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.copy_page()</span></code></a></p></td>
<td><p>仅限 PDF：复制页面引用</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.del_toc_item" title="Document.del_toc_item"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.del_toc_item()</span></code></a></p></td>
<td><p>仅限 PDF：删除单个目录项</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_page()</span></code></a></p></td>
<td><p>仅限 PDF：删除页面</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.delete_pages" title="Document.delete_pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_pages()</span></code></a></p></td>
<td><p>仅限 PDF：删除多个页面</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.embfile_add" title="Document.embfile_add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_add()</span></code></a></p></td>
<td><p>仅限 PDF：从缓冲区添加新的嵌入文件</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.embfile_count" title="Document.embfile_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_count()</span></code></a></p></td>
<td><p>仅限 PDF：获取嵌入文件的数量</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.embfile_del" title="Document.embfile_del"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_del()</span></code></a></p></td>
<td><p>仅限 PDF：删除嵌入文件条目</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.embfile_get" title="Document.embfile_get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_get()</span></code></a></p></td>
<td><p>仅限 PDF：提取嵌入文件的缓冲区</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.embfile_info" title="Document.embfile_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_info()</span></code></a></p></td>
<td><p>仅限 PDF：获取嵌入文件的元数据</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.embfile_names" title="Document.embfile_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_names()</span></code></a></p></td>
<td><p>仅限 PDF：列出嵌入文件</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.embfile_upd" title="Document.embfile_upd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_upd()</span></code></a></p></td>
<td><p>仅限 PDF：更新嵌入文件</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.extract_font" title="Document.extract_font"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extract_font()</span></code></a></p></td>
<td><p>仅限 PDF：通过 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 提取字体</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.extract_image" title="Document.extract_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extract_image()</span></code></a></p></td>
<td><p>仅限 PDF：通过 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 提取嵌入图像</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.ez_save" title="Document.ez_save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.ez_save()</span></code></a></p></td>
<td><p>仅限 PDF：使用不同默认值调用 <a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.find_bookmark" title="Document.find_bookmark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.find_bookmark()</span></code></a></p></td>
<td><p>获取文档布局后的书签页位置</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.fullcopy_page" title="Document.fullcopy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.fullcopy_page()</span></code></a></p></td>
<td><p>仅限 PDF：复制整个页面</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_layer" title="Document.get_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_layer()</span></code></a></p></td>
<td><p>仅限 PDF：获取开启、关闭、RBGroups 中的 OCGs</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_layers" title="Document.get_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_layers()</span></code></a></p></td>
<td><p>仅限 PDF：获取所有可选内容配置</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_oc" title="Document.get_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_oc()</span></code></a></p></td>
<td><p>仅限 PDF：获取图像 / 表单 xobject 的 OCG / OCMD <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_ocgs" title="Document.get_ocgs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_ocgs()</span></code></a></p></td>
<td><p>仅限 PDF：获取所有可选内容组信息</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_ocmd" title="Document.get_ocmd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_ocmd()</span></code></a></p></td>
<td><p>仅限 PDF：检索 <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a> 定义</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_page_fonts" title="Document.get_page_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_fonts()</span></code></a></p></td>
<td><p>仅限 PDF：获取页面中引用的字体列表</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_page_images" title="Document.get_page_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_images()</span></code></a></p></td>
<td><p>仅限 PDF：获取页面中引用的图像列表</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_page_labels" title="Document.get_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_labels()</span></code></a></p></td>
<td><p>仅限 PDF：获取页面标签定义列表</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_page_numbers" title="Document.get_page_numbers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_numbers()</span></code></a></p></td>
<td><p>仅限 PDF：获取具有特定标签的页码</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_page_pixmap" title="Document.get_page_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_pixmap()</span></code></a></p></td>
<td><p>通过页码创建页面的 pixmap</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_page_text" title="Document.get_page_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_text()</span></code></a></p></td>
<td><p>通过页码提取页面文本</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_page_xobjects" title="Document.get_page_xobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_xobjects()</span></code></a></p></td>
<td><p>仅限 PDF：获取页面引用的 XObjects 列表</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_sigflags" title="Document.get_sigflags"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_sigflags()</span></code></a></p></td>
<td><p>仅限 PDF：确定签名状态</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a></p></td>
<td><p>提取目录（TOC）</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_xml_metadata" title="Document.get_xml_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_xml_metadata()</span></code></a></p></td>
<td><p>仅限 PDF：读取 XML 元数据</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.has_annots" title="Document.has_annots"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.has_annots()</span></code></a></p></td>
<td><p>仅限 PDF：检查 PDF 是否包含注释</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.has_links" title="Document.has_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.has_links()</span></code></a></p></td>
<td><p>仅限 PDF：检查 PDF 是否包含链接</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.insert_page" title="Document.insert_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a></p></td>
<td><p>仅限 PDF：插入新页面</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a></p></td>
<td><p>仅限 PDF：从另一个 PDF 插入页面</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.insert_file" title="Document.insert_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_file()</span></code></a></p></td>
<td><p>仅限 PDF：从任意文档插入页面</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.journal_can_do" title="Document.journal_can_do"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_can_do()</span></code></a></p></td>
<td><p>仅限 PDF：检查支持的日志操作</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.journal_enable" title="Document.journal_enable"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_enable()</span></code></a></p></td>
<td><p>仅限 PDF：启用日志记录</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.journal_load" title="Document.journal_load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_load()</span></code></a></p></td>
<td><p>仅限 PDF：从文件加载日志</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.journal_op_name" title="Document.journal_op_name"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_op_name()</span></code></a></p></td>
<td><p>仅限 PDF：获取日志步骤名称</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.journal_position" title="Document.journal_position"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_position()</span></code></a></p></td>
<td><p>仅限 PDF：获取日志状态</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.journal_redo" title="Document.journal_redo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_redo()</span></code></a></p></td>
<td><p>仅限 PDF：重做当前操作</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.journal_save" title="Document.journal_save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_save()</span></code></a></p></td>
<td><p>仅限 PDF：保存日志到文件</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.journal_start_op" title="Document.journal_start_op"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_start_op()</span></code></a></p></td>
<td><p>仅限 PDF：开始新的日志操作并命名</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.journal_stop_op" title="Document.journal_stop_op"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_stop_op()</span></code></a></p></td>
<td><p>仅限 PDF：结束当前日志操作</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.journal_undo" title="Document.journal_undo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_undo()</span></code></a></p></td>
<td><p>仅限 PDF：撤销当前操作</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.layer_ui_configs" title="Document.layer_ui_configs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layer_ui_configs()</span></code></a></p></td>
<td><p>仅限 PDF：获取可选内容的 UI 配置</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.layout" title="Document.layout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layout()</span></code></a></p></td>
<td><p>重新分页文档（如果支持）</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a></p></td>
<td><p>读取页面</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.make_bookmark" title="Document.make_bookmark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.make_bookmark()</span></code></a></p></td>
<td><p>在可重排文档中创建页面指针</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.move_page" title="Document.move_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.move_page()</span></code></a></p></td>
<td><p>仅限 PDF：移动页面到文档中不同位置</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.need_appearances" title="Document.need_appearances"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.need_appearances()</span></code></a></p></td>
<td><p>仅限 PDF：获取 / 设置 <code class="xref any docutils literal notranslate"><span class="pre">/NeedAppearances</span></code> 属性</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.new_page" title="Document.new_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.new_page()</span></code></a></p></td>
<td><p>仅限 PDF：插入新的空白页面</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.next_location" title="Document.next_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.next_location()</span></code></a></p></td>
<td><p>返回下一页的 (chapter, pno)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.outline_xref" title="Document.outline_xref"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.outline_xref()</span></code></a></p></td>
<td><p>仅限 PDF：获取目录项的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.page_cropbox" title="Document.page_cropbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.page_cropbox()</span></code></a></p></td>
<td><p>仅限 PDF：获取未旋转的页面矩形</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.page_xref" title="Document.page_xref"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.page_xref()</span></code></a></p></td>
<td><p>仅限 PDF：获取页面的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.pages" title="Document.pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pages()</span></code></a></p></td>
<td><p>迭代页面范围</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.pdf_catalog" title="Document.pdf_catalog"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pdf_catalog()</span></code></a></p></td>
<td><p>仅限 PDF：获取 PDF 目录的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.pdf_trailer" title="Document.pdf_trailer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pdf_trailer()</span></code></a></p></td>
<td><p>仅限 PDF：获取 PDF 预告信息</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.prev_location" title="Document.prev_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.prev_location()</span></code></a></p></td>
<td><p>返回前一页的 (chapter, pno)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.reload_page" title="Document.reload_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.reload_page()</span></code></a></p></td>
<td><p>仅限 PDF：重新加载页面</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.resolve_names" title="Document.resolve_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.resolve_names()</span></code></a></p></td>
<td><p>仅限 PDF：将目标名称转换为 Python 字典</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a></p></td>
<td><p>仅限 PDF：保存文档</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.saveIncr" title="Document.saveIncr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.saveIncr()</span></code></a></p></td>
<td><p>仅限 PDF：增量保存文档</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.scrub" title="Document.scrub"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.scrub()</span></code></a></p></td>
<td><p>仅限 PDF：删除敏感数据</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.search_page_for" title="Document.search_page_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.search_page_for()</span></code></a></p></td>
<td><p>在页面中搜索字符串</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a></p></td>
<td><p>仅限 PDF：选择页面子集</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_layer_ui_config" title="Document.set_layer_ui_config"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_layer_ui_config()</span></code></a></p></td>
<td><p>仅限 PDF：临时设置 OCG 可见性</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_layer" title="Document.set_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_layer()</span></code></a></p></td>
<td><p>仅限 PDF：批量更改 OCG 状态</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_markinfo" title="Document.set_markinfo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_markinfo()</span></code></a></p></td>
<td><p>仅限 PDF：设置 MarkInfo 值</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_metadata" title="Document.set_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_metadata()</span></code></a></p></td>
<td><p>仅限 PDF：设置元数据</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_oc" title="Document.set_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_oc()</span></code></a></p></td>
<td><p>仅限 PDF：将 OCG/OCMD 附加到图像 / 表单 xobject</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_ocmd" title="Document.set_ocmd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_ocmd()</span></code></a></p></td>
<td><p>仅限 PDF：创建或更新 <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_page_labels" title="Document.set_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_page_labels()</span></code></a></p></td>
<td><p>仅限 PDF：添加 / 更新页面标签定义</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_pagemode" title="Document.set_pagemode"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_pagemode()</span></code></a></p></td>
<td><p>仅限 PDF：设置 PageMode</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_pagelayout" title="Document.set_pagelayout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_pagelayout()</span></code></a></p></td>
<td><p>仅限 PDF：设置 PageLayout</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_toc_item" title="Document.set_toc_item"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_toc_item()</span></code></a></p></td>
<td><p>仅限 PDF：修改单个目录项</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_toc" title="Document.set_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_toc()</span></code></a></p></td>
<td><p>仅限 PDF：设置目录（TOC）</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_xml_metadata" title="Document.set_xml_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_xml_metadata()</span></code></a></p></td>
<td><p>仅限 PDF：创建或更新 XML 元数据</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.subset_fonts" title="Document.subset_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.subset_fonts()</span></code></a></p></td>
<td><p>仅限 PDF：创建字体子集</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.switch_layer" title="Document.switch_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.switch_layer()</span></code></a></p></td>
<td><p>仅限 PDF：激活 OC 配置</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a></p></td>
<td><p>仅限 PDF：将文档写入内存</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Class API</strong></p>
<dl class="py class">
<dt class="sig sig-object py" id="Document">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Document</span></span><a class="headerlink" href="#Document" title="永久链接至目标">#</a></dt>
<dd><span class="target" id="index-0"></span><dl class="py method">
<dt class="sig sig-object py" id="Document.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filetype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.__init__" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.14.13 版本更改：支持 <code class="xref any docutils literal notranslate"><span class="pre">io.BytesIO</span></code> 作为内存文档。</p></li>
<li><p>v1.19.6 版本更改：提供更清晰、更简短且更一致的异常消息。如果未指定文件类型，则默认假定为 “pdf”。空文件或空内存区域将始终导致异常。</p></li>
</ul>
<p>创建一个 <em>Document</em> 对象。</p>
<ul class="simple">
<li><p>使用默认参数时，将创建一个 <strong>新的空 PDF</strong> 文档。</p></li>
<li><p>如果提供了 <em>stream</em>，则从内存创建文档。如果该文档不是 PDF，则必须通过 <em>filename</em> 或 <em>filetype</em> 指定其类型。</p></li>
<li><p>如果 <em>stream</em> 为 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>，则从 <em>filename</em> 指定的文件创建文档。其类型将根据文件扩展名推断。该推断可以通过 <em>filetype</em> 覆盖。</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>,</em><em>pathlib</em>) – 一个 UTF-8 字符串或 <em>pathlib</em> 对象，表示文件路径。文档类型由文件名扩展名推断。如果未提供，或者扩展名不匹配 <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">支持的类型</span></a>，则默认假定为 PDF。对于内存文档，可以使用此参数代替 <code class="xref any docutils literal notranslate"><span class="pre">filetype</span></code>，详见下文。</p></li>
<li><p><strong>stream</strong> (<em>bytes</em><em>,</em><em>bytearray</em><em>,</em><em>BytesIO</em>) – 一个包含支持的文档数据的内存区域。如果不是 PDF，则必须通过 <code class="xref any docutils literal notranslate"><span class="pre">filename</span></code> 或 <code class="xref any docutils literal notranslate"><span class="pre">filetype</span></code> 指定其类型。</p></li>
<li><p><strong>filetype</strong> (<em>str</em>) – 指定文档类型的字符串。它可以是类似于文件名的格式（例如 <code class="xref any docutils literal notranslate"><span class="pre">&quot;x.pdf&quot;</span></code>），此时 MuPDF 会使用扩展名来确定类型，或者 MIME 类型（如 <em>application/pdf</em>）。直接使用 <code class="xref any docutils literal notranslate"><span class="pre">&quot;pdf&quot;</span></code> 或 <code class="xref any docutils literal notranslate"><span class="pre">&quot;.pdf&quot;</span></code> 也是可以的。对于 PDF 文档，此参数可以省略，否则必须匹配 <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">支持的文档类型</span></a>。</p></li>
<li><p><strong>rect</strong> (<em>rect_like</em>) – 指定所需页面尺寸的矩形。此参数仅对具有可变页面布局（”可重排” 文档，例如电子书或 HTML）的文档有意义，其他情况下会被忽略。如果指定，该矩形必须是非空的有限矩形，且左上角坐标为 (0, 0)。与 <em>fontsize</em> 参数结合，每个页面将根据此布局计算，并由此决定总页数。</p></li>
<li><p><strong>width</strong> (<em>float</em>) – 可以与 <em>height</em> 一起用作 <em>rect</em> 的替代方案，以指定页面布局信息。</p></li>
<li><p><strong>height</strong> (<em>float</em>) – 可以与 <em>width</em> 一起用作 <em>rect</em> 的替代方案，以指定页面布局信息。</p></li>
<li><p><strong>fontsize</strong> (<em>float</em>) – 可重排文档类型的默认 <a class="reference internal" href="glossary.html#fontsize" title="fontsize"><code class="xref py py-data docutils literal notranslate"><span class="pre">fontsize</span></code></a>。如果未指定 <em>rect</em>，或者 <em>width</em> 和 <em>height</em>，则该参数被忽略。否则，将用于计算页面布局。</p></li>
</ul>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – 如果任一参数的类型不符合要求。</p></li>
<li><p><strong>FileNotFoundError</strong> – 如果无法找到文件/路径。该异常被重新实现为 <code class="xref any docutils literal notranslate"><span class="pre">RuntimeError</span></code> 的子类。</p></li>
<li><p><strong>EmptyFileError</strong> – 如果文件/路径为空，或内存中的 <code class="xref any docutils literal notranslate"><span class="pre">bytes</span></code> 对象长度为零。该异常是 <code class="xref any docutils literal notranslate"><span class="pre">FileDataError</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">RuntimeError</span></code> 的子类。</p></li>
<li><p><strong>ValueError</strong> – 如果显式指定了未知的文件类型。</p></li>
<li><p><strong>FileDataError</strong> – 如果文档的结构对于给定的类型无效，或者不是文件（例如是一个文件夹）。该异常是 <code class="xref any docutils literal notranslate"><span class="pre">RuntimeError</span></code> 的子类。</p></li>
</ul>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>返回一个文档对象。如果文档无法创建，则按照上述顺序引发异常。请注意，PyMuPDF 特定的异常 <code class="xref any docutils literal notranslate"><span class="pre">FileNotFoundError</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">EmptyFileError</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">FileDataError</span></code> 在检查 <code class="xref any docutils literal notranslate"><span class="pre">RuntimeError</span></code> 时也会被拦截。</p>
<p>如果遇到问题，可以使用以下方式查看内部消息存储的详细信息：
<code class="xref any docutils literal notranslate"><span class="pre">print(pymupdf.TOOLS.mupdf_warnings())</span></code>
该调用会清空消息存储，但也可以防止清空，详见 <a class="reference internal" href="tools.html#Tools.mupdf_warnings" title="Tools.mupdf_warnings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Tools.mupdf_warnings()</span></code></a>。</p>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>并非所有文档类型都会在打开时立即检查格式的有效性。例如，栅格图像可能会在访问内容时才引发异常。其他类型（尤其是非二进制内容）有时即使内容格式无效也可以打开（甚至可以 <strong>访问</strong> 部分内容）：</p>
<ul class="simple">
<li><p>HTM, HTML, XHTML：<strong>始终</strong> 可以打开，<code class="xref any docutils literal notranslate"><span class="pre">metadata[&quot;format&quot;]</span></code> 分别为 <code class="xref any docutils literal notranslate"><span class="pre">&quot;HTML5&quot;</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">&quot;XHTML&quot;</span></code>。</p></li>
<li><p>XML, FB2：<strong>始终</strong> 可以打开，<code class="xref any docutils literal notranslate"><span class="pre">metadata[&quot;format&quot;]</span></code> 为 <code class="xref any docutils literal notranslate"><span class="pre">&quot;FictionBook2&quot;</span></code>。</p></li>
</ul>
</div>
<p>以下是可能的使用方式，注意：<code class="xref any docutils literal notranslate"><span class="pre">open</span></code> 是 <a class="reference internal" href="#document"><span class="std std-ref">Document</span></a> 的同义词:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 从文件打开</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;some.xps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 处理错误的扩展名</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;some.file&quot;</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;xps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 从内存打开，如果不是 PDF，必须提供 filetype</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;xps&quot;</span><span class="p">,</span> <span class="n">mem_area</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">mem_area</span><span class="p">,</span> <span class="s2">&quot;xps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">stream</span><span class="o">=</span><span class="n">mem_area</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s2">&quot;xps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 创建一个新的空 PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>如果栅格图像的文件扩展名错误（但仍然是受支持的格式），<strong>不会有问题</strong>。MuPDF 在实际访问文件 <strong>内容</strong> 时会确定正确的图像类型，并能正常处理。因此，即使 <code class="xref any docutils literal notranslate"><span class="pre">file.jpg</span></code> 实际上是 PNG 图像，<code class="xref any docutils literal notranslate"><span class="pre">pymupdf.open(&quot;file.jpg&quot;)</span></code> 仍然可以工作。</p>
</div>
<p><a class="reference internal" href="#document"><span class="std std-ref">Document</span></a> 类也可以用作 <strong>上下文管理器</strong>。退出时，文档会自动关闭。</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="o">...</span><span class="p">)</span> <span class="k">as</span> <span class="n">doc</span><span class="p">:</span>
<span class="go">        for page in doc: print(&quot;page %i&quot; % page.number)</span>
<span class="go">page 0</span>
<span class="go">page 1</span>
<span class="go">page 2</span>
<span class="go">page 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">is_closed</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_oc">
<span class="sig-name descname"><span class="pre">get_oc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_oc" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.4</p></li>
</ul>
<p>返回附加到图像或表单 xobject 的 <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> 或 <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a> 的交叉引用号。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – 图像或表单 xobject 的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。有效的交叉引用号可通过 <a class="reference internal" href="#Document.get_page_images" title="Document.get_page_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_images()</span></code></a> 或 <a class="reference internal" href="#Document.get_page_xobjects" title="Document.get_page_xobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_xobjects()</span></code></a> 获取。对于无效的编号，将引发异常。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>可选内容对象的交叉引用号，如果没有则返回 0。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_oc">
<span class="sig-name descname"><span class="pre">set_oc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ocxref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_oc" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.4</p></li>
</ul>
<p>如果 <em>xref</em> 代表一个图像或表单 xobject，则设置或移除可选内容对象的交叉引用号 <em>ocxref</em>。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – 图像或表单 xobject 的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> <a class="footnote-reference brackets" href="#f12" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>12<span class="fn-bracket">]</span></a>。有效的交叉引用号可通过 <a class="reference internal" href="#Document.get_page_images" title="Document.get_page_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_images()</span></code></a> 或 <a class="reference internal" href="#Document.get_page_xobjects" title="Document.get_page_xobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_xobjects()</span></code></a> 获取。对于无效的编号，将引发异常。</p></li>
<li><p><strong>ocxref</strong> (<em>int</em>) – <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> / <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a> 的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 号。如果不为 0，则无效的引用会引发异常。如果为 0，则移除任何 OC 引用。</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_layers">
<span class="sig-name descname"><span class="pre">get_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_layers" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.3</p></li>
</ul>
<p>显示可选的图层配置。始终存在一个标准配置，但不会包含在返回结果中。</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_layers</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="go">{&#39;number&#39;: 0, &#39;name&#39;: &#39;my-config&#39;, &#39;creator&#39;: &#39;&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 在 add_ocg 中使用 &#39;number&#39; 作为配置标识符</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.add_layer">
<span class="sig-name descname"><span class="pre">add_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">creator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.add_layer" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.3</p></li>
</ul>
<p>添加一个可选内容配置。图层用于管理可选内容组的开 / 关状态，并允许在同一文档的不同视图之间快速切换可见性。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – 任意名称。</p></li>
<li><p><strong>creator</strong> (<em>str</em>) – (可选) 创建此图层的软件。</p></li>
<li><p><strong>on</strong> (<em>sequ</em>) – 需要在此图层激活时设置为 ON 的 OCG <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 编号序列。所有未列出的 OCG 将被设置为 OFF。</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.switch_layer">
<span class="sig-name descname"><span class="pre">switch_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.switch_layer" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.3</p></li>
</ul>
<p>切换到由可选图层的配置编号定义的文档视图。该操作是临时的，除非设定为默认配置。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>number</strong> (<em>int</em>) – 由 <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layer_configs()</span></code> 返回的配置编号。</p></li>
<li><p><strong>as_default</strong> (<em>bool</em>) – 是否将此配置设为默认。</p></li>
</ul>
</dd>
</dl>
<p>激活 OCG 的开 / 关状态，该状态由指定图层定义。如果 <em>as_default=True</em>，则所有图层（包括标准图层）将被合并，并将结果写回标准图层，同时 <strong>所有可选图层都会被删除</strong>。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.add_ocg">
<span class="sig-name descname"><span class="pre">add_ocg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'View'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Artwork'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.add_ocg" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.3</p></li>
</ul>
<p>添加一个可选内容组。OCG 是确定对象可见性的最重要单位。对于 PDF，如果希望支持可选内容，至少需要存在一个 OCG。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – 任意名称，将显示在支持的 PDF 查看器中。</p></li>
<li><p><strong>config</strong> (<em>int</em>) – 图层配置编号。默认值 -1 表示标准配置。</p></li>
<li><p><strong>on</strong> (<em>bool</em>) – 指向该 OCG 的对象的标准可见性状态。</p></li>
<li><p><strong>intent</strong> (<em>str</em><em>,</em><em>list</em>) – 一个字符串或字符串列表，声明可见性意图。PDF 标准提供了两个选项：”View” 和 “Design”。默认值为 “View”。<strong>拼写必须正确</strong>。</p></li>
<li><p><strong>usage</strong> (<em>str</em>) – 影响 OCG 可见性的另一个因素。此值将成为 OCG 的 <code class="xref any docutils literal notranslate"><span class="pre">/Usage</span></code> 键的一部分。PDF 标准提供了两个选项：”Artwork” 和 “Technical”，默认值为 “Artwork”。仅在必要时更改。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>创建的 OCG 的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。可用于支持对象的 <code class="xref any docutils literal notranslate"><span class="pre">oc</span></code> 参数。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>可以创建多个具有相同参数的 OCG，这不会导致问题。使用 <a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> 的垃圾回收选项 3 可删除任何重复项。</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_ocmd">
<span class="sig-name descname"><span class="pre">set_ocmd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ocgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'AnyOn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_ocmd" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.4</p></li>
</ul>
<p>创建或更新一个 <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a>，即 <strong>可选内容成员字典 (Optional Content Membership Dictionary)</strong>。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – 要更新的 OCMD 的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>，如果为 0，则创建一个新的 OCMD。</p></li>
<li><p><strong>ocgs</strong> (<em>list</em>) – 现有 <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> PDF 对象的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 号序列。</p></li>
<li><p><strong>policy</strong> (<em>str</em>) – 可选值为 “AnyOn”（默认）、”AnyOff”、”AllOn”、”AllOff”（可混合大小写）。</p></li>
<li><p><strong>ve</strong> (<em>list</em>) – “可见性表达式”，由任意嵌套的列表组成（详细说明见下文）。如果需要更复杂的条件，可以使用此参数替代 <em>ocgs</em> / <em>policy</em> 组合。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>OCMD 的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>，可作为支持对象的 <code class="xref any docutils literal notranslate"><span class="pre">oc=xref</span></code> 参数，也可用于 <a class="reference internal" href="#Document.set_oc" title="Document.set_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_oc()</span></code></a> 或 <a class="reference internal" href="annot.html#Annot.set_oc" title="Annot.set_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_oc()</span></code></a>。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>与 OCG 类似，OCMD 具有 ON 或 OFF 的可见性状态，并可与 OCG 相同方式使用。但 OCMD 通过 <strong>布尔表达式</strong> 计算一个或多个 OCG 的状态，以决定自身的可见性。如果表达式计算结果为 true，则 OCMD 处于 ON 状态；若为 false，则处于 OFF 状态。</p>
<p>OCMD 可通过以下两种方式设定可见性：</p>
<ol class="arabic simple">
<li><p>使用 <em>ocgs</em> 和 <em>policy</em> 组合：</p></li>
</ol>
<blockquote>
<div><p><em>policy</em> 的值含义如下：</p>
<ul class="simple">
<li><p><strong>AnyOn</strong> ——（默认）至少有一个 OCG 处于 ON 状态，则 OCMD 也为 ON。</p></li>
<li><p><strong>AnyOff</strong> —— 只要有一个 OCG 处于 OFF 状态，则 OCMD 为 ON。</p></li>
<li><p><strong>AllOn</strong> —— 仅当所有 OCG 均为 ON 时，OCMD 才为 ON。</p></li>
<li><p><strong>AllOff</strong> —— 仅当所有 OCG 均为 OFF 时，OCMD 才为 ON。</p></li>
</ul>
<p>假设希望两个 PDF 对象交替显示（一个 ON，另一个必须 OFF）：</p>
<p>解决方案：对象 1 使用 <strong>OCG</strong>，对象 2 使用 <strong>OCMD</strong>。通过 <code class="xref any docutils literal notranslate"><span class="pre">set_ocmd(ocgs=[xref],</span> <span class="pre">policy=&quot;AllOff&quot;)</span></code> 创建 OCMD，其中 <em>xref</em> 为 OCG 的交叉引用号。</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>使用 <strong>可见性表达式</strong> <em>ve</em>：</p></li>
</ol>
<blockquote>
<div><p>该参数是一个至少包含两个元素的列表，<strong>第一个元素</strong> 必须是逻辑关键字之一：”and”、”or” 或 “not”。<strong>第二个及后续元素</strong> 必须是整数或嵌套列表：</p>
<ul class="simple">
<li><p>每个列表必须以逻辑关键字开头。</p></li>
<li><p>若关键字为 <strong>“not”</strong>，列表必须包含恰好两个元素。</p></li>
<li><p>若关键字为 <strong>“and”</strong> 或 <strong>“or”</strong>，则后续可以有任意数量的元素。</p></li>
<li><p>逻辑关键字后面的元素可以是整数（OCG 的 xref 号）或嵌套列表（必须符合上述规则）。</p></li>
</ul>
<p><strong>示例：</strong></p>
<ul class="simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">set_ocmd(ve=[&quot;or&quot;,</span> <span class="pre">4,</span> <span class="pre">[&quot;not&quot;,</span> <span class="pre">5],</span> <span class="pre">[&quot;and&quot;,</span> <span class="pre">6,</span> <span class="pre">7]])</span></code>
逻辑含义：<strong>“4 为 ON，或 5 为 OFF，或 6 和 7 均为 ON”</strong>。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">set_ocmd(ve=[&quot;not&quot;,</span> <span class="pre">xref])</span></code>
其效果与示例 1 中的 OCMD 相同。</p></li>
</ul>
<p>更多详细信息和示例可参考 <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a> 第 224 页，以及 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/optional-content">此处</a> 的示例脚本。</p>
<p>可见性表达式 (<code class="xref any docutils literal notranslate"><span class="pre">/VE</span></code>) 属于 PDF 规范 1.6 版的一部分，因此并非所有 PDF 查看器都支持此功能。对于不支持的查看器，将采用某种标准处理方式。</p>
</div></blockquote>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_ocmd">
<span class="sig-name descname"><span class="pre">get_ocmd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_ocmd" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.4</p></li>
</ul>
<p>获取 <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a> 的定义。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – OCMD 的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>包含以下键的字典：<em>xref</em>、<em>ocgs</em>、<em>policy</em> 和 <em>ve</em>。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_layer">
<span class="sig-name descname"><span class="pre">get_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_layer" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.3</p></li>
</ul>
<p>按状态列出指定配置中的可选内容组。返回包含 OCG 交叉引用号列表的字典，这些 OCG 出现在 <code class="xref any docutils literal notranslate"><span class="pre">/ON</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">/OFF</span></code> 或单选按钮组 (<code class="xref any docutils literal notranslate"><span class="pre">/RBGroups</span></code>) 数组中。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>int</em>) – 配置层编号（默认值为标准配置层）。</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">get_layer</span><span class="p">())</span>
<span class="go">{&#39;off&#39;: [8, 9, 10], &#39;on&#39;: [5, 6, 7], &#39;rbgroups&#39;: [[7, 10]]}</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_layer">
<span class="sig-name descname"><span class="pre">set_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">off</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basestate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rbgroups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locked</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_layer" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.3</p></li>
<li><p>v1.22.5 变更：支持 <em>locked</em> OCGs 列表。</p></li>
</ul>
<p>批量更改可选内容组（OCG）的状态。此方法 <strong>永久</strong> 设置 OCG 的状态。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>int</em>) – 目标配置层，选择 -1 代表默认配置层。</p></li>
<li><p><strong>on</strong> (<em>list</em>) – 需要设置为 ON 的 OCG 的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 号列表。会替换先前的值。空列表表示不再将任何 OCG 设为 ON。若使用 <code class="xref any docutils literal notranslate"><span class="pre">basestate=&quot;ON&quot;</span></code>，则应指定此参数。</p></li>
<li><p><strong>off</strong> (<em>list</em>) – 需要设置为 OFF 的 OCG 的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 号列表。会替换先前的值。空列表表示不再将任何 OCG 设为 OFF。若使用 <code class="xref any docutils literal notranslate"><span class="pre">basestate=&quot;OFF&quot;</span></code>，则应指定此参数。</p></li>
<li><p><strong>basestate</strong> (<em>str</em>) – 未在 <em>on</em> 或 <em>off</em> 中提及的 OCG 的状态。可能的取值为 “ON”、”OFF” 或 “Unchanged”（不变）。大小写均可。</p></li>
<li><p><strong>rbgroups</strong> (<em>list</em>) – 一个列表，包含多个子列表。会替换先前的值。每个子列表包含两个或多个 OCG 的 xref 号。处于同一子列表中的 OCG 会像单选按钮一样处理：设定其中一个为 ON，会自动将同组中的其他 OCG 设为 OFF。</p></li>
<li><p><strong>locked</strong> (<em>list</em>) – OCG xref 号列表，其中的 OCG 不能通过用户界面更改状态。</p></li>
</ul>
</dd>
</dl>
<p>若参数值为 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>，则不会更改对应的 PDF 数组。</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">set_layer</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">basestate</span><span class="o">=</span><span class="s2">&quot;OFF&quot;</span><span class="p">)</span>  <span class="c1"># 仅更改基础状态</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">get_layer</span><span class="p">())</span>
<span class="go">{&#39;basestate&#39;: &#39;OFF&#39;, &#39;off&#39;: [8, 9, 10], &#39;on&#39;: [5, 6, 7], &#39;rbgroups&#39;: [[7, 10]]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_ocgs">
<span class="sig-name descname"><span class="pre">get_ocgs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_ocgs" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.3</p></li>
</ul>
<p>获取所有可选内容组 (OCG) 的详细信息。返回一个字典，其中键为 OCG 的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 号，值为 OCG 的属性字典：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">get_ocgs</span><span class="p">())</span>
<span class="go">{13: {&#39;on&#39;: True,</span>
<span class="go">      &#39;intent&#39;: [&#39;View&#39;, &#39;Design&#39;],</span>
<span class="go">      &#39;name&#39;: &#39;Circle&#39;,</span>
<span class="go">      &#39;usage&#39;: &#39;Artwork&#39;},</span>
<span class="go">14: {&#39;on&#39;: True,</span>
<span class="go">      &#39;intent&#39;: [&#39;View&#39;, &#39;Design&#39;],</span>
<span class="go">      &#39;name&#39;: &#39;Square&#39;,</span>
<span class="go">      &#39;usage&#39;: &#39;Artwork&#39;},</span>
<span class="go">15: {&#39;on&#39;: False, &#39;intent&#39;: [&#39;View&#39;], &#39;name&#39;: &#39;Square&#39;, &#39;usage&#39;: &#39;Artwork&#39;}}</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.layer_ui_configs">
<span class="sig-name descname"><span class="pre">layer_ui_configs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.layer_ui_configs" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.3</p></li>
</ul>
<p>显示支持 PDF 查看器的用户界面可修改的可选内容可见性状态。</p>
<blockquote>
<div><ul class="simple">
<li><p>仅报告当前所选层配置中包含的项目。</p></li>
<li><p>字典键的含义如下：</p>
<ul>
<li><p><em>depth:</em> 项目在 <code class="xref any docutils literal notranslate"><span class="pre">/Order</span></code> 数组中的嵌套级别</p></li>
<li><p><em>locked:</em> 若为 true，则无法通过用户界面更改</p></li>
<li><p><em>number:</em> 运行序列号</p></li>
<li><p><em>on:</em> 项目状态</p></li>
<li><p><em>text:</em> 该 OCG 的文本字符串或名称字段</p></li>
<li><p><em>type:</em> 可能的值包括 “label”（由文本字符串设定）、”checkbox”（由单个 OCG 设定）或 “radiobox”（由一组相关 OCG 设定）</p></li>
</ul>
</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_layer_ui_config">
<span class="sig-name descname"><span class="pre">set_layer_ui_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_layer_ui_config" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.3</p></li>
</ul>
<p>修改内容组的可见性状态。其作用类似于支持 PDF 查看器提供的用户界面功能。</p>
<blockquote>
<div><p>请注意，可见性 <strong>不是</strong> OCG 本身存储的属性，甚至不一定包含在 PDF 文档中。当前可见性是通过支持的 PDF 软件用户界面 <strong>临时</strong> 设定的。本方法提供了相同类型的功能。</p>
<p>若需 <strong>永久</strong> 更改可见性，请使用 <a class="reference internal" href="#Document.set_layer" title="Document.set_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_layer()</span></code></a>。</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>number</strong> (<em>int</em><em>,</em><em>str</em>) – 可选项的序列号（在 <code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layer_configs()</span></code> 列表中的索引）或该项的 <em>text</em> 字段值。</p></li>
<li><p><strong>action</strong> (<em>int</em>) – <ul>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">PDF_OC_ON</span></code> = 设为 ON（默认值）</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">PDF_OC_TOGGLE</span></code> = 切换 ON/OFF</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">PDF_OC_OFF</span></code> = 设为 OFF</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.authenticate">
<span class="sig-name descname"><span class="pre">authenticate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">password</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.authenticate" title="永久链接至目标">#</a></dt>
<dd><p>使用字符串 <em>password</em> 解密文档。若解密成功，即可访问文档数据。对于 PDF 文档，“所有者”与“用户”具有不同的权限，因此可能存在不同的密码。该方法会根据提供的密码自动建立适当的访问权限（所有者或用户）。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>password</strong> (<em>str</em>) – 所有者或用户密码。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>若成功，则返回正值；若失败（密码不匹配），则返回 0。若返回正值，则 <a class="reference internal" href="#Document.is_encrypted" title="Document.is_encrypted"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_encrypted</span></code></a> 设为 <em>False</em>。 <strong>正值</strong> 的含义如下：</p>
<ul class="simple">
<li><p>1 =&gt; 认证成功，但 PDF 既无所有者密码，也无用户密码。</p></li>
<li><p>2 =&gt; 认证成功，使用的是 <strong>用户</strong> 密码。</p></li>
<li><p>4 =&gt; 认证成功，使用的是 <strong>所有者</strong> 密码。</p></li>
<li><p>6 =&gt; 认证成功，且所有者密码与用户密码相同（可能较为罕见）。</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>文档可能受所有者密码保护，但 <strong>未</strong> 受用户密码保护。可通过 <code class="xref any docutils literal notranslate"><span class="pre">doc.authenticate(&quot;&quot;)</span> <span class="pre">==</span> <span class="pre">2</span></code> 进行检测。这种情况下，文档可在 <strong>无需认证</strong> 的情况下打开和阅读，但具体操作可能受 <a class="reference internal" href="#Document.permissions" title="Document.permissions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.permissions</span></code></a> 限制。然而，PyMuPDF（与 MuPDF 一样） <strong>忽略</strong> 这些限制。因此，与普通 PDF 查看器不同，即使 <code class="xref any docutils literal notranslate"><span class="pre">PDF_PERM_COPY</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">PDF_PERM_MODIFY</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">PDF_PERM_ANNOTATE</span></code> 等权限被禁用，仍可提取文本、添加或修改内容。请确保您的应用符合相关法律要求。</p>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_page_numbers">
<span class="sig-name descname"><span class="pre">get_page_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_one</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_numbers" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.6</p></li>
</ul>
<p>仅适用于 PDF：返回具有指定标签的页面编号列表——请注意，在 PDF 中，页面标签可能并不唯一。因此，该方法会 <strong>顺序搜索所有页面</strong>，以比较其标签。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>实现细节 —— 该方法 <strong>不会加载页面</strong> 进行搜索。</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – 要查找的标签，例如 “vii”（罗马数字 7）。</p></li>
<li><p><strong>only_one</strong> (<em>bool</em>) – 若为 True，则在找到第一个匹配项后停止。适用于已知标签唯一或文档页面较多的情况。默认行为是检查所有页面。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>包含所有匹配页面编号的列表。若未找到匹配项，或文档未定义页面标签，则返回空列表。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_page_labels">
<span class="sig-name descname"><span class="pre">get_page_labels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_labels" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.7</p></li>
</ul>
<p>仅适用于 PDF：提取页面标签定义列表。通常用于修改后传递给 <a class="reference internal" href="#Document.set_page_labels" title="Document.set_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_page_labels()</span></code></a> 进行更新。</p>
<dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>以字典形式表示的页面标签定义列表，格式与 <a class="reference internal" href="#Document.set_page_labels" title="Document.set_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_page_labels()</span></code></a> 相同。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_page_labels">
<span class="sig-name descname"><span class="pre">set_page_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_page_labels" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.6</p></li>
</ul>
<p>仅适用于 PDF：新增或更新 PDF 的页面标签定义。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>labels</strong> (<em>list</em>) – <p>由字典组成的列表，每个字典定义一个标签规则，并指定起始页面编号（从 0 开始）。每个字典最多包含 4 个键，格式如下：</p>
<p><code class="xref any docutils literal notranslate"><span class="pre">{'startpage':</span> <span class="pre">int,</span> <span class="pre">'prefix':</span> <span class="pre">str,</span> <span class="pre">'style':</span> <span class="pre">str,</span> <span class="pre">'firstpagenum':</span> <span class="pre">int}</span></code>，其中：</p>
<ul class="simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">startpage</span></code>: (int) 规则适用的第一个页面（从 0 开始）。<strong>必须提供</strong>。该规则适用于所有后续页面，直到文档结束，或被下一个规则覆盖。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">prefix</span></code>: (str) 标签前缀，例如 “A-”。默认为 “”。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">style</span></code>: (str) 编号样式，可选值:</p>
<ul>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">&quot;D&quot;</span></code>：十进制数字</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">&quot;r&quot;/&quot;R&quot;</span></code>：罗马数字（小写 / 大写）</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">&quot;a&quot;/&quot;A&quot;</span></code>：字母编号（小写 / 大写）。示例：”a” 至 “z”，然后 “aa” 至 “zz”，以此类推。</p></li>
<li><p>默认为 “”，即无编号，仅使用 <code class="xref any docutils literal notranslate"><span class="pre">prefix</span></code> 作为标签。若 <code class="xref any docutils literal notranslate"><span class="pre">prefix</span></code> 也为空，则该范围内的页面标签将为空字符串 “”。</p></li>
</ul>
</li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">firstpagenum</span></code>: (int) 编号的起始值。默认为 1，若小于 1，则忽略。</p></li>
</ul>
</p>
</dd>
</dl>
<p>例如:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="s1">&#39;startpage&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;A-&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;firstpagenum&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
<span class="p">{</span><span class="s1">&#39;startpage&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;prefix&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;firstpagenum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}]</span>
</pre></div>
</div>
<p>以上规则会生成如下页面标签：”A-10”, “A-11”, “A-12”, “A-13”, “1”, “2”, “3”, … 对应的页面为 6, 7, 8, 9, 10, 11, 12，直到文档结束。页面 0 至 5 的标签为空字符串 “”。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.make_bookmark">
<span class="sig-name descname"><span class="pre">make_bookmark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.make_bookmark" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.17.3</p></li>
</ul>
<p>在可重排（reflowable）文档中返回一个页面指针。重新布局文档后，可以使用该方法的返回值来查找该页面的新位置。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>不要与目录 (TOC) 条目混淆</strong>。</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>loc</strong> (<em>list</em><em>,</em><em>tuple</em>) – 页面位置。必须是有效的 <em>(chapter, pno)</em>。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>pointer</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>一个长整数，表示指针格式。可用于在文档重新布局后查找新位置。请勿修改或重新分配此值。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.find_bookmark">
<span class="sig-name descname"><span class="pre">find_bookmark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bookmark</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.find_bookmark" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.17.3</p></li>
</ul>
<p>重新布局文档后，返回书签对应的新页面位置。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bookmark</strong> (<em>pointer</em>) – 由 <a class="reference internal" href="#Document.make_bookmark" title="Document.make_bookmark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.make_bookmark()</span></code></a> 创建的书签。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>该页面的新位置 <em>(chapter, pno)</em>。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.chapter_page_count">
<span class="sig-name descname"><span class="pre">chapter_page_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chapter</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.chapter_page_count" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.17.0</p></li>
</ul>
<p>返回指定章节的页面数量。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>chapter</strong> (<em>int</em>) – 以 0 为基准的章节编号。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>该章节的页面数。仅适用于支持章节结构的文档类型（目前适用于 EPUB）。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.next_location">
<span class="sig-name descname"><span class="pre">next_location</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">page_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.next_location" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.17.0</p></li>
</ul>
<p>返回下一页的位置。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>page_id</strong> (<em>tuple</em>) – 当前页面的标识，必须是 <em>(chapter, pno)</em> 形式的元组，指向现有页面。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>下一页的位置，即 <em>(chapter, pno + 1)</em> 或 <em>(chapter + 1, 0)</em>， <strong>如果当前页面为最后一页，则返回空元组 ()</strong> 。仅适用于支持章节结构的文档类型（目前适用于 EPUB）。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.prev_location">
<span class="sig-name descname"><span class="pre">prev_location</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">page_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.prev_location" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.17.0</p></li>
</ul>
<p>返回前一页的位置。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>page_id</strong> (<em>tuple</em>) – 当前页面的标识，必须是 <em>(chapter, pno)</em> 形式的元组，指向现有页面。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>前一页的位置，即 <em>(chapter, pno - 1)</em> 或前一章节的最后一页， <strong>如果当前页面为第一页，则返回空元组 ()</strong>。仅适用于支持章节结构的文档类型（目前适用于 EPUB）。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.load_page">
<span class="sig-name descname"><span class="pre">load_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">page_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.load_page" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>变更于 v1.17.0: 对于支持“章节结构”的文档类型（如 EPUB），页面现在也可以通过章节号和相对页码来加载，而不仅仅是绝对页码。这在处理大型文档时 <strong>显著提高了访问速度</strong>。</p></li>
</ul>
<p>创建一个 <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> 对象，以便进行后续处理（如渲染、文本搜索等）。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>page_id</strong> (<em>int</em><em>,</em><em>tuple</em>) – <p><em>(变更于 v1.17.0)</em></p>
<p>可以是 0 基准的页面编号，也可以是 <em>(chapter, pno)</em> 形式的元组。</p>
<ul class="simple">
<li><p><strong>整数类型</strong>: 允许 <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">page_id</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>。如果 <code class="xref any docutils literal notranslate"><span class="pre">page_id</span></code> 为负数，则会自动加上 <a class="reference internal" href="#Document.page_count" title="Document.page_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">page_count</span></code></a>。例如，要加载最后一页，可以使用 <em>doc.load_page(-1)</em>，此时 <code class="xref any docutils literal notranslate"><span class="pre">page.number</span> <span class="pre">=</span> <span class="pre">doc.page_count</span> <span class="pre">-</span> <span class="pre">1</span></code>。</p></li>
<li><p><strong>元组类型</strong>: <code class="xref any docutils literal notranslate"><span class="pre">chapter</span></code> 必须在 <a class="reference internal" href="#Document.chapter_count" title="Document.chapter_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.chapter_count</span></code></a> 范围内，<code class="xref any docutils literal notranslate"><span class="pre">pno</span></code> 必须在该章节的 <a class="reference internal" href="#Document.chapter_page_count" title="Document.chapter_page_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.chapter_page_count()</span></code></a> 范围内。两者均从 0 开始计数。使用此格式时，<a class="reference internal" href="page.html#Page.number" title="Page.number"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.number</span></code></a> 将等于提供的元组值。</p></li>
</ul>
</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a></p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">备注</p>
<p>文档也遵循 Python 序列协议，页面编号作为索引：<em>doc.load_page(n) == doc[n]</em>。</p>
<p>仅对 <strong>绝对页面编号</strong>，像 <em>“for page in doc: …”</em> 和 <em>“for page in reversed(doc): …”</em> 这样的表达式将依次返回文档的页面。参见 <a class="reference internal" href="#Document.pages" title="Document.pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pages()</span></code></a>，它允许像切片一样处理页面。</p>
<p>你也可以使用基于章节的页面标识符的索引表示法：使用 <em>page = doc[(5, 2)]</em> 加载第六章的第三页。</p>
<p>为了保持一致的 API，对于不支持章节结构的文档类型（如 PDF），<a class="reference internal" href="#Document.chapter_count" title="Document.chapter_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.chapter_count</span></code></a> 为 1，页面也可以通过元组 <em>(0, pno)</em> 来加载。请参阅此 <a class="footnote-reference brackets" href="#f10" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a> 脚注，了解性能改进的说明。</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="Document.reload_page">
<span class="sig-name descname"><span class="pre">reload_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">page</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.reload_page" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>在 v1.16.10 中新增</p></li>
</ul>
<p>仅适用于 PDF：在完成并更新所有待处理更改后，提供页面的新副本。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>page</strong> (<a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a>) – 页面对象。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>同一页面的新副本。所有待处理更新（例如注释或小部件）将被最终确定，并将加载页面的新副本。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>在典型的使用情况下，应该在添加或更改注释/小部件后获取页面 <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a>。为了强制所有更改反映在页面结构中，此方法重新加载一个新副本，同时保持对象层次结构“文档 -&gt; 页面 -&gt; 注释/小部件”不变。</p>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.resolve_names">
<span class="sig-name descname"><span class="pre">resolve_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.resolve_names" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：将目标名称转换为 Python 字典。</p>
<dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>一个字典，包含以下布局：</p>
<ul class="simple">
<li><p><em>key</em>: (str) 名称。</p></li>
<li><dl class="simple">
<dt><em>value</em>: (dict)，具有以下布局：</dt><dd><ul>
<li><p>”page”: 目标页面编号（从 0 开始）。如果未找到页面编号，则为 -1。</p></li>
<li><p>”to”: (x, y) 页面上的目标点。当前为 PDF 坐标，
即点 (0,0) 是页面的左下角。</p></li>
<li><p>”zoom”: (float) 缩放因子。</p></li>
<li><p>”dest”: (str) 仅在目标位置未提供为 “/XYZ” 或未找到页面编号时出现。</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>示例:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;__bookmark_1&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;page&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">541.0</span><span class="p">),</span> <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span>
    <span class="s1">&#39;__bookmark_2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;page&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;to&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">481.45</span><span class="p">),</span> <span class="s1">&#39;zoom&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>或:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;21154a7c20684ceb91f9c9adc3b677c40&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;page&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dest&#39;</span><span class="p">:</span> <span class="s1">&#39;/XYZ 15.75 1486 0&#39;</span><span class="p">},</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</dd>
</dl>
<p>所有在目录中通过键 “/Dests” 和 “/Names/Dests” 找到的名称都会被包括。</p>
<ul class="simple">
<li><p>在 v1.23.6 中新增</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.page_cropbox">
<span class="sig-name descname"><span class="pre">page_cropbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.page_cropbox" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>在 v1.17.7 中新增</p></li>
</ul>
<p>仅适用于 PDF：返回未旋转的页面矩形—— <strong>无需加载页面</strong> （通过 <a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a>）。此方法用于需要最佳性能的内部用途。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – 从 0 开始的页面编号。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> 页面，如 <a class="reference internal" href="page.html#Page.rect" title="Page.rect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.rect()</span></code></a>，但忽略任何旋转。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.page_xref">
<span class="sig-name descname"><span class="pre">page_xref</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.page_xref" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>在 v1.17.7 中新增</p></li>
</ul>
<p>仅适用于 PDF：返回页面的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> —— <strong>无需加载页面</strong> （通过 <a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a>）。此方法用于需要最佳性能的内部用途。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – 从 0 开始的页面编号。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>页面 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>，如 <a class="reference internal" href="page.html#Page.xref" title="Page.xref"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.xref</span></code></a>。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.pages">
<span class="sig-name descname"><span class="pre">pages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start=None</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">stop=None</span></span></em><span class="optional">[</span>, <em class="sig-param"><span class="n"><span class="pre">step=None</span></span></em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.pages" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>在 v1.16.4 中新增</p></li>
</ul>
<p>一个用于页面范围的生成器。参数的含义与内置函数 <em>range()</em> 相同。用于类似 <em>“for page in doc.pages(start, stop, step): …”</em> 的表达式。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>int</em>) – 从此页面编号开始迭代。默认值为零，允许的值为 <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">start</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>。当为负数时，<a class="reference internal" href="#Document.page_count" title="Document.page_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">page_count</span></code></a> 会 <strong>在</strong> 开始迭代之前加上。</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – 在此页面编号停止迭代。默认值为 <a class="reference internal" href="#Document.page_count" title="Document.page_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">page_count</span></code></a>，允许的值为 <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">stop</span> <span class="pre">&lt;=</span> <span class="pre">page_count</span></code>。较大的值会 <strong>默默地替换</strong> 为默认值。负值会循环按相反顺序返回页面。与内置的 <em>range()</em> 一样，这是 <strong>不</strong> 返回的第一个页面。</p></li>
<li><p><strong>step</strong> (<em>int</em>) – 步进值。如果 start &lt; stop，则默认为 1；如果 start &gt; stop，则默认为 -1。不允许为零。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><p>文档页面的生成器迭代器。以下是一些示例：</p>
<ul class="simple">
<li><p>”doc.pages()” 返回所有页面。</p></li>
<li><p>”doc.pages(4, 9, 2)” 返回页面 4、6、8。</p></li>
<li><p>”doc.pages(0, None, 2)” 返回所有偶数页。</p></li>
<li><p>”doc.pages(-2)” 返回最后两页。</p></li>
<li><p>”doc.pages(-1, -1)” 返回所有页面，按相反顺序。</p></li>
<li><p>”doc.pages(-1, -10)” 总是以相反顺序返回 10 页，从最后一页开始——如果文档少于 10 页，则 <strong>重复</strong> 返回。例如，对于一个 4 页的文档，返回的页面编号依次为：3, 2, 1, 0, 3, 2, 1, 0, 3, 2, 1, 0, 3。</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="index-1"></span><dl class="py method">
<dt class="sig sig-object py" id="Document.convert_to_pdf">
<span class="sig-name descname"><span class="pre">convert_to_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.convert_to_pdf" title="永久链接至目标">#</a></dt>
<dd><p>创建当前文档的 PDF 版本并将其写入内存。 <strong>所有文档类型</strong> 都受支持。参数与 <a class="reference internal" href="#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_pdf()</span></code></a> 中的含义相同。实际上，您可以限制转换为页面子集、指定页面旋转角度，并逆转页面顺序。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_page</strong> (<em>int</em>) – 要复制的第一页（从 0 开始）。默认是第一页。</p></li>
<li><p><strong>to_page</strong> (<em>int</em>) – 要复制的最后一页（从 0 开始）。默认是最后一页。</p></li>
<li><p><strong>rotate</strong> (<em>int</em>) – 旋转角度。默认是 0（不旋转）。应为 <em>n * 90</em>，其中 n 是整数（未检查）。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>bytes</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>一个包含 PDF 文件图像的 Python <em>bytes</em> 对象。它是通过内部使用 <code class="xref any docutils literal notranslate"><span class="pre">tobytes(garbage=4,</span> <span class="pre">deflate=True)</span></code> 创建的。参见 <a class="reference internal" href="#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tobytes()</span></code></a>。您可以直接将其输出到磁盘或将其作为 PDF 打开。以下是一些示例:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 将 XPS 文件转换为 PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xps</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;some.xps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdfbytes</span> <span class="o">=</span> <span class="n">xps</span><span class="o">.</span><span class="n">convert_to_pdf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 任选其一 --&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="n">pdfbytes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;some.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 或者这样 --&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdfout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;some.pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdfout</span><span class="o">.</span><span class="n">tobytes</span><span class="p">(</span><span class="n">pdfbytes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdfout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 将图像文件复制到 PDF 页面</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 每个页面将具有图像尺寸</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>                     <span class="c1"># 新建 PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imglist</span> <span class="o">=</span> <span class="p">[</span> <span class="o">...</span> <span class="n">图像文件名</span> <span class="o">...</span><span class="p">]</span> <span class="c1"># 例如一个目录列表</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">imglist</span><span class="p">:</span>
<span class="go">        imgdoc=pymupdf.open(img)           # 打开图像作为文档</span>
<span class="go">        pdfbytes=imgdoc.convert_to_pdf()  # 创建一个 1 页的 PDF</span>
<span class="go">        imgpdf=pymupdf.open(&quot;pdf&quot;, pdfbytes)</span>
<span class="go">        doc.insert_pdf(imgpdf)             # 插入图像 PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;allmyimages.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>该方法使用与 <em>mutool convert</em> CLI 相同的逻辑。在大多数情况下，这非常有效——但是，需要注意以下限制。</p>
<ul class="simple">
<li><p>图像文件：完美，无检测到问题。然而，图像透明度会被忽略。如果您需要透明度（如水印），请使用 <a class="reference internal" href="page.html#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a>。否则，推荐使用此方法，因为它性能更好。</p></li>
<li><p>XPS：外观非常好。链接正常，书签（大纲）丢失，但可以轻松恢复 <a class="footnote-reference brackets" href="#f9" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a>。</p></li>
<li><p>EPUB, CBZ, FB2：与 XPS 相似。</p></li>
<li><p>SVG：中等。大致可与 <a class="reference external" href="https://github.com/deeplook/svglib">svglib</a> 相比。</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_toc">
<span class="sig-name descname"><span class="pre">get_toc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_toc" title="永久链接至目标">#</a></dt>
<dd><p>从文档的目录链创建目录（TOC）。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simple</strong> (<em>bool</em>) – 指示是否需要简单或详细的目录。如果 <em>False</em>，列表中的每个条目还将包含一个字典，包含每个大纲条目的 <a class="reference internal" href="linkdest.html#linkdest"><span class="std std-ref">linkDest</span></a> 详细信息。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>一个列表的列表。每个条目的形式为 <em>[lvl, title, page, dest]</em>。其条目有以下含义：</p>
<ul class="simple">
<li><p><em>lvl</em> – 层级（正整数）。第一个条目总是 1。行中的条目要么 <strong>相等</strong> ，要么 <strong>增加</strong> 1，或者 <strong>减少</strong> 任意数目。</p></li>
<li><p><em>title</em> – 标题（字符串）。</p></li>
<li><p><em>page</em> – 基于 1 的源页面编号（整数）。如果没有目标或在文档之外，则为 <code class="xref any docutils literal notranslate"><span class="pre">-1</span></code>。</p></li>
<li><p><em>dest</em> – （字典）仅在 <em>simple=False</em> 时包含。包含以下 TOC 项目的详细信息：</p>
<ul>
<li><p>kind: 目标类型，见 <a class="reference internal" href="vars.html#linkdest-kinds"><span class="std std-ref">链接目标类型</span></a>。</p></li>
<li><p>file: 如果类型为 <a class="reference internal" href="vars.html#LINK_GOTOR" title="LINK_GOTOR"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_GOTOR</span></code></a> 或 <a class="reference internal" href="vars.html#LINK_LAUNCH" title="LINK_LAUNCH"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_LAUNCH</span></code></a>，则为文件名。</p></li>
<li><p>page: 目标页面，基于 0，只有 <a class="reference internal" href="vars.html#LINK_GOTOR" title="LINK_GOTOR"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_GOTOR</span></code></a> 或 <a class="reference internal" href="vars.html#LINK_GOTO" title="LINK_GOTO"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_GOTO</span></code></a>。</p></li>
<li><p>to: 目标页面上的位置（<a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a>）。</p></li>
<li><p>zoom: 目标页面的缩放因子（浮动）。</p></li>
<li><p>xref: 项目的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> （如果没有 PDF，则为 0）。</p></li>
<li><p>color: 项目在 PDF 中的 RGB 颜色格式 <code class="xref any docutils literal notranslate"><span class="pre">(红色，绿色，蓝色)</span></code>，或者省略（如果没有 PDF，则始终省略）。</p></li>
<li><p>bold: 如果项目文本是粗体，则为 true，或者省略。仅限 PDF。</p></li>
<li><p>italic: 如果项目文本是斜体，则为 true，或者省略。仅限 PDF。</p></li>
<li><p>collapse: 如果子项被折叠，则为 true，或者省略。仅限 PDF。</p></li>
<li><p>nameddest: 如果 kind=4，目标名称。仅限 PDF。（在 1.23.7 中新增）</p></li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_get_keys">
<span class="sig-name descname"><span class="pre">xref_get_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_get_keys" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>在 v1.18.7 中新增</p></li>
</ul>
<p>仅限 PDF：返回由其 xref 编号提供的 PDF 字典对象的字典键。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – 该 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。 <em>(在 v1.18.10 中更改)</em> 使用 <code class="xref any docutils literal notranslate"><span class="pre">-1</span></code> 来访问特殊字典“PDF trailer”。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><p>一个包含对象 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 中字典键的元组。示例：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">=</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pymupdf.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xref</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">page_xref</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># 页面 0 的 xref</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">xref_get_keys</span><span class="p">(</span><span class="n">xref</span><span class="p">))</span>  <span class="c1"># 页面主键</span>
<span class="go">(&#39;Type&#39;, &#39;Contents&#39;, &#39;Resources&#39;, &#39;MediaBox&#39;, &#39;Parent&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">xref_get_keys</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># trailer 的主键</span>
<span class="go">(&#39;Type&#39;, &#39;Index&#39;, &#39;Size&#39;, &#39;W&#39;, &#39;Root&#39;, &#39;Info&#39;, &#39;ID&#39;, &#39;Length&#39;, &#39;Filter&#39;)</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_get_key">
<span class="sig-name descname"><span class="pre">xref_get_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_get_key" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>在 v1.18.7 中新增</p></li>
</ul>
<p>仅限 PDF：返回给定 xref 的 PDF 字典键的类型和值。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – 该 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。<em>在 v1.18.10 中更改:</em> 使用 <code class="xref any docutils literal notranslate"><span class="pre">-1</span></code> 来访问特殊字典“PDF trailer”。</p></li>
<li><p><strong>key</strong> (<em>str</em>) – 所需的 PDF 键。必须 <strong>完全</strong> 匹配（区分大小写） <a class="reference internal" href="#Document.xref_get_keys" title="Document.xref_get_keys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_keys()</span></code></a> 中包含的键。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>一个元组 (type, value) 的字符串，其中 type 是以下之一：“xref”，“array”，“dict”，“int”，“float”，“null”，“bool”，“name”，“string” 或 “unknown”（应避免发生）。独立于 “type” ，键的值 <strong>始终</strong> 格式化为字符串——见下例——并且（几乎总是）忠实地反映 PDF 中存储的内容。在大多数情况下，值字符串的格式还可以提供有关键类型的线索：</p>
</dd>
</dl>
<ul>
<li><p>“name” 总是以 “/” 斜杠开头。</p></li>
<li><p>“xref” 总是以 “ 0 R” 结尾。</p></li>
<li><p>“array” 总是用 “[…]” 括起来。</p></li>
<li><p>“dict” 总是用 “&lt;&lt;…&gt;&gt;” 括起来。</p></li>
<li><p>“bool” 或 “null” 总是等于 “true”、”false” 或 “null”。</p></li>
<li><p>“float” 和 “int” 以其字符串格式表示——因此不能总是区分。</p></li>
<li><p>“string” 被转换为 UTF-8，因此可能与 PDF 中存储的内容有所不同。例如，PDF 键 “Author” 在文件中的值可能是 “&lt;FEFF004A006F0072006A00200058002E0020004D0063004B00690065&gt;”，但该方法将返回 <code class="xref any docutils literal notranslate"><span class="pre">('string',</span> <span class="pre">'Jorj</span> <span class="pre">X.</span> <span class="pre">McKie')</span></code>。</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_get_keys</span><span class="p">(</span><span class="n">xref</span><span class="p">):</span>
<span class="go">        print(key, &quot;=&quot; , doc.xref_get_key(xref, key))</span>
<span class="go">Type = (&#39;name&#39;, &#39;/Page&#39;)</span>
<span class="go">Contents = (&#39;xref&#39;, &#39;1297 0 R&#39;)</span>
<span class="go">Resources = (&#39;xref&#39;, &#39;1296 0 R&#39;)</span>
<span class="go">MediaBox = (&#39;array&#39;, &#39;[0 0 612 792]&#39;)</span>
<span class="go">Parent = (&#39;xref&#39;, &#39;1301 0 R&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 现在对于 PDF trailer 做同样的事情。</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 它没有 xref，因此必须使用 -1。</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">xref_get_keys</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="go">        print(key, &quot;=&quot;, doc.xref_get_key(-1, key))</span>
<span class="go">Type = (&#39;name&#39;, &#39;/XRef&#39;)</span>
<span class="go">Index = (&#39;array&#39;, &#39;[0 8802]&#39;)</span>
<span class="go">Size = (&#39;int&#39;, &#39;8802&#39;)</span>
<span class="go">W = (&#39;array&#39;, &#39;[1 3 1]&#39;)</span>
<span class="go">Root = (&#39;xref&#39;, &#39;8799 0 R&#39;)</span>
<span class="go">Info = (&#39;xref&#39;, &#39;8800 0 R&#39;)</span>
<span class="go">ID = (&#39;array&#39;, &#39;[&lt;DC9D56A6277EFFD82084E64F9441E18C&gt;&lt;DC9D56A6277EFFD82084E64F9441E18C&gt;]&#39;)</span>
<span class="go">Length = (&#39;int&#39;, &#39;21111&#39;)</span>
<span class="go">Filter = (&#39;name&#39;, &#39;/FlateDecode&#39;)</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_set_key">
<span class="sig-name descname"><span class="pre">xref_set_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_set_key" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>在 v1.18.7 中新增，v1.18.13 中更改</p></li>
<li><p>在 v1.19.4 中更改：如果设置为 “null”，则“物理”地移除一个键。</p></li>
</ul>
<p>仅限 PDF：为通过其 xref 提供的 <code class="xref py py-data docutils literal notranslate"><span class="pre">字典</span></code> 对象设置（添加、更新、删除）PDF 键的值。</p>
<div class="admonition caution">
<p class="admonition-title">小心</p>
<p>这是一个专家功能：如果您不知道自己在做什么，存在将（部分）PDF 渲染为不可用的高风险。请参考 <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a> 中关于对象规范格式（第18页）以及诸如页面对象等特殊字典类型的结构。</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – 该 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。<em>在 v1.18.13 中更改：</em> 若要更新 PDF trailer，需指定 -1。</p></li>
<li><p><strong>key</strong> (<em>str</em>) – 所需的 PDF 键（不带前导的 “/”）。不能为空。任何有效的 PDF 键——无论是已经存在于对象中（将被覆盖）还是新的。可以使用 PDF 路径表示法，如 <code class="xref any docutils literal notranslate"><span class="pre">&quot;Resources/ExtGState&quot;</span></code>——这会将键 <code class="xref any docutils literal notranslate"><span class="pre">&quot;/ExtGState&quot;</span></code> 的值设置为 <code class="xref any docutils literal notranslate"><span class="pre">&quot;/Resources&quot;</span></code> 的子对象。</p></li>
<li><p><strong>value</strong> (<em>str</em>) – 键的值。它必须是一个非空字符串，并且根据所需的 PDF 对象类型，必须遵守以下规则。存在某些语法检查，但 <strong>没有类型检查</strong> ，也没有检查其在 PDF 上是否合理，即 <strong>没有语义检查</strong> 。大小写非常重要！</p></li>
</ul>
</dd>
</dl>
<ul>
<li><p><strong>xref</strong> – 必须作为 <code class="xref any docutils literal notranslate"><span class="pre">&quot;nnn</span> <span class="pre">0</span> <span class="pre">R&quot;</span></code> 提供，其中 nnn 为有效的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 编号。后缀 “<code class="xref any docutils literal notranslate"><span class="pre">0</span> <span class="pre">R</span></code>” 必须存在，以便 PDF 应用程序识别为 xref。</p></li>
<li><p><strong>array</strong> – 类似 <code class="xref any docutils literal notranslate"><span class="pre">&quot;[a</span> <span class="pre">b</span> <span class="pre">c</span> <span class="pre">d</span> <span class="pre">e</span> <span class="pre">f]&quot;</span></code> 的字符串。方括号是必需的。数组项必须至少用一个空格分隔（而不是像 Python 中的逗号）。空数组 <code class="xref any docutils literal notranslate"><span class="pre">&quot;[]&quot;</span></code> 是可能的，并且*等同于*删除该键。数组项可以是任何 PDF 对象，如字典、xref、其他数组等。与 Python 中一样，数组项可以是不同类型的。</p></li>
<li><p><strong>dict</strong> – 类似 <code class="xref any docutils literal notranslate"><span class="pre">&quot;&lt;&lt;</span> <span class="pre">...</span> <span class="pre">&gt;&gt;&quot;</span></code> 的字符串。方括号是必需的，且必须包含有效的 PDF 字典定义。空字典 <code class="xref any docutils literal notranslate"><span class="pre">&quot;&lt;&lt;&gt;&gt;&quot;</span></code> 是可能的，并且*等同于*删除该键。</p></li>
<li><p><strong>int</strong> – 以字符串格式表示的整数。</p></li>
<li><p><strong>float</strong> – 以字符串格式表示的浮点数。PDF 不允许使用科学记数法（带有指数）。</p></li>
<li><p><strong>null</strong> – 字符串 <code class="xref any docutils literal notranslate"><span class="pre">&quot;null&quot;</span></code>。这是 PDF 等效于 Python 的 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>，并导致该键被忽略——但不一定被移除，或者在保存时通过垃圾回收移除。<em>在 v1.19.4 中更改：</em> 如果键不是路径层次（即不包含斜杠 “/”），则将完全移除它。</p></li>
<li><p><strong>bool</strong> – 字符串 <code class="xref any docutils literal notranslate"><span class="pre">&quot;true&quot;</span></code> 或 <code class="xref any docutils literal notranslate"><span class="pre">&quot;false&quot;</span></code>。</p></li>
<li><p><strong>name</strong> – 有效的 PDF 名称，前导斜杠，例如：<code class="xref any docutils literal notranslate"><span class="pre">&quot;/PageLayout&quot;</span></code>。请参见 <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a> 第16页。</p></li>
<li><p><strong>string</strong> – 有效的 PDF 字符串。<strong>所有 PDF 字符串必须被括在括号中</strong>。空字符串表示为 <code class="xref any docutils literal notranslate"><span class="pre">&quot;()&quot;</span></code>。根据内容，可能使用以下括号：</p>
<ul>
<li><p>“(…)” 用于仅包含 ASCII 的文本。保留的 PDF 字符必须使用反斜杠转义，非 ASCII 字符必须使用 3 位的反斜杠转义八进制表示——包括前导零。例如：12 = 0x0C 必须编码为 <code class="xref any docutils literal notranslate"><span class="pre">014</span></code>。</p></li>
<li><p>“&lt;…&gt;” 用于十六进制编码文本。每个字符必须由两个十六进制数字表示（大小写均可）。</p></li>
<li><p>如果不确定， <strong>强烈推荐</strong> 使用 <a class="reference internal" href="functions.html#get_pdf_str" title="get_pdf_str"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_pdf_str()</span></code></a>！此函数会自动生成正确的括号、转义和整体格式。例如：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 由于 € 符号，以下结果为 UTF-16BE BOM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pymupdf</span><span class="o">.</span><span class="n">get_pdf_str</span><span class="p">(</span><span class="s2">&quot;Pay in $ or €.&quot;</span><span class="p">)</span>
<span class="go">&#39;&lt;feff00500061007900200069006e002000240020006f0072002020ac002e&gt;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 对括号和非 ASCII 字符进行转义</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pymupdf</span><span class="o">.</span><span class="n">get_pdf_str</span><span class="p">(</span><span class="s2">&quot;Prices in EUR (USD also accepted). Areas are in m².&quot;</span><span class="p">)</span>
<span class="go">&#39;(Prices in EUR \\(USD also accepted\\). Areas are in m\\262.)&#39;</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_page_pixmap">
<span class="sig-name descname"><span class="pre">get_page_pixmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">matrix_like</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">Identity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorspace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="colorspace.html#Colorspace" title="Colorspace"><span class="pre">Colorspace</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">csRGB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">rect_like</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_pixmap" title="永久链接至目标">#</a></dt>
<dd><p>从页面 <em>pno</em> （基于零）创建一个位图。调用 <a class="reference internal" href="page.html#Page.get_pixmap" title="Page.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_pixmap()</span></code></a>。</p>
<p>所有参数除了 <code class="xref any docutils literal notranslate"><span class="pre">pno</span></code> 都是 <em>仅限关键字</em> 。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – 页面编号，基于零，<code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_page_xobjects">
<span class="sig-name descname"><span class="pre">get_page_xobjects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_xobjects" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>在 v1.16.13 中新增</p></li>
<li><p>在 v1.18.11 中更改</p></li>
</ul>
<p>仅限 PDF：返回页面引用的所有 XObjects 的列表。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – 页面编号，基于零，<code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>一个包含（非图像）XObjects 的列表。这些对象通常表示嵌入的（而非复制的）其他 PDF 页面。例如， <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> 将创建这种类型的对象。该列表中的一项具有以下布局：<code class="xref any docutils literal notranslate"><span class="pre">(xref,</span> <span class="pre">name,</span> <span class="pre">invoker,</span> <span class="pre">bbox)</span></code>，其中：</p>
<ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) 是 XObject 的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。</p></li>
<li><p><strong>name</strong> (<em>str</em>) 是引用 XObject 的符号名称。</p></li>
<li><p><strong>invoker</strong> (<em>int</em>) 是调用 XObject 的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>，如果页面直接调用它，则为零。</p></li>
<li><p><strong>bbox</strong> (<a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a>) 是 XObject 在页面上的边界框位置 <strong>未经过变换的坐标</strong> 。要获取实际的、非旋转的页面坐标，可以与页面的变换矩阵 <a class="reference internal" href="page.html#Page.transformation_matrix" title="Page.transformation_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.transformation_matrix</span></code></a> 相乘。<em>在 v1.18.11 中更改：</em> bbox 现在以 <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> 格式返回。</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_page_images">
<span class="sig-name descname"><span class="pre">get_page_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_images" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：返回页面直接或间接引用的所有图像的列表。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – 页面编号，基于零，<code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>。</p></li>
<li><p><strong>full</strong> (<em>bool</em>) – 是否还包括引用者的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> （如果是页面，则为零）。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>一个包含 <strong>该页面引用的</strong> 图像的列表。每项的格式如下：</p>
<p><code class="xref any docutils literal notranslate"><span class="pre">(xref,</span> <span class="pre">smask,</span> <span class="pre">width,</span> <span class="pre">height,</span> <span class="pre">bpc,</span> <span class="pre">colorspace,</span> <span class="pre">alt_colorspace,</span> <span class="pre">name,</span> <span class="pre">filter,</span> <span class="pre">referencer)</span></code></p>
<p>其中：</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) 是图像对象编号</p></li>
<li><p><strong>smask</strong> (<em>int</em>) 是其软掩码图像的对象编号</p></li>
<li><p><strong>width</strong> (<em>int</em>) 是图像宽度</p></li>
<li><p><strong>height</strong> (<em>int</em>) 是图像高度</p></li>
<li><p><strong>bpc</strong> (<em>int</em>) 表示每个组件的位数（通常为 8）</p></li>
<li><p><strong>colorspace</strong> (<em>str</em>) 是表示颜色空间的字符串（如 <strong>DeviceRGB</strong>）</p></li>
<li><p><strong>alt_colorspace</strong> (<em>str</em>) 是根据 <strong>colorspace</strong> 的值可能的任何替代颜色空间</p></li>
<li><p><strong>name</strong> (<em>str</em>) 是图像的符号名称</p></li>
<li><p><strong>filter</strong> (<em>str</em>) 是图像的解码过滤器（参考 <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a>，第22页）。</p></li>
<li><p><strong>referencer</strong> (<em>int</em>) 是引用者的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。如果由页面直接引用，则为零。只有在 <em>full=True</em> 时才会存在。</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>一般来说，这不是 <strong>实际显示的</strong> 图像列表。此方法仅解析多个 PDF 对象，以收集对嵌入图像的引用。它并不分析页面的 <a class="reference internal" href="glossary.html#contents" title="contents"><code class="xref py py-data docutils literal notranslate"><span class="pre">contents</span></code></a>，其中定义了所有实际的图像显示命令。要获取此信息，请使用 <a class="reference internal" href="page.html#Page.get_image_info" title="Page.get_image_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_info()</span></code></a>。还请参阅 <a class="reference internal" href="textpage.html#textpagedict"><span class="std std-ref">字典输出的结构</span></a> 部分中的讨论。</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_page_fonts">
<span class="sig-name descname"><span class="pre">get_page_fonts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_fonts" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：返回页面直接或间接引用的所有字体的列表。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – 页面编号，基于零，<code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>。</p></li>
<li><p><strong>full</strong> (<em>bool</em>) – 是否还包括引用者的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。如果 <em>True</em>，返回的每个条目将多一个项。使用此选项可以知道页面是否直接引用了该字体。如果是，最后一个条目为 0。如果字体是通过页面的 <code class="xref any docutils literal notranslate"><span class="pre">/XObject</span></code> 引用的，您将在此看到其 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>一个包含页面引用的字体的列表。每个条目格式如下：</p>
</dd>
</dl>
<p><strong>(xref, ext, type, basefont, name, encoding, referencer)</strong>，</p>
<p>其中：</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) 是字体对象编号（如果 PDF 直接使用内置字体，则可能为零）</p></li>
<li><p><strong>ext</strong> (<em>str</em>) 字体文件扩展名（例如 “ttf”，参见 <a class="reference internal" href="vars.html#fontextensions"><span class="std std-ref">字体文件扩展名</span></a>）</p></li>
<li><p><strong>type</strong> (<em>str</em>) 字体类型（如 “Type1” 或 “TrueType” 等）</p></li>
<li><p><strong>basefont</strong> (<em>str</em>) 基本字体名称，</p></li>
<li><p><strong>name</strong> (<em>str</em>) 是引用字体的符号名称</p></li>
<li><p><strong>encoding</strong> (<em>str</em>) 如果字体的字符编码不同于其内置编码，则为字体的字符编码（参考 <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a>，第254页）</p></li>
<li><p><strong>referencer</strong> (<em>int</em> 可选) 引用者的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。如果由页面直接引用，则为零，否则是 XObject 的 xref。仅在 <em>full=True</em> 时存在。</p></li>
</ul>
</div></blockquote>
<p>示例:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">get_page_fonts</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">[(12, &#39;ttf&#39;, &#39;TrueType&#39;, &#39;FNUUTH+Calibri-Bold&#39;, &#39;R8&#39;, &#39;&#39;),</span>
<span class="go">(13, &#39;ttf&#39;, &#39;TrueType&#39;, &#39;DOKBTG+Calibri&#39;, &#39;R10&#39;, &#39;&#39;),</span>
<span class="go">(14, &#39;ttf&#39;, &#39;TrueType&#39;, &#39;NOHSJV+Calibri-Light&#39;, &#39;R12&#39;, &#39;&#39;),</span>
<span class="go">(15, &#39;ttf&#39;, &#39;TrueType&#39;, &#39;NZNDCL+CourierNewPSMT&#39;, &#39;R14&#39;, &#39;&#39;),</span>
<span class="go">(16, &#39;ttf&#39;, &#39;Type0&#39;, &#39;MNCSJY+SymbolMT&#39;, &#39;R17&#39;, &#39;Identity-H&#39;),</span>
<span class="go">(17, &#39;cff&#39;, &#39;Type1&#39;, &#39;UAEUYH+Helvetica&#39;, &#39;R20&#39;, &#39;WinAnsiEncoding&#39;),</span>
<span class="go">(18, &#39;ttf&#39;, &#39;Type0&#39;, &#39;ECPLRU+Calibri&#39;, &#39;R23&#39;, &#39;Identity-H&#39;),</span>
<span class="go">(19, &#39;ttf&#39;, &#39;Type0&#39;, &#39;TONAYT+CourierNewPSMT&#39;, &#39;R27&#39;, &#39;Identity-H&#39;)]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ul class="simple">
<li><p>该列表没有重复项： <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 、 <em>name</em> 和 <em>referencer</em> 的组合是唯一的。</p></li>
<li><p>一般来说，这是页面实际使用字体的超集。PDF 创建者可能指定了一些全局字体列表，而每个页面只使用其中的一部分。</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_page_text">
<span class="sig-name descname"><span class="pre">get_page_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'text'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">textpage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_page_text" title="永久链接至目标">#</a></dt>
<dd><p>提取给定页面编号 <em>pno</em> （基于零）的页面文本。调用 <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a>。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – 页面编号，基于零，任何值 <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>。</p>
</dd>
</dl>
<p>对于其他参数，请参阅页面方法。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="index-2"></span><dl class="py method">
<dt class="sig sig-object py" id="Document.layout">
<span class="sig-name descname"><span class="pre">layout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.layout" title="永久链接至目标">#</a></dt>
<dd><p>根据给定的页面尺寸和字体大小重新分页（“重新流动”）文档。这只影响一些文档类型，如电子书和 HTML。如果不支持则会被忽略。受支持的文档在属性 <a class="reference internal" href="#Document.is_reflowable" title="Document.is_reflowable"><code class="xref py py-attr docutils literal notranslate"><span class="pre">is_reflowable</span></code></a> 中为 <em>True</em>。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rect</strong> (<em>rect_like</em>) – 所需的页面尺寸。必须是有限的，非空且起始点为 (0, 0)。</p></li>
<li><p><strong>width</strong> (<em>float</em>) – 与 <em>height</em> 一起使用，作为 <em>rect</em> 的替代。</p></li>
<li><p><strong>height</strong> (<em>float</em>) – 与 <em>width</em> 一起使用，作为 <em>rect</em> 的替代。</p></li>
<li><p><strong>fontsize</strong> (<em>float</em>) – 所需的默认字体大小。</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.select">
<span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.select" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：仅保留文档中页码出现在列表中的页面。空的序列或超出 <code class="xref any docutils literal notranslate"><span class="pre">range(doc.page_count)</span></code> 的元素将引发 <em>ValueError</em>。有关更多详细信息，请参见本章节底部的备注。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>s</strong> (<em>sequence</em>) – 要包含的页面编号序列（基于零）。不在序列中的页面将被删除（从内存中）并且直到重新打开文档才会变得可用。<strong>页面编号可以多次出现且无特定顺序：</strong> 结果文档将完全按照指定的序列反映。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ul class="simple">
<li><p>序列中的页面编号无需唯一或按特定顺序排列。这使得该方法成为一个多功能的工具，例如，只选择偶数页或奇数页，或满足其他标准等。</p></li>
<li><p>从技术层面讲，该方法始终会创建一个新的 <a class="reference internal" href="glossary.html#pagetree" title="pagetree"><code class="xref py py-data docutils literal notranslate"><span class="pre">pagetree</span></code></a>。</p></li>
<li><p>处理少量页面时，使用方法 <a class="reference internal" href="#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">copy_page()</span></code></a>、<a class="reference internal" href="#Document.move_page" title="Document.move_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">move_page()</span></code></a>、<a class="reference internal" href="#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_page()</span></code></a> 会更容易。事实上，当文档包含很多页面时，它们的效率 <strong>更高</strong> ——至少提高一个数量级。</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_metadata">
<span class="sig-name descname"><span class="pre">set_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_metadata" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：根据 <em>m</em> （一个 Python 字典）设置或更新文档的元数据。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>m</strong> (<em>dict</em>) – 一个与 <em>metadata</em> 相同键的字典（见下文）。所有键都是可选的。PDF 的格式和加密方法不能设置或更改，并将被忽略。如果任何值不应包含数据，请不要指定其键或将值设置为 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>。如果使用 <em>{}</em>，所有元数据将被清除并设置为字符串 <em>“none”</em>。如果您只想选择性地更改某些值，可以修改 <em>doc.metadata</em> 的副本并将其作为参数使用。可以指定任意的 UTF-8 编码的 Unicode 值。</p>
</dd>
</dl>
<p><em>(在 v1.18.4 中更改)</em> 现在空值或 “none” 不再写入，而是完全省略。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_xml_metadata">
<span class="sig-name descname"><span class="pre">get_xml_metadata</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_xml_metadata" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：获取文档的 XML 元数据。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>文档的 XML 元数据。如果没有或不是 PDF，则返回空字符串。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_xml_metadata">
<span class="sig-name descname"><span class="pre">set_xml_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xml</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_xml_metadata" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：设置或更新文档的 XML 元数据。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xml</strong> (<em>str</em>) – 新的 XML 元数据。应为 XML 语法，但此方法不进行检查，接受任何字符串。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_pagelayout">
<span class="sig-name descname"><span class="pre">set_pagelayout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_pagelayout" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.22.2</p></li>
</ul>
<p>仅限 PDF：设置 <code class="xref any docutils literal notranslate"><span class="pre">/PageLayout</span></code>。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>str</em>) – 以下字符串之一 “SinglePage”, “OneColumn”, “TwoColumnLeft”, “TwoColumnRight”, “TwoPageLeft”, “TwoPageRight”。支持小写。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_pagemode">
<span class="sig-name descname"><span class="pre">set_pagemode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_pagemode" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.22.2</p></li>
</ul>
<p>仅限 PDF：设置 <code class="xref any docutils literal notranslate"><span class="pre">/PageMode</span></code>。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>str</em>) – 以下字符串之一 “UseNone”, “UseOutlines”, “UseThumbs”, “FullScreen”, “UseOC”, “UseAttachments”。支持小写。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_markinfo">
<span class="sig-name descname"><span class="pre">set_markinfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_markinfo" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.22.2</p></li>
</ul>
<p>仅限 PDF：设置 <code class="xref any docutils literal notranslate"><span class="pre">/MarkInfo</span></code> 值。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>dict</em>) – 一个类似于 <code class="xref any docutils literal notranslate"><span class="pre">{&quot;Marked&quot;:</span> <span class="pre">False,</span> <span class="pre">&quot;UserProperties&quot;:</span> <span class="pre">False,</span> <span class="pre">&quot;Suspects&quot;:</span> <span class="pre">False}</span></code> 的字典。此字典包含有关 Tagged PDF 约定使用情况的信息。有关详细信息，请参见 <a class="reference external" href="https://opensource.adobe.com/dc-acrobat-sdk-docs/standards/pdfstandards/pdf/PDF32000_2008.pdf">PDF 规范</a>。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_toc">
<span class="sig-name descname"><span class="pre">set_toc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">toc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collapse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_toc" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：用提供的参数替换 <strong>完整的当前大纲</strong> 树（目录）。成功执行后，可以像平常一样通过 <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a> 或 <a class="reference internal" href="#Document.outline" title="Document.outline"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.outline</span></code></a> 访问新的大纲树。与其他输出导向的方法一样，只有通过 <a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a> （支持增量保存）时，修改才会成为永久性。此方法内部包含以下两个步骤。示例如下所示。</p>
<ul class="simple">
<li><p>第 1 步：删除所有现有的书签。</p></li>
<li><p>第 2 步：从 <em>toc</em> 中包含的条目创建新的目录。</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>toc</strong> (<em>sequence</em>) – <p>一个包含 <strong>所有书签条目</strong> 的列表/元组，构成新的目录。可以接受 <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_toc()</span></code></a> 的输出变体。如果要完全删除目录，指定一个空的序列或 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>。每个条目必须是具有以下格式的列表。</p>
<ul>
<li><p>[lvl, title, page [, dest]] 其中</p>
<ul>
<li><p><strong>lvl</strong> 是项的层级（int &gt; 0）， <strong>必须为 1</strong> 对于第一个项，且最大为前一个项的层级加 1。</p></li>
<li><p><strong>title</strong> （str）是要显示的标题。假定它是 UTF-8 编码的（仅对多字节字符集相关）。</p></li>
<li><p><strong>page</strong> （int）是目标页面编号 <strong>（注意：基于 1）</strong>。如果是正数，则必须在有效范围内。如果没有目标或目标是外部的，则设置为 -1。</p></li>
<li><p><strong>dest</strong> （可选）是字典或数字。如果是数字，它将被解释为此条目应指向页面的高度（以点为单位）。使用字典（例如 <code class="xref any docutils literal notranslate"><span class="pre">get_toc(False)</span></code> 的输出）来详细控制书签的属性，详细信息见 <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a>。</p></li>
</ul>
</li>
</ul>
</p></li>
<li><p><strong>collapse</strong> (<em>int</em>) – <em>(新增于 v1.16.9)</em> 控制大纲条目初始显示折叠的层级。默认值为 1，这意味着仅显示第 1 层级，更高层级需要使用 PDF 查看器展开。要展开所有条目，指定一个较大的整数、0 或 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>插入或删除的条目数量。</p>
</dd>
</dl>
<p>在 v1.23.8 中更改：目标 ‘to’ 坐标现在应与 <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">get_toc()</span></code></a> 返回的坐标系统相同（内部会使用 <code class="xref any docutils literal notranslate"><span class="pre">page.cropbox</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">page.rotation_matrix</span></code> 进行转换）。因此，例如 <code class="xref any docutils literal notranslate"><span class="pre">set_toc(get_toc())</span></code> 现在会返回未更改的目标 ‘to’ 坐标。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.outline_xref">
<span class="sig-name descname"><span class="pre">outline_xref</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.outline_xref" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.17.7</p></li>
</ul>
<p>仅限 PDF：返回大纲项的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。主要用于内部用途。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>int</em>) – 在 <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a> 返回的列表中的项的索引。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.del_toc_item">
<span class="sig-name descname"><span class="pre">del_toc_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.del_toc_item" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.17.7</p></li>
<li><p>在 v1.18.14 中更改：不再移除该项的文本，而是将其显示为灰色。</p></li>
</ul>
<p>仅限 PDF：删除此目录项。这是一个高速方法，它 <strong>禁用</strong> 该项，但保持整体目录结构不变。物理上，该项仍存在于目录树中，但显示为灰色，并且不再指向任何目标。</p>
<p>这也意味着，您可以在需要时通过 <a class="reference internal" href="#Document.set_toc_item" title="Document.set_toc_item"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_toc_item()</span></code></a> 将该项重新分配到新的目标。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>int</em>) – 在 <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a> 返回的列表中的项的索引。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.set_toc_item">
<span class="sig-name descname"><span class="pre">set_toc_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.set_toc_item" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.17.7</p></li>
<li><p>在 v1.18.6 中更改</p></li>
</ul>
<p>仅限 PDF：更改由索引标识的 TOC 项目。可以更改项目的 <strong>标题</strong>、 <strong>目标</strong>、 <strong>外观</strong> （颜色、加粗、斜体）或折叠子项，或者完全删除该项目。</p>
<p>如果只需要对选定的条目进行特定修改，并且想避免替换整个目录，则使用此方法。特别是在处理大型目录时，这非常有用。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – 在 <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a> 创建的列表中的条目的索引。</p></li>
<li><p><strong>dest_dict</strong> (<em>dict</em>) – 新的目标。一个字典，类似于 <code class="xref any docutils literal notranslate"><span class="pre">doc.get_toc(False)</span></code> 中条目的最后一个条目。建议使用此作为模板。当给定时，<strong>所有其他参数将被忽略</strong>，仅保留标题。</p></li>
<li><p><strong>kind</strong> (<em>int</em>) – 链接类型，参见 <a class="reference internal" href="vars.html#linkdest-kinds"><span class="std std-ref">链接目标类型</span></a>。如果是 <a class="reference internal" href="vars.html#LINK_NONE" title="LINK_NONE"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_NONE</span></code></a>，则所有其他参数将被忽略，目录项将被移除——与 <a class="reference internal" href="#Document.del_toc_item" title="Document.del_toc_item"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.del_toc_item()</span></code></a> 相同。如果为 None，则仅修改标题，忽略其余参数。其他所有值将使用随后的参数创建一个新的目标字典。</p></li>
<li><p><strong>pno</strong> (<em>int</em>) – 基于 1 的页面编号，即 1 &lt;= pno &lt;= doc.page_count。对于 LINK_GOTO 是必需的。</p></li>
<li><p><strong>uri</strong> (<em>str</em>) – URL 文本。对于 LINK_URI 是必需的。</p></li>
<li><p><strong>title</strong> (<em>str</em>) – 所需的新标题。如果不更改，则为 None。</p></li>
<li><p><strong>to</strong> (<em>point_like</em>) – （可选）指向目标页面上的坐标。对于 LINK_GOTO 有效。如果省略，则选择页面顶部附近的一个点。</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – 对于 LINK_GOTOR 和 LINK_LAUNCH 是必需的。</p></li>
<li><p><strong>zoom</strong> (<em>float</em>) – 显示目标页面时使用的缩放因子。</p></li>
</ul>
</dd>
</dl>
<p><strong>示例用法：</strong> 更改 SWIG 手册的 TOC，如下所示：</p>
<p>折叠所有低于顶级的内容，并将关于 Python 支持的章节显示为红色、加粗和斜体:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">=</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;SWIGDocumentation.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_toc</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># 我们需要详细的 TOC</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 获取第 1 层级的索引和标题列表</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lvl1</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">toc</span><span class="p">)</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="n">lvl1</span><span class="p">:</span>
<span class="go">        d = toc[i][3]  # 获取目标字典</span>
<span class="go">        d[&quot;collapse&quot;] = True  # 折叠其下的条目</span>
<span class="go">        if &quot;Python&quot; in title:  # 显示 &#39;Python&#39; 章节</span>
<span class="go">            d[&quot;color&quot;] = (1, 0, 0)  # 红色，</span>
<span class="go">            d[&quot;bold&quot;] = True  # 加粗并且</span>
<span class="go">            d[&quot;italic&quot;] = True  # 斜体</span>
<span class="go">        doc.set_toc_item(i, dest_dict=d)  # 更新此 TOC 项</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;NEWSWIG.pdf&quot;</span><span class="p">,</span><span class="n">garbage</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">deflate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>在上面的示例中，我们仅更改了文件中 1240 个 TOC 条目中的 42 个。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.bake">
<span class="sig-name descname"><span class="pre">bake</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">widgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.bake" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：将注释和/或小部件转换为页面的永久部分。此方法将 <strong>更改</strong> PDF 文件。如果 <a class="reference internal" href="page.html#Page.widgets" title="Page.widgets"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">widgets</span></code></a> 为 <code class="xref any docutils literal notranslate"><span class="pre">True</span></code>，则文档将不再是 “表单 PDF”。</p>
<p>所有页面看起来相同，但不再包含注释或字段。可见部分将根据需要转换为标准文本、矢量图形或图像。</p>
<p>因此，该方法可能是使用 <a class="reference internal" href="#Document.convert_to_pdf" title="Document.convert_to_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.convert_to_pdf()</span></code></a> 进行 PDF 到 PDF 转换的一个有效 <strong>替代方案</strong>。</p>
<p>请考虑到注释是复杂的对象，可能包含其可视外观下方的更多数据。例如，”Text” 和 “FileAttachment” 注释。当将注释/小部件 “烘焙” 进 PDF 时，所有底层信息（附加文件、评论、相关的 PopUp 注释等）将丢失，并在下次垃圾回收时被移除。</p>
<p>例如，当源页面应该在目标中完全相同但不支持注释或小部件时，可以使用此功能，例如在 <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> 中。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>annots</strong> (<em>bool</em>) – 是否转换注释。</p></li>
<li><p><strong>widgets</strong> (<em>bool</em>) – 是否转换字段/小部件。执行后，文档将不再是 “表单 PDF”。</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.can_save_incrementally">
<span class="sig-name descname"><span class="pre">can_save_incrementally</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.can_save_incrementally" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.16.0</p></li>
</ul>
<p>检查文档是否可以增量保存。使用此方法可以在不遇到异常的情况下选择正确的选项。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.scrub">
<span class="sig-name descname"><span class="pre">scrub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attached_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean_pages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedded_files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">javascript</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redactions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redact_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_links</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_responses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thumbnails</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xml_metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.scrub" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.16.14</p></li>
</ul>
<p>仅限 PDF：从 PDF 中移除潜在的敏感数据。此功能灵感来自于 Adobe Acrobat 产品中的类似 “Sanitize” 功能。该过程可以通过多个选项进行配置。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attached_files</strong> (<em>bool</em>) – 搜索 ‘FileAttachment’ 注释并移除文件内容。</p></li>
<li><p><strong>clean_pages</strong> (<em>bool</em>) – 移除页面绘制源中的所有评论。如果此选项设置为 <em>False</em>，则也会对 <em>hidden_text</em> 和 <em>redactions</em> 进行清理。</p></li>
<li><p><strong>embedded_files</strong> (<em>bool</em>) – 移除嵌入的文件。</p></li>
<li><p><strong>hidden_text</strong> (<em>bool</em>) – 移除 OCR 识别的文本和不可见文本 <a class="footnote-reference brackets" href="#f14" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>14<span class="fn-bracket">]</span></a>。</p></li>
<li><p><strong>javascript</strong> (<em>bool</em>) – 移除 JavaScript 源代码。</p></li>
<li><p><strong>metadata</strong> (<em>bool</em>) – 移除 PDF 标准元数据。</p></li>
<li><p><strong>redactions</strong> (<em>bool</em>) – 应用删除标记注释。</p></li>
<li><p><strong>redact_images</strong> (<em>int</em>) – 处理图像时如何应用删除标记。可以选择 0（忽略）、1（遮盖重叠部分）或 2（移除）。</p></li>
<li><p><strong>remove_links</strong> (<em>bool</em>) – 移除所有链接。</p></li>
<li><p><strong>reset_fields</strong> (<em>bool</em>) – 重置所有表单字段为默认值。</p></li>
<li><p><strong>reset_responses</strong> (<em>bool</em>) – 移除所有注释中的响应。</p></li>
<li><p><strong>thumbnails</strong> (<em>bool</em>) – 移除页面的缩略图。</p></li>
<li><p><strong>xml_metadata</strong> (<em>bool</em>) – 移除 XML 元数据。</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">garbage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deflate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deflate_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deflate_fonts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incremental</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_new_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encryption</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PDF_ENCRYPT_NONE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">owner_pw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_pw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_objstms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.save" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>更改于 v1.18.7</p></li>
<li><p>更改于 v1.19.0</p></li>
<li><p>更改于 v1.24.1</p></li>
</ul>
<p>仅限 PDF：保存文档的 <strong>当前状态</strong>。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outfile</strong> (<em>str</em><em>, </em><em>Path</em><em>, </em><em>fp</em>) – 要保存的文件路径，<code class="xref any docutils literal notranslate"><span class="pre">pathlib.Path</span></code> 或文件对象。文件对象必须通过 <code class="xref any docutils literal notranslate"><span class="pre">open(...)</span></code> 或 <code class="xref any docutils literal notranslate"><span class="pre">io.BytesIO()</span></code> 事先创建。选择 <code class="xref any docutils literal notranslate"><span class="pre">io.BytesIO()</span></code> 类似于下面的 <a class="reference internal" href="#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a>，其等同于内部创建的 <code class="xref any docutils literal notranslate"><span class="pre">io.BytesIO()</span></code> 的 <code class="xref any docutils literal notranslate"><span class="pre">getvalue()</span></code> 输出。</p></li>
<li><p><strong>garbage</strong> (<em>int</em>) – <p>执行垃圾回收。正值将排除 “增量” 保存。</p>
<ul>
<li><p>0 = 无</p></li>
<li><p>1 = 移除未使用（未引用）对象。</p></li>
<li><p>2 = 在执行第 1 步的基础上，压缩 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 表。</p></li>
<li><p>3 = 在执行第 2 步的基础上，合并重复对象。</p></li>
<li><p>4 = 在执行第 3 步的基础上，检查 <a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref py py-data docutils literal notranslate"><span class="pre">stream</span></code></a> 对象的重复性。这可能较慢，因为这些数据通常较大。</p></li>
</ul>
</p></li>
<li><p><strong>clean</strong> (<em>bool</em>) – 清理并消毒内容流 <a class="footnote-reference brackets" href="#f8" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a>。对应于 “mutool clean -sc”。</p></li>
<li><p><strong>deflate</strong> (<em>bool</em>) – 压缩（deflate）未压缩的流。</p></li>
<li><p><strong>deflate_images</strong> (<em>bool</em>) – <em>(v1.18.3 新增)</em> 压缩（deflate）未压缩的图像流 <a class="footnote-reference brackets" href="#f11" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>11<span class="fn-bracket">]</span></a>。</p></li>
<li><p><strong>deflate_fonts</strong> (<em>bool</em>) – <em>(v1.18.3 新增)</em> 压缩（deflate）未压缩的字体文件流 <a class="footnote-reference brackets" href="#f11" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>11<span class="fn-bracket">]</span></a>。</p></li>
<li><p><strong>incremental</strong> (<em>bool</em>) – 仅保存对 PDF 的更改。排除 “garbage” 和 “linear”。此选项仅在 <em>outfile</em> 为字符串或 <code class="xref any docutils literal notranslate"><span class="pre">pathlib.Path</span></code> 且等于 <a class="reference internal" href="#Document.name" title="Document.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.name</span></code></a> 时可用。对于解密或修复后的文件以及其他某些情况，不能使用此选项。为了确保，请检查 <a class="reference internal" href="#Document.can_save_incrementally" title="Document.can_save_incrementally"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.can_save_incrementally()</span></code></a>。如果返回 false，则需要保存到新文件。</p></li>
<li><p><strong>ascii</strong> (<em>bool</em>) – 将二进制数据转换为 ASCII。</p></li>
<li><p><strong>expand</strong> (<em>int</em>) – <p>解压对象。生成可以被其他程序更好读取的版本，但文件可能会更大。</p>
<ul>
<li><p>0 = 无</p></li>
<li><p>1 = 图像</p></li>
<li><p>2 = 字体</p></li>
<li><p>255 = 所有</p></li>
</ul>
</p></li>
<li><p><strong>linear</strong> (<em>bool</em>) – 保存线性化版本的文档。此选项为改进互联网访问性能创建文件格式。排除 “incremental” 和 “use_objstms”。</p></li>
<li><p><strong>pretty</strong> (<em>bool</em>) – 美化文档源，增加可读性。PDF 对象将重新格式化，以便更像 <a class="reference internal" href="#Document.xref_object" title="Document.xref_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_object()</span></code></a> 的默认输出。</p></li>
<li><p><strong>no_new_id</strong> (<em>bool</em>) – 抑制更新文件的 <code class="xref any docutils literal notranslate"><span class="pre">/ID</span></code> 字段。如果文件根本没有该字段，也抑制创建新字段。默认为 <code class="xref any docutils literal notranslate"><span class="pre">False</span></code>，即每次保存都会导致文件标识的更新。</p></li>
<li><p><strong>permissions</strong> (<em>int</em>) – <em>(v1.16.0 新增)</em> 设置所需的权限级别。请参阅 <a class="reference internal" href="vars.html#permissioncodes"><span class="std std-ref">文档权限</span></a> 了解可能的值。默认是授予所有权限。</p></li>
<li><p><strong>encryption</strong> (<em>int</em>) – <em>(v1.16.0 新增)</em> 设置所需的加密方法。请参阅 <a class="reference internal" href="vars.html#encryptionmethods"><span class="std std-ref">PDF 加密方法代码</span></a> 了解可能的值。</p></li>
<li><p><strong>owner_pw</strong> (<em>str</em>) – <em>(v1.16.0 新增)</em> 设置文档的所有者密码。<em>(v1.18.3 更改)</em> 如果未提供，则使用用户密码（如果提供）。字符串长度不得超过 40 个字符。</p></li>
<li><p><strong>user_pw</strong> (<em>str</em>) – <em>(v1.16.0 新增)</em> 设置文档的用户密码。字符串长度不得超过 40 个字符。</p></li>
<li><p><strong>use_objstms</strong> (<em>int</em>) – <em>(v1.24.0 新增)</em> 压缩选项，将合适的 PDF 对象定义转换为存储在其他对象的 <a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref py py-data docutils literal notranslate"><span class="pre">stream</span></code></a> 数据中。根据 <code class="xref any docutils literal notranslate"><span class="pre">deflate</span></code> 参数的值，转换后的对象定义将被压缩——这可以显著减少文件大小。</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>该方法不会检查文件是否已经存在，因此不会提示确认，并会覆盖文件。作为程序员，你需要负责处理这个问题。</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>文件大小减少</strong></p>
<p>1. 使用保存选项如 <code class="xref any docutils literal notranslate"><span class="pre">garbage=3|4,</span> <span class="pre">deflate=True,</span> <span class="pre">use_objstms=1</span></code>。不要更改默认值 <code class="xref any docutils literal notranslate"><span class="pre">expand=False|0,</span> <span class="pre">clean=False|0,</span> <span class="pre">incremental=False|0,</span> <span class="pre">linear=False|0</span></code>。
这是一种 “无损” 的文件大小减小。该方法有一个便利版本，默认设置了这些值： <a class="reference internal" href="#Document.ez_save" title="Document.ez_save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.ez_save()</span></code></a>，请参阅下面。</p>
<ol class="arabic simple" start="2">
<li><p>“有损” 文件大小减小本质上必须放弃某些图像方面的内容，例如 (a) 移除所有图像 (b) 将图像替换为其灰度版本 (c) 降低图像分辨率。可以在 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/replace-image">PyMuPDF Utilities “replace-image” 文件夹</a> 找到示例。</p></li>
</ol>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.ez_save">
<span class="sig-name descname"><span class="pre">ez_save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.ez_save" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新增于 v1.18.11</p></li>
</ul>
<p>仅限 PDF：与 <a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> 相同，但默认选项为 <code class="xref any docutils literal notranslate"><span class="pre">deflate=True,</span> <span class="pre">garbage=3,</span> <span class="pre">use_objstms=1</span></code>。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.saveIncr">
<span class="sig-name descname"><span class="pre">saveIncr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.saveIncr" title="永久链接至目标">#</a></dt>
<dd><p>PDF only: saves the document incrementally. This is a convenience abbreviation for <em>doc.save(doc.name, incremental=True, encryption=PDF_ENCRYPT_KEEP)</em>.</p>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">备注</p>
<p>如果文档包含经过验证的签名，保存为新文件可能会导致签名无效，此时可能需要增量保存。</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="Document.tobytes">
<span class="sig-name descname"><span class="pre">tobytes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">garbage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deflate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deflate_images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deflate_fonts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_new_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encryption</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PDF_ENCRYPT_NONE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permissions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">owner_pw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_pw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_objstms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.tobytes" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>更改于 v1.18.7</p></li>
<li><p>更改于 v1.19.0</p></li>
<li><p>更改于 v1.24.1</p></li>
</ul>
<p>仅限 PDF：将 <strong>文档的当前内容</strong> 写入字节对象，而不是文件。显然，您应该注意内存要求。参数的含义与 <a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a> 中的完全相同。章节 <a class="reference internal" href="faq.html#faq"><span class="std std-ref">FAQ</span></a> 包含一个示例，演示如何将此方法用作 <a class="reference external" href="https://pypi.python.org/pypi/pdfrw/0.3">pdfrw</a> 的预处理器。</p>
<p><em>(v1.16.0 更改)</em> 增强的加密支持。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>bytes</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>包含完整文档的字节对象。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.search_page_for">
<span class="sig-name descname"><span class="pre">search_page_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.search_page_for" title="永久链接至目标">#</a></dt>
<dd><p>在页面编号 “pno” 上搜索 “text”。与对应的 <a class="reference internal" href="page.html#Page.search_for" title="Page.search_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.search_for()</span></code></a> 完全相同。任何整数 <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code> 都是可接受的。</p>
</dd></dl>

<span class="target" id="index-3"></span><dl class="py method">
<dt class="sig sig-object py" id="Document.insert_pdf">
<span class="sig-name descname"><span class="pre">insert_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">docsrc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_at</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">links</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">widgets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">join_duplicates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.insert_pdf" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：将 PDF 文档 <em>docsrc</em> 的页面范围 <strong>[from_page, to_page]</strong> （包括两者）复制到当前文档中。插入将从页面编号 <em>start_at</em> 开始。值为 -1 表示使用默认值。所有复制的页面将按照指定的旋转角度进行旋转。链接、注释和小部件可以在目标中排除，具体如下。所有页面编号为 0 基础。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>docsrc</strong> (<em>Document</em>) – 已打开的 PDF <em>Document</em>，必须与当前文档不同，但可以引用相同的底层文件。</p></li>
<li><p><strong>from_page</strong> (<em>int</em>) – <em>docsrc</em> 中的第一页编号。默认值为零。</p></li>
<li><p><strong>to_page</strong> (<em>int</em>) – <em>docsrc</em> 中的最后一页编号。默认为最后一页。</p></li>
<li><p><strong>start_at</strong> (<em>int</em>) – 第一个复制的页面，将在目标中成为页面编号 <em>start_at</em>。默认 -1 表示将页面范围追加到最后。如果为零，则页面范围将插入到当前第一页之前。</p></li>
<li><p><strong>rotate</strong> (<em>int</em>) – 所有复制的页面将按提供的值旋转（度数，90 的整数倍）。</p></li>
<li><p><strong>links</strong> (<em>bool</em>) – 选择是否应包括复制中的（内部和外部）链接。默认值为 <code class="xref any docutils literal notranslate"><span class="pre">True</span></code>。 <em>命名</em> 链接 ( <a class="reference internal" href="vars.html#LINK_NAMED" title="LINK_NAMED"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_NAMED</span></code></a> ) 和指向复制页面范围之外的内部链接 <strong>始终会被排除</strong>。</p></li>
<li><p><strong>annots</strong> (<em>bool</em>) – 选择是否应包括复制中的注释。</p></li>
<li><p><strong>widgets</strong> (<em>bool</em>) – 选择是否应包括复制中的注释。如果为 <code class="xref any docutils literal notranslate"><span class="pre">True</span></code> 且源页面中至少有一个表单字段，则目标 PDF 将变成一个表单 PDF（如果尚未是）。</p></li>
<li><p><strong>join_duplicates</strong> (<em>bool</em>) – <p><em>(新功能，版本 1.25.5)</em> 选择如何处理源页面中的重复根字段名称。如果 <code class="xref any docutils literal notranslate"><span class="pre">widgets=False</span></code>，则此参数被忽略。</p>
<p>默认值为 <code class="docutils literal notranslate"><span class="pre">False</span></code>，这将为目标中已存在的重复源根字段添加统一的字符串。例如，如果 “name” 已经存在于目标中，源小部件的名称将更改为 “name [text]”，并附加适当选择的字符串 “text”。</p>
<p>如果 <code class="docutils literal notranslate"><span class="pre">True</span></code>，源和目标中重复名称的根字段将被转换为 “父” 对象的 “Kids”（即列表中的所有子小部件）。这会有效地将这些小部件变成 “相同” 小部件的实例：例如，如果其中一个小部件被更改，则所有实例都会自动继承该更改，无论它们显示在哪一页。</p>
</p></li>
<li><p><strong>show_progress</strong> (<em>int</em>) – <em>(新功能，版本 1.17.7)</em> 指定大于零的间隔大小，以便在 <code class="xref any docutils literal notranslate"><span class="pre">sys.stdout</span></code> 上查看进度消息。每个间隔后，将打印类似 “Inserted 30 of 47 pages.” 的消息。</p></li>
<li><p><strong>final</strong> (<em>int</em>) – <em>(新功能，版本 1.18.0)</em> 控制是否在此方法后 <strong>丢弃</strong> 已复制对象的列表，默认为 <em>True</em>。除了从同一源 PDF 进行的多次插入的最后一次外，将其设置为 0 以节省目标文件的大小并显著加快执行速度。</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">备注</p>
<ol class="arabic simple">
<li><p>这是一个基于页面的方法。因此，源文档的文档级信息大多数将被忽略。例如，包括可选内容、嵌入文件、<code class="xref any docutils literal notranslate"><span class="pre">StructureElem</span></code>、目录、页面标签、元数据、命名目标（和其他命名条目）等。</p></li>
<li><p>如果 <code class="xref any docutils literal notranslate"><span class="pre">from_page</span> <span class="pre">&gt;</span> <span class="pre">to_page</span></code>，页面将 <strong>按相反顺序复制</strong>。如果 <code class="xref any docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">from_page</span> <span class="pre">==</span> <span class="pre">to_page</span></code>，则只复制一页。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">docsrc</span></code> 的 TOC 条目 <strong>不会被复制</strong>。但是，恢复结果文档的目录是很容易的。请查看下面的示例以及程序 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py">join.py</a>，它可以同时合并 PDF 文档并拼接相应部分的目录。</p></li>
</ol>
</div>
<span class="target" id="index-4"></span><dl class="py method">
<dt class="sig sig-object py" id="Document.insert_file">
<span class="sig-name descname"><span class="pre">insert_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_at</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">links</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.insert_file" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新功能，版本 v1.22.0</p></li>
</ul>
<p>仅限 PDF：将任意受支持的文档添加到当前 PDF 中。打开 “infile” 作为文档，将其转换为 PDF 然后调用 <a class="reference internal" href="#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a> 方法。参数与该方法相同。此功能提供了一种简单的方法，可以将图像作为完整页面附加到输出 PDF 中。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>infile</strong> (<em>multiple</em>) – 要插入的输入文档。可以是创建 <a class="reference internal" href="#document"><span class="std std-ref">Document</span></a> 或 <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> 时有效的文件名规格。</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="index-5"></span><dl class="py method">
<dt class="sig sig-object py" id="Document.new_page">
<span class="sig-name descname"><span class="pre">new_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">595</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">842</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.new_page" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：插入一个空白页面。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – 新页面应插入的页面编号。必须在 <em>1 &lt; pno &lt;= page_count</em> 范围内。特殊值 -1 和 <em>doc.page_count</em> 表示插入到最后一页之后。</p></li>
<li><p><strong>width</strong> (<em>float</em>) – 页面宽度。</p></li>
<li><p><strong>height</strong> (<em>float</em>) – 页面高度。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>创建的页面对象。</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="index-6"></span><dl class="py method">
<dt class="sig sig-object py" id="Document.insert_page">
<span class="sig-name descname"><span class="pre">insert_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">595</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">842</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'helv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.insert_page" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：插入一个新页面并插入一些文本。此便捷函数结合了 <a class="reference internal" href="#Document.new_page" title="Document.new_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.new_page()</span></code></a> 和（部分） <a class="reference internal" href="page.html#Page.insert_text" title="Page.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_text()</span></code></a> 方法。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – <p>页面编号（0 基数），表示新页面插入的位置。必须在 <code class="xref any docutils literal notranslate"><span class="pre">range(-1,</span> <span class="pre">doc.page_count</span> <span class="pre">+</span> <span class="pre">1)</span></code> 范围内。特殊值 -1 和 <code class="xref any docutils literal notranslate"><span class="pre">doc.page_count</span></code> 表示插入到最后一页之后。</p>
<dl class="simple">
<dt>变更于 v1.14.12</dt><dd><p>现在是一个位置参数</p>
</dd>
</dl>
</p>
</dd>
</dl>
<p>对于其他参数，请参阅上述方法。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="page.html#Page.insert_text" title="Page.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_text()</span></code></a> 的结果（成功插入的行数）。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.delete_page">
<span class="sig-name descname"><span class="pre">delete_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.delete_page" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：删除指定的页面，页面编号为 <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span> <span class="pre">-</span> <span class="pre">1</span></code>。</p>
<ul class="simple">
<li><p>变更于 v1.18.14：支持 Python 的 <code class="xref any docutils literal notranslate"><span class="pre">del</span></code> 语句。</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pno</strong> (<em>int</em>) – 要删除的页面。负数从文档末尾开始计数（与索引类似）。默认值为最后一页。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.delete_pages">
<span class="sig-name descname"><span class="pre">delete_pages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.delete_pages" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>变更于 v1.18.13：更灵活地指定要删除的页面。</p></li>
<li><p>变更于 v1.18.14：支持 Python 的 <code class="xref any docutils literal notranslate"><span class="pre">del</span></code> 语句。</p></li>
</ul>
<p>仅限 PDF：删除多个页面，给定 0 基数的页面编号。</p>
<dl class="simple">
<dt><strong>格式 1</strong>：使用关键字参数。表示旧格式。删除一个连续的页面范围。</dt><dd><ul class="simple">
<li><p>“from_page”：要删除的第一页。如果省略，则为零。</p></li>
<li><p>“to_page”：要删除的最后一页。如果省略，则为文档的最后一页。不能小于 “from_page”。</p></li>
</ul>
</dd>
</dl>
<p><strong>格式 2</strong>：两个页面编号作为位置参数。与格式 1 相同处理。</p>
<p><strong>格式 3</strong>：一个位置整数参数。等同于 <code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.delete_page()</span></code>。</p>
<p><strong>格式 4</strong>：一个位置参数，类型为 <em>list</em>、<em>tuple</em> 或 <em>range()</em>，包含要删除的页面编号。该序列中的项目可以按任何顺序排列，并且可以包含重复项。</p>
<p><strong>格式 5</strong>：<em>(新功能，v1.18.14)</em> 现在可以使用 Python 的 <code class="xref any docutils literal notranslate"><span class="pre">del</span></code> 语句和索引/切片表示法。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><em>(变更于 v1.14.17，优化于 v1.17.7)</em> 为了保持有效的 PDF 结构，此方法和 <a class="reference internal" href="#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_page()</span></code></a> 还会停用指向已删除页面的目录项。此处的“停用”意味着书签将不指向任何位置，并且支持的 PDF 查看器将显示为灰色标题。总体目录结构保持不变。</p>
<p>它还会移除所有指向已删除页面的 <strong>链接</strong> ，此操作可能对页面较多的文档有较长的响应时间。</p>
<p>以下示例将删除第 500 页至第 519 页：</p>
<ul class="simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">doc.delete_pages(500,</span> <span class="pre">519)</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">doc.delete_pages(from_page=500,</span> <span class="pre">to_page=519)</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">doc.delete_pages((500,</span> <span class="pre">501,</span> <span class="pre">502,</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">519))</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">doc.delete_pages(range(500,</span> <span class="pre">520))</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">del</span> <span class="pre">doc[500:520]</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">del</span> <span class="pre">doc[(500,</span> <span class="pre">501,</span> <span class="pre">502,</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">519)]</span></code></p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">del</span> <span class="pre">doc[range(500,</span> <span class="pre">520)]</span></code></p></li>
</ul>
<p>对于 <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a>，上述操作大约需要 0.6 秒，因为剩余的 1290 页必须清除无效链接。</p>
<p>一般来说，此方法的性能依赖于剩余页面的数量，而不是删除页面的数量：例如，<strong>删除所有页面</strong>，只保留那 20 页，将需要更少的时间。</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.copy_page">
<span class="sig-name descname"><span class="pre">copy_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.copy_page" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：在文档中复制页面引用。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – 要复制的页面。必须在 <code class="xref any docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code> 范围内。</p></li>
<li><p><strong>to</strong> (<em>int</em>) – 要复制到的页面编号。默认将插入到最后一页之后。</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>仅会创建页面对象的 <strong>新引用</strong> ，而不是新的页面对象，所有复制的页面将具有相同的属性值，包括 <a class="reference internal" href="page.html#Page.xref" title="Page.xref"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.xref</span></code></a>。这意味着对其中一个副本的任何更改将出现在所有副本中。</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.fullcopy_page">
<span class="sig-name descname"><span class="pre">fullcopy_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.fullcopy_page" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新功能，v1.14.17</p></li>
</ul>
<p>仅限 PDF：完全复制（重复）一个页面。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – 要复制的页面。必须在 <code class="xref any docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code> 范围内。</p></li>
<li><p><strong>to</strong> (<em>int</em>) – 要复制到的页面编号。默认将插入到最后一页之后。</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ul class="simple">
<li><p>与 <a class="reference internal" href="#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">copy_page()</span></code></a> 不同，此方法创建一个新的页面对象（带有新的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>），可以独立于原始页面进行更改。</p></li>
<li><p>任何弹出窗口和 “IRT”（“响应于”）注释将 <strong>不被复制</strong> ，以避免出现潜在的不正确情况。</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.move_page">
<span class="sig-name descname"><span class="pre">move_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pno</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.move_page" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：在文档中移动（复制并删除原始页面）一个页面。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pno</strong> (<em>int</em>) – 要移动的页面。必须在 <code class="xref any docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code> 范围内。</p></li>
<li><p><strong>to</strong> (<em>int</em>) – 要插入的页面编号。默认将移动到最后一页之后。</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.need_appearances">
<span class="sig-name descname"><span class="pre">need_appearances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.need_appearances" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新功能，v1.17.4</p></li>
</ul>
<p>仅限 PDF：获取或设置表单 PDF 的 <em>/NeedAppearances</em> 属性。引用：“（可选）一个标志，指定是否为文档中的所有小部件注释构建外观流和外观字典… 默认值：false。” 这可能有助于控制某些读取器/查看器的行为。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>bool</em>) – 设置此属性的值。如果省略或为 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>，则查询当前值。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>None: 不是表单 PDF，或未定义该属性。</p></li>
<li><p>True / False: 属性的值（无论是刚设置的还是查询时已有的）。如果不是表单 PDF，则无效。</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.get_sigflags">
<span class="sig-name descname"><span class="pre">get_sigflags</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.get_sigflags" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：返回文档是否包含签名字段。这是一个可选的 PDF 属性：如果不存在（返回值为 -1），则无法得出结论——PDF 创建者可能只是没有使用它。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>-1: 不是表单 PDF / 没有记录的签名字段 / 未找到 <em>SigFlags</em>。</p></li>
<li><p>1: 至少存在一个签名字段。</p></li>
<li><p>3: 包含可能会被使无效的签名，如果文件以一种修改其先前内容的方式保存（写入），而不是增量更新。</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.embfile_add">
<span class="sig-name descname"><span class="pre">embfile_add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ufilename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_add" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>变更于 v1.14.16：位置参数“name”和“buffer”的顺序已更改，以符合其他函数的调用模式。</p></li>
</ul>
<p>仅限 PDF：嵌入一个新文件。所有字符串参数（除了名称）都可以是 Unicode（在以前的版本中，只有 ASCII 正常工作）。文件内容将在有益的情况下进行压缩。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – 条目标识符，<strong>不能已经存在</strong>。</p></li>
<li><p><strong>buffer</strong> (<em>bytes</em><em>,</em><em>bytearray</em><em>,</em><em>BytesIO</em>) – <p>文件内容。</p>
<p><em>(变更于 v1.14.13)</em> 现在也支持 <em>io.BytesIO</em>。</p>
</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – 可选文件名。仅文档说明，如果为 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>，则设置为 <em>name</em>。</p></li>
<li><p><strong>ufilename</strong> (<em>str</em>) – 可选的 Unicode 文件名。仅文档说明，如果为 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>，则设置为 <em>filename</em>。</p></li>
<li><p><strong>desc</strong> (<em>str</em>) – 可选的描述。仅文档说明，如果为 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>，则设置为 <em>name</em>。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>(变更于 v1.18.13)</em> 该方法现在返回插入文件的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。此外，文件对象将自动赋予 PDF 键 <code class="xref any docutils literal notranslate"><span class="pre">/CreationDate</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">/ModDate</span></code>，基于当前日期和时间。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.embfile_count">
<span class="sig-name descname"><span class="pre">embfile_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_count" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>变更于 v1.14.16：现在这是一个方法。在以前的版本中，这是一个属性。</p></li>
</ul>
<p>仅限 PDF：返回嵌入文件的数量。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.embfile_get">
<span class="sig-name descname"><span class="pre">embfile_get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_get" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：通过条目编号或名称检索嵌入文件的内容。如果文档不是 PDF，或无法找到条目，则会引发异常。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>item</strong> (<em>int</em><em>,</em><em>str</em>) – 条目的索引或名称。整数必须在 <code class="xref any docutils literal notranslate"><span class="pre">range(embfile_count())</span></code> 范围内。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>bytes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.embfile_del">
<span class="sig-name descname"><span class="pre">embfile_del</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_del" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>变更于 v1.14.16：现在也可以通过索引删除条目。</p></li>
</ul>
<p>仅限 PDF：从 <code class="xref any docutils literal notranslate"><span class="pre">/EmbeddedFiles</span></code> 中删除一个条目。与往常一样，只有在将文档保存为新文件并使用适当的垃圾回收选项时，才会实际删除嵌入的文件内容（并恢复文件空间）。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>item</strong> (<em>int/str</em>) – 条目的索引或名称。</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>当指定条目名称时，此函数将仅 <strong>删除第一个</strong> 具有该名称的条目。请注意，未使用 PyMuPDF 创建的 PDF 可能包含重复的名称。因此，您可能需要采取适当的预防措施。</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.embfile_info">
<span class="sig-name descname"><span class="pre">embfile_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_info" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>变更于 v1.18.13</p></li>
</ul>
<p>仅限 PDF：通过条目的编号或名称检索嵌入文件的信息。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>item</strong> (<em>int/str</em>) – 条目的索引或名称。整数必须在 <code class="xref any docutils literal notranslate"><span class="pre">range(embfile_count())</span></code> 范围内。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>包含以下键的字典：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> – (<em>str</em>) 存储此条目的名称</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filename</span></code> – (<em>str</em>) 文件名</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ufilename</span></code> – (<em>unicode</em>) 文件名</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> – (<em>str</em>) 描述</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">size</span></code> – (<em>int</em>) 原始文件大小</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">length</span></code> – (<em>int</em>) 压缩后的文件长度</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">creationDate</span></code> – (<em>str</em>) 项目创建日期时间，PDF 格式</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modDate</span></code> – (<em>str</em>) 最后修改日期时间，PDF 格式</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">collection</span></code> – (<em>int</em>) 关联的 PDF 组合项的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>，如果有的话，否则为零。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">checksum</span></code> – (<em>str</em>) 存储文件内容的哈希码，作为十六进制字符串。根据 PDF 规范，它应该是 MD5，但可以看到其他哈希算法。</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.embfile_names">
<span class="sig-name descname"><span class="pre">embfile_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_names" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：返回嵌入文件名称的列表。名称的顺序等于文档中物理顺序。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.embfile_upd">
<span class="sig-name descname"><span class="pre">embfile_upd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ufilename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.embfile_upd" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：根据条目的编号或名称更改嵌入的文件。所有参数都是可选的，默认值会导致无操作。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item</strong> (<em>int/str</em>) – 条目的索引或名称。整数必须在 <code class="xref any docutils literal notranslate"><span class="pre">range(embfile_count())</span></code> 范围内。</p></li>
<li><p><strong>buffer</strong> (<em>bytes</em><em>,</em><em>bytearray</em><em>,</em><em>BytesIO</em>) – <p>新的文件内容。</p>
<p><em>(变更于 v1.14.13)</em> 现在也支持 <em>io.BytesIO</em>。</p>
</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – 新的文件名。</p></li>
<li><p><strong>ufilename</strong> (<em>str</em>) – 新的 Unicode 文件名。</p></li>
<li><p><strong>desc</strong> (<em>str</em>) – 新的描述。</p></li>
</ul>
</dd>
</dl>
<p><em>(变更于 v1.18.13)</em> 该方法现在返回文件对象的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>文件对象的 xref。自动地，PDF 键 <code class="xref any docutils literal notranslate"><span class="pre">/ModDate</span></code> 将会更新为当前日期时间。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.close" title="永久链接至目标">#</a></dt>
<dd><p>释放与文档相关的对象和空间分配。如果是从文件创建的，也会关闭 <em>filename</em> （将控制权交还给操作系统）。显式关闭文档等同于删除它，<code class="xref any docutils literal notranslate"><span class="pre">del</span> <span class="pre">doc</span></code>，或将其赋值为其他对象，如 <code class="xref any docutils literal notranslate"><span class="pre">doc</span> <span class="pre">=</span> <span class="pre">None</span></code>。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_object">
<span class="sig-name descname"><span class="pre">xref_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compressed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_object" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新功能，v1.16.8</p></li>
<li><p>变更于 v1.18.10</p></li>
</ul>
<p>仅限 PDF：返回 PDF 对象的定义源。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – 对象的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。<em>变更于 v1.18.10:</em> 值为 <code class="xref any docutils literal notranslate"><span class="pre">-1</span></code> 时返回 PDF trailer 源。</p></li>
<li><p><strong>compressed</strong> (<em>bool</em>) – 是否生成没有换行符或空格的紧凑输出。</p></li>
<li><p><strong>ascii</strong> (<em>bool</em>) – 是否将二进制数据进行 ASCII 编码。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>对象的定义源。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.pdf_catalog">
<span class="sig-name descname"><span class="pre">pdf_catalog</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.pdf_catalog" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新功能，v1.16.8</p></li>
</ul>
<p>仅限 PDF：返回 PDF 目录（或根）对象的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 编号。使用该编号与 <a class="reference internal" href="#Document.xref_object" title="Document.xref_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_object()</span></code></a> 来查看其源。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.pdf_trailer">
<span class="sig-name descname"><span class="pre">pdf_trailer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compressed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.pdf_trailer" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新功能，v1.16.8</p></li>
</ul>
<p>仅限 PDF：返回 PDF 的 trailer 源，通常位于 PDF 文件的末尾。这相当于 <a class="reference internal" href="#Document.xref_object" title="Document.xref_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_object()</span></code></a>，并且 <em>xref</em> 参数为 -1。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_stream">
<span class="sig-name descname"><span class="pre">xref_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_stream" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新功能，v1.16.8</p></li>
</ul>
<p>仅限 PDF：返回 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 流对象的 <strong>解压缩</strong> 内容。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 编号。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>bytes</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>对象的（解压缩的）流内容。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_stream_raw">
<span class="sig-name descname"><span class="pre">xref_stream_raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_stream_raw" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新功能，v1.16.8</p></li>
</ul>
<p>仅限 PDF：返回 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 流对象的 <strong>未修改</strong> （尤其是 <strong>未解压缩</strong>）内容。与 <a class="reference internal" href="#Document.xref_stream" title="Document.xref_stream"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_stream()</span></code></a> 基本相同。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>bytes</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>对象的（原始，未修改的）流内容。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.update_object">
<span class="sig-name descname"><span class="pre">update_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obj_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.update_object" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新功能，v1.16.8</p></li>
</ul>
<p>仅限 PDF：用提供的字符串替换 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 对象的定义。该 xref 也可以是新的，在这种情况下，此指令将完成对象定义。如果提供了页面对象，页面的链接和注释将在之后重新加载。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 编号。</p></li>
<li><p><strong>obj_str</strong> (<em>str</em>) – 包含有效 PDF 对象定义的字符串。</p></li>
<li><p><strong>page</strong> (<a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a>) – 页面对象。如果提供，将指示该页面的注释应该刷新（重新加载），以反映链接和/或注释所做的更改。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>如果成功则返回零，否则将引发异常。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.update_stream">
<span class="sig-name descname"><span class="pre">update_stream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.update_stream" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新功能，v1.16.8</p></li>
<li><p>变更于 v1.19.2：添加了参数 “compress”</p></li>
<li><p>变更于 v1.19.6：弃用参数 “new”。现在确认对象是一个 PDF 字典对象。</p></li>
</ul>
<p>替换由 <em>xref</em> 标识的对象的流，该对象必须是 PDF 字典。如果该对象不是 <a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref py py-data docutils literal notranslate"><span class="pre">stream</span></code></a>，它将被转换为流。该函数会自动执行压缩操作（”deflate”），如果有益的话。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 编号。</p></li>
<li><p><strong>stream</strong> (<em>bytes</em><em>|</em><em>bytearray</em><em>|</em><em>BytesIO</em>) – <p>流的新内容。</p>
<p><em>(变更于 v1.14.13:)</em> 现在也支持 <em>io.BytesIO</em> 对象。</p>
</p></li>
<li><p><strong>new</strong> (<em>bool</em>) – <em>弃用</em>，将被忽略。将在 v1.20.0 之后移除。</p></li>
<li><p><strong>compress</strong> (<em>bool</em>) – 是否压缩插入的流。如果 <code class="xref any docutils literal notranslate"><span class="pre">True</span></code> （默认），则流将使用 <code class="xref any docutils literal notranslate"><span class="pre">/FlateDecode</span></code> 压缩（如果有益），否则流将按原样插入。</p></li>
</ul>
</dd>
<dt class="field-even">抛出<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – 如果 <em>xref</em> 不代表 PDF <code class="xref py py-data docutils literal notranslate"><span class="pre">dict</span></code>。空字典 <code class="docutils literal notranslate"><span class="pre">&lt;&lt;&gt;&gt;</span></code> 是被接受的。所以，如果您刚创建了 xref 并想给它一个流，请先执行 <code class="xref any docutils literal notranslate"><span class="pre">doc.update_object(xref,</span> <span class="pre">&quot;&lt;&lt;&gt;&gt;&quot;)</span></code>，然后使用此方法插入流数据。</p>
</dd>
</dl>
<p>此方法主要（但不完全）用于操作包含 PDF 操作符语法的流（请参阅 <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a> 第 643 页），例如页面内容流。</p>
<p>如果更新内容流，请考虑使用保存参数 <em>clean=True</em> 来确保 PDF 操作符源和对象结构之间的一致性。</p>
<p>示例：假设您不再希望页面上出现某个图像。这可以通过删除相应内容源中的引用来实现——事实上：图像在重新加载页面后将消失。但页面的 <a class="reference internal" href="glossary.html#resources" title="resources"><code class="xref py py-data docutils literal notranslate"><span class="pre">resources</span></code></a> 对象仍会显示该图像被页面引用。此保存选项将清理任何此类不匹配。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_copy">
<span class="sig-name descname"><span class="pre">xref_copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_copy" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>新功能，v1.19.5</p></li>
</ul>
<p>仅限 PDF：使 <em>target</em> xref 成为 <em>source</em> 的精确副本。如果 <em>source</em> 是 <a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref py py-data docutils literal notranslate"><span class="pre">stream</span></code></a>，那么这些数据也会被复制。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<em>int</em>) – 源 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。必须是现有的 <strong>字典</strong> 对象。</p></li>
<li><p><strong>target</strong> (<em>int</em>) – 目标 xref。必须是现有的 <strong>字典</strong> 对象。如果该 xref 刚刚被创建，请确保将其初始化为具有最小规格的 PDF 字典 <code class="docutils literal notranslate"><span class="pre">&lt;&lt;&gt;&gt;</span></code>。</p></li>
<li><p><strong>keep</strong> (<em>list</em>) – 可选的 <em>target</em> 顶级键的列表，这些键在准备复制过程中不应被删除。</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ul class="simple">
<li><p>此方法与 Python 的 <em>dict</em> 方法 <a class="reference internal" href="pixmap.html#Pixmap.copy" title="Pixmap.copy"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">copy()</span></code></a> 非常相似。</p></li>
<li><p>两个 xref 编号必须代表现有的字典。</p></li>
<li><p>在从 <em>source</em> 复制数据之前，所有 <em>target</em> 字典键都会被删除。您可以在 <em>keep</em> 列表中指定例外。如果 <em>source</em> 具有相同名称的键，其值仍会替换目标。</p></li>
<li><p>如果 <em>source</em> 是 <a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref py py-data docutils literal notranslate"><span class="pre">stream</span></code></a> 对象，那么这些数据也会被复制，并且 <em>target</em> 将被转换为流对象。</p></li>
<li><p>一个典型的用例是替换或移除现有图像，而不使用删除注释。示例脚本可以在 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/replace-image">这里</a> 中看到。</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.extract_image">
<span class="sig-name descname"><span class="pre">extract_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.extract_image" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：提取存储在文档中的图像数据和元信息。输出可以直接用于存储为图像文件、作为 PIL 输入、创建 <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> 等。此方法尽可能避免使用 pixmap 来呈现图像，以其原始格式（例如 JPEG）展示图像。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – 图像对象的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。如果不在 <code class="xref any docutils literal notranslate"><span class="pre">range(1,</span> <span class="pre">doc.xref_length())</span></code> 范围内，或该对象不是图像或发生其他错误，则返回 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>，且不会引发异常。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>包含以下键的字典：</p>
<ul class="simple">
<li><p><em>ext</em> (<em>str</em>) 图像类型（例如 <em>‘jpeg’</em>），可用作图像文件扩展名。</p></li>
<li><p><em>smask</em> (<em>int</em>) 蒙版 (/SMask) 图像的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 编号，或为零。</p></li>
<li><p><em>width</em> (<em>int</em>) 图像宽度。</p></li>
<li><p><em>height</em> (<em>int</em>) 图像高度。</p></li>
<li><p><em>colorspace</em> (<em>int</em>) 图像的 <em>colorspace.n</em> 编号。</p></li>
<li><p><em>cs-name</em> (<em>str</em>) 图像的 <em>colorspace.name</em>。</p></li>
<li><p><em>xres</em> (<em>int</em>) x 方向的分辨率。请参见 <a class="reference internal" href="glossary.html#resolution" title="resolution"><code class="xref py py-data docutils literal notranslate"><span class="pre">resolution</span></code></a>。</p></li>
<li><p><em>yres</em> (<em>int</em>) y 方向的分辨率。请参见 <a class="reference internal" href="glossary.html#resolution" title="resolution"><code class="xref py py-data docutils literal notranslate"><span class="pre">resolution</span></code></a>。</p></li>
<li><p><em>image</em> (<em>bytes</em>) 图像数据，可作为图像文件内容使用。</p></li>
</ul>
</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">extract_image</span><span class="p">(</span><span class="mi">1373</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">{&#39;ext&#39;: &#39;png&#39;, &#39;smask&#39;: 2934, &#39;width&#39;: 5, &#39;height&#39;: 629, &#39;colorspace&#39;: 3, &#39;xres&#39;: 96,</span>
<span class="go">&#39;yres&#39;: 96, &#39;cs-name&#39;: &#39;DeviceRGB&#39;,</span>
<span class="go">&#39;image&#39;: b&#39;\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00\x05\ ...&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;image.</span><span class="si">{</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;ext&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">])</span>
<span class="go">102</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgout</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>此方法与 <em>pix = pymupdf.Pixmap(doc, xref)</em>，然后调用 <em>pix.tobytes()</em> 有功能重叠。主要区别在于，<a class="reference internal" href="#Document.extract_image" title="Document.extract_image"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">extract_image</span></code></a> <strong>(1)</strong> 不总是提供 PNG 图像格式， <strong>(2)</strong> 对非 PNG 图像 <strong>非常</strong> 快速，<strong>(3)</strong> 通常会导致提取的图像占用更少的磁盘存储，<strong>(4)</strong> 在错误情况下返回 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code> （不会生成异常）。以下是同一 PDF 中的示例图像。</p>
<ul>
<li><p>xref 1268 是 PNG – 可比的执行时间和相同的输出:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>In [23]: %timeit pix = pymupdf.Pixmap(doc, 1268);pix.tobytes()
10.8 ms ± 52.4 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
In [24]: len(pix.tobytes())
Out[24]: 21462

In [25]: %timeit img = doc.extract_image(1268)
10.8 ms ± 86 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
In [26]: len(img[&quot;image&quot;])
Out[26]: 21462
</pre></div>
</div>
</li>
<li><p>xref 1186 是 JPEG – <a class="reference internal" href="#Document.extract_image" title="Document.extract_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extract_image()</span></code></a> <strong>速度更快</strong>，并生成 <strong>更小的</strong> 输出（2.48 MB vs. 0.35 MB）:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>In [27]: %timeit pix = pymupdf.Pixmap(doc, 1186);pix.tobytes()
341 ms ± 2.86 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
In [28]: len(pix.tobytes())
Out[28]: 2599433

In [29]: %timeit img = doc.extract_image(1186)
15.7 µs ± 116 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
In [30]: len(img[&quot;image&quot;])
Out[30]: 371177
</pre></div>
</div>
</li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.extract_font">
<span class="sig-name descname"><span class="pre">extract_font</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">named</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.extract_font" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.19.4 变更：如果 <code class="xref any docutils literal notranslate"><span class="pre">named</span> <span class="pre">==</span> <span class="pre">True</span></code>，返回一个字典。</p></li>
</ul>
<p>仅限 PDF：返回嵌入字体文件的数据和相应的文件扩展名。可用于将字体存储为外部文件。该方法不会引发异常（除了检查 PDF 和有效的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>）。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – 要提取的字体的 PDF 对象编号。</p></li>
<li><p><strong>info_only</strong> (<em>bool</em>) – 仅返回字体信息，不返回缓冲区。用于仅获取信息的目的，避免分配大型缓冲区区域。</p></li>
<li><p><strong>named</strong> (<em>bool</em>) – 如果为 True，返回包含以下键的字典：’name’（字体基本名称），’ext’（字体文件扩展名），’type’（字体类型），’content’（字体文件内容）。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple,dict</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>一个元组 <code class="xref any docutils literal notranslate"><span class="pre">(basename,</span> <span class="pre">ext,</span> <span class="pre">type,</span> <span class="pre">content)</span></code>，其中 <em>ext</em> 是 3 字节的建议文件扩展名 (<em>str</em>)，<em>basename</em> 是字体的名称 (<em>str</em>)，<em>type</em> 是字体的类型（例如 “Type1”），<em>content</em> 是包含字体文件内容的字节对象（或 <em>b””</em>）。对于可能的扩展值及其含义，请参阅 <a class="reference internal" href="vars.html#fontextensions"><span class="std std-ref">字体文件扩展名</span></a>。错误时返回详细信息：</p>
<ul class="simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">(&quot;&quot;,</span> <span class="pre">&quot;&quot;,</span> <span class="pre">&quot;&quot;,</span> <span class="pre">b&quot;&quot;)</span></code> – 无效的 xref 或 xref 不是（有效的）字体对象。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">(basename,</span> <span class="pre">&quot;n/a&quot;,</span> <span class="pre">&quot;Type1&quot;,</span> <span class="pre">b&quot;&quot;)</span></code> – <em>basename</em> 未嵌入，因此无法提取。这适用于例如 <a class="reference internal" href="app3.html#base-14-fonts"><span class="std std-ref">PDF Base 14 字体</span></a> 和 Type 3 字体。</p></li>
</ul>
</p>
</dd>
</dl>
<p>示例：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 将字体存储为外部文件</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name</span><span class="p">,</span> <span class="n">ext</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">content</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">extract_font</span><span class="p">(</span><span class="mi">4711</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 假设 content 不是 None：</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ofile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">ext</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ofile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ofile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p><code class="xref any docutils literal notranslate"><span class="pre">basename</span></code> 会保持从 PDF 返回，可能包含一些字符（如空格），这些字符可能不适合您的操作系统的文件名。请采取适当的措施。</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ul class="simple">
<li><p>返回的 <em>basename</em> 通常 <strong>不是</strong> 原始文件名，但可能与之有某些相似之处。</p></li>
<li><p>如果参数 <code class="xref any docutils literal notranslate"><span class="pre">named</span> <span class="pre">==</span> <span class="pre">True</span></code>，则返回一个包含以下键的字典：<code class="xref any docutils literal notranslate"><span class="pre">{'name':</span> <span class="pre">'T1',</span> <span class="pre">'ext':</span> <span class="pre">'n/a',</span> <span class="pre">'type':</span> <span class="pre">'Type3',</span> <span class="pre">'content':</span> <span class="pre">b''}</span></code>。</p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.xref_xml_metadata">
<span class="sig-name descname"><span class="pre">xref_xml_metadata</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.xref_xml_metadata" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.16.8 新增</p></li>
</ul>
<p>仅限 PDF：返回文档 XML 元数据的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.has_links">
<span class="sig-name descname"><span class="pre">has_links</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.has_links" title="永久链接至目标">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.has_annots">
<span class="sig-name descname"><span class="pre">has_annots</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.has_annots" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.18.7 新增</p></li>
</ul>
<p>仅限 PDF：检查文档中是否存在链接或注释。</p>
<dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>True</em> / <em>False</em>。与字段不同，字段存储在 PDF 文档的中央位置，而链接或注释的存在只能通过解析每个页面来检测。这些方法经过优化，可高效执行，并且如果在某个页面找到 <em>True</em>，则会立即返回。但如果 PDF 包含数千页，并且未找到链接或注释，则可能需要较长时间 <a class="footnote-reference brackets" href="#f13" id="id11" role="doc-noteref"><span class="fn-bracket">[</span>13<span class="fn-bracket">]</span></a> 。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.subset_fonts">
<span class="sig-name descname"><span class="pre">subset_fonts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fallback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.subset_fonts" title="永久链接至目标">#</a></dt>
<dd><p>仅限 PDF：分析文档中的字体是否可用于文本，并检查是否可以缩小字体大小。如果字体支持且可以减少大小，则会用仅包含部分字符的字体版本替换原字体。</p>
<p>请在保存文档之前立即使用此方法。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>verbose</strong> (<em>bool</em>) – 是否向标准输出打印进度信息。目前仅在 <code class="xref any docutils literal notranslate"><span class="pre">fallback</span></code> 为 <code class="xref any docutils literal notranslate"><span class="pre">True</span></code> 时有效。</p></li>
<li><p><strong>fallback</strong> (<em>bool</em>) – 是否使用已弃用的算法，该算法依赖于 <a class="reference external" href="https://pypi.org/project/fonttools/">fontTools</a> （必须安装此包）。如果使用推荐值 <code class="xref any docutils literal notranslate"><span class="pre">False</span></code> （默认），则会使用 MuPDF 的原生函数 —— <strong>速度快得多</strong> ，并且支持更多种类的字体。在此情况下，无需安装 <code class="xref any docutils literal notranslate"><span class="pre">fontTools</span></code>。</p></li>
</ul>
</dd>
</dl>
<p>在创建包含大字体（如亚洲字符集）的新 PDF 时，此方法的优化效果最明显。例如，使用 <a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a> 类或方法 <a class="reference internal" href="page.html#Page.insert_htmlbox" title="Page.insert_htmlbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_htmlbox()</span></code></a> 时，可能会自动包含多个字体，而程序员对此可能并不知情。</p>
<p>在这些情况下，实际使用的 Unicode 字符通常远少于字体可用的字形数量。使用此方法可以轻松减少嵌入字体的大小，从几 MB 级别减少到几十 KB。</p>
<p>创建字体子集后，PDF 可能会遗留大量未使用的 PDF 对象（“幽灵对象”）。因此，在保存文件时，请务必进行压缩和垃圾回收。建议使用 <a class="reference internal" href="#Document.ez_save" title="Document.ez_save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.ez_save()</span></code></a>。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.7 新增</p></li>
<li><p>v1.18.9 变更</p></li>
<li><p>v1.24.2 变更，改为使用 MuPDF 的原生函数。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_enable">
<span class="sig-name descname"><span class="pre">journal_enable</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_enable" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.19.0 新增</p></li>
</ul>
<p>仅限 PDF：启用日志记录。在开始记录操作之前，请先调用此方法。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_start_op">
<span class="sig-name descname"><span class="pre">journal_start_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_start_op" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.19.0 新增</p></li>
</ul>
<p>仅限 PDF：启动一个日志操作，并使用字符串 <code class="xref any docutils literal notranslate"><span class="pre">&quot;name&quot;</span></code> 作为标识。对于启用了日志记录的 PDF，如果未启动操作，则更新将失败。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_stop_op">
<span class="sig-name descname"><span class="pre">journal_stop_op</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_stop_op" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.19.0 新增</p></li>
</ul>
<p>仅限 PDF：停止当前操作。从开始到停止之间的所有更新都属于同一个工作单元，并将在撤销/重做时一同应用。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_position">
<span class="sig-name descname"><span class="pre">journal_position</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_position" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.19.0 新增</p></li>
</ul>
<p>仅限 PDF：返回当前操作编号及总操作数。</p>
<dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>一个元组 <code class="xref any docutils literal notranslate"><span class="pre">(step,</span> <span class="pre">steps)</span></code>，其中 <strong>step</strong> 是当前操作编号，<strong>steps</strong> 是日志中的总操作数。如果 <strong>step</strong> 为 0，表示当前位于日志顶部；如果 <strong>step</strong> 等于 <strong>steps</strong>，表示当前位于日志底部。</p>
</dd>
</dl>
<p>在执行撤销或重做以外的任何更新时，当前操作之后的所有日志条目都会被删除，新更新将成为日志中的最新条目。被删除的日志条目对应的更新将被永久丢失。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_op_name">
<span class="sig-name descname"><span class="pre">journal_op_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_op_name" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.19.0 新增</p></li>
</ul>
<p>仅限 PDF：返回编号为 <em>step</em> 的操作名称。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_can_do">
<span class="sig-name descname"><span class="pre">journal_can_do</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_can_do" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.19.0 新增</p></li>
</ul>
<p>仅限 PDF：检查是否可以从当前日志位置执行前进（”redo”）或后退（”undo”）操作。</p>
<dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>一个字典 <code class="xref any docutils literal notranslate"><span class="pre">{&quot;undo&quot;:</span> <span class="pre">bool,</span> <span class="pre">&quot;redo&quot;:</span> <span class="pre">bool}</span></code>。如果值为 <code class="xref any docutils literal notranslate"><span class="pre">True</span></code>，则相应的方法可用。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_undo">
<span class="sig-name descname"><span class="pre">journal_undo</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_undo" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.19.0 新增</p></li>
</ul>
<p>仅限 PDF：撤销（undo）日志中的当前步骤。此操作会向日志的顶部移动。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_redo">
<span class="sig-name descname"><span class="pre">journal_redo</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_redo" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.19.0 新增</p></li>
</ul>
<p>仅限 PDF：重做（redo）日志中的当前步骤。此操作会向日志的底部移动。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_save">
<span class="sig-name descname"><span class="pre">journal_save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_save" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.19.0 新增</p></li>
</ul>
<p>仅限 PDF：将日志保存到文件。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em><em>,</em><em>fp</em>) – 可以是字符串格式的文件名，也可以是以 <code class="xref any docutils literal notranslate"><span class="pre">&quot;wb&quot;</span></code> 打开的文件对象（或 <code class="xref any docutils literal notranslate"><span class="pre">io.BytesIO()</span></code> 对象）。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.journal_load">
<span class="sig-name descname"><span class="pre">journal_load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Document.journal_load" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.19.0 新增</p></li>
</ul>
<p>仅限 PDF：从文件加载日志，并为文档启用日志记录。如果日志记录已启用，则会引发异常。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em><em>,</em><em>fp</em>) – 日志文件的名称（字符串），或以 <code class="xref any docutils literal notranslate"><span class="pre">&quot;rb&quot;</span></code> 打开的文件对象（或 <code class="xref any docutils literal notranslate"><span class="pre">io.BytesIO()</span></code> 对象）。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Document.save_snapshot">
<span class="sig-name descname"><span class="pre">save_snapshot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Document.save_snapshot" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.19.0 新增</p></li>
</ul>
<p>仅限 PDF：保存文档的“快照”。这是一种特殊的增量保存格式的 PDF 文档，兼容日志记录，因此不提供任何保存选项。新建文档无法保存快照。</p>
<p>这是一个正常的 PDF 文档，没有任何使用限制。如果未进行任何更改，它可以与日志一起使用，以执行撤销 / 重做操作或继续更新。</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.outline">
<span class="sig-name descname"><span class="pre">outline</span></span><a class="headerlink" href="#Document.outline" title="永久链接至目标">#</a></dt>
<dd><p>包含文档的首个 <a class="reference internal" href="outline.html#outline"><span class="std std-ref">Outline</span></a> 条目（或 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>）。可作为遍历所有大纲项的起点。对于加密但未经身份验证的文档，访问此属性将引发 <em>AttributeError</em>。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="outline.html#outline"><span class="std std-ref">Outline</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_closed">
<span class="sig-name descname"><span class="pre">is_closed</span></span><a class="headerlink" href="#Document.is_closed" title="永久链接至目标">#</a></dt>
<dd><p>如果文档仍然打开，则值为 <em>False</em>。如果文档已关闭，则大多数其他属性和方法都将被删除 / 禁用。此外，所有引用此文档的 <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> 对象（即通过 <a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a> 创建的页面）及其相关对象也将无法使用。
出于参考目的，<a class="reference internal" href="#Document.name" title="Document.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.name</span></code></a> 仍然存在，并包含原始文档的文件名（如果适用）。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_dirty">
<span class="sig-name descname"><span class="pre">is_dirty</span></span><a class="headerlink" href="#Document.is_dirty" title="永久链接至目标">#</a></dt>
<dd><p>如果这是一个 PDF 文档且包含未保存的更改，则值为 <em>True</em>，否则为 <em>False</em>。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_pdf">
<span class="sig-name descname"><span class="pre">is_pdf</span></span><a class="headerlink" href="#Document.is_pdf" title="永久链接至目标">#</a></dt>
<dd><p>如果这是一个 PDF 文档，则值为 <em>True</em>，否则为 <em>False</em>。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_form_pdf">
<span class="sig-name descname"><span class="pre">is_form_pdf</span></span><a class="headerlink" href="#Document.is_form_pdf" title="永久链接至目标">#</a></dt>
<dd><p>如果文档不是 PDF 或者没有表单字段，则值为 <em>False</em>。否则，返回根表单字段（无父级字段）的数量。</p>
<p><em>(v1.16.4 变更)</em> 现在返回总的（根）表单字段数量。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool,int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_reflowable">
<span class="sig-name descname"><span class="pre">is_reflowable</span></span><a class="headerlink" href="#Document.is_reflowable" title="永久链接至目标">#</a></dt>
<dd><p>如果文档具有可变页面布局（如电子书或 HTML），则值为 <em>True</em>。在这种情况下，可以在文档创建（打开）时或通过 <a class="reference internal" href="#Document.layout" title="Document.layout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">layout()</span></code></a> 方法设置所需的页面尺寸。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_repaired">
<span class="sig-name descname"><span class="pre">is_repaired</span></span><a class="headerlink" href="#Document.is_repaired" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.18.2 新增</p></li>
</ul>
<p>如果 PDF 在打开时因结构问题被修复，则值为 <em>True</em>。对于非 PDF 文档，始终为 <em>False</em>。
如果该值为 <em>True</em>，则详细信息存储在 <code class="xref any docutils literal notranslate"><span class="pre">TOOLS.mupdf_warnings()</span></code> 中，并且 <a class="reference internal" href="#Document.can_save_incrementally" title="Document.can_save_incrementally"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.can_save_incrementally()</span></code></a> 将返回 <em>False</em>。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_fast_webaccess">
<span class="sig-name descname"><span class="pre">is_fast_webaccess</span></span><a class="headerlink" href="#Document.is_fast_webaccess" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.22.2 新增</p></li>
</ul>
<p>如果 PDF 采用线性化格式，则值为 <em>True</em>。对于非 PDF 文档，值为 <em>False</em>。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.markinfo">
<span class="sig-name descname"><span class="pre">markinfo</span></span><a class="headerlink" href="#Document.markinfo" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.22.2 新增</p></li>
</ul>
<p>一个字典，指示 <code class="xref any docutils literal notranslate"><span class="pre">/MarkInfo</span></code> 值。如果未指定，则返回空字典。对于非 PDF 文档，返回 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.pagemode">
<span class="sig-name descname"><span class="pre">pagemode</span></span><a class="headerlink" href="#Document.pagemode" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.22.2 新增</p></li>
</ul>
<p>一个字符串，包含 <code class="xref any docutils literal notranslate"><span class="pre">/PageMode</span></code> 值。如果未指定，则返回默认值 <code class="xref any docutils literal notranslate"><span class="pre">&quot;UseNone&quot;</span></code>。对于非 PDF 文档，返回 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.pagelayout">
<span class="sig-name descname"><span class="pre">pagelayout</span></span><a class="headerlink" href="#Document.pagelayout" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.22.2 新增</p></li>
</ul>
<p>一个字符串，包含 <code class="xref any docutils literal notranslate"><span class="pre">/PageLayout</span></code> 值。如果未指定，则返回默认值 <code class="xref any docutils literal notranslate"><span class="pre">&quot;SinglePage&quot;</span></code>。对于非 PDF 文档，返回 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.version_count">
<span class="sig-name descname"><span class="pre">version_count</span></span><a class="headerlink" href="#Document.version_count" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.22.2 新增</p></li>
</ul>
<p>一个整数，表示文档中存在的版本数量。如果不是 PDF，则返回 0，否则返回增量保存次数加 1。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.needs_pass">
<span class="sig-name descname"><span class="pre">needs_pass</span></span><a class="headerlink" href="#Document.needs_pass" title="永久链接至目标">#</a></dt>
<dd><p>指示文档是否受密码保护以限制访问。该指示器在 <strong>即使文档已通过身份验证</strong> 后仍保持不变。如果值为 <em>True</em>，则无法进行增量保存。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.is_encrypted">
<span class="sig-name descname"><span class="pre">is_encrypted</span></span><a class="headerlink" href="#Document.is_encrypted" title="永久链接至目标">#</a></dt>
<dd><p>该指示器初始值等于 <a class="reference internal" href="#Document.needs_pass" title="Document.needs_pass"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.needs_pass</span></code></a>。成功身份验证后，该值会被设置为 <em>False</em> 以反映当前状态。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.permissions">
<span class="sig-name descname"><span class="pre">permissions</span></span><a class="headerlink" href="#Document.permissions" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.16.0 变更：该属性现在是一个包含位指示器的整数，之前是一个字典。</p></li>
</ul>
<p>包含访问文档的权限。该值是一个整数，其中各个位表示不同的权限。例如，如果 <em>doc.permissions &amp; pymupdf.PDF_PERM_MODIFY &gt; 0</em>，则可以修改文档。
详见 <a class="reference internal" href="vars.html#permissioncodes"><span class="std std-ref">文档权限</span></a>。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.metadata">
<span class="sig-name descname"><span class="pre">metadata</span></span><a class="headerlink" href="#Document.metadata" title="永久链接至目标">#</a></dt>
<dd><p>包含文档的元数据，格式为 Python 字典。如果 <em>is_encrypted=True</em> 且 <em>needs_pass=True</em>，则返回 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>。
键包括 <em>format</em>、<em>encryption</em>、<em>title</em>、<em>author</em>、<em>subject</em>、<em>keywords</em>、<em>creator</em>、<em>producer</em>、<em>creationDate</em>、<em>modDate</em>、<em>trapped</em>，其值均为字符串或 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>。</p>
<p>对于 PDF 文档，除 <em>format</em> 和 <em>encryption</em> 之外，键名对应于 PDF 的标准元数据键，例如 <em>/Creator</em>、<em>/Producer</em>、<em>/CreationDate</em>、<em>/ModDate</em>、<em>/Title</em>、<em>/Author</em>、<em>/Subject</em>、<em>/Trapped</em> 和 <em>/Keywords</em>。</p>
<ul class="simple">
<li><p><em>format</em> 表示文档格式（如 <code class="xref any docutils literal notranslate"><span class="pre">'PDF-1.6'</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">'XPS'</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">'EPUB'</span></code>）。</p></li>
<li><p><em>encryption</em> 指示加密方式，可能为 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code> （未加密）或加密算法名称（如 <code class="xref any docutils literal notranslate"><span class="pre">'Standard</span> <span class="pre">V4</span> <span class="pre">R4</span> <span class="pre">128-bit</span> <span class="pre">RC4'</span></code>）。即使 <em>needs_pass=False</em>，文档仍可能受到部分权限限制，可通过 <a class="reference internal" href="#Document.permissions" title="Document.permissions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.permissions</span></code></a> 检查具体权限。</p></li>
<li><p>如果日期字段包含有效数据（这并不总是保证的），则采用 PDF 专用时间戳格式 <code class="xref any docutils literal notranslate"><span class="pre">&quot;D:&lt;TS&gt;&lt;TZ&gt;&quot;</span></code>，其中：</p>
<ul>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">&lt;TS&gt;</span></code> 是 12 位 ISO 格式时间戳 <em>YYYYMMDDhhmmss</em> （ <em>YYYY</em> - 年， <em>MM</em> - 月， <em>DD</em> - 日， <em>hh</em> - 小时， <em>mm</em> - 分钟， <em>ss</em> - 秒）。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">&lt;TZ&gt;</span></code> 是时区值（相对 GMT 的时间偏移量），格式为 <code class="xref any docutils literal notranslate"><span class="pre">+hh'mm'</span></code> 或 <code class="xref any docutils literal notranslate"><span class="pre">-hh'mm'</span></code>。</p></li>
</ul>
</li>
<li><p>例如，巴拉圭的时间戳可能为 <code class="xref any docutils literal notranslate"><span class="pre">&quot;D:20150415131602-04'00'&quot;</span></code>，表示 2015 年 4 月 15 日 13:16:02（当地时间：亚松森）。</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#Document.name" title="永久链接至目标">#</a></dt>
<dd><p>包含 <em>Document</em> 创建时的 <em>文件名</em> 或 <em>文件类型</em>。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.page_count">
<span class="sig-name descname"><span class="pre">page_count</span></span><a class="headerlink" href="#Document.page_count" title="永久链接至目标">#</a></dt>
<dd><p>文档的总页数。如果文档没有页面，则返回 0。可以使用 <code class="xref any docutils literal notranslate"><span class="pre">len(doc)</span></code> 获取相同的结果。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.chapter_count">
<span class="sig-name descname"><span class="pre">chapter_count</span></span><a class="headerlink" href="#Document.chapter_count" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.17.0 新增</p></li>
</ul>
<p>文档中的章节数。对于支持章节的文档格式（目前仅 EPUB）有效，始终至少为 1。其他格式返回 1。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.last_location">
<span class="sig-name descname"><span class="pre">last_location</span></span><a class="headerlink" href="#Document.last_location" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>v1.17.0 新增</p></li>
</ul>
<p>记录文档的最后位置，格式为 <code class="xref any docutils literal notranslate"><span class="pre">(chapter,</span> <span class="pre">pno)</span></code>。仅适用于支持章节的格式（目前仅 EPUB）。
其他格式返回 <code class="xref any docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">page_count</span> <span class="pre">-</span> <span class="pre">1)</span></code>，如果文档无页面，则返回 <code class="xref any docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">-1)</span></code>。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple(int, int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Document.FormFonts">
<span class="sig-name descname"><span class="pre">FormFonts</span></span><a class="headerlink" href="#Document.FormFonts" title="永久链接至目标">#</a></dt>
<dd><p>包含在 <em>/AcroForm</em> 对象中定义的表单字段字体名称的列表。如果不是 PDF，则返回 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">备注</p>
<p>对于修改 PDF 结构的方法（如 <a class="reference internal" href="#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_pdf()</span></code></a>、<a class="reference internal" href="#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">select()</span></code></a>、<a class="reference internal" href="#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">copy_page()</span></code></a>、<a class="reference internal" href="#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_page()</span></code></a> 等），请注意，程序中的对象或属性可能会失效或变成孤立对象。例如:</p>
<ul class="simple">
<li><p><a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> 对象及其子对象（链接、注释、小部件）可能会变得无效。</p></li>
<li><p>存储旧页面计数的变量可能需要更新。</p></li>
<li><p>目录结构等数据可能需要重新生成。</p></li>
</ul>
<p>请务必保持相关变量的更新，或删除无效对象。详见 <a class="reference internal" href="app3.html#referenialintegrity"><span class="std std-ref">确保 PyMuPDF 中重要对象的一致性</span></a>。</p>
</div>
</dd></dl>

</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">英文</label><div class="tab-content docutils container">
<p>This class represents a document. It can be constructed from a file or from memory.</p>
<p>There exists the alias <em>open</em> for this class, i.e. <code class="xref any docutils literal notranslate"><span class="pre">pymupdf.Document(...)</span></code> and <code class="xref any docutils literal notranslate"><span class="pre">pymupdf.open(...)</span></code> do exactly the same thing.</p>
<p>For details on <strong>embedded files</strong> refer to Appendix 3.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Starting with v1.17.0, a new page addressing mechanism for <strong>EPUB files only</strong> is supported. This document type is internally organized in chapters such that pages can most efficiently be found by their so-called “location”. The location is a tuple <em>(chapter, pno)</em> consisting of the chapter number and the page number <strong>in that chapter</strong>. Both numbers are zero-based.</p>
<p>While it is still possible to locate a page via its (absolute) number, doing so may mean that the complete EPUB document must be laid out before the page can be addressed. This may have a significant performance impact if the document is very large. Using the page’s <em>(chapter, pno)</em> prevents this from happening.</p>
<p>To maintain a consistent API, PyMuPDF supports the page <em>location</em> syntax for <strong>all file types</strong> – documents without this feature simply have just one chapter. <a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a> and the equivalent index access now also support a <em>location</em> argument.</p>
<p>There are a number of methods for converting between page numbers and locations, for determining the chapter count, the page count per chapter, for computing the next and the previous locations, and the last page location of a document.</p>
</div>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Method / Attribute</strong></p></th>
<th class="head"><p><strong>Short Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.add_layer" title="Document.add_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.add_layer()</span></code></a></p></td>
<td><p>PDF only: make new optional content configuration</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.add_ocg" title="Document.add_ocg"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.add_ocg()</span></code></a></p></td>
<td><p>PDF only: add new optional content group</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.authenticate" title="Document.authenticate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.authenticate()</span></code></a></p></td>
<td><p>gain access to an encrypted document</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.bake" title="Document.bake"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.bake()</span></code></a></p></td>
<td><p>PDF only: make annotations / fields permanent content</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.can_save_incrementally" title="Document.can_save_incrementally"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.can_save_incrementally()</span></code></a></p></td>
<td><p>check if incremental save is possible</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.chapter_page_count" title="Document.chapter_page_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.chapter_page_count()</span></code></a></p></td>
<td><p>number of pages in chapter</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.close" title="Document.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.close()</span></code></a></p></td>
<td><p>close the document</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.convert_to_pdf" title="Document.convert_to_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.convert_to_pdf()</span></code></a></p></td>
<td><p>write a PDF version to memory</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.copy_page()</span></code></a></p></td>
<td><p>PDF only: copy a page reference</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.del_toc_item" title="Document.del_toc_item"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.del_toc_item()</span></code></a></p></td>
<td><p>PDF only: remove a single TOC item</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_page()</span></code></a></p></td>
<td><p>PDF only: delete a page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.delete_pages" title="Document.delete_pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_pages()</span></code></a></p></td>
<td><p>PDF only: delete multiple pages</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.embfile_add" title="Document.embfile_add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_add()</span></code></a></p></td>
<td><p>PDF only: add a new embedded file from buffer</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.embfile_count" title="Document.embfile_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_count()</span></code></a></p></td>
<td><p>PDF only: number of embedded files</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.embfile_del" title="Document.embfile_del"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_del()</span></code></a></p></td>
<td><p>PDF only: delete an embedded file entry</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.embfile_get" title="Document.embfile_get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_get()</span></code></a></p></td>
<td><p>PDF only: extract an embedded file buffer</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.embfile_info" title="Document.embfile_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_info()</span></code></a></p></td>
<td><p>PDF only: metadata of an embedded file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.embfile_names" title="Document.embfile_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_names()</span></code></a></p></td>
<td><p>PDF only: list of embedded files</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.embfile_upd" title="Document.embfile_upd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.embfile_upd()</span></code></a></p></td>
<td><p>PDF only: change an embedded file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.extract_font" title="Document.extract_font"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extract_font()</span></code></a></p></td>
<td><p>PDF only: extract a font by <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.extract_image" title="Document.extract_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.extract_image()</span></code></a></p></td>
<td><p>PDF only: extract an embedded image by <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.ez_save" title="Document.ez_save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.ez_save()</span></code></a></p></td>
<td><p>PDF only: <a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> with different defaults</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.find_bookmark" title="Document.find_bookmark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.find_bookmark()</span></code></a></p></td>
<td><p>retrieve page location after laid out document</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.fullcopy_page" title="Document.fullcopy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.fullcopy_page()</span></code></a></p></td>
<td><p>PDF only: duplicate a page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_layer" title="Document.get_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_layer()</span></code></a></p></td>
<td><p>PDF only: lists of OCGs in ON, OFF, RBGroups</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_layers" title="Document.get_layers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_layers()</span></code></a></p></td>
<td><p>PDF only: list of optional content configurations</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_oc" title="Document.get_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_oc()</span></code></a></p></td>
<td><p>PDF only: get OCG /OCMD xref of image / form xobject</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_ocgs" title="Document.get_ocgs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_ocgs()</span></code></a></p></td>
<td><p>PDF only: info on all optional content groups</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_ocmd" title="Document.get_ocmd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_ocmd()</span></code></a></p></td>
<td><p>PDF only: retrieve definition of an <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_page_fonts" title="Document.get_page_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_fonts()</span></code></a></p></td>
<td><p>PDF only: list of fonts referenced by a page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_page_images" title="Document.get_page_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_images()</span></code></a></p></td>
<td><p>PDF only: list of images referenced by a page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_page_labels" title="Document.get_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_labels()</span></code></a></p></td>
<td><p>PDF only: list of page label definitions</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_page_numbers" title="Document.get_page_numbers"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_numbers()</span></code></a></p></td>
<td><p>PDF only: get page numbers having a given label</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_page_pixmap" title="Document.get_page_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_pixmap()</span></code></a></p></td>
<td><p>create a pixmap of a page by page number</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_page_text" title="Document.get_page_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_text()</span></code></a></p></td>
<td><p>extract the text of a page by page number</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_page_xobjects" title="Document.get_page_xobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_xobjects()</span></code></a></p></td>
<td><p>PDF only: list of XObjects referenced by a page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_sigflags" title="Document.get_sigflags"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_sigflags()</span></code></a></p></td>
<td><p>PDF only: determine signature state</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a></p></td>
<td><p>extract the table of contents</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.get_xml_metadata" title="Document.get_xml_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_xml_metadata()</span></code></a></p></td>
<td><p>PDF only: read the XML metadata</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.has_annots" title="Document.has_annots"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.has_annots()</span></code></a></p></td>
<td><p>PDF only: check if PDF contains any annots</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.has_links" title="Document.has_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.has_links()</span></code></a></p></td>
<td><p>PDF only: check if PDF contains any links</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.insert_page" title="Document.insert_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a></p></td>
<td><p>PDF only: insert a new page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a></p></td>
<td><p>PDF only: insert pages from another PDF</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.insert_file" title="Document.insert_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_file()</span></code></a></p></td>
<td><p>PDF only: insert pages from arbitrary document</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.journal_can_do" title="Document.journal_can_do"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_can_do()</span></code></a></p></td>
<td><p>PDF only: which journal actions are possible</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.journal_enable" title="Document.journal_enable"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_enable()</span></code></a></p></td>
<td><p>PDF only: enables journalling for the document</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.journal_load" title="Document.journal_load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_load()</span></code></a></p></td>
<td><p>PDF only: load journal from a file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.journal_op_name" title="Document.journal_op_name"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_op_name()</span></code></a></p></td>
<td><p>PDF only: return name of a journalling step</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.journal_position" title="Document.journal_position"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_position()</span></code></a></p></td>
<td><p>PDF only: return journalling status</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.journal_redo" title="Document.journal_redo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_redo()</span></code></a></p></td>
<td><p>PDF only: redo current operation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.journal_save" title="Document.journal_save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_save()</span></code></a></p></td>
<td><p>PDF only: save journal to a file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.journal_start_op" title="Document.journal_start_op"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_start_op()</span></code></a></p></td>
<td><p>PDF only: start an “operation” giving it a name</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.journal_stop_op" title="Document.journal_stop_op"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_stop_op()</span></code></a></p></td>
<td><p>PDF only: end current operation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.journal_undo" title="Document.journal_undo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.journal_undo()</span></code></a></p></td>
<td><p>PDF only: undo current operation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.layer_ui_configs" title="Document.layer_ui_configs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layer_ui_configs()</span></code></a></p></td>
<td><p>PDF only: list of optional content intents</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.layout" title="Document.layout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.layout()</span></code></a></p></td>
<td><p>re-paginate the document (if supported)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a></p></td>
<td><p>read a page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.make_bookmark" title="Document.make_bookmark"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.make_bookmark()</span></code></a></p></td>
<td><p>create a page pointer in reflowable documents</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.move_page" title="Document.move_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.move_page()</span></code></a></p></td>
<td><p>PDF only: move a page to different location in doc</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.need_appearances" title="Document.need_appearances"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.need_appearances()</span></code></a></p></td>
<td><p>PDF only: get/set <code class="xref any docutils literal notranslate"><span class="pre">/NeedAppearances</span></code> property</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.new_page" title="Document.new_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.new_page()</span></code></a></p></td>
<td><p>PDF only: insert a new empty page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.next_location" title="Document.next_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.next_location()</span></code></a></p></td>
<td><p>return (chapter, pno) of following page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.outline_xref" title="Document.outline_xref"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.outline_xref()</span></code></a></p></td>
<td><p>PDF only: <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> a TOC item</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.page_cropbox" title="Document.page_cropbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.page_cropbox()</span></code></a></p></td>
<td><p>PDF only: the unrotated page rectangle</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.page_xref" title="Document.page_xref"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.page_xref()</span></code></a></p></td>
<td><p>PDF only: <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of a page number</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.pages" title="Document.pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pages()</span></code></a></p></td>
<td><p>iterator over a page range</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.pdf_catalog" title="Document.pdf_catalog"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pdf_catalog()</span></code></a></p></td>
<td><p>PDF only: <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of catalog (root)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.pdf_trailer" title="Document.pdf_trailer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.pdf_trailer()</span></code></a></p></td>
<td><p>PDF only: trailer source</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.prev_location" title="Document.prev_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.prev_location()</span></code></a></p></td>
<td><p>return (chapter, pno) of preceding page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.reload_page" title="Document.reload_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.reload_page()</span></code></a></p></td>
<td><p>PDF only: provide a new copy of a page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.resolve_names" title="Document.resolve_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.resolve_names()</span></code></a></p></td>
<td><p>PDF only: Convert destination names into a Python dict</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a></p></td>
<td><p>PDF only: save the document</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.saveIncr" title="Document.saveIncr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.saveIncr()</span></code></a></p></td>
<td><p>PDF only: save the document incrementally</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.scrub" title="Document.scrub"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.scrub()</span></code></a></p></td>
<td><p>PDF only: remove sensitive data</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.search_page_for" title="Document.search_page_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.search_page_for()</span></code></a></p></td>
<td><p>search for a string on a page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a></p></td>
<td><p>PDF only: select a subset of pages</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_layer_ui_config" title="Document.set_layer_ui_config"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_layer_ui_config()</span></code></a></p></td>
<td><p>PDF only: set OCG visibility temporarily</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_layer" title="Document.set_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_layer()</span></code></a></p></td>
<td><p>PDF only: mass changing OCG states</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_markinfo" title="Document.set_markinfo"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_markinfo()</span></code></a></p></td>
<td><p>PDF only: set the MarkInfo values</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_metadata" title="Document.set_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_metadata()</span></code></a></p></td>
<td><p>PDF only: set the metadata</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_oc" title="Document.set_oc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_oc()</span></code></a></p></td>
<td><p>PDF only: attach OCG/OCMD to image / form xobject</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_ocmd" title="Document.set_ocmd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_ocmd()</span></code></a></p></td>
<td><p>PDF only: create or update an <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_page_labels" title="Document.set_page_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_page_labels()</span></code></a></p></td>
<td><p>PDF only: add/update page label definitions</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_pagemode" title="Document.set_pagemode"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_pagemode()</span></code></a></p></td>
<td><p>PDF only: set the PageMode</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_pagelayout" title="Document.set_pagelayout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_pagelayout()</span></code></a></p></td>
<td><p>PDF only: set the PageLayout</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_toc_item" title="Document.set_toc_item"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_toc_item()</span></code></a></p></td>
<td><p>PDF only: change a single TOC item</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.set_toc" title="Document.set_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_toc()</span></code></a></p></td>
<td><p>PDF only: set the table of contents (TOC)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.set_xml_metadata" title="Document.set_xml_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.set_xml_metadata()</span></code></a></p></td>
<td><p>PDF only: create or update document XML metadata</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.subset_fonts" title="Document.subset_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.subset_fonts()</span></code></a></p></td>
<td><p>PDF only: create font subsets</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.switch_layer" title="Document.switch_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.switch_layer()</span></code></a></p></td>
<td><p>PDF only: activate OC configuration</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.tobytes" title="Document.tobytes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a></p></td>
<td><p>PDF only: writes document to memory</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.xref_copy" title="Document.xref_copy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_copy()</span></code></a></p></td>
<td><p>PDF only: copy a PDF dictionary to another <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.xref_get_key" title="Document.xref_get_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_key()</span></code></a></p></td>
<td><p>PDF only: get the value of a dictionary key</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.xref_get_keys" title="Document.xref_get_keys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_get_keys()</span></code></a></p></td>
<td><p>PDF only: list the keys of object at <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.xref_object" title="Document.xref_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_object()</span></code></a></p></td>
<td><p>PDF only: get the definition source of <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.xref_set_key" title="Document.xref_set_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_set_key()</span></code></a></p></td>
<td><p>PDF only: set the value of a dictionary key</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.xref_stream_raw" title="Document.xref_stream_raw"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_stream_raw()</span></code></a></p></td>
<td><p>PDF only: raw stream source at <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.xref_xml_metadata" title="Document.xref_xml_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.xref_xml_metadata()</span></code></a></p></td>
<td><p>PDF only: <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of XML metadata</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.chapter_count" title="Document.chapter_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.chapter_count</span></code></a></p></td>
<td><p>number of chapters</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.FormFonts" title="Document.FormFonts"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.FormFonts</span></code></a></p></td>
<td><p>PDF only: list of global widget fonts</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.is_closed" title="Document.is_closed"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_closed</span></code></a></p></td>
<td><p>has document been closed?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.is_dirty" title="Document.is_dirty"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_dirty</span></code></a></p></td>
<td><p>PDF only: has document been changed yet?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.is_encrypted" title="Document.is_encrypted"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_encrypted</span></code></a></p></td>
<td><p>document (still) encrypted?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.is_fast_webaccess" title="Document.is_fast_webaccess"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_fast_webaccess</span></code></a></p></td>
<td><p>is PDF linearized?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.is_form_pdf" title="Document.is_form_pdf"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_form_pdf</span></code></a></p></td>
<td><p>is this a Form PDF?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.is_pdf" title="Document.is_pdf"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_pdf</span></code></a></p></td>
<td><p>is this a PDF?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.is_reflowable" title="Document.is_reflowable"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_reflowable</span></code></a></p></td>
<td><p>is this a reflowable document?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.is_repaired" title="Document.is_repaired"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.is_repaired</span></code></a></p></td>
<td><p>PDF only: has this PDF been repaired during open?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.last_location" title="Document.last_location"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.last_location</span></code></a></p></td>
<td><p>(chapter, pno) of last page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.metadata" title="Document.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.metadata</span></code></a></p></td>
<td><p>metadata</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.markinfo" title="Document.markinfo"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.markinfo</span></code></a></p></td>
<td><p>PDF MarkInfo value</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.name" title="Document.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.name</span></code></a></p></td>
<td><p>filename of document</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.needs_pass" title="Document.needs_pass"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.needs_pass</span></code></a></p></td>
<td><p>require password to access data?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.outline" title="Document.outline"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.outline</span></code></a></p></td>
<td><p>first <a class="reference internal" href="outline.html#outline"><span class="std std-ref">Outline</span></a> item</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.page_count" title="Document.page_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.page_count</span></code></a></p></td>
<td><p>number of pages</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.permissions" title="Document.permissions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.permissions</span></code></a></p></td>
<td><p>permissions to access the document</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.pagemode" title="Document.pagemode"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.pagemode</span></code></a></p></td>
<td><p>PDF PageMode value</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Document.pagelayout" title="Document.pagelayout"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.pagelayout</span></code></a></p></td>
<td><p>PDF PageLayout value</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Document.version_count" title="Document.version_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.version_count</span></code></a></p></td>
<td><p>PDF count of versions</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Class API</strong></p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>For methods that change the structure of a PDF (<code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_pdf()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">select()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">copy_page()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">delete_page()</span></code> and others), be aware that objects or properties in your program may have been invalidated or orphaned. Examples are <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> objects and their children (links, annotations, widgets), variables holding old page counts, tables of content and the like. Remember to keep such variables up to date or delete orphaned objects. Also refer to <a class="reference internal" href="app3.html#referenialintegrity"><span class="std std-ref">确保 PyMuPDF 中重要对象的一致性</span></a>.</p>
</div>
</div>
</div>
<section id="set-metadata">
<h2><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_metadata()</span></code> 例子<a class="headerlink" href="#set-metadata" title="此标题的永久链接">#</a></h2>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_metadata()</span></code> Example</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">中文</label><div class="tab-content docutils container">
<p>清除元数据。如果出于隐私或数据保护考虑执行此操作，请确保将文档保存为新文件，并设置 <em>garbage &gt; 0</em>。这样，旧的 <em>/Info</em> 对象也会被物理删除。在这种情况下，您可能还希望清除由多个 PDF 编辑器插入的任何 XML 元数据：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pymupdf.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">metadata</span>             <span class="c1"># 查看当前的元数据</span>
<span class="go">{&#39;producer&#39;: &#39;rst2pdf, reportlab&#39;, &#39;format&#39;: &#39;PDF 1.4&#39;, &#39;encryption&#39;: None, &#39;author&#39;:</span>
<span class="go">&#39;Jorj X. McKie&#39;, &#39;modDate&#39;: &quot;D:20160611145816-04&#39;00&#39;&quot;, &#39;keywords&#39;: &#39;PDF, XPS, EPUB, CBZ&#39;,</span>
<span class="go">&#39;title&#39;: &#39;The PyMuPDF Documentation&#39;, &#39;creationDate&#39;: &quot;D:20160611145816-04&#39;00&#39;&quot;,</span>
<span class="go">&#39;creator&#39;: &#39;sphinx&#39;, &#39;subject&#39;: &#39;PyMuPDF 1.9.1&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">({})</span>      <span class="c1"># 清除所有字段</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">metadata</span>             <span class="c1"># 再次查看，验证修改结果</span>
<span class="go">{&#39;producer&#39;: &#39;none&#39;, &#39;format&#39;: &#39;PDF 1.4&#39;, &#39;encryption&#39;: None, &#39;author&#39;: &#39;none&#39;,</span>
<span class="go">&#39;modDate&#39;: &#39;none&#39;, &#39;keywords&#39;: &#39;none&#39;, &#39;title&#39;: &#39;none&#39;, &#39;creationDate&#39;: &#39;none&#39;,</span>
<span class="go">&#39;creator&#39;: &#39;none&#39;, &#39;subject&#39;: &#39;none&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">del_xml_metadata</span><span class="p">()</span>    <span class="c1"># 清除任何 XML 元数据</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;anonymous.pdf&quot;</span><span class="p">,</span> <span class="n">garbage</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>       <span class="c1"># 保存匿名化后的文档</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">英文</label><div class="tab-content docutils container">
<p>Clear metadata information. If you do this out of privacy / data protection concerns, make sure you save the document as a new file with <em>garbage &gt; 0</em>. Only then the old <em>/Info</em> object will also be physically removed from the file. In this case, you may also want to clear any XML metadata inserted by several PDF editors:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">=</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;pymupdf.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">metadata</span>             <span class="c1"># look at what we currently have</span>
<span class="go">{&#39;producer&#39;: &#39;rst2pdf, reportlab&#39;, &#39;format&#39;: &#39;PDF 1.4&#39;, &#39;encryption&#39;: None, &#39;author&#39;:</span>
<span class="go">&#39;Jorj X. McKie&#39;, &#39;modDate&#39;: &quot;D:20160611145816-04&#39;00&#39;&quot;, &#39;keywords&#39;: &#39;PDF, XPS, EPUB, CBZ&#39;,</span>
<span class="go">&#39;title&#39;: &#39;The PyMuPDF Documentation&#39;, &#39;creationDate&#39;: &quot;D:20160611145816-04&#39;00&#39;&quot;,</span>
<span class="go">&#39;creator&#39;: &#39;sphinx&#39;, &#39;subject&#39;: &#39;PyMuPDF 1.9.1&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">({})</span>      <span class="c1"># clear all fields</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">metadata</span>             <span class="c1"># look again to show what happened</span>
<span class="go">{&#39;producer&#39;: &#39;none&#39;, &#39;format&#39;: &#39;PDF 1.4&#39;, &#39;encryption&#39;: None, &#39;author&#39;: &#39;none&#39;,</span>
<span class="go">&#39;modDate&#39;: &#39;none&#39;, &#39;keywords&#39;: &#39;none&#39;, &#39;title&#39;: &#39;none&#39;, &#39;creationDate&#39;: &#39;none&#39;,</span>
<span class="go">&#39;creator&#39;: &#39;none&#39;, &#39;subject&#39;: &#39;none&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">del_xml_metadata</span><span class="p">()</span>    <span class="c1"># clear any XML metadata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;anonymous.pdf&quot;</span><span class="p">,</span> <span class="n">garbage</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>       <span class="c1"># save anonymized doc</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-toc">
<h2><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_toc()</span></code> 演示<a class="headerlink" href="#set-toc" title="此标题的永久链接">#</a></h2>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_toc()</span></code> Demonstration</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">中文</label><div class="tab-content docutils container">
<p>这展示了如何修改或添加目录。也可以查看 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/import-toc/import.py">import.py</a> 和 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/export-toc/export.py">export.py</a> 示例目录中的示例。</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_toc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">toc</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>                           <span class="c1"># 显示当前目录</span>
<span class="go">[1, &#39;The PyMuPDF Documentation&#39;, 1]</span>
<span class="go">[2, &#39;Introduction&#39;, 1]</span>
<span class="go">[3, &#39;Note on the Name fitz&#39;, 1]</span>
<span class="go">[3, &#39;License&#39;, 1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot; modified by set_toc&quot;</span>               <span class="c1"># 修改内容</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">set_toc</span><span class="p">(</span><span class="n">toc</span><span class="p">)</span>                                  <span class="c1"># 替换目录树</span>
<span class="go">3                                                    # 插入了 3 个书签</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_toc</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>                  <span class="c1"># 验证修改是否成功</span>
<span class="go">[1, &#39;The PyMuPDF Documentation&#39;, 1]</span>
<span class="go">[2, &#39;Introduction modified by set_toc&#39;, 1]            # &lt;&lt;&lt; 这里已更改</span>
<span class="go">[3, &#39;Note on the Name fitz&#39;, 1]</span>
<span class="go">[3, &#39;License&#39;, 1]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">英文</label><div class="tab-content docutils container">
<p>This shows how to modify or add a table of contents. Also have a look at <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/import-toc/import.py">import.py</a> and <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/export-toc/export.py">export.py</a> in the examples directory.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;test.pdf&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_toc</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">toc</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>                           <span class="c1"># show what we have</span>
<span class="go">[1, &#39;The PyMuPDF Documentation&#39;, 1]</span>
<span class="go">[2, &#39;Introduction&#39;, 1]</span>
<span class="go">[3, &#39;Note on the Name fitz&#39;, 1]</span>
<span class="go">[3, &#39;License&#39;, 1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot; modified by set_toc&quot;</span>               <span class="c1"># modify something</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">set_toc</span><span class="p">(</span><span class="n">toc</span><span class="p">)</span>                                  <span class="c1"># replace outline tree</span>
<span class="go">3                                                    # number of bookmarks inserted</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_toc</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>                  <span class="c1"># demonstrate it worked</span>
<span class="go">[1, &#39;The PyMuPDF Documentation&#39;, 1]</span>
<span class="go">[2, &#39;Introduction modified by set_toc&#39;, 1]            # &lt;&lt;&lt; this has changed</span>
<span class="go">[3, &#39;Note on the Name fitz&#39;, 1]</span>
<span class="go">[3, &#39;License&#39;, 1]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="insert-pdf">
<h2><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_pdf()</span></code> 例子<a class="headerlink" href="#insert-pdf" title="此标题的永久链接">#</a></h2>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_pdf()</span></code> Examples</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">中文</label><div class="tab-content docutils container">
<p><strong>(1) 合并两个文档并包括它们的目录（TOC）：</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;file1.pdf&quot;</span><span class="p">)</span>          <span class="c1"># 必须是 PDF 文件</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc2</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;file2.pdf&quot;</span><span class="p">)</span>          <span class="c1"># 必须是 PDF 文件</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pages1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc1</span><span class="p">)</span>                        <span class="c1"># 保存 doc1 的页面数</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc1</span> <span class="o">=</span> <span class="n">doc1</span><span class="o">.</span><span class="n">get_toc</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>                <span class="c1"># 保存 TOC 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc2</span> <span class="o">=</span> <span class="n">doc2</span><span class="o">.</span><span class="n">get_toc</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>                <span class="c1"># 保存 TOC 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">)</span>                     <span class="c1"># 将 doc2 插入到 doc1 的末尾</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">toc2</span><span class="p">:</span>                            <span class="c1"># 增加 toc2 页码</span>
<span class="go">        t[2] += pages1                        # 增加原 doc1 的页面数</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">set_toc</span><span class="p">(</span><span class="n">toc1</span> <span class="o">+</span> <span class="n">toc2</span><span class="p">)</span>                <span class="c1"># 现在结果包含总的 TOC</span>
</pre></div>
</div>
<p>显然，在更一般的情况下可以找到类似的方式。只需确保目录中的层级顺序不会增加超过一级。在 <em>toc2</em> 部分前后插入虚拟书签可以修复此类情况。一个现成的 GUI（wxPython）解决方案可以在 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py">join.py</a> 示例目录中找到。</p>
<p><strong>(2) 更多示例：</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 插入 doc2 的 5 页，其中 doc2 的第 21 页变为 doc1 的第 15 页</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">,</span> <span class="n">from_page</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">start_at</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 相同示例，但页面被旋转并逆序复制</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">,</span> <span class="n">from_page</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">start_at</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 将复制的页面插入到 doc1 前面</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">,</span> <span class="n">from_page</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">start_at</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">英文</label><div class="tab-content docutils container">
<p><strong>(1) Concatenate two documents including their TOCs:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;file1.pdf&quot;</span><span class="p">)</span>          <span class="c1"># must be a PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc2</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;file2.pdf&quot;</span><span class="p">)</span>          <span class="c1"># must be a PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pages1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc1</span><span class="p">)</span>                     <span class="c1"># save doc1&#39;s page count</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc1</span> <span class="o">=</span> <span class="n">doc1</span><span class="o">.</span><span class="n">get_toc</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>     <span class="c1"># save TOC 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">toc2</span> <span class="o">=</span> <span class="n">doc2</span><span class="o">.</span><span class="n">get_toc</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>     <span class="c1"># save TOC 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">)</span>                   <span class="c1"># doc2 at end of doc1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">toc2</span><span class="p">:</span>                         <span class="c1"># increase toc2 page numbers</span>
<span class="go">        t[2] += pages1                     # by old len(doc1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">set_toc</span><span class="p">(</span><span class="n">toc1</span> <span class="o">+</span> <span class="n">toc2</span><span class="p">)</span>               <span class="c1"># now result has total TOC</span>
</pre></div>
</div>
<p>Obviously, similar ways can be found in more general situations. Just make sure that hierarchy levels in a row do not increase by more than one. Inserting dummy bookmarks before and after <em>toc2</em> segments would heal such cases. A ready-to-use GUI (wxPython) solution can be found in script <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py">join.py</a> of the examples directory.</p>
<p><strong>(2) More examples:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># insert 5 pages of doc2, where its page 21 becomes page 15 in doc1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">,</span> <span class="n">from_page</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">start_at</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># same example, but pages are rotated and copied in reverse order</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">,</span> <span class="n">from_page</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">start_at</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># put copied pages in front of doc1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">,</span> <span class="n">from_page</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">start_at</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id16">
<h2>其他例子<a class="headerlink" href="#id16" title="此标题的永久链接">#</a></h2>
<p>Other Examples</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">中文</label><div class="tab-content docutils container">
<p><strong>从 PDF 中提取所有页面引用的图像并保存为单独的 PNG 文件</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">page_count</span><span class="p">):</span>
    <span class="n">imglist</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_page_images</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">imglist</span><span class="p">:</span>
        <span class="n">xref</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                  <span class="c1"># xref 编号</span>
        <span class="n">pix</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">xref</span><span class="p">)</span>   <span class="c1"># 从图像创建 pixmap</span>
        <span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>      <span class="c1"># 可以保存为 PNG 格式</span>
            <span class="n">pix</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;p</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">xref</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>                          <span class="c1"># CMYK: 必须先转换</span>
            <span class="n">pix0</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">csRGB</span><span class="p">,</span> <span class="n">pix</span><span class="p">)</span>
            <span class="n">pix0</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;p</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">xref</span><span class="p">))</span>
            <span class="n">pix0</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1"># 释放 Pixmap 资源</span>
        <span class="n">pix</span> <span class="o">=</span> <span class="kc">None</span>                     <span class="c1"># 释放 Pixmap 资源</span>
</pre></div>
</div>
<p><strong>旋转 PDF 的所有页面：</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span> <span class="n">page</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">英文</label><div class="tab-content docutils container">
<p><strong>Extract all page-referenced images of a PDF into separate PNG files</strong>:</p>
<dl>
<dt>for i in range(doc.page_count):</dt><dd><p>imglist = doc.get_page_images(i)
for img in imglist:</p>
<blockquote>
<div><p>xref = img[0]                  # xref number
pix = pymupdf.Pixmap(doc, xref)   # make pixmap from image
if pix.n - pix.alpha &lt; 4:      # can be saved as PNG</p>
<blockquote>
<div><p>pix.save(“p%s-%s.png” % (i, xref))</p>
</div></blockquote>
<dl class="simple">
<dt>else:                          # CMYK: must convert first</dt><dd><p>pix0 = pymupdf.Pixmap(pymupdf.csRGB, pix)
pix0.save(“p%s-%s.png” % (i, xref))
pix0 = None                # free Pixmap resources</p>
</dd>
</dl>
<p>pix = None                     # free Pixmap resources</p>
</div></blockquote>
</dd>
</dl>
<p><strong>Rotate all pages of a PDF:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span> <span class="n">page</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="f1" role="note">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Content streams describe what (e.g. text or images) appears where and how on a page. PDF uses a specialized mini language similar to PostScript to do this (pp. 643 in <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a>), which gets interpreted when a page is loaded.</p>
</aside>
<aside class="footnote brackets" id="f2" role="note">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>However, you <strong>can</strong> use <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a> and <a class="reference internal" href="page.html#Page.get_links" title="Page.get_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_links()</span></code></a> (which are available for all document types) and copy this information over to the output PDF. See demo <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/convert-document/convert.py">convert.py</a>.</p>
</aside>
<aside class="footnote brackets" id="f3" role="note">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>For applicable (EPUB) document types, loading a page via its absolute number may result in layouting a large part of the document, before the page can be accessed. To avoid this performance impact, prefer chapter-based access. Use convenience methods and attributes <a class="reference internal" href="#Document.next_location" title="Document.next_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.next_location()</span></code></a>, <a class="reference internal" href="#Document.prev_location" title="Document.prev_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.prev_location()</span></code></a> and <a class="reference internal" href="#Document.last_location" title="Document.last_location"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.last_location</span></code></a> for maintaining a high level of coding efficiency.</p>
</aside>
<aside class="footnote brackets" id="f4" role="note">
<span class="label"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></span>
<p>These parameters cause separate handling of stream categories: use it together with <code class="xref any docutils literal notranslate"><span class="pre">expand</span></code> to restrict decompression to streams other than images / fontfiles.</p>
</aside>
<aside class="footnote brackets" id="f5" role="note">
<span class="label"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></span>
<p>Examples for “Form XObjects” are created by <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a>.</p>
</aside>
<aside class="footnote brackets" id="f6" role="note">
<span class="label"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></span>
<p>For a <em>False</em> the <strong>complete document</strong> must be scanned. Both methods <strong>do not load pages,</strong> but only scan object definitions. This makes them at least 10 times faster than application-level loops (where total response time roughly equals the time for loading all pages). For the <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a> (756 pages) and the Pandas documentation (over 3070 pages) – both have no annotations – the method needs about 11 ms for the answer <em>False</em>. So response times will probably become significant only well beyond this order of magnitude.</p>
</aside>
<aside class="footnote brackets" id="f7" role="note">
<span class="label"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></span>
<p>This only works under certain conditions. For example, if there is normal text covered by some image on top of it, then this is undetectable and the respective text is <strong>not</strong> removed. Similar is true for white text on white background, and so on.</p>
</aside>
<aside class="footnote brackets" id="f8" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">8</a><span class="fn-bracket">]</span></span>
<p>内容流（Content Streams）描述了页面上出现的内容（如文本或图像）、位置及呈现方式。PDF 采用了一种类似于 PostScript 的专用小型语言来实现这一点（详见 <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a> 第 643 页）。该语言在页面加载时被解释执行。</p>
</aside>
<aside class="footnote brackets" id="f9" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">9</a><span class="fn-bracket">]</span></span>
<p>但您 <strong>可以</strong> 使用 <a class="reference internal" href="#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a> 和 <a class="reference internal" href="page.html#Page.get_links" title="Page.get_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_links()</span></code></a> （适用于所有文档类型），并将这些信息复制到输出 PDF 中。参见示例代码：
<a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/convert-document/convert.py">convert.py</a>。</p>
</aside>
<aside class="footnote brackets" id="f10" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">10</a><span class="fn-bracket">]</span></span>
<p>对于适用的文档类型（如 EPUB），如果通过绝对页码加载页面，可能会导致大量文档布局计算，从而影响性能。因此，建议优先使用基于章节的访问方式。
可使用 <a class="reference internal" href="#Document.next_location" title="Document.next_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.next_location()</span></code></a>、<a class="reference internal" href="#Document.prev_location" title="Document.prev_location"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.prev_location()</span></code></a> 和 <a class="reference internal" href="#Document.last_location" title="Document.last_location"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.last_location</span></code></a> 等便捷方法和属性，提高代码执行效率。</p>
</aside>
<aside class="footnote brackets" id="f11" role="note">
<span class="label"><span class="fn-bracket">[</span>11<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id8">1</a>,<a role="doc-backlink" href="#id9">2</a>)</span>
<p>这些参数可用于对不同类别的流进行单独处理：可与 <code class="xref any docutils literal notranslate"><span class="pre">expand</span></code> 结合使用，以限制对非图像 / 字体文件流的解压缩。</p>
</aside>
<aside class="footnote brackets" id="f12" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">12</a><span class="fn-bracket">]</span></span>
<p>由 <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> 方法创建的示例包括 “Form XObjects”。</p>
</aside>
<aside class="footnote brackets" id="f13" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id11">13</a><span class="fn-bracket">]</span></span>
<p>如果返回 <em>False</em>，则必须扫描 <strong>整个文档</strong>。这两种方法 <strong>不会加载页面</strong>，而只是扫描对象定义，因此它们比应用级循环快至少 10 倍（应用级循环的总响应时间通常等于加载所有页面的时间）。
例如，在 <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a> （756 页）和 Pandas 文档（超过 3070 页）这类无批注文档中，该方法的响应时间约为 11 毫秒。因此，响应时间通常仅在处理规模远超此量级时才会变得显著。</p>
</aside>
<aside class="footnote brackets" id="f14" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">14</a><span class="fn-bracket">]</span></span>
<p>该方法仅在特定条件下有效。例如，如果某段正常文本被某个图像覆盖，则无法检测到该文本，因此 <strong>不会</strong> 被移除。同样，白色文本位于白色背景上等情况也难以识别。</p>
</aside>
</aside>
<div class="feedbackLink"><a id="feedbackLinkBottom" target=_blank>您对此页面有任何反馈吗？</b></a></div><hr class="docutils" />
<script>

   var url_string = window.location.href;
   var a = document.getElementById('feedbackLinkBottom');
   a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link&url="+url_string);

</script>

<p style="color:#999" id="footerDisclaimer">本软件按原样提供，不作任何明示或暗示担保。本软件根据许可分发，除非根据该许可条款明确授权，否则不得复制、修改或分发。请参阅 <a href="https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link">artifex.com</a> 上的许可信息，或联系 Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States 了解更多信息。</p>



<script>

   let docLanguage = document.getElementsByTagName('html')[0].getAttribute('lang');

   function getHeaderAndFooterTranslation(str) {
       if (docLanguage == "ja") {
           if (str == "Do you have any feedback on this page?") {
               return "このページに関するご意見はありますか？";
           } else if (str == "Find <b>#pymupdf</b> on <b>Discord</b>") {
               return "<b>Discord</b>の <b>#pymupdf</b> を見つける";
           } else if (str == "This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.") {

               return "このソフトウェアは無保証で提供されており、明示または黙示を問わず、いかなる保証もありません。このソフトウェアはライセンスの下で配布され、ライセンスの条件に明示的に許可されている場合を除き、コピー、変更、または配布してはなりません。ライセンシング情報については、<a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a>でライセンス情報を参照するか、アメリカ合衆国カリフォルニア州サンフランシスコのArtifex Software Inc. までお問い合わせください。"

           }
       }

       return str;
   }

   document.getElementById("findOnDiscord").innerHTML = getHeaderAndFooterTranslation("Find <b>#pymupdf</b> on <b>Discord</b>");
   document.getElementById("feedbackLinkTop").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("feedbackLinkBottom").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("footerDisclaimer").innerHTML = getHeaderAndFooterTranslation("This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.");


   // more translation for admonition-title as the in-built translation isn't great, needs: 注釈 -> 注
   if (docLanguage == "ja") {
       const collection = document.getElementsByClassName("admonition-title");
       for (var i=0;i<collection.length;i++) {
           collection[i].innerHTML = "注";
       }
   }


</script><p class="footer-version">This documentation covers all versions up to 1.25.4.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="document-writer-class.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">DocumentWriter</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="displaylist.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">DisplayList</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2025, Artifex
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 19. 3月 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Document</a><ul>
<li><a class="reference internal" href="#Document"><code class="docutils literal notranslate"><span class="pre">Document</span></code></a><ul>
<li><a class="reference internal" href="#Document.__init__"><code class="docutils literal notranslate"><span class="pre">Document.__init__()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_oc"><code class="docutils literal notranslate"><span class="pre">Document.get_oc()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_oc"><code class="docutils literal notranslate"><span class="pre">Document.set_oc()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_layers"><code class="docutils literal notranslate"><span class="pre">Document.get_layers()</span></code></a></li>
<li><a class="reference internal" href="#Document.add_layer"><code class="docutils literal notranslate"><span class="pre">Document.add_layer()</span></code></a></li>
<li><a class="reference internal" href="#Document.switch_layer"><code class="docutils literal notranslate"><span class="pre">Document.switch_layer()</span></code></a></li>
<li><a class="reference internal" href="#Document.add_ocg"><code class="docutils literal notranslate"><span class="pre">Document.add_ocg()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_ocmd"><code class="docutils literal notranslate"><span class="pre">Document.set_ocmd()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_ocmd"><code class="docutils literal notranslate"><span class="pre">Document.get_ocmd()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_layer"><code class="docutils literal notranslate"><span class="pre">Document.get_layer()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_layer"><code class="docutils literal notranslate"><span class="pre">Document.set_layer()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_ocgs"><code class="docutils literal notranslate"><span class="pre">Document.get_ocgs()</span></code></a></li>
<li><a class="reference internal" href="#Document.layer_ui_configs"><code class="docutils literal notranslate"><span class="pre">Document.layer_ui_configs()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_layer_ui_config"><code class="docutils literal notranslate"><span class="pre">Document.set_layer_ui_config()</span></code></a></li>
<li><a class="reference internal" href="#Document.authenticate"><code class="docutils literal notranslate"><span class="pre">Document.authenticate()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_page_numbers"><code class="docutils literal notranslate"><span class="pre">Document.get_page_numbers()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_page_labels"><code class="docutils literal notranslate"><span class="pre">Document.get_page_labels()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_page_labels"><code class="docutils literal notranslate"><span class="pre">Document.set_page_labels()</span></code></a></li>
<li><a class="reference internal" href="#Document.make_bookmark"><code class="docutils literal notranslate"><span class="pre">Document.make_bookmark()</span></code></a></li>
<li><a class="reference internal" href="#Document.find_bookmark"><code class="docutils literal notranslate"><span class="pre">Document.find_bookmark()</span></code></a></li>
<li><a class="reference internal" href="#Document.chapter_page_count"><code class="docutils literal notranslate"><span class="pre">Document.chapter_page_count()</span></code></a></li>
<li><a class="reference internal" href="#Document.next_location"><code class="docutils literal notranslate"><span class="pre">Document.next_location()</span></code></a></li>
<li><a class="reference internal" href="#Document.prev_location"><code class="docutils literal notranslate"><span class="pre">Document.prev_location()</span></code></a></li>
<li><a class="reference internal" href="#Document.load_page"><code class="docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.reload_page"><code class="docutils literal notranslate"><span class="pre">Document.reload_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.resolve_names"><code class="docutils literal notranslate"><span class="pre">Document.resolve_names()</span></code></a></li>
<li><a class="reference internal" href="#Document.page_cropbox"><code class="docutils literal notranslate"><span class="pre">Document.page_cropbox()</span></code></a></li>
<li><a class="reference internal" href="#Document.page_xref"><code class="docutils literal notranslate"><span class="pre">Document.page_xref()</span></code></a></li>
<li><a class="reference internal" href="#Document.pages"><code class="docutils literal notranslate"><span class="pre">Document.pages()</span></code></a></li>
<li><a class="reference internal" href="#Document.convert_to_pdf"><code class="docutils literal notranslate"><span class="pre">Document.convert_to_pdf()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_toc"><code class="docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_get_keys"><code class="docutils literal notranslate"><span class="pre">Document.xref_get_keys()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_get_key"><code class="docutils literal notranslate"><span class="pre">Document.xref_get_key()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_set_key"><code class="docutils literal notranslate"><span class="pre">Document.xref_set_key()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_page_pixmap"><code class="docutils literal notranslate"><span class="pre">Document.get_page_pixmap()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_page_xobjects"><code class="docutils literal notranslate"><span class="pre">Document.get_page_xobjects()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_page_images"><code class="docutils literal notranslate"><span class="pre">Document.get_page_images()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_page_fonts"><code class="docutils literal notranslate"><span class="pre">Document.get_page_fonts()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_page_text"><code class="docutils literal notranslate"><span class="pre">Document.get_page_text()</span></code></a></li>
<li><a class="reference internal" href="#Document.layout"><code class="docutils literal notranslate"><span class="pre">Document.layout()</span></code></a></li>
<li><a class="reference internal" href="#Document.select"><code class="docutils literal notranslate"><span class="pre">Document.select()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_metadata"><code class="docutils literal notranslate"><span class="pre">Document.set_metadata()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_xml_metadata"><code class="docutils literal notranslate"><span class="pre">Document.get_xml_metadata()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_xml_metadata"><code class="docutils literal notranslate"><span class="pre">Document.set_xml_metadata()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_pagelayout"><code class="docutils literal notranslate"><span class="pre">Document.set_pagelayout()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_pagemode"><code class="docutils literal notranslate"><span class="pre">Document.set_pagemode()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_markinfo"><code class="docutils literal notranslate"><span class="pre">Document.set_markinfo()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_toc"><code class="docutils literal notranslate"><span class="pre">Document.set_toc()</span></code></a></li>
<li><a class="reference internal" href="#Document.outline_xref"><code class="docutils literal notranslate"><span class="pre">Document.outline_xref()</span></code></a></li>
<li><a class="reference internal" href="#Document.del_toc_item"><code class="docutils literal notranslate"><span class="pre">Document.del_toc_item()</span></code></a></li>
<li><a class="reference internal" href="#Document.set_toc_item"><code class="docutils literal notranslate"><span class="pre">Document.set_toc_item()</span></code></a></li>
<li><a class="reference internal" href="#Document.bake"><code class="docutils literal notranslate"><span class="pre">Document.bake()</span></code></a></li>
<li><a class="reference internal" href="#Document.can_save_incrementally"><code class="docutils literal notranslate"><span class="pre">Document.can_save_incrementally()</span></code></a></li>
<li><a class="reference internal" href="#Document.scrub"><code class="docutils literal notranslate"><span class="pre">Document.scrub()</span></code></a></li>
<li><a class="reference internal" href="#Document.save"><code class="docutils literal notranslate"><span class="pre">Document.save()</span></code></a></li>
<li><a class="reference internal" href="#Document.ez_save"><code class="docutils literal notranslate"><span class="pre">Document.ez_save()</span></code></a></li>
<li><a class="reference internal" href="#Document.saveIncr"><code class="docutils literal notranslate"><span class="pre">Document.saveIncr()</span></code></a></li>
<li><a class="reference internal" href="#Document.tobytes"><code class="docutils literal notranslate"><span class="pre">Document.tobytes()</span></code></a></li>
<li><a class="reference internal" href="#Document.search_page_for"><code class="docutils literal notranslate"><span class="pre">Document.search_page_for()</span></code></a></li>
<li><a class="reference internal" href="#Document.insert_pdf"><code class="docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a></li>
<li><a class="reference internal" href="#Document.insert_file"><code class="docutils literal notranslate"><span class="pre">Document.insert_file()</span></code></a></li>
<li><a class="reference internal" href="#Document.new_page"><code class="docutils literal notranslate"><span class="pre">Document.new_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.insert_page"><code class="docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.delete_page"><code class="docutils literal notranslate"><span class="pre">Document.delete_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.delete_pages"><code class="docutils literal notranslate"><span class="pre">Document.delete_pages()</span></code></a></li>
<li><a class="reference internal" href="#Document.copy_page"><code class="docutils literal notranslate"><span class="pre">Document.copy_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.fullcopy_page"><code class="docutils literal notranslate"><span class="pre">Document.fullcopy_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.move_page"><code class="docutils literal notranslate"><span class="pre">Document.move_page()</span></code></a></li>
<li><a class="reference internal" href="#Document.need_appearances"><code class="docutils literal notranslate"><span class="pre">Document.need_appearances()</span></code></a></li>
<li><a class="reference internal" href="#Document.get_sigflags"><code class="docutils literal notranslate"><span class="pre">Document.get_sigflags()</span></code></a></li>
<li><a class="reference internal" href="#Document.embfile_add"><code class="docutils literal notranslate"><span class="pre">Document.embfile_add()</span></code></a></li>
<li><a class="reference internal" href="#Document.embfile_count"><code class="docutils literal notranslate"><span class="pre">Document.embfile_count()</span></code></a></li>
<li><a class="reference internal" href="#Document.embfile_get"><code class="docutils literal notranslate"><span class="pre">Document.embfile_get()</span></code></a></li>
<li><a class="reference internal" href="#Document.embfile_del"><code class="docutils literal notranslate"><span class="pre">Document.embfile_del()</span></code></a></li>
<li><a class="reference internal" href="#Document.embfile_info"><code class="docutils literal notranslate"><span class="pre">Document.embfile_info()</span></code></a></li>
<li><a class="reference internal" href="#Document.embfile_names"><code class="docutils literal notranslate"><span class="pre">Document.embfile_names()</span></code></a></li>
<li><a class="reference internal" href="#Document.embfile_upd"><code class="docutils literal notranslate"><span class="pre">Document.embfile_upd()</span></code></a></li>
<li><a class="reference internal" href="#Document.close"><code class="docutils literal notranslate"><span class="pre">Document.close()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_object"><code class="docutils literal notranslate"><span class="pre">Document.xref_object()</span></code></a></li>
<li><a class="reference internal" href="#Document.pdf_catalog"><code class="docutils literal notranslate"><span class="pre">Document.pdf_catalog()</span></code></a></li>
<li><a class="reference internal" href="#Document.pdf_trailer"><code class="docutils literal notranslate"><span class="pre">Document.pdf_trailer()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_stream"><code class="docutils literal notranslate"><span class="pre">Document.xref_stream()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_stream_raw"><code class="docutils literal notranslate"><span class="pre">Document.xref_stream_raw()</span></code></a></li>
<li><a class="reference internal" href="#Document.update_object"><code class="docutils literal notranslate"><span class="pre">Document.update_object()</span></code></a></li>
<li><a class="reference internal" href="#Document.update_stream"><code class="docutils literal notranslate"><span class="pre">Document.update_stream()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_copy"><code class="docutils literal notranslate"><span class="pre">Document.xref_copy()</span></code></a></li>
<li><a class="reference internal" href="#Document.extract_image"><code class="docutils literal notranslate"><span class="pre">Document.extract_image()</span></code></a></li>
<li><a class="reference internal" href="#Document.extract_font"><code class="docutils literal notranslate"><span class="pre">Document.extract_font()</span></code></a></li>
<li><a class="reference internal" href="#Document.xref_xml_metadata"><code class="docutils literal notranslate"><span class="pre">Document.xref_xml_metadata()</span></code></a></li>
<li><a class="reference internal" href="#Document.has_links"><code class="docutils literal notranslate"><span class="pre">Document.has_links()</span></code></a></li>
<li><a class="reference internal" href="#Document.has_annots"><code class="docutils literal notranslate"><span class="pre">Document.has_annots()</span></code></a></li>
<li><a class="reference internal" href="#Document.subset_fonts"><code class="docutils literal notranslate"><span class="pre">Document.subset_fonts()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_enable"><code class="docutils literal notranslate"><span class="pre">Document.journal_enable()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_start_op"><code class="docutils literal notranslate"><span class="pre">Document.journal_start_op()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_stop_op"><code class="docutils literal notranslate"><span class="pre">Document.journal_stop_op()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_position"><code class="docutils literal notranslate"><span class="pre">Document.journal_position()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_op_name"><code class="docutils literal notranslate"><span class="pre">Document.journal_op_name()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_can_do"><code class="docutils literal notranslate"><span class="pre">Document.journal_can_do()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_undo"><code class="docutils literal notranslate"><span class="pre">Document.journal_undo()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_redo"><code class="docutils literal notranslate"><span class="pre">Document.journal_redo()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_save"><code class="docutils literal notranslate"><span class="pre">Document.journal_save()</span></code></a></li>
<li><a class="reference internal" href="#Document.journal_load"><code class="docutils literal notranslate"><span class="pre">Document.journal_load()</span></code></a></li>
<li><a class="reference internal" href="#Document.save_snapshot"><code class="docutils literal notranslate"><span class="pre">Document.save_snapshot()</span></code></a></li>
<li><a class="reference internal" href="#Document.outline"><code class="docutils literal notranslate"><span class="pre">Document.outline</span></code></a></li>
<li><a class="reference internal" href="#Document.is_closed"><code class="docutils literal notranslate"><span class="pre">Document.is_closed</span></code></a></li>
<li><a class="reference internal" href="#Document.is_dirty"><code class="docutils literal notranslate"><span class="pre">Document.is_dirty</span></code></a></li>
<li><a class="reference internal" href="#Document.is_pdf"><code class="docutils literal notranslate"><span class="pre">Document.is_pdf</span></code></a></li>
<li><a class="reference internal" href="#Document.is_form_pdf"><code class="docutils literal notranslate"><span class="pre">Document.is_form_pdf</span></code></a></li>
<li><a class="reference internal" href="#Document.is_reflowable"><code class="docutils literal notranslate"><span class="pre">Document.is_reflowable</span></code></a></li>
<li><a class="reference internal" href="#Document.is_repaired"><code class="docutils literal notranslate"><span class="pre">Document.is_repaired</span></code></a></li>
<li><a class="reference internal" href="#Document.is_fast_webaccess"><code class="docutils literal notranslate"><span class="pre">Document.is_fast_webaccess</span></code></a></li>
<li><a class="reference internal" href="#Document.markinfo"><code class="docutils literal notranslate"><span class="pre">Document.markinfo</span></code></a></li>
<li><a class="reference internal" href="#Document.pagemode"><code class="docutils literal notranslate"><span class="pre">Document.pagemode</span></code></a></li>
<li><a class="reference internal" href="#Document.pagelayout"><code class="docutils literal notranslate"><span class="pre">Document.pagelayout</span></code></a></li>
<li><a class="reference internal" href="#Document.version_count"><code class="docutils literal notranslate"><span class="pre">Document.version_count</span></code></a></li>
<li><a class="reference internal" href="#Document.needs_pass"><code class="docutils literal notranslate"><span class="pre">Document.needs_pass</span></code></a></li>
<li><a class="reference internal" href="#Document.is_encrypted"><code class="docutils literal notranslate"><span class="pre">Document.is_encrypted</span></code></a></li>
<li><a class="reference internal" href="#Document.permissions"><code class="docutils literal notranslate"><span class="pre">Document.permissions</span></code></a></li>
<li><a class="reference internal" href="#Document.metadata"><code class="docutils literal notranslate"><span class="pre">Document.metadata</span></code></a></li>
<li><a class="reference internal" href="#Document.name"><code class="docutils literal notranslate"><span class="pre">Document.name</span></code></a></li>
<li><a class="reference internal" href="#Document.page_count"><code class="docutils literal notranslate"><span class="pre">Document.page_count</span></code></a></li>
<li><a class="reference internal" href="#Document.chapter_count"><code class="docutils literal notranslate"><span class="pre">Document.chapter_count</span></code></a></li>
<li><a class="reference internal" href="#Document.last_location"><code class="docutils literal notranslate"><span class="pre">Document.last_location</span></code></a></li>
<li><a class="reference internal" href="#Document.FormFonts"><code class="docutils literal notranslate"><span class="pre">Document.FormFonts</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#set-metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_metadata()</span></code> 例子</a></li>
<li><a class="reference internal" href="#set-toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_toc()</span></code> 演示</a></li>
<li><a class="reference internal" href="#insert-pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_pdf()</span></code> 例子</a></li>
<li><a class="reference internal" href="#id16">其他例子</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/tabs.js"></script>
    <script src="_static/translations.js"></script>
    </body>
</html>