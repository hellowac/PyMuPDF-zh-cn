<!doctype html>
<html class="no-js" lang="zh-CN">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="Artifex" name="author" />
<meta content="PyMuPDF 是一个高性能 Python 库，用于 PDF（及其他）文档的数据提取、分析、转换和操作。" name="description" />
<meta content="PDF Text Extraction, PDF Image Extraction, PDF Conversion, PDF Tables, PDF Splitting, PDF Creation, Pyodide, PyScript" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZTN4VTL9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZTN4VTL9M');
    </script>
    <link rel="author" title="关于此文档" href="about.html" /><link rel="index" title="索引" href="genindex.html" /><link rel="search" title="搜索" href="search.html" /><link rel="next" title="Pixmap" href="pixmap.html" /><link rel="prev" title="Outline" href="outline.html" />

    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/><!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>Page - PyMuPDF 1.25.4 文档</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMuPDF 1.25.4 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/sidebar-logo-dark.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/sidebar-logo-light.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyMuPDF 1.25.4 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">关于/About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">功能比较</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-performance">性能</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-license">许可和版权</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf4llm/index.html">PyMuPDF4LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf-pro.html">PyMuPDF Pro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">用户指南/User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-basics.html">基础用法</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">PyMuPDF、LLM 和 RAG</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">资源</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">教程/How to Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how-to-open-a-file.html">打开文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-text.html">文本</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-images.html">图片</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-annotations.html">注释</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-drawing-and-graphics.html">绘图和图形</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-stories.html">故事</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-journalling.html">日记</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-multiprocessing.html">多进程</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-ocr.html">OCR - 光学字符识别</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-optional-content.html">可选内容支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-low-level-interfaces.html">低级接口</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-common-issues-and-their-solutions.html">常见问题及其解决方案</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API参考/API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="module.html">命令行界面</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="classes.html">类</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="annot.html">Annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="archive-class.html">Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="colorspace.html">Colorspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="displaylist.html">DisplayList</a></li>
<li class="toctree-l2"><a class="reference internal" href="document.html">Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-writer-class.html">DocumentWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="font.html">Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="irect.html">IRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="link.html">Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkdest.html">linkDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="outline.html">Outline</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixmap.html">Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="point.html">Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="quad.html">Quad</a></li>
<li class="toctree-l2"><a class="reference internal" href="rect.html">Rect</a></li>
<li class="toctree-l2"><a class="reference internal" href="shape.html">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="story-class.html">Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="textpage.html">TextPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="textwriter.html">TextWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="widget.html">Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml-class.html">Xml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algebra.html">几何对象的运算符代数</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lowlevel.html">低级函数和类</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html">函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="device.html">设备</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop_low.html">协同工作: DisplayList 和 TextPage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">常量和枚举</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">颜色数据库</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">其他/Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app1.html">附录 1：文本提取详细信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app2.html">附录 2：嵌入式文件的注意事项</a></li>
<li class="toctree-l1"><a class="reference internal" href="app3.html">附录 3：各类技术信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app4.html">附录 4：性能比较方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">更新日志</a></li>
<li class="toctree-l1"><a class="reference internal" href="znames.html">已废弃名称</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div style="display:flex;justify-content:space-between;align-items: center;">
    <form class="sidebar-search-container top" method="get" action="search.html" role="search" style="width:75%">
      <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
    <div class="discordLink" style="display:flex;align-items:center;margin-top: -5px;">
        <a href="https://discord.gg/TSpYGBW4eq" id="findOnDiscord" target=_blank>Find <b>#pymupdf</b> on <b>Discord</b></a>
        <a href="https://discord.gg/TSpYGBW4eq" target=_blank>
            <div style="width:30px;height:30px;margin-left:5px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
                    <defs>
                        <style>.discordLogoFill{fill:#5865f2;}</style>
                    </defs>
                    <g id="Discord_Logo" data-name="Discord Logo">
                        <path class="discordLogoFill" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                    </g>
                </svg>
            </div>
        </a>
    </div>

</div><section id="page">
<span id="id1"></span><h1>Page<a class="headerlink" href="#page" title="此标题的永久链接">#</a></h1>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">中文</label><div class="tab-content docutils container">
<p>表示文档页面的类。页面对象由 <a class="reference internal" href="document.html#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a> 创建，或者等效地通过 <code class="xref any docutils literal notranslate"><span class="pre">doc[n]</span></code> 进行索引访问——它没有独立的构造函数。</p>
<p>文档和页面之间存在父子关系。如果文档被关闭或删除，所有已存在的页面对象（以及它们的子对象）都将变得不可用（”孤立”）。在这种情况下，任何页面属性或方法的调用都会引发异常。</p>
<p>为了方便使用，许多页面方法都有一个相应的 <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> 级别的替代方法。本章节末尾提供了这些方法的概览。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>本章节中多次提及 <strong>坐标</strong> 这一术语。理解坐标系统至关重要，建议先熟悉 <a class="reference internal" href="app3.html#coordinates"><span class="std std-ref">坐标</span></a> 章节，以便更好地掌握相关概念。</p>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">英文</label><div class="tab-content docutils container">
<p>Class representing a document page. A page object is created by <a class="reference internal" href="document.html#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a> or, equivalently, via indexing the document like <code class="xref any docutils literal notranslate"><span class="pre">doc[n]</span></code> - it has no independent constructor.</p>
<p>There is a parent-child relationship between a document and its pages. If the document is closed or deleted, all page objects (and their respective children, too) in existence will become unusable (“orphaned”): If a page property or method is being used, an exception is raised.</p>
<p>Several page methods have a <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> counterpart for convenience. At the end of this chapter you will find a synopsis.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Many times in this chapter we are using the term <strong>coordinate</strong>. It is of high importance to have at least a basic understanding of what that is and that you feel comfortable with the section <a class="reference internal" href="app3.html#coordinates"><span class="std std-ref">坐标</span></a>.</p>
</div>
</div>
</div>
<section id="id2">
<h2>更改 Page<a class="headerlink" href="#id2" title="此标题的永久链接">#</a></h2>
<p>Modifying Pages</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">中文</label><div class="tab-content docutils container">
<p>仅 PDF 文档支持更改页面属性和修改页面内容。</p>
<p>简而言之，您可以使用 PyMuPDF 执行以下操作：</p>
<ul class="simple">
<li><p>修改页面旋转角度及其可见部分（”裁剪框”）。</p></li>
<li><p>插入图像、其他 PDF 页面、文本和简单的几何对象。</p></li>
<li><p>添加注释和表单字段。</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>许多方法需要使用坐标（点、矩形）来将内容放置在指定位置。请注意，自 v1.17.0 以来，这些坐标 <strong>必须始终</strong> 以 <strong>未旋转</strong> 的页面为基准提供。反之亦然：除了 <a class="reference internal" href="#Page.rect" title="Page.rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rect</span></code></a> 和 <a class="reference internal" href="#Page.bound" title="Page.bound"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.bound()</span></code></a> （它们会随页面旋转而变化），其他方法和属性返回的所有坐标均基于未旋转页面。</p>
<p>例如，<a class="reference internal" href="#Page.get_image_bbox" title="Page.get_image_bbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_bbox()</span></code></a> 的返回值不会因 <a class="reference internal" href="#Page.set_rotation" title="Page.set_rotation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_rotation()</span></code></a> 调用而变化。同样，<a class="reference internal" href="#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> 返回的坐标、注释矩形等也不会变化。如果要获取对象在 <strong>旋转坐标系</strong> 中的位置，可以将坐标与 <a class="reference internal" href="#Page.rotation_matrix" title="Page.rotation_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rotation_matrix</span></code></a> 相乘。相应地，<a class="reference internal" href="#Page.derotation_matrix" title="Page.derotation_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.derotation_matrix</span></code></a> 提供了逆变换，可用于与其他可能有不同行为的阅读器交互。</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>如果您在页面上添加或更新了注释、链接或表单字段，并且 <strong>立即</strong> 需要处理这些内容（即 <strong>未离开页面</strong>），请在访问这些新或更新的项目之前，使用 <a class="reference internal" href="document.html#Document.reload_page" title="Document.reload_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.reload_page()</span></code></a> 重新加载页面。</p>
<p>通常建议重新加载页面——尽管在所有情况下都不一定是强制性的。然而，与 MuPDF 相比，PyMuPDF 对某些注释和表单控件提供了扩展功能，未来可能还会增加更多扩展。</p>
<p>重新加载页面可确保所有更改已完全应用到 PDF 结构，因此您可以安全地创建 Pixmap，或成功地遍历注释、链接和表单字段。</p>
</div>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>方法 / 属性</strong></p></th>
<th class="head"><p><strong>简要描述</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_caret_annot" title="Page.add_caret_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_caret_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加脱字符（Caret）注释</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_circle_annot" title="Page.add_circle_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_circle_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加圆形注释</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_file_annot" title="Page.add_file_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_file_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加文件附件注释</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_freetext_annot" title="Page.add_freetext_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_freetext_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加自由文本注释</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_highlight_annot" title="Page.add_highlight_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_highlight_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加高亮注释</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_ink_annot" title="Page.add_ink_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_ink_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加手写墨迹注释</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_line_annot" title="Page.add_line_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_line_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加直线注释</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_polygon_annot" title="Page.add_polygon_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_polygon_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加多边形注释</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_polyline_annot" title="Page.add_polyline_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_polyline_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加折线注释</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_rect_annot" title="Page.add_rect_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_rect_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加矩形注释</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_redact_annot" title="Page.add_redact_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_redact_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加遮蔽（Redaction）注释</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_squiggly_annot" title="Page.add_squiggly_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_squiggly_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加波浪线注释</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_stamp_annot" title="Page.add_stamp_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_stamp_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加印章（Stamp）注释</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_strikeout_annot" title="Page.add_strikeout_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_strikeout_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加删除线（Strikeout）注释</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_text_annot" title="Page.add_text_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_text_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加文本注释（评论）</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_underline_annot" title="Page.add_underline_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_underline_annot()</span></code></a></p></td>
<td><p>仅限 PDF：添加下划线注释</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_widget" title="Page.add_widget"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_widget()</span></code></a></p></td>
<td><p>仅限 PDF：添加表单控件字段</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.annot_names" title="Page.annot_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.annot_names()</span></code></a></p></td>
<td><p>仅限 PDF：获取页面上所有注释（及控件）名称的列表</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.annot_xrefs" title="Page.annot_xrefs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.annot_xrefs()</span></code></a></p></td>
<td><p>仅限 PDF：获取页面上所有注释（及控件）xref 的列表</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.annots" title="Page.annots"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.annots()</span></code></a></p></td>
<td><p>返回页面上所有注释的生成器</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.apply_redactions" title="Page.apply_redactions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.apply_redactions()</span></code></a></p></td>
<td><p>仅限 PDF：处理页面上的遮蔽内容</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.bound" title="Page.bound"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.bound()</span></code></a></p></td>
<td><p>获取页面边界矩形</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.cluster_drawings" title="Page.cluster_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.cluster_drawings()</span></code></a></p></td>
<td><p>仅限 PDF：获取矢量图形的边界框</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.delete_annot" title="Page.delete_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.delete_annot()</span></code></a></p></td>
<td><p>仅限 PDF：删除指定注释</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.delete_image" title="Page.delete_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.delete_image()</span></code></a></p></td>
<td><p>仅限 PDF：删除页面上的图像</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.delete_link" title="Page.delete_link"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.delete_link()</span></code></a></p></td>
<td><p>仅限 PDF：删除链接</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.delete_widget" title="Page.delete_widget"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.delete_widget()</span></code></a></p></td>
<td><p>仅限 PDF：删除表单控件字段</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.draw_bezier" title="Page.draw_bezier"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_bezier()</span></code></a></p></td>
<td><p>仅限 PDF：绘制三次贝塞尔曲线</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.draw_circle" title="Page.draw_circle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_circle()</span></code></a></p></td>
<td><p>仅限 PDF：绘制圆</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.draw_curve" title="Page.draw_curve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_curve()</span></code></a></p></td>
<td><p>仅限 PDF：绘制贝塞尔曲线</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.draw_line" title="Page.draw_line"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_line()</span></code></a></p></td>
<td><p>仅限 PDF：绘制直线</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.draw_oval" title="Page.draw_oval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_oval()</span></code></a></p></td>
<td><p>仅限 PDF：绘制椭圆</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.draw_polyline" title="Page.draw_polyline"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_polyline()</span></code></a></p></td>
<td><p>仅限 PDF：绘制折线</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.draw_quad" title="Page.draw_quad"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_quad()</span></code></a></p></td>
<td><p>仅限 PDF：绘制四边形</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.draw_rect" title="Page.draw_rect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_rect()</span></code></a></p></td>
<td><p>仅限 PDF：绘制矩形</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.draw_sector" title="Page.draw_sector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_sector()</span></code></a></p></td>
<td><p>仅限 PDF：绘制扇形</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.draw_squiggle" title="Page.draw_squiggle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_squiggle()</span></code></a></p></td>
<td><p>仅限 PDF：绘制波浪线</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.draw_zigzag" title="Page.draw_zigzag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_zigzag()</span></code></a></p></td>
<td><p>仅限 PDF：绘制锯齿线</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.find_tables" title="Page.find_tables"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.find_tables()</span></code></a></p></td>
<td><p>在页面上检测表格</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a></p></td>
<td><p>获取页面上的矢量图形</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.get_fonts" title="Page.get_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_fonts()</span></code></a></p></td>
<td><p>仅限 PDF：获取页面中引用的字体列表</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_image_bbox" title="Page.get_image_bbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_bbox()</span></code></a></p></td>
<td><p>仅限 PDF：获取嵌入图像的边界框和矩阵</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.get_image_info" title="Page.get_image_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_info()</span></code></a></p></td>
<td><p>获取页面中所有图像的元信息列表</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_image_rects" title="Page.get_image_rects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_rects()</span></code></a></p></td>
<td><p>仅限 PDF：改进版的 <a class="reference internal" href="#Page.get_image_bbox" title="Page.get_image_bbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_bbox()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.get_images" title="Page.get_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_images()</span></code></a></p></td>
<td><p>仅限 PDF：获取页面中引用的图像列表</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_label" title="Page.get_label"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_label()</span></code></a></p></td>
<td><p>仅限 PDF：获取页面标签</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.get_links" title="Page.get_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_links()</span></code></a></p></td>
<td><p>获取页面上所有链接</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_pixmap" title="Page.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_pixmap()</span></code></a></p></td>
<td><p>以光栅格式创建页面图像</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.get_svg_image" title="Page.get_svg_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_svg_image()</span></code></a></p></td>
<td><p>以 SVG 格式创建页面图像</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a></p></td>
<td><p>提取页面文本</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.get_textbox" title="Page.get_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_textbox()</span></code></a></p></td>
<td><p>提取矩形区域内的文本</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_textpage_ocr" title="Page.get_textpage_ocr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_textpage_ocr()</span></code></a></p></td>
<td><p>使用 OCR 解析页面文本</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.get_textpage" title="Page.get_textpage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_textpage()</span></code></a></p></td>
<td><p>解析页面文本</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_xobjects" title="Page.get_xobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_xobjects()</span></code></a></p></td>
<td><p>仅限 PDF：获取页面中引用的 xobjects 列表</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.insert_font" title="Page.insert_font"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_font()</span></code></a></p></td>
<td><p>仅限 PDF：在页面上插入字体</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a></p></td>
<td><p>仅限 PDF：插入图像</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.insert_link" title="Page.insert_link"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_link()</span></code></a></p></td>
<td><p>仅限 PDF：插入链接</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.insert_text" title="Page.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_text()</span></code></a></p></td>
<td><p>仅限 PDF：插入文本</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.insert_htmlbox" title="Page.insert_htmlbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_htmlbox()</span></code></a></p></td>
<td><p>仅限 PDF：在矩形区域内插入 HTML 文本</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.insert_textbox" title="Page.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_textbox()</span></code></a></p></td>
<td><p>仅限 PDF：插入文本框</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.links" title="Page.links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.links()</span></code></a></p></td>
<td><p>返回页面上所有链接的生成器</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.load_annot" title="Page.load_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.load_annot()</span></code></a></p></td>
<td><p>仅限 PDF：加载指定注释</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.load_widget" title="Page.load_widget"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.load_widget()</span></code></a></p></td>
<td><p>仅限 PDF：加载指定表单控件字段</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.load_links" title="Page.load_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.load_links()</span></code></a></p></td>
<td><p>返回页面上的第一个链接</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.new_shape" title="Page.new_shape"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.new_shape()</span></code></a></p></td>
<td><p>仅限 PDF：创建新的 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.remove_rotation" title="Page.remove_rotation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.remove_rotation()</span></code></a></p></td>
<td><p>仅限 PDF：移除页面旋转（重置为 0）</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.replace_image" title="Page.replace_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.replace_image()</span></code></a></p></td>
<td><p>仅限 PDF：替换页面上的图像</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.search_for" title="Page.search_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.search_for()</span></code></a></p></td>
<td><p>搜索字符串</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.set_artbox" title="Page.set_artbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_artbox()</span></code></a></p></td>
<td><p>仅限 PDF：修改 <code class="xref any docutils literal notranslate"><span class="pre">/ArtBox</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.set_bleedbox" title="Page.set_bleedbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_bleedbox()</span></code></a></p></td>
<td><p>仅限 PDF：修改 <code class="xref any docutils literal notranslate"><span class="pre">/BleedBox</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.set_cropbox" title="Page.set_cropbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_cropbox()</span></code></a></p></td>
<td><p>仅限 PDF：修改 <code class="xref py py-data docutils literal notranslate"><span class="pre">cropbox</span></code> （可见页面）</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.set_mediabox" title="Page.set_mediabox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_mediabox()</span></code></a></p></td>
<td><p>仅限 PDF：修改 <code class="xref any docutils literal notranslate"><span class="pre">/MediaBox</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.set_rotation" title="Page.set_rotation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_rotation()</span></code></a></p></td>
<td><p>仅限 PDF：设置页面旋转角度</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.set_trimbox" title="Page.set_trimbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_trimbox()</span></code></a></p></td>
<td><p>仅限 PDF：修改 <code class="xref any docutils literal notranslate"><span class="pre">/TrimBox</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a></p></td>
<td><p>仅限 PDF：显示 PDF 页面图像</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.update_link" title="Page.update_link"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.update_link()</span></code></a></p></td>
<td><p>仅限 PDF：修改链接</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.widgets" title="Page.widgets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.widgets()</span></code></a></p></td>
<td><p>返回页面上所有表单控件字段的生成器</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.write_text" title="Page.write_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.write_text()</span></code></a></p></td>
<td><p>写入一个或多个 <a class="reference internal" href="textwriter.html#textwriter"><span class="std std-ref">TextWriter</span></a> 对象</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.cropbox_position" title="Page.cropbox_position"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.cropbox_position</span></code></a></p></td>
<td><p><code class="xref py py-data docutils literal notranslate"><span class="pre">cropbox</span></code> 的偏移量</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.cropbox" title="Page.cropbox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.cropbox</span></code></a></p></td>
<td><p>页面的 <code class="xref py py-data docutils literal notranslate"><span class="pre">cropbox</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.artbox" title="Page.artbox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.artbox</span></code></a></p></td>
<td><p>页面的 <code class="xref any docutils literal notranslate"><span class="pre">/ArtBox</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.bleedbox" title="Page.bleedbox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.bleedbox</span></code></a></p></td>
<td><p>页面的 <code class="xref any docutils literal notranslate"><span class="pre">/BleedBox</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.trimbox" title="Page.trimbox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.trimbox</span></code></a></p></td>
<td><p>页面的 <code class="xref any docutils literal notranslate"><span class="pre">/TrimBox</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.derotation_matrix" title="Page.derotation_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.derotation_matrix</span></code></a></p></td>
<td><p>仅限 PDF：获取未旋转坐标</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.first_annot" title="Page.first_annot"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.first_annot</span></code></a></p></td>
<td><p>页面上的第一个 <a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.first_link" title="Page.first_link"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.first_link</span></code></a></p></td>
<td><p>页面上的第一个 <a class="reference internal" href="link.html#link"><span class="std std-ref">Link</span></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.first_widget" title="Page.first_widget"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.first_widget</span></code></a></p></td>
<td><p>页面上的第一个表单控件字段</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.mediabox_size" title="Page.mediabox_size"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.mediabox_size</span></code></a></p></td>
<td><p><code class="xref py py-data docutils literal notranslate"><span class="pre">mediabox</span></code> 的右下角点</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.mediabox" title="Page.mediabox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.mediabox</span></code></a></p></td>
<td><p>页面的 <code class="xref py py-data docutils literal notranslate"><span class="pre">mediabox</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.number" title="Page.number"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.number</span></code></a></p></td>
<td><p>页码</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.parent" title="Page.parent"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.parent</span></code></a></p></td>
<td><p>所属文档对象</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.rect" title="Page.rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rect</span></code></a></p></td>
<td><p>页面矩形区域</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.rotation_matrix" title="Page.rotation_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rotation_matrix</span></code></a></p></td>
<td><p>仅限 PDF：获取旋转坐标</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.rotation" title="Page.rotation"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rotation</span></code></a></p></td>
<td><p>仅限 PDF：页面旋转角度</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.transformation_matrix" title="Page.transformation_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.transformation_matrix</span></code></a></p></td>
<td><p>仅限 PDF：转换 PDF 和 MuPDF 坐标</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.xref" title="Page.xref"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.xref</span></code></a></p></td>
<td><p>仅限 PDF：页面的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">英文</label><div class="tab-content docutils container">
<p>Changing page properties and adding or changing page content is available for PDF documents only.</p>
<p>In a nutshell, this is what you can do with PyMuPDF:</p>
<ul class="simple">
<li><p>Modify page rotation and the visible part (“cropbox”) of the page.</p></li>
<li><p>Insert images, other PDF pages, text and simple geometrical objects.</p></li>
<li><p>Add annotations and form fields.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Methods require coordinates (points, rectangles) to put content in desired places. Please be aware that these coordinates <strong>must always</strong> be provided relative to the <strong>unrotated</strong> page (since v1.17.0). The reverse is also true: except <a class="reference internal" href="#Page.rect" title="Page.rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rect</span></code></a>, resp. <a class="reference internal" href="#Page.bound" title="Page.bound"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.bound()</span></code></a> (both <em>reflect</em> when the page is rotated), all coordinates returned by methods and attributes pertain to the unrotated page.</p>
<p>So the returned value of e.g. <a class="reference internal" href="#Page.get_image_bbox" title="Page.get_image_bbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_bbox()</span></code></a> will not change if you do a <a class="reference internal" href="#Page.set_rotation" title="Page.set_rotation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_rotation()</span></code></a>. The same is true for coordinates returned by <a class="reference internal" href="#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a>, annotation rectangles, and so on. If you want to find out, where an object is located in <strong>rotated coordinates</strong>, multiply the coordinates with <a class="reference internal" href="#Page.rotation_matrix" title="Page.rotation_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rotation_matrix</span></code></a>. There also is its inverse, <a class="reference internal" href="#Page.derotation_matrix" title="Page.derotation_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.derotation_matrix</span></code></a>, which you can use when interfacing with other readers, which may behave differently in this respect.</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>If you add or update annotations, links or form fields on the page and immediately afterwards need to work with them (i.e. <strong>without leaving the page</strong>), you should reload the page using <a class="reference internal" href="document.html#Document.reload_page" title="Document.reload_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.reload_page()</span></code></a> before referring to these new or updated items.</p>
<p>Reloading the page is generally recommended – although not strictly required in all cases. However, some annotation and widget types have extended features in PyMuPDF compared to MuPDF. More of these extensions may also be added in the future.</p>
<p>Releoading the page ensures all your changes have been fully applied to PDF structures, so you can safely create Pixmaps or successfully iterate over annotations, links and form fields.</p>
</div>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Method / Attribute</strong></p></th>
<th class="head"><p><strong>Short Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_caret_annot" title="Page.add_caret_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_caret_annot()</span></code></a></p></td>
<td><p>PDF only: add a caret annotation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_circle_annot" title="Page.add_circle_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_circle_annot()</span></code></a></p></td>
<td><p>PDF only: add a circle annotation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_file_annot" title="Page.add_file_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_file_annot()</span></code></a></p></td>
<td><p>PDF only: add a file attachment annotation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_freetext_annot" title="Page.add_freetext_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_freetext_annot()</span></code></a></p></td>
<td><p>PDF only: add a text annotation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_highlight_annot" title="Page.add_highlight_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_highlight_annot()</span></code></a></p></td>
<td><p>PDF only: add a “highlight” annotation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_ink_annot" title="Page.add_ink_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_ink_annot()</span></code></a></p></td>
<td><p>PDF only: add an ink annotation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_line_annot" title="Page.add_line_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_line_annot()</span></code></a></p></td>
<td><p>PDF only: add a line annotation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_polygon_annot" title="Page.add_polygon_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_polygon_annot()</span></code></a></p></td>
<td><p>PDF only: add a polygon annotation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_polyline_annot" title="Page.add_polyline_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_polyline_annot()</span></code></a></p></td>
<td><p>PDF only: add a multi-line annotation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_rect_annot" title="Page.add_rect_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_rect_annot()</span></code></a></p></td>
<td><p>PDF only: add a rectangle annotation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_redact_annot" title="Page.add_redact_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_redact_annot()</span></code></a></p></td>
<td><p>PDF only: add a redaction annotation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_squiggly_annot" title="Page.add_squiggly_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_squiggly_annot()</span></code></a></p></td>
<td><p>PDF only: add a “squiggly” annotation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_stamp_annot" title="Page.add_stamp_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_stamp_annot()</span></code></a></p></td>
<td><p>PDF only: add a “rubber stamp” annotation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_strikeout_annot" title="Page.add_strikeout_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_strikeout_annot()</span></code></a></p></td>
<td><p>PDF only: add a “strike-out” annotation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_text_annot" title="Page.add_text_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_text_annot()</span></code></a></p></td>
<td><p>PDF only: add a comment</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.add_underline_annot" title="Page.add_underline_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_underline_annot()</span></code></a></p></td>
<td><p>PDF only: add an “underline” annotation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.add_widget" title="Page.add_widget"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.add_widget()</span></code></a></p></td>
<td><p>PDF only: add a PDF Form field</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.annot_names" title="Page.annot_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.annot_names()</span></code></a></p></td>
<td><p>PDF only: a list of annotation (and widget) names</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.annot_xrefs" title="Page.annot_xrefs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.annot_xrefs()</span></code></a></p></td>
<td><p>PDF only: a list of annotation (and widget) xrefs</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.annots" title="Page.annots"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.annots()</span></code></a></p></td>
<td><p>return a generator over the annots on the page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.apply_redactions" title="Page.apply_redactions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.apply_redactions()</span></code></a></p></td>
<td><p>PDF only: process the redactions of the page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.bound" title="Page.bound"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.bound()</span></code></a></p></td>
<td><p>rectangle of the page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.cluster_drawings" title="Page.cluster_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.cluster_drawings()</span></code></a></p></td>
<td><p>PDF only: bounding boxes of vector graphics</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.delete_annot" title="Page.delete_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.delete_annot()</span></code></a></p></td>
<td><p>PDF only: delete an annotation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.delete_image" title="Page.delete_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.delete_image()</span></code></a></p></td>
<td><p>PDF only: delete an image</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.delete_link" title="Page.delete_link"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.delete_link()</span></code></a></p></td>
<td><p>PDF only: delete a link</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.delete_widget" title="Page.delete_widget"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.delete_widget()</span></code></a></p></td>
<td><p>PDF only: delete a widget / field</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.draw_bezier" title="Page.draw_bezier"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_bezier()</span></code></a></p></td>
<td><p>PDF only: draw a cubic Bezier curve</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.draw_circle" title="Page.draw_circle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_circle()</span></code></a></p></td>
<td><p>PDF only: draw a circle</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.draw_curve" title="Page.draw_curve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_curve()</span></code></a></p></td>
<td><p>PDF only: draw a special Bezier curve</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.draw_line" title="Page.draw_line"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_line()</span></code></a></p></td>
<td><p>PDF only: draw a line</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.draw_oval" title="Page.draw_oval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_oval()</span></code></a></p></td>
<td><p>PDF only: draw an oval / ellipse</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.draw_polyline" title="Page.draw_polyline"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_polyline()</span></code></a></p></td>
<td><p>PDF only: connect a point sequence</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.draw_quad" title="Page.draw_quad"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_quad()</span></code></a></p></td>
<td><p>PDF only: draw a quad</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.draw_rect" title="Page.draw_rect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_rect()</span></code></a></p></td>
<td><p>PDF only: draw a rectangle</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.draw_sector" title="Page.draw_sector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_sector()</span></code></a></p></td>
<td><p>PDF only: draw a circular sector</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.draw_squiggle" title="Page.draw_squiggle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_squiggle()</span></code></a></p></td>
<td><p>PDF only: draw a squiggly line</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.draw_zigzag" title="Page.draw_zigzag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.draw_zigzag()</span></code></a></p></td>
<td><p>PDF only: draw a zig-zagged line</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.find_tables" title="Page.find_tables"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.find_tables()</span></code></a></p></td>
<td><p>locate tables on the page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a></p></td>
<td><p>get vector graphics on page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.get_fonts" title="Page.get_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_fonts()</span></code></a></p></td>
<td><p>PDF only: get list of referenced fonts</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_image_bbox" title="Page.get_image_bbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_bbox()</span></code></a></p></td>
<td><p>PDF only: get bbox and matrix of embedded image</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.get_image_info" title="Page.get_image_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_info()</span></code></a></p></td>
<td><p>get list of meta information for all used images</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_image_rects" title="Page.get_image_rects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_rects()</span></code></a></p></td>
<td><p>PDF only: improved version of <a class="reference internal" href="#Page.get_image_bbox" title="Page.get_image_bbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_bbox()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.get_images" title="Page.get_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_images()</span></code></a></p></td>
<td><p>PDF only: get list of referenced images</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_label" title="Page.get_label"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_label()</span></code></a></p></td>
<td><p>PDF only: return the label of the page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.get_links" title="Page.get_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_links()</span></code></a></p></td>
<td><p>get all links</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_pixmap" title="Page.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_pixmap()</span></code></a></p></td>
<td><p>create a page image in raster format</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.get_svg_image" title="Page.get_svg_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_svg_image()</span></code></a></p></td>
<td><p>create a page image in SVG format</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a></p></td>
<td><p>extract the page’s text</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.get_textbox" title="Page.get_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_textbox()</span></code></a></p></td>
<td><p>extract text contained in a rectangle</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_textpage_ocr" title="Page.get_textpage_ocr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_textpage_ocr()</span></code></a></p></td>
<td><p>create a TextPage with OCR for the page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.get_textpage" title="Page.get_textpage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_textpage()</span></code></a></p></td>
<td><p>create a TextPage for the page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.get_xobjects" title="Page.get_xobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_xobjects()</span></code></a></p></td>
<td><p>PDF only: get list of referenced xobjects</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.insert_font" title="Page.insert_font"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_font()</span></code></a></p></td>
<td><p>PDF only: insert a font for use by the page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a></p></td>
<td><p>PDF only: insert an image</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.insert_link" title="Page.insert_link"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_link()</span></code></a></p></td>
<td><p>PDF only: insert a link</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.insert_text" title="Page.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_text()</span></code></a></p></td>
<td><p>PDF only: insert text</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.insert_htmlbox" title="Page.insert_htmlbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_htmlbox()</span></code></a></p></td>
<td><p>PDF only: insert html text in a rectangle</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.insert_textbox" title="Page.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_textbox()</span></code></a></p></td>
<td><p>PDF only: insert a text box</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.links" title="Page.links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.links()</span></code></a></p></td>
<td><p>return a generator of the links on the page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.load_annot" title="Page.load_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.load_annot()</span></code></a></p></td>
<td><p>PDF only: load a specific annotation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.load_widget" title="Page.load_widget"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.load_widget()</span></code></a></p></td>
<td><p>PDF only: load a specific field</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.load_links" title="Page.load_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.load_links()</span></code></a></p></td>
<td><p>return the first link on a page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.new_shape" title="Page.new_shape"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.new_shape()</span></code></a></p></td>
<td><p>PDF only: create a new <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.remove_rotation" title="Page.remove_rotation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.remove_rotation()</span></code></a></p></td>
<td><p>PDF only: set page rotation to 0</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.replace_image" title="Page.replace_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.replace_image()</span></code></a></p></td>
<td><p>PDF only: replace an image</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.search_for" title="Page.search_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.search_for()</span></code></a></p></td>
<td><p>search for a string</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.set_artbox" title="Page.set_artbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_artbox()</span></code></a></p></td>
<td><p>PDF only: modify <code class="xref any docutils literal notranslate"><span class="pre">/ArtBox</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.set_bleedbox" title="Page.set_bleedbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_bleedbox()</span></code></a></p></td>
<td><p>PDF only: modify <code class="xref any docutils literal notranslate"><span class="pre">/BleedBox</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.set_cropbox" title="Page.set_cropbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_cropbox()</span></code></a></p></td>
<td><p>PDF only: modify the <code class="xref py py-data docutils literal notranslate"><span class="pre">cropbox</span></code> (visible page)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.set_mediabox" title="Page.set_mediabox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_mediabox()</span></code></a></p></td>
<td><p>PDF only: modify <code class="xref any docutils literal notranslate"><span class="pre">/MediaBox</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.set_rotation" title="Page.set_rotation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_rotation()</span></code></a></p></td>
<td><p>PDF only: set page rotation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.set_trimbox" title="Page.set_trimbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_trimbox()</span></code></a></p></td>
<td><p>PDF only: modify <code class="xref any docutils literal notranslate"><span class="pre">/TrimBox</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a></p></td>
<td><p>PDF only: display PDF page image</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.update_link" title="Page.update_link"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.update_link()</span></code></a></p></td>
<td><p>PDF only: modify a link</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.widgets" title="Page.widgets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.widgets()</span></code></a></p></td>
<td><p>return a generator over the fields on the page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.write_text" title="Page.write_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.write_text()</span></code></a></p></td>
<td><p>write one or more <a class="reference internal" href="textwriter.html#textwriter"><span class="std std-ref">TextWriter</span></a> objects</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.cropbox_position" title="Page.cropbox_position"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.cropbox_position</span></code></a></p></td>
<td><p>displacement of the <code class="xref py py-data docutils literal notranslate"><span class="pre">cropbox</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.cropbox" title="Page.cropbox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.cropbox</span></code></a></p></td>
<td><p>the page’s <code class="xref py py-data docutils literal notranslate"><span class="pre">cropbox</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.artbox" title="Page.artbox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.artbox</span></code></a></p></td>
<td><p>the page’s <code class="xref any docutils literal notranslate"><span class="pre">/ArtBox</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.bleedbox" title="Page.bleedbox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.bleedbox</span></code></a></p></td>
<td><p>the page’s <code class="xref any docutils literal notranslate"><span class="pre">/BleedBox</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.trimbox" title="Page.trimbox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.trimbox</span></code></a></p></td>
<td><p>the page’s <code class="xref any docutils literal notranslate"><span class="pre">/TrimBox</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.derotation_matrix" title="Page.derotation_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.derotation_matrix</span></code></a></p></td>
<td><p>PDF only: get coordinates in unrotated page space</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.first_annot" title="Page.first_annot"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.first_annot</span></code></a></p></td>
<td><p>first <a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a> on the page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.first_link" title="Page.first_link"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.first_link</span></code></a></p></td>
<td><p>first <a class="reference internal" href="link.html#link"><span class="std std-ref">Link</span></a> on the page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.first_widget" title="Page.first_widget"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.first_widget</span></code></a></p></td>
<td><p>first widget (form field) on the page</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.mediabox_size" title="Page.mediabox_size"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.mediabox_size</span></code></a></p></td>
<td><p>bottom-right point of <code class="xref py py-data docutils literal notranslate"><span class="pre">mediabox</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.mediabox" title="Page.mediabox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.mediabox</span></code></a></p></td>
<td><p>the page’s <code class="xref py py-data docutils literal notranslate"><span class="pre">mediabox</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.number" title="Page.number"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.number</span></code></a></p></td>
<td><p>page number</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.parent" title="Page.parent"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.parent</span></code></a></p></td>
<td><p>owning document object</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.rect" title="Page.rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rect</span></code></a></p></td>
<td><p>rectangle of the page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.rotation_matrix" title="Page.rotation_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rotation_matrix</span></code></a></p></td>
<td><p>PDF only: get coordinates in rotated page space</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.rotation" title="Page.rotation"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rotation</span></code></a></p></td>
<td><p>PDF only: page rotation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#Page.transformation_matrix" title="Page.transformation_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.transformation_matrix</span></code></a></p></td>
<td><p>PDF only: translate between PDF and MuPDF space</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#Page.xref" title="Page.xref"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.xref</span></code></a></p></td>
<td><p>PDF only: page <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p><strong>Class API</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">中文</label><div class="tab-content docutils container">
<dl class="py class">
<dt class="sig sig-object py" id="Page">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Page</span></span><a class="headerlink" href="#Page" title="永久链接至目标">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="Page.bound">
<span class="sig-name descname"><span class="pre">bound</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Page.bound" title="永久链接至目标">#</a></dt>
<dd><p>确定页面的矩形区域。等同于属性 <a class="reference internal" href="#Page.rect" title="Page.rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rect</span></code></a>。对于 PDF 文档，该矩形 <strong>通常</strong> 也与 <a class="reference internal" href="#Page.mediabox" title="Page.mediabox"><code class="xref py py-data docutils literal notranslate"><span class="pre">mediabox</span></code></a> 和 <a class="reference internal" href="#Page.cropbox" title="Page.cropbox"><code class="xref py py-data docutils literal notranslate"><span class="pre">cropbox</span></code></a> 一致，但并非总是如此。例如，如果页面经过旋转，则此方法会反映该变化，而 <a class="reference internal" href="#Page.cropbox" title="Page.cropbox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.cropbox</span></code></a> 不会受到影响。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.add_caret_annot">
<span class="sig-name descname"><span class="pre">add_caret_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_caret_annot" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：添加一个插入标记图标。插入标记（Caret Annotation）通常用于指示页面上的文本编辑。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>point</strong> (<em>point_like</em>) – 插入标记图标的左上角位置，该图标位于一个 20 × 20 的矩形内，由 MuPDF 提供。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>创建的注释对象。描边颜色为蓝色 (0, 0, 1)，不支持填充颜色。</p>
</dd>
</dl>
<a class="reference internal image-reference" href="_images/img-caret-annot.jpg"><img alt="_images/img-caret-annot.jpg" src="_images/img-caret-annot.jpg" style="width: 280.0px; height: 51.8px;" /></a>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.16.0</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.add_text_annot">
<span class="sig-name descname"><span class="pre">add_text_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Note'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_text_annot" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：添加评论图标（“便签”），并附带文本。仅图标可见，文本默认隐藏，许多 PDF 查看器可在鼠标悬停或双击图标时显示文本内容。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point</strong> (<em>point_like</em>) – 评论图标的左上角位置，该图标位于 20 × 20 的矩形内，由 MuPDF 提供。</p></li>
<li><p><strong>text</strong> (<em>str</em>) – 评论文本，双击或悬停图标时显示。可包含任意拉丁字符。</p></li>
<li><p><strong>icon</strong> (<em>str</em>) – 选择用于表示评论的图标，可选值包括：
- <code class="xref any docutils literal notranslate"><span class="pre">&quot;Note&quot;</span></code> （默认）
- <code class="xref any docutils literal notranslate"><span class="pre">&quot;Comment&quot;</span></code>
- <code class="xref any docutils literal notranslate"><span class="pre">&quot;Help&quot;</span></code>
- <code class="xref any docutils literal notranslate"><span class="pre">&quot;Insert&quot;</span></code>
- <code class="xref any docutils literal notranslate"><span class="pre">&quot;Key&quot;</span></code>
- <code class="xref any docutils literal notranslate"><span class="pre">&quot;NewParagraph&quot;</span></code>
- <code class="xref any docutils literal notranslate"><span class="pre">&quot;Paragraph&quot;</span></code></p></li>
</ul>
</dd>
</dl>
<p>（新增于 v1.16.0）</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a></p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>创建的注释对象。描边颜色为黄色 (1, 1, 0)，不支持填充颜色。</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="index-0"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.add_freetext_annot">
<span class="sig-name descname"><span class="pre">add_freetext_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'helv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dashes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PDF_ANNOT_LE_OPEN_ARROW</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">TEXT_ALIGN_LEFT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">richtext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_freetext_annot" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：在给定矩形区域内添加文本。可以通过指定两个或三个点状对象来选择性地请求显示“标注”形状（见下文）。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rect</strong> (<em>rect_like</em>) – 要插入文本的矩形区域。文本会根据框宽自动换行，超出矩形区域的文本部分将不可见且不提示警告。</p></li>
<li><p><strong>text</strong> (<em>str</em>) – 文本内容。可以包含任何混合的拉丁字母、希腊字母、 Cyrillic、汉字、日文和韩文字符。如果 <code class="xref any docutils literal notranslate"><span class="pre">richtext=True</span></code> （见下文），则字符串会被解释为 HTML 语法，这为文本效果提供了更多的选择。</p></li>
<li><p><strong>fontsize</strong> (<em>float</em>) – 字体大小。默认值为 11。如果 <code class="xref any docutils literal notranslate"><span class="pre">richtext=True</span></code>，则此参数会被忽略。</p></li>
<li><p><strong>fontname</strong> (<em>str</em>) – <p>字体名称。默认值为 “Helv”。如果 <code class="xref any docutils literal notranslate"><span class="pre">richtext=True</span></code>，则此参数被忽略；否则，以下字体是可接受的：</p>
<ul>
<li><p>可接受的字体有 “Helv”（Helvetica），”Cour”（Courier），”TiRo”（Times-Roman），”ZaDb”（ZapfDingBats）和 “Symb”（Symbol）。名称可以缩写为前两个字母，如 “Co” 代表 “Cour”，可使用小写字母。</p></li>
<li><p>不支持字体的粗体或斜体变体。</p></li>
</ul>
</p></li>
<li><p><strong>text_color</strong> (<em>list</em><em>,</em><em>tuple</em><em>,</em><em>float</em>) – 文本颜色。默认值为黑色。如果 <code class="xref any docutils literal notranslate"><span class="pre">richtext=True</span></code>，则此参数被忽略。</p></li>
<li><p><strong>fill_color</strong> (<em>list</em><em>,</em><em>tuple</em><em>,</em><em>float</em>) – 填充颜色。用于 <code class="docutils literal notranslate"><span class="pre">rect</span></code> 和适用情况下的标注线条的终点。默认值为 <code class="docutils literal notranslate"><span class="pre">None</span></code>。</p></li>
<li><p><strong>border_color</strong> (<em>list</em><em>,</em><em>tuple</em><em>,</em><em>float</em>) – 该参数仅对 <code class="xref any docutils literal notranslate"><span class="pre">richtext=True</span></code> 有效，否则使用 <code class="docutils literal notranslate"><span class="pre">text_color</span></code>。</p></li>
<li><p><strong>border_width</strong> (<em>float</em>) – 边框和标注线条的宽度。默认值为 0（无边框），在这种情况下，标注线条可能会在不同的 PDF 查看器中显示为细线。</p></li>
<li><p><strong>dashes</strong> (<em>list</em><em>,</em><em>tuple</em>) – 指定边框和标注线条虚线样式的浮动列表。默认值为 <code class="docutils literal notranslate"><span class="pre">None</span></code>。</p></li>
<li><p><strong>callout</strong> (<em>list</em><em>,</em><em>tuple</em>) – 一个包含两个或三个 <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a> 对象的列表/元组，这些对象会被解释为起点、膝点和终点（按此顺序），将该标注转换为一个标注形状。</p></li>
<li><p><strong>line_end</strong> (<em>int</em>) – 标注线条的终点符号。它会被绘制在 <code class="xref any docutils literal notranslate"><span class="pre">callout</span></code> 列表中的第一个点。默认值为开放箭头。可以参考 <a class="reference internal" href="vars.html#annotationlineends"><span class="std std-ref">注释行尾样式</span></a> 获取更多可能的值。</p></li>
<li><p><strong>opacity</strong> (<em>float</em>) – 透明度，值为 <code class="xref any docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">opacity</span> <span class="pre">&lt;</span> <span class="pre">1</span></code>，使标注变得透明。默认值为无透明度。</p></li>
<li><p><strong>align</strong> (<em>int</em>) – 文本对齐方式，取值为 TEXT_ALIGN_LEFT、TEXT_ALIGN_CENTER 或 TEXT_ALIGN_RIGHT — 不支持两端对齐。如果 <code class="xref any docutils literal notranslate"><span class="pre">richtext=True</span></code>，此参数将被忽略。</p></li>
<li><p><strong>rotate</strong> (<em>int</em>) – 文本方向，接受的值为 90° 的整数倍。无效值将会设置为 0。</p></li>
<li><p><strong>richtext</strong> (<em>bool</em>) – 将 <code class="docutils literal notranslate"><span class="pre">text</span></code> 视为 HTML 语法。允许实现 <strong>粗体</strong>、<em>斜体</em>、任意文本颜色、字体大小、文本对齐（包括两端对齐）等效果，具体取决于 HTML 和样式指令的支持。类似于 <a class="reference internal" href="#Page.insert_htmlbox" title="Page.insert_htmlbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_htmlbox()</span></code></a> 中的处理方式。基础库会在遇到不包含在标准字体中的字符时引入所需的字体。如果设置了此选项，一些参数将被忽略，如上所述。默认值为 <code class="docutils literal notranslate"><span class="pre">False</span></code>。</p></li>
<li><p><strong>style</strong> (<em>str</em>) – 提供可选的 CSS 语法的 HTML 样式信息。如果 <code class="xref any docutils literal notranslate"><span class="pre">richtext=False</span></code>，则此参数被忽略。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>创建的注释对象。</p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>在 v1.19.6 中更改：添加边框颜色参数</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.add_file_annot">
<span class="sig-name descname"><span class="pre">add_file_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ufilename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PushPin'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_file_annot" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：在指定位置添加文件附件标注，并显示 “PushPin” 图标。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>point_like</em>) – “PushPin” 图标的左上角位置，该图标位于一个 18x18 的矩形内。</p></li>
<li><p><strong>buffer</strong> (<em>bytes</em><em>,</em><em>bytearray</em><em>,</em><em>BytesIO</em>) – <p>要存储的数据（实际文件内容、任何数据等）。</p>
<p>在 v1.14.13 中更改：现在也支持 <em>io.BytesIO</em>。</p>
</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – 与数据关联的文件名。</p></li>
<li><p><strong>ufilename</strong> (<em>str</em>) – 文件名的可选 PDF Unicode 版本。默认为文件名。</p></li>
<li><p><strong>desc</strong> (<em>str</em>) – 文件的可选描述。默认为文件名。</p></li>
<li><p><strong>icon</strong> (<em>str</em>) – 选择以下图标之一作为附件的可视符号：
- <code class="xref any docutils literal notranslate"><span class="pre">&quot;PushPin&quot;</span></code> （默认）
- <code class="xref any docutils literal notranslate"><span class="pre">&quot;Graph&quot;</span></code>
- <code class="xref any docutils literal notranslate"><span class="pre">&quot;Paperclip&quot;</span></code>
- <code class="xref any docutils literal notranslate"><span class="pre">&quot;Tag&quot;</span></code>
（新增于 v1.16.0）</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>创建的注释对象。描边颜色为黄色 (1, 1, 0)，不支持填充颜色。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.add_ink_annot">
<span class="sig-name descname"><span class="pre">add_ink_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_ink_annot" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：添加“手绘”涂鸦标注。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>list</strong> (<em>sequence</em>) – 一个包含一个或多个子列表的列表，每个子列表包含 <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a> 项。每个子列表中的每个项都被解释为 <a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a>，并通过这些点绘制连接线。不同的子列表代表不同的绘制线条。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>创建的注释，默认外观为黑色 (0, 0, 0)，线条宽度为 1。没有填充颜色支持。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.add_line_annot">
<span class="sig-name descname"><span class="pre">add_line_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_line_annot" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：添加一条直线标注。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p1</strong> (<em>point_like</em>) – 直线的起始点。</p></li>
<li><p><strong>p2</strong> (<em>point_like</em>) – 直线的终点。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>创建的注释。直线（描边）颜色为红色 = (1, 0, 0)，线条宽度为 1。没有填充颜色支持。 <strong>标注矩形</strong> 会自动创建，包含两个点，每个点周围有半径为 3 * 线条宽度的圆圈，以便为任何线条结束符号腾出空间。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.add_rect_annot">
<span class="sig-name descname"><span class="pre">add_rect_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_rect_annot" title="永久链接至目标">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.add_circle_annot">
<span class="sig-name descname"><span class="pre">add_circle_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_circle_annot" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：添加矩形或圆形标注。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rect</strong> (<em>rect_like</em>) – 绘制矩形或圆形的矩形区域，必须是有限且非空的。如果矩形不是等边的，则绘制椭圆。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>创建的注释。它以红色 (1, 0, 0) 作为描边颜色，线条宽度为 1，支持填充颜色。</p>
</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<section id="redactions">
<h3>删节/Redactions<a class="headerlink" href="#redactions" title="此标题的永久链接">#</a></h3>
<dl class="py method">
<dt class="sig sig-object py" id="Page.add_redact_annot">
<span class="sig-name descname"><span class="pre">add_redact_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">TEXT_ALIGN_LEFT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_redact_annot" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF</strong>：添加一个编辑标注。编辑标注标识出需要从文档中移除的内容。添加此类标注是两个步骤中的第一个，它会显示出在随后的步骤中将被移除的内容，具体步骤为 <a class="reference internal" href="#Page.apply_redactions" title="Page.apply_redactions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.apply_redactions()</span></code></a>。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quad</strong> (<em>quad_like</em><em>,</em><em>rect_like</em>) – 指定要移除的（矩形）区域，这个区域始终等于标注矩形。它可以是 <a class="reference internal" href="glossary.html#rect_like" title="rect_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">rect_like</span></code></a> 或 <a class="reference internal" href="glossary.html#quad_like" title="quad_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">quad_like</span></code></a> 对象。如果指定了四边形，则取其包围矩形。</p></li>
<li><p><strong>text</strong> (<em>str</em>) – 在应用编辑后（即移除旧内容）要放入矩形中的文本。（新增于 v1.16.12）</p></li>
<li><p><strong>fontname</strong> (<em>str</em>) – <p>使用的字体名称，当提供 <em>text</em> 时才有效，否则忽略。此处适用与 <a class="reference internal" href="#Page.insert_textbox" title="Page.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_textbox()</span></code></a> 相同的规则 – 即 <a class="reference internal" href="#Page.apply_redactions" title="Page.apply_redactions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.apply_redactions()</span></code></a> 内部调用的方法。替换文本将 <strong>垂直居中</strong>，如果使用的是 CJK 或 <a class="reference internal" href="app3.html#base-14-fonts"><span class="std std-ref">PDF Base 14 字体</span></a> 字体。（新增于 v1.16.12）</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ul>
<li><p>对于页面中的 <strong>现有</strong> 字体，使用其引用名称作为 <em>fontname</em> （即 <a class="reference internal" href="#Page.get_fonts" title="Page.get_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_fonts()</span></code></a> 中条目的 <em>item[4]</em>）。</p></li>
<li><p>对于 <strong>新字体，非内建字体</strong>，操作如下:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">page</span><span class="o">.</span><span class="n">insert_text</span><span class="p">(</span><span class="n">point</span><span class="p">,</span>  <span class="c1"># 任意位置，但不在所有编辑矩形内</span>
      <span class="s2">&quot;something&quot;</span><span class="p">,</span>  <span class="c1"># 非空字符串</span>
      <span class="n">fontname</span><span class="o">=</span><span class="s2">&quot;newname&quot;</span><span class="p">,</span>  <span class="c1"># 新的、未使用的引用名称</span>
      <span class="n">fontfile</span><span class="o">=</span><span class="s2">&quot;...&quot;</span><span class="p">,</span>  <span class="c1"># 所需的字体文件</span>
      <span class="n">render_mode</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># 使文本不可见</span>
<span class="p">)</span>
<span class="n">page</span><span class="o">.</span><span class="n">add_redact_annot</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">fontname</span><span class="o">=</span><span class="s2">&quot;newname&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
</p></li>
<li><p><strong>fontsize</strong> (<em>float</em>) – 替换文本的 <a class="reference internal" href="glossary.html#fontsize" title="fontsize"><code class="xref py py-data docutils literal notranslate"><span class="pre">fontsize</span></code></a>。如果文本太大以至于无法适应，会尝试多次插入，逐渐将 <a class="reference internal" href="glossary.html#fontsize" title="fontsize"><code class="xref py py-data docutils literal notranslate"><span class="pre">fontsize</span></code></a> 减小，最低不低于 4。如果仍然无法适配，则不插入文本。（新增于 v1.16.12）</p></li>
<li><p><strong>align</strong> (<em>int</em>) – 替换文本的水平对齐方式。参见 <a class="reference internal" href="#Page.insert_textbox" title="Page.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_textbox()</span></code></a> 以了解可用值。若使用 PDF 内建字体（CJK 或 <a class="reference internal" href="app3.html#base-14-fonts"><span class="std std-ref">PDF Base 14 字体</span></a>），垂直对齐将（大致）居中。（新增于 v1.16.12）</p></li>
<li><p><strong>fill</strong> (<em>sequence</em>) – 编辑后矩形的填充颜色。默认值为 <em>白色 = (1, 1, 1)</em>，如果指定为 <code class="docutils literal notranslate"><span class="pre">None</span></code>，也会取此值。若完全不希望填充颜色，可指定 <code class="docutils literal notranslate"><span class="pre">False</span></code>。此时矩形保持透明。（新增于 v1.16.12）</p></li>
<li><p><strong>text_color</strong> (<em>sequence</em>) – 替换文本的颜色。默认值为 <em>黑色 = (0, 0, 0)</em>。（新增于 v1.16.12）</p></li>
<li><p><strong>cross_out</strong> (<em>bool</em>) – 向标注矩形添加两条对角线。（新增于 v1.17.2）</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>创建的标注。其标准外观为一个红色矩形（无填充颜色），可选择显示两条对角线。颜色、线宽、虚线、透明度和混合模式可以像其他标注一样通过 <a class="reference internal" href="annot.html#Annot.update" title="Annot.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.update()</span></code></a> 设置和应用。（在 v1.17.2 中更改）</p>
</dd>
</dl>
<img alt="_images/img-redact.jpg" src="_images/img-redact.jpg" />
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.16.11</p></li>
<li><p>在 v1.16.12 中更改：删除了先前的 <em>mark</em> 参数。现在，每个编辑标注的矩形将被填充各自的 <em>fill</em> 颜色。如果标注中提供了 <em>text</em>，则会调用 <a class="reference internal" href="#Page.insert_textbox" title="Page.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_textbox()</span></code></a> 插入替换文本。</p></li>
<li><p>在 v1.18.0 中更改：增加了处理重叠图片的选项。</p></li>
<li><p>在 v1.23.27 中更改：增加了移除图形的选项。</p></li>
<li><p>在 v1.24.2 中更改：增加了 <code class="xref any docutils literal notranslate"><span class="pre">keep_text</span></code> 选项，用于保持文本不受影响。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.apply_redactions">
<span class="sig-name descname"><span class="pre">apply_redactions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PDF_REDACT_IMAGE_PIXELS</span> <span class="pre">|</span> <span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graphics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PDF_REDACT_LINE_ART_REMOVE_IF_TOUCHED</span> <span class="pre">|</span> <span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PDF_REDACT_TEXT_REMOVE</span> <span class="pre">|</span> <span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.apply_redactions" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF</strong>：移除页面上所有 <strong>内容</strong>，这些内容被任何编辑矩形覆盖。</p>
<p><strong>此方法会应用并删除页面上的所有编辑标注。</strong></p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>images</strong> (<em>int</em>) – 如何处理重叠的图片。默认值（2）会遮蔽重叠的像素。<code class="xref any docutils literal notranslate"><span class="pre">PDF_REDACT_IMAGE_NONE</span> <span class="pre">|</span> <span class="pre">0</span></code> 会忽略，<code class="xref any docutils literal notranslate"><span class="pre">PDF_REDACT_IMAGE_REMOVE</span> <span class="pre">|</span> <span class="pre">1</span></code> 会完全移除任何与编辑标注重叠的图片。选项 <code class="xref any docutils literal notranslate"><span class="pre">PDF_REDACT_IMAGE_REMOVE_UNLESS_INVISIBLE</span> <span class="pre">|</span> <span class="pre">3</span></code> 仅移除可见的图片。</p></li>
<li><p><strong>graphics</strong> (<em>int</em>) – 如何处理重叠的矢量图形（也称为“线条艺术”或“图形”）。默认值（2）会移除任何重叠的矢量图形。<code class="xref any docutils literal notranslate"><span class="pre">PDF_REDACT_LINE_ART_NONE</span> <span class="pre">|</span> <span class="pre">0</span></code> 会忽略，<code class="xref any docutils literal notranslate"><span class="pre">PDF_REDACT_LINE_ART_REMOVE_IF_COVERED</span> <span class="pre">|</span> <span class="pre">1</span></code> 会移除完全被编辑标注覆盖的图形。移除线条艺术时，请注意 <strong>描边</strong> 矢量图形（即类型为 “s” 或 “sf”）的 <strong>包围矩形</strong> 比预期的大：首先，每个方向至少要加上路径线宽的 50%。如果提供了所谓的“斜接限制”（参见 PDF 规范第 121 页），扩大值为 <code class="xref any docutils literal notranslate"><span class="pre">miter</span> <span class="pre">*</span> <span class="pre">width</span> <span class="pre">/</span> <span class="pre">2</span></code>。因此，当使用默认设置（线宽=1，斜接=10）时，编辑矩形应至少比实际图形大 5 个点。</p></li>
<li><p><strong>text</strong> (<em>int</em>) – 是否移除重叠的文本。默认值 <code class="xref any docutils literal notranslate"><span class="pre">PDF_REDACT_TEXT_REMOVE</span> <span class="pre">|</span> <span class="pre">0</span></code> 会移除所有与编辑矩形重叠的字符边界框中的字符。这符合编辑标注的原始法律/数据保护意图。然而，其他用例可能需要在编辑矢量图形或图片的同时 <strong>保留文本</strong>。这可以通过设置 <code class="xref any docutils literal notranslate"><span class="pre">text=True|PDF_REDACT_TEXT_NONE</span> <span class="pre">|</span> <span class="pre">1</span></code> 实现。这种做法 <strong>不符合</strong> 数据保护的意图。<strong>使用此功能时请自担风险。</strong></p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>如果处理了至少一个编辑标注，返回 <code class="xref any docutils literal notranslate"><span class="pre">True</span></code>，否则返回 <code class="xref any docutils literal notranslate"><span class="pre">False</span></code>。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ul class="simple">
<li><p>被编辑矩形覆盖的文本将被 <strong>物理</strong> 移除（假设 <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> 配合适当的垃圾回收选项），并且将不再出现在文本提取或其他地方。所有编辑标注也将被移除。其他标注不受影响。</p></li>
<li><p>所有重叠的链接将被移除。如果链接矩形覆盖了文本，则仅移除与链接矩形重叠的文本部分。类似的情况也适用于被链接矩形覆盖的图片。</p></li>
<li><p><strong>图片</strong> 的重叠部分将被遮蔽，默认选项为 <code class="xref any docutils literal notranslate"><span class="pre">PDF_REDACT_IMAGE_PIXELS</span></code> （在 v1.18.0 中更改）。选项 0 不触及任何图片，1 会移除所有与编辑标注重叠的图片。</p></li>
<li><p>对于选项 <code class="xref any docutils literal notranslate"><span class="pre">images=PDF_REDACT_IMAGE_REMOVE</span></code>，仅会移除该页面对图片的 <strong>引用</strong> - 并不一定移除图片本身。仅在图片完全不再被引用时（假设垃圾回收选项合适），才会将图片完全从文件中移除。</p></li>
<li><p>对于选项 <code class="xref any docutils literal notranslate"><span class="pre">images=PDF_REDACT_IMAGE_PIXELS</span></code>，会创建一个新的 PNG 格式图片，页面将使用该图片替换原图。原始图片不会在此过程中删除或替换，因此其他页面可能仍显示原图。此外，修改后的 PNG 图片目前是 <strong>无压缩存储</strong> 的。在选择合适的垃圾回收方法和压缩选项时，请考虑这些因素。</p></li>
<li><p><strong>文本移除</strong> 是按字符进行的：如果字符的边界框与编辑矩形有 <strong>非空重叠</strong>，则该字符将被移除（在 MuPDF v1.17 中更改）。根据字体属性和/或所选的行间距，删除可能会影响不希望移除的文本部分。在执行文本搜索之前，使用 <a class="reference internal" href="tools.html#Tools.set_small_glyph_heights" title="Tools.set_small_glyph_heights"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Tools.set_small_glyph_heights()</span></code></a> 配合 <code class="docutils literal notranslate"><span class="pre">True</span></code> 参数，可能有助于避免这种情况。</p></li>
<li><p>编辑标注是替换 PDF 中单个单词的简单方法，或者仅仅是物理地移除它们。可以使用某些文本提取或搜索方法定位“秘密”一词，并使用“xxxxxx”作为每个实例的替换文本插入编辑标注。</p></li>
</ul>
<ul class="simple">
<li><p>如果替换文本比原文本长，请小心 – 这可能会导致外观不协调、行断裂，或者完全没有新文本。</p></li>
<li><p>由于多种原因，新文本的定位可能与旧文本不完全对齐 – 尤其是当替换字体不是 CJK 或 <a class="reference internal" href="app3.html#base-14-fonts"><span class="std std-ref">PDF Base 14 字体</span></a> 字体时，情况尤为明显。</p></li>
</ul>
</div>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.16.11</p></li>
<li><p>在 v1.16.12 中更改：删除了先前的 <em>mark</em> 参数。现在，每个编辑标注的矩形将被填充各自的 <em>fill</em> 颜色。如果标注中提供了 <em>text</em>，则会调用 <a class="reference internal" href="#Page.insert_textbox" title="Page.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_textbox()</span></code></a> 插入替换文本。</p></li>
<li><p>在 v1.18.0 中更改：增加了处理重叠图片的选项。</p></li>
<li><p>在 v1.23.27 中更改：增加了移除图形的选项。</p></li>
<li><p>在 v1.24.2 中更改：增加了 <code class="xref any docutils literal notranslate"><span class="pre">keep_text</span></code> 选项，用于保持文本不受影响。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<hr class="docutils" />
<dl class="py method">
<dt class="sig sig-object py" id="Page.add_polyline_annot">
<span class="sig-name descname"><span class="pre">add_polyline_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_polyline_annot" title="永久链接至目标">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.add_polygon_annot">
<span class="sig-name descname"><span class="pre">add_polygon_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_polygon_annot" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF</strong>：添加一个由连接给定点的直线构成的标注。 <strong>多边形</strong> 的首尾点会自动连接，而 <strong>多线段</strong> 则不会如此。 <strong>矩形</strong> 会自动创建为包含所有点的最小矩形，矩形中的每个点会被一个半径为 3 的圆圈包围（= 3 * 线宽）。以下是一个被修改过颜色和线条末端样式的 “多线段” 示例。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>points</strong> (<em>list</em>) – 一组 <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a> 对象。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>创建的标注。它的绘制方式是黑色的线条、宽度为 1，且没有填充颜色，但支持填充颜色。可以使用 <a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a> 的方法来进行修改，以实现类似于以下效果：</p>
</dd>
</dl>
<a class="reference internal image-reference" href="_images/img-polyline.png"><img alt="_images/img-polyline.png" src="_images/img-polyline.png" style="width: 271.59999999999997px; height: 66.5px;" /></a>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.add_underline_annot">
<span class="sig-name descname"><span class="pre">add_underline_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_underline_annot" title="永久链接至目标">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.add_strikeout_annot">
<span class="sig-name descname"><span class="pre">add_strikeout_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_strikeout_annot" title="永久链接至目标">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.add_squiggly_annot">
<span class="sig-name descname"><span class="pre">add_squiggly_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_squiggly_annot" title="永久链接至目标">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.add_highlight_annot">
<span class="sig-name descname"><span class="pre">add_highlight_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_highlight_annot" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF</strong>：这些标注通常用于 <strong>标记已定位的文本</strong> （例如通过 <a class="reference internal" href="#Page.search_for" title="Page.search_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.search_for()</span></code></a> 定位）。但这并不是必须的：您可以自由地“标记”任何内容。</p>
<p>标准颜色（仅线条，不支持填充颜色）被指定为每种标注类型的默认颜色： <strong>黄色</strong> 用于高亮， <strong>红色</strong> 用于删除线， <strong>绿色</strong> 用于下划线， <strong>品红</strong> 用于波浪下划线。</p>
<p>这四个方法将参数转换为一组 <a class="reference internal" href="quad.html#quad"><span class="std std-ref">Quad</span></a> 对象。然后， <strong>标注</strong> 矩形被计算为包含所有这些四边形的矩形。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><a class="reference internal" href="#Page.search_for" title="Page.search_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">search_for()</span></code></a> 返回的是一组 <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> 或 <a class="reference internal" href="quad.html#quad"><span class="std std-ref">Quad</span></a> 对象。该列表可以直接作为这些标注类型的参数，且会为搜索字符串的所有匹配项生成 <strong>一个公共标注</strong> ：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 在文本搜索中优先使用 quads=True！</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quads</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">search_for</span><span class="p">(</span><span class="s2">&quot;pymupdf&quot;</span><span class="p">,</span> <span class="n">quads</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">add_highlight_annot</span><span class="p">(</span><span class="n">quads</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>显然，文本标记标注需要知道被标记区域的顶部、底部、左侧和右侧位置。如果参数是四边形，则这些信息由四边形的点序列提供。而矩形则提供了较少的信息——例如，四个矩形角点可以构成 4! = 24 种不同的四边形。</p>
<p>因此，我们 <strong>强烈建议</strong> 在进行文本搜索时使用 <code class="xref any docutils literal notranslate"><span class="pre">quads</span></code> 参数，以确保标注的正确性。对于通过 “dict” 或 “rawdict” 选项从 <a class="reference internal" href="#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> 提取的 <strong>文本片段</strong> 进行标记时，类似的考虑也适用。有关如何计算此类四边形的更多细节，请参见 <a class="reference internal" href="faq.html#faq"><span class="std std-ref">FAQ</span></a> 中的“如何标记非水平文本”。</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quads</strong> (<em>rect_like</em><em>,</em><em>quad_like</em><em>,</em><em>list</em><em>,</em><em>tuple</em>) – 要标记的矩形或四边形的位置。（从 v1.14.20 开始更改）
如果传递的是列表或元组，它们必须由 <a class="reference internal" href="glossary.html#rect_like" title="rect_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">rect_like</span></code></a> 或 <a class="reference internal" href="glossary.html#quad_like" title="quad_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">quad_like</span></code></a> 项组成（甚至可以是这两者的混合）。每个项必须是有限的、凸的且不为空（如果适用）。
如果将该参数设置为 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>，则必须使用以下参数（从 v1.16.14 开始）。
反之亦然：如果不是 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>，则其余参数必须是 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>。</p></li>
<li><p><strong>start</strong> (<em>point_like</em>) – 从此点开始标记文本。默认为 <em>clip</em> 的左上角。如果 <code class="xref any docutils literal notranslate"><span class="pre">quads</span></code> 为 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>，则必须提供该参数。（从 v1.16.14 新增）</p></li>
<li><p><strong>stop</strong> (<em>point_like</em>) – 在此点停止文本标记。默认为 <em>clip</em> 的右下角。如果使用 <code class="xref any docutils literal notranslate"><span class="pre">start</span></code> 参数，必须提供此参数。（从 v1.16.14 新增）</p></li>
<li><p><strong>clip</strong> (<em>rect_like</em>) – 仅考虑与该区域相交的文本行。默认为页面矩形。如果提供了 <code class="xref any docutils literal notranslate"><span class="pre">start</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">stop</span></code> 参数，则必须使用此参数。（从 v1.16.14 新增）</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a> 或  <code class="docutils literal notranslate"><span class="pre">None</span></code> （从 v1.16.14 开始更改）。</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>创建的标注。如果 <em>quads</em> 是空列表， <strong>不会创建标注</strong> （从 v1.16.14 开始更改）。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>您可以使用 <code class="xref any docutils literal notranslate"><span class="pre">start</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">stop</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">clip</span></code> 参数在 <code class="xref any docutils literal notranslate"><span class="pre">start</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">stop</span></code> 之间的连续行上进行标记（从 v1.16.14 开始）。
使用 <em>clip</em> 来进一步缩小选定行的边界框，从而处理例如多列页面等问题。
以下是一个多行标记示例，该标记使用了两个红点并适当设置了 <em>clip</em>。</p>
</div>
<a class="reference internal image-reference" href="_images/img-markers.jpg"><img alt="_images/img-markers.jpg" src="_images/img-markers.jpg" style="width: 261.0px; height: 185.0px;" /></a>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.cluster_drawings">
<span class="sig-name descname"><span class="pre">cluster_drawings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drawings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.cluster_drawings" title="永久链接至目标">#</a></dt>
<dd><p>根据几何相似性将矢量图形（同义词：线条艺术或绘图）进行聚类。该方法遍历 <a class="reference internal" href="#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a> 的输出，连接那些 <code class="xref any docutils literal notranslate"><span class="pre">path[&quot;rect&quot;]</span></code> 彼此距离小于某些容差值的路径（由参数指定）。结果是一个矩形列表，每个矩形包裹着表格（带网格线）、饼图、条形图等。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clip</strong> (<em>rect_like</em>) – 仅考虑位于该区域内的路径。默认是整个页面。</p></li>
<li><p><strong>drawings</strong> (<em>list</em>) – （可选）提供一个之前生成的 <a class="reference internal" href="#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a> 输出。如果为 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>，则该方法将执行 <a class="reference internal" href="#Page.get_drawings" title="Page.get_drawings"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings</span></code></a>。</p></li>
<li><p><strong>x_tolerance</strong> (<em>float</em>) – x 方向的容差值。</p></li>
<li><p><strong>y_tolerance</strong> (<em>float</em>) – y 方向的容差值。</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.find_tables">
<span class="sig-name descname"><span class="pre">find_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">horizontal_strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical_lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">horizontal_lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snap_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snap_x_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snap_y_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">join_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">join_x_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">join_y_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_min_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_words_vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_words_horizontal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intersection_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intersection_x_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intersection_y_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_x_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_y_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.find_tables" title="永久链接至目标">#</a></dt>
<dd><p>在页面中查找表格并返回一个包含相关信息的对象。通常，许多参数的默认值足够使用。调整仅在特殊情况中才需要。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clip</strong> (<em>rect_like</em>) – 指定页面矩形内要考虑的区域，忽略其余部分。默认是整个页面。</p></li>
<li><p><strong>strategy</strong> (<em>str</em>) – <p>请求 <strong>表格检测</strong> 策略。有效值为 “lines”、”lines_strict” 和 “text”。</p>
<p>默认值是 <strong>“lines”</strong>，使用页面上的所有矢量图形来检测网格线。</p>
<p><strong>”lines_strict”</strong> 策略忽略无边框的矩形矢量图形。有时，单个文本可能具有背景色，这可能导致错误的列或行。此策略会忽略它们，从而提高检测精度。</p>
<p>如果指定了 <strong>“text”</strong>，则使用文本位置生成“虚拟”列和/或行边界。使用 <code class="xref any docutils literal notranslate"><span class="pre">min_words_*</span></code> 参数来请求用于考虑其坐标的单词数量。</p>
<p>使用参数 <code class="xref any docutils literal notranslate"><span class="pre">vertical_strategy</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">horizontal_strategy</span></code> <strong>代替</strong> 以更精细地处理维度。</p>
</p></li>
<li><p><strong>horizontal_lines</strong> (<em>sequence</em><em>[</em><em>floats</em><em>]</em>) – 行的 y 坐标。如果提供，将不会尝试识别其他表格行。这会影响表格检测。</p></li>
<li><p><strong>vertical_lines</strong> (<em>sequence</em><em>[</em><em>floats</em><em>]</em>) – 列的 x 坐标。如果提供，将不会尝试识别其他表格列。这会影响表格检测。</p></li>
<li><p><strong>min_words_vertical</strong> (<em>int</em>) – 适用于垂直策略选项 “text”：至少需要此数量的单词重合才能确定一个 <strong>虚拟列</strong> 边界。</p></li>
<li><p><strong>min_words_horizontal</strong> (<em>int</em>) – 适用于水平策略选项 “text”：至少需要此数量的单词重合才能确定一个 <strong>虚拟行</strong> 边界。</p></li>
<li><p><strong>snap_tolerance</strong> (<em>float</em>) – 任何两个水平线的 y 值之间的差异不超过该值时，将被 <strong>吸附</strong> 为一条线。对于垂直线也是如此。默认值为 3。可以为不同维度分别指定值，使用 <code class="xref any docutils literal notranslate"><span class="pre">snap_x_tolerance</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">snap_y_tolerance</span></code>。</p></li>
<li><p><strong>join_tolerance</strong> (<em>float</em>) – 任何两条线段的起始和结束点差异不超过此值时，将 <strong>连接</strong> 为一条线（单位：点）。默认值为 3。可以为不同维度分别指定值，使用 <code class="xref any docutils literal notranslate"><span class="pre">join_x_tolerance</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">join_y_tolerance</span></code>。</p></li>
<li><p><strong>edge_min_length</strong> (<em>float</em>) – 如果一条线的长度不超过此值（单位：点），则忽略此线。默认值为 3。</p></li>
<li><p><strong>intersection_tolerance</strong> (<em>float</em>) – 当将线条组合为单元格边界时，正交线必须在此值（单位：点）范围内才算作交点。默认值为 3。可以为不同维度分别指定值，使用 <code class="xref any docutils literal notranslate"><span class="pre">intersection_x_tolerance</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">intersection_y_tolerance</span></code>。</p></li>
<li><p><strong>text_tolerance</strong> (<em>float</em>) – 字符只有在它们的距离不大于此值（单位：点）时才会组合成单词。默认值为 3。可以为不同维度分别指定值，使用 <code class="xref any docutils literal notranslate"><span class="pre">text_x_tolerance</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">text_y_tolerance</span></code>。</p></li>
<li><p><strong>add_lines</strong> (<em>tuple</em><em>,</em><em>list</em>) – 指定一组“线”（即一对 <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a> 对象）作为 <strong>附加</strong> 、”虚拟” 矢量图形。这些线可以帮助表格和/或单元格的检测，并且不会对检测策略产生其他影响。特别是，与参数 <code class="xref any docutils literal notranslate"><span class="pre">horizontal_lines</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">vertical_lines</span></code> 相比，它们不会阻止使用其他方式检测行或列。这些线将被视为与“真实”矢量图形一样的线条，适用于连接、吸附、交点、最小长度和包含在 <code class="xref any docutils literal notranslate"><span class="pre">clip</span></code> 矩形中的规则。类似地，非平行于坐标轴的线将被忽略。</p></li>
</ul>
</dd>
</dl>
<img alt="_images/img-findtables.jpg" src="_images/img-findtables.jpg" />
<dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>一个 <code class="xref any docutils literal notranslate"><span class="pre">TableFinder</span></code> 对象，具有以下重要属性：</p>
<ul>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">cells</span></code>: 一个列表，包含页面上识别出的所有表格单元格的边界框（所有表格）。每个单元格是一个 <a class="reference internal" href="glossary.html#rect_like" title="rect_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">rect_like</span></code></a> 元组 <code class="xref any docutils literal notranslate"><span class="pre">(x0,</span> <span class="pre">y0,</span> <span class="pre">x1,</span> <span class="pre">y1)</span></code> 坐标，或者为 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">tables</span></code>: 一个包含 <code class="xref any docutils literal notranslate"><span class="pre">Table</span></code> 对象的列表。如果页面没有表格，则为 <code class="xref any docutils literal notranslate"><span class="pre">[]</span></code>。可以通过该列表找到单个表格。<code class="xref any docutils literal notranslate"><span class="pre">TableFinder</span></code> 对象本身也是其表格的序列。这意味着如果 <code class="xref any docutils literal notranslate"><span class="pre">tabs</span></code> 是一个 <code class="xref any docutils literal notranslate"><span class="pre">TableFinder</span></code> 对象，则表格 “n” 可以通过 <code class="xref any docutils literal notranslate"><span class="pre">tabs.tables[n]</span></code> 或更简短的 <code class="xref any docutils literal notranslate"><span class="pre">tabs[n]</span></code> 来获取。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">Table</span></code> 对象具有以下属性：</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bbox</span></code>: 表格的边界框，作为 <code class="xref any docutils literal notranslate"><span class="pre">(x0,</span> <span class="pre">y0,</span> <span class="pre">x1,</span> <span class="pre">y1)</span></code> 元组。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cells</span></code>: 表格单元格的边界框（元组列表）。单元格也可以是 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">extract()</span></code>: 该方法返回每个表格单元格的文本内容，作为一个字符串的列表的列表。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">to_markdown()</span></code>: 该方法将表格作为 <strong>markdown 格式的字符串</strong> 返回（兼容 Github）。支持的查看器可以将字符串渲染为表格。此输出经过优化，适用于 <strong>小型标记</strong> ，这对于 LLM/RAG 输入非常有利。Pandas DataFrame（参见 <code class="xref any docutils literal notranslate"><span class="pre">to_pandas()</span></code> 方法）提供等效的 markdown 表格输出，但对于人眼而言更易读。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">to_pandas()</span></code>: 该方法将表格作为一个 <a class="reference external" href="https://pypi.org/project/pandas/">pandas</a> <a class="reference external" href="https://pandas.pydata.org/docs/reference/frame.html">DataFrame</a> 返回。DataFrames 是非常灵活的对象，允许进行大量的表格操作，并支持将表格输出到几乎 20 种常见格式，其中包括 Excel 文件、CSV、JSON、markdown 格式的表格等。<code class="xref any docutils literal notranslate"><span class="pre">DataFrame.to_markdown()</span></code> 生成的 markdown 格式适用于 Github，优化了人类可读性。然而，该方法需要额外安装 <a class="reference external" href="https://pypi.org/project/tabulate/">tabulate</a> 包。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">header</span></code>: 一个 <code class="xref any docutils literal notranslate"><span class="pre">TableHeader</span></code> 对象，包含表格的头部信息。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">col_count</span></code>: 表格列数的整数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">row_count</span></code>: 表格行数的整数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rows</span></code>: 一个 <code class="xref any docutils literal notranslate"><span class="pre">TableRow</span></code> 对象的列表，其中包含两个属性： <code class="docutils literal notranslate"><span class="pre">bbox</span></code> 是该行的边界框， <code class="xref any docutils literal notranslate"><span class="pre">cells</span></code> 是该行包含的单元格列表。</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">TableHeader</span></code> 对象具有以下属性：</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bbox</span></code>: 头部的边界框。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">cells</span></code>: 包含每个列名的单元格的边界框列表。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">names</span></code>: 包含每个单元格文本的字符串列表，表示列名 —— 用于将表格导出为 Pandas DataFrame、markdown 等格式。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">external</span></code>: 一个布尔值，指示头部的边界框是否在表格主体之外（ <code class="xref any docutils literal notranslate"><span class="pre">True</span></code> ）或不在之外（ <code class="xref any docutils literal notranslate"><span class="pre">False</span></code> ）。表格头部从不由 <code class="xref any docutils literal notranslate"><span class="pre">TableFinder</span></code> 逻辑识别。因此，如果 <code class="xref any docutils literal notranslate"><span class="pre">external</span></code> 为 <code class="xref any docutils literal notranslate"><span class="pre">True</span></code>，则头部单元格不属于任何由 <code class="xref any docutils literal notranslate"><span class="pre">TableFinder</span></code> 识别的单元格。如果 <code class="xref any docutils literal notranslate"><span class="pre">external</span> <span class="pre">==</span> <span class="pre">False</span></code>，则表格的第一行就是表头。</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>请查看这些 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/table-analysis">Jupyter notebooks</a>，它们涵盖了标准情况，例如一页上有多个表格，或跨多页连接表格片段。</p>
<div class="admonition caution">
<p class="admonition-title">小心</p>
<p><code class="xref any docutils literal notranslate"><span class="pre">TableFinder</span></code> 对象以及它的所有表格的生命周期 <strong>等同于页面的生命周期</strong> 。如果页面对象被删除或重新分配，则所有表格将不再有效。</p>
<p>唯一能够在页面失效后保持表格内容的方法是通过 <code class="xref any docutils literal notranslate"><span class="pre">Table.to_markdown()</span></code> 、 <code class="xref any docutils literal notranslate"><span class="pre">Table.to_pandas()</span></code> 或 <code class="xref any docutils literal notranslate"><span class="pre">Table.extract()</span></code> 的副本（例如 <code class="xref any docutils literal notranslate"><span class="pre">Table.extract()[:]</span></code>）来 <strong>提取</strong> 它。</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>一旦表格通过 <code class="xref any docutils literal notranslate"><span class="pre">to_pandas()</span></code> 提取为 <strong>Pandas DataFrame</strong>，就可以使用 <strong>Pandas API</strong> 将其转换为其他文件类型：</p>
<ul class="simple">
<li><p>表格转为 Markdown，使用 <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_markdown.html#pandas.DataFrame.to_markdown">to_markdown</a></p></li>
<li><p>表格转为 JSON，使用： <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_json.html">to_json</a></p></li>
<li><p>表格转为 Excel，使用： <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_excel.html">to_excel</a></p></li>
<li><p>表格转为 CSV，使用： <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_csv.html">to_csv</a></p></li>
<li><p>表格转为 HTML，使用： <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_html.html">to_html</a></p></li>
<li><p>表格转为 SQL，使用： <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_sql.html">to_sql</a></p></li>
</ul>
</div>
</p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>版本 1.23.0 新增</p></li>
<li><p>版本 1.23.19 更改：新增参数 <code class="xref any docutils literal notranslate"><span class="pre">add_lines</span></code>。</p></li>
</ul>
<p></small></details></p>
<div class="admonition important">
<p class="admonition-title">重要</p>
<p>还有 <a class="reference external" href="https://pdf2docx.readthedocs.io/en/latest/quickstart.table.html">pdf2docx extract tables method</a> ，如果你更喜欢使用它进行表格提取。</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.add_stamp_annot">
<span class="sig-name descname"><span class="pre">add_stamp_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_stamp_annot" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：添加类似“橡皮图章”的注释，例如表示文档的预定用途（如“草稿”、“机密”等）。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rect</strong> (<em>rect_like</em>) – 指定放置注释的矩形区域。</p></li>
<li><p><strong>stamp</strong> (<em>int</em>) – 图章文本的 ID 编号。有关可用图章，请参见 <a class="reference internal" href="vars.html#stampicons"><span class="std std-ref">图章注释图标</span></a>。</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ul class="simple">
<li><p>图章的文本及其边框线将自动调整大小，并水平和垂直居中于给定的矩形中。 <a class="reference internal" href="annot.html#Annot.rect" title="Annot.rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Annot.rect</span></code></a> 会自动计算，以适应给定的 <strong>宽度</strong> ，通常会小于此参数。</p></li>
<li><p>选用的字体为“Times Bold”，文本将以大写字母呈现。</p></li>
<li><p>外观可以通过 <a class="reference internal" href="annot.html#Annot.set_opacity" title="Annot.set_opacity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Annot.set_opacity()</span></code></a> 和设置“描边”颜色进行更改（不支持“填充”颜色）。</p></li>
<li><p>这可以用来创建水印图像：在临时 PDF 页面上创建一个图章注释并设置较低的不透明度值，使用 <em>alpha=True</em> 从中生成一个 pixmap（可能还需要旋转它），丢弃临时 PDF 页面，然后使用 <a class="reference internal" href="#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">insert_image()</span></code></a> 将 pixmap 插入目标 PDF。</p></li>
</ul>
</div>
<a class="reference internal image-reference" href="_images/img-stampannot.jpg"><img alt="_images/img-stampannot.jpg" src="_images/img-stampannot.jpg" style="width: 340.8px; height: 48.800000000000004px;" /></a>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.add_widget">
<span class="sig-name descname"><span class="pre">add_widget</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">widget</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.add_widget" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：将 PDF 表单字段（“小部件”）添加到页面。这也 <strong>将 PDF 转换为表单 PDF</strong> 。由于小部件有大量不同的选项，我们开发了一个新的类 <a class="reference internal" href="widget.html#widget"><span class="std std-ref">Widget</span></a>，它包含所有可能的 PDF 字段属性。必须在创建和更新表单字段时使用该类。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>widget</strong> (<a class="reference internal" href="widget.html#widget"><span class="std std-ref">Widget</span></a>) – 一个已经创建的小部件 <a class="reference internal" href="widget.html#widget"><span class="std std-ref">Widget</span></a> 对象。</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>一个小部件注释。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.delete_annot">
<span class="sig-name descname"><span class="pre">delete_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annot</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.delete_annot" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>删除操作现在会包括任何绑定的“弹出”或响应注释及相关对象（在 v1.16.6 中更改）。</p></li>
</ul>
<p>仅适用于 PDF：删除页面上的注释并返回下一个注释。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>annot</strong> (<a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a>) – 要删除的注释。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>删除后的下一个注释。请记住，物理删除需要将文件保存为新文件，并且垃圾收集设置为大于 0。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.delete_widget">
<span class="sig-name descname"><span class="pre">delete_widget</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">widget</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.delete_widget" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：删除页面上的表单字段并返回下一个小部件。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>widget</strong> (<a class="reference internal" href="widget.html#widget"><span class="std std-ref">Widget</span></a>) – 要删除的小部件。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="widget.html#widget"><span class="std std-ref">Widget</span></a></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>删除后的下一个小部件。请记住，物理删除需要将文件保存为新文件，并且垃圾收集设置为大于 0。</p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<p>(v1.18.4 新增)</p>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.delete_link">
<span class="sig-name descname"><span class="pre">delete_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">linkdict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.delete_link" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：删除页面上的指定链接。参数必须是 <a class="reference internal" href="#Page.get_links" title="Page.get_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_links()</span></code></a> 提供的 <strong>原始项</strong> ，请参阅 <a class="reference internal" href="#link-dict-description"><span class="std std-ref">get_links() 条目的描述</span></a>。这是因为字典中的 <em>“xref”</em> 键标识了要删除的 PDF 对象。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>linkdict</strong> (<em>dict</em>) – 要删除的链接。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.insert_link">
<span class="sig-name descname"><span class="pre">insert_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">linkdict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.insert_link" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：在此页面上插入新链接。参数必须是 <a class="reference internal" href="#Page.get_links" title="Page.get_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_links()</span></code></a> 提供的字典格式，请参阅 <a class="reference internal" href="#link-dict-description"><span class="std std-ref">get_links() 条目的描述</span></a>。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>linkdict</strong> (<em>dict</em>) – 要插入的链接。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.update_link">
<span class="sig-name descname"><span class="pre">update_link</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">linkdict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.update_link" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：修改指定的链接。参数必须是 <a class="reference internal" href="#Page.get_links" title="Page.get_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_links()</span></code></a> 提供的（已修改的） <strong>原始项</strong> ，请参阅 <a class="reference internal" href="#link-dict-description"><span class="std std-ref">get_links() 条目的描述</span></a>。这是因为字典中的 <em>“xref”</em> 键标识了要更改的 PDF 对象。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>linkdict</strong> (<em>dict</em>) – 要修改的链接。</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>如果更新/插入 URI 链接（ <code class="xref any docutils literal notranslate"><span class="pre">&quot;kind&quot;:</span> <span class="pre">LINK_URI</span></code> ），请确保 <code class="xref any docutils literal notranslate"><span class="pre">&quot;uri&quot;</span></code> 键的值以如 <code class="xref any docutils literal notranslate"><span class="pre">&quot;http://&quot;</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">&quot;https://&quot;</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">&quot;file://&quot;</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">&quot;ftp://&quot;</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">&quot;mailto:&quot;</span></code> 等消歧义字符串开始。否则，取决于您的浏览器或其他“消费者”软件，意外的默认假设可能导致不想要的行为。</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.get_label">
<span class="sig-name descname"><span class="pre">get_label</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_label" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：返回页面的标签。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>标签字符串，例如 Roman 编号的“vii”或如果未定义则为 “”。</p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.6 中新增</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.get_links">
<span class="sig-name descname"><span class="pre">get_links</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_links" title="永久链接至目标">#</a></dt>
<dd><p>获取页面的 <strong>所有</strong> 链接。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>字典列表。有关字典条目的说明，请参见 <a class="reference internal" href="#link-dict-description"><span class="std std-ref">get_links() 条目的描述</span></a>。如果您打算更改页面的链接，请始终使用此方法或 <a class="reference internal" href="#Page.links" title="Page.links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.links()</span></code></a> 方法。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.links">
<span class="sig-name descname"><span class="pre">links</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kinds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.links" title="永久链接至目标">#</a></dt>
<dd><p>返回页面链接的生成器。结果与 <a class="reference internal" href="#Page.get_links" title="Page.get_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_links()</span></code></a> 的条目相同。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kinds</strong> (<em>sequence</em>) – 一个整数序列，用于选择一个或多个链接类型。默认为所有链接。例如： <em>kinds=(pymupdf.LINK_GOTO,)</em> 将只返回内部链接。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>generator</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>每次迭代返回 <a class="reference internal" href="#Page.get_links" title="Page.get_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_links()</span></code></a> 的一个条目。</p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.16.4 中新增</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.annots">
<span class="sig-name descname"><span class="pre">annots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.annots" title="永久链接至目标">#</a></dt>
<dd><p>返回页面注释的生成器。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>types</strong> (<em>sequence</em>) – 一个整数序列，用于选择一个或多个注释类型。默认为所有注释。例如：<code class="xref any docutils literal notranslate"><span class="pre">types=(pymupdf.PDF_ANNOT_FREETEXT,</span> <span class="pre">pymupdf.PDF_ANNOT_TEXT)</span></code> 将只返回 ‘FreeText’ 和 ‘Text’ 注释。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>generator</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>每次迭代返回一个 <a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a>。</p>
<div class="admonition caution">
<p class="admonition-title">小心</p>
<p>您 <strong>不能安全地在此生成器内更新注释</strong> 。这是因为大多数注释更新需要通过 <code class="xref any docutils literal notranslate"><span class="pre">page</span> <span class="pre">=</span> <span class="pre">doc.reload_page(page)</span></code> 重新加载页面。为了规避此限制，首先列出注释的 xref 编号，然后遍历这些编号:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">xrefs</span> <span class="o">=</span> <span class="p">[</span><span class="n">annot</span><span class="o">.</span><span class="n">xref</span> <span class="k">for</span> <span class="n">annot</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">annots</span><span class="p">(</span><span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="o">...</span><span class="p">])]</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="k">for</span> <span class="n">xref</span> <span class="ow">in</span> <span class="n">xrefs</span><span class="p">:</span>
   <span class="o">...</span><span class="p">:</span>     <span class="n">annot</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">load_annot</span><span class="p">(</span><span class="n">xref</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span>     <span class="n">annot</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
   <span class="o">...</span><span class="p">:</span>     <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">reload_page</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span>
</pre></div>
</div>
</div>
</p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.16.4 中新增</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.widgets">
<span class="sig-name descname"><span class="pre">widgets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.widgets" title="永久链接至目标">#</a></dt>
<dd><p>返回页面表单字段的生成器。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>types</strong> (<em>sequence</em>) – 一个整数序列，用于选择一个或多个小部件类型。默认为所有表单字段。例如： <code class="xref any docutils literal notranslate"><span class="pre">types=(pymupdf.PDF_WIDGET_TYPE_TEXT,)</span></code> 将只返回 ‘Text’ 字段。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>generator</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>每次迭代返回一个 <a class="reference internal" href="widget.html#widget"><span class="std std-ref">Widget</span></a>。</p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.16.4 中新增</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.write_text">
<span class="sig-name descname"><span class="pre">write_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_proportion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.write_text" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：将一个或多个 <a class="reference internal" href="textwriter.html#textwriter"><span class="std std-ref">TextWriter</span></a> 对象的文本写入页面。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rect</strong> (<em>rect_like</em>) – 文本放置的位置。如果省略，则使用文本写入器的矩形联合区域。</p></li>
<li><p><strong>writers</strong> (<em>sequence</em>) – 非空的 <a class="reference internal" href="textwriter.html#textwriter"><span class="std std-ref">TextWriter</span></a> 对象元组/列表，或单个 <a class="reference internal" href="textwriter.html#textwriter"><span class="std std-ref">TextWriter</span></a>。</p></li>
<li><p><strong>opacity</strong> (<em>float</em>) – 设置透明度，覆盖文本写入器中的相应值。</p></li>
<li><p><strong>color</strong> (<em>sequence</em>) – 设置文本颜色，覆盖文本写入器中的相应值。</p></li>
<li><p><strong>overlay</strong> (<em>bool</em>) – 将文本放置在前景还是背景中。</p></li>
<li><p><strong>keep_proportion</strong> (<em>bool</em>) – 保持纵横比。</p></li>
<li><p><strong>rotate</strong> (<em>float</em>) – 以任意角度旋转文本。</p></li>
<li><p><strong>oc</strong> (<em>int</em>) – <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> 或 <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a> 的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。（v1.18.4 中新增）</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>参数 <em>overlay, keep_proportion, rotate</em> 和 <em>oc</em> 的含义与 <a class="reference internal" href="#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> 中相同。</p>
</div>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.16.18 中新增</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-1"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.insert_text">
<span class="sig-name descname"><span class="pre">insert_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'helv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">miter_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">TEXT_ENCODING_LATIN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.insert_text" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：从 <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a> 类型的 <code class="docutils literal notranslate"><span class="pre">point</span></code> 开始插入文本行。参见 <a class="reference internal" href="shape.html#Shape.insert_text" title="Shape.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_text()</span></code></a>。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.4 中更改</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-2"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.insert_textbox">
<span class="sig-name descname"><span class="pre">insert_textbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'helv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">miter_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">TEXT_ENCODING_LATIN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expandtabs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">TEXT_ALIGN_LEFT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charwidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.insert_textbox" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF：</strong> 将文本插入到指定的 <a class="reference internal" href="glossary.html#rect_like" title="rect_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">rect_like</span></code></a> <em>rect</em> 中。参见 <a class="reference internal" href="shape.html#Shape.insert_textbox" title="Shape.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.insert_textbox()</span></code></a>。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.4 中进行了修改。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-3"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.insert_htmlbox">
<span class="sig-name descname"><span class="pre">insert_htmlbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">css</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">archive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.insert_htmlbox" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF：</strong> 将文本插入到指定的矩形区域。此方法与 <a class="reference internal" href="#Page.insert_textbox" title="Page.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_textbox()</span></code></a> 和 <a class="reference internal" href="textwriter.html#TextWriter.fill_textbox" title="TextWriter.fill_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.fill_textbox()</span></code></a> 方法类似，但 <strong>功能更强大</strong> 。这是通过让 <a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a> 对象完成所有必要的处理来实现的。</p>
<ul>
<li><p>参数 <code class="docutils literal notranslate"><span class="pre">text</span></code> 可以是一个字符串，正如其他方法中一样。但它将 <strong>作为 HTML 源代码进行解释</strong> ，因此也可以包含 HTML 语言元素——包括样式。可以使用 <code class="docutils literal notranslate"><span class="pre">css</span></code> 参数传递附加的样式指令。</p></li>
<li><p>自动换行会在单词边界处生成。字符 <code class="xref any docutils literal notranslate"><span class="pre">&quot;&amp;#173;&quot;</span></code> （或 <code class="xref any docutils literal notranslate"><span class="pre">&amp;shy;</span></code> ）可用于触发连字符，因此也可能导致换行。然而， <strong>强制性</strong> 换行只能通过 HTML 标签 <code class="docutils literal notranslate"><span class="pre">&lt;br&gt;</span></code> 来实现， <code class="docutils literal notranslate"><span class="pre">\n</span></code> 会被忽略并当作空格处理。</p></li>
<li><p>使用此方法，可以实现以下功能：</p>
<blockquote>
<div><ul class="simple">
<li><p>样式效果，如粗体、斜体、文本颜色、文本对齐、字体大小或字体切换。</p></li>
<li><p>文本可以包含任意语言—— <strong>包括从右到左的语言</strong> 。</p></li>
<li><p>像 <a class="reference external" href="https://en.wikipedia.org/wiki/Devanagari">Devanagari</a> 等亚洲地区的脚本有一个复杂的连字系统，其中两个或更多的 Unicode 字符组合成一个字形。Story 使用软件包 <a class="reference external" href="https://harfbuzz.github.io/">HarfBuzz</a> 来处理这些内容并生成正确的输出。</p></li>
<li><p>还可以通过 HTML 标签 <code class="xref any docutils literal notranslate"><span class="pre">&lt;img&gt;</span></code> 包含图像——Story 将处理适当的布局。这是插入图像的替代方法，相较于 <a class="reference internal" href="#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a> 。</p></li>
<li><p>HTML 表格（ <code class="xref any docutils literal notranslate"><span class="pre">&lt;table&gt;</span></code> 标签 ）可以包含在文本中，并将被适当处理。</p></li>
<li><p>自动生成链接。</p></li>
</ul>
</div></blockquote>
</li>
<li><p>如果内容未能适应矩形区域，开发者有两个选择：</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>或者</strong> 仅被告知此情况（并接受无操作，就像其他文本框插入方法一样），</p></li>
<li><p><strong>或者</strong> （<code class="xref any docutils literal notranslate"><span class="pre">scale_low=0</span></code> - 默认值）缩放内容直到适应。</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rect</strong> (<em>rect_like</em>) – 页面上用于接收文本的矩形区域。</p></li>
<li><p><strong>text</strong> (<em>str</em><em>,</em><a class="reference internal" href="story-class.html#Story" title="Story"><em>Story</em></a>) – 要插入的文本。可以包含纯文本和 HTML 标签混合的内容，包含样式指令。或者，可以指定一个 <a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a> 对象（此时将省略内部的 Story 生成步骤）。必须使用所有所需的样式和归档信息生成 Story。</p></li>
<li><p><strong>css</strong> (<em>str</em>) – 可选的附加 CSS 指令字符串。如果 <code class="docutils literal notranslate"><span class="pre">text</span></code> 是一个 Story，此参数将被忽略。</p></li>
<li><p><strong>scale_low</strong> (<em>float</em>) – 如果需要，将内容缩小直到适应目标矩形。这设置了下缩放的限制。默认值为 0，无限制。值为 1 表示不允许缩小。例如，0.2 表示最多缩小 80%。</p></li>
<li><p><strong>archive</strong> (<a class="reference internal" href="archive-class.html#id0" title="Archive"><em>Archive</em></a>) – 指向图像或非标准字体所在位置的 Archive 对象。如果 <code class="docutils literal notranslate"><span class="pre">text</span></code> 中引用了图像或非标准字体，则此参数是必需的。如果 <code class="docutils literal notranslate"><span class="pre">text</span></code> 是一个 Story，则此参数将被忽略。</p></li>
<li><p><strong>rotate</strong> (<em>int</em>) – <p>值可以为 0、90、180 或 270。根据该值，文本将按以下方式填充：</p>
<ul>
<li><p>0: 从左上到右下。</p></li>
<li><p>90: 从左下到右上。</p></li>
<li><p>180: 从右下到左上。</p></li>
<li><p>270: 从右上到左下。</p></li>
</ul>
<img alt="_images/img-rotate.png" src="_images/img-rotate.png" /></p></li>
<li><p><strong>oc</strong> (<em>int</em>) – <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> / <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a> 的 xref 或 0。有关详细信息，请参阅 <a class="reference internal" href="#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a>。</p></li>
<li><p><strong>opacity</strong> (<em>float</em>) – 设置填充和描边的不透明度。仅考虑 <code class="xref any docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">opacity</span> <span class="pre">&lt;</span> <span class="pre">1</span></code> 的值。</p></li>
<li><p><strong>overlay</strong> (<em>bool</em>) – 将文本置于其他内容的前面。请参阅 <a class="reference internal" href="#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> 了解详细信息。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><p>一个包含浮动数值的元组 <code class="xref any docutils literal notranslate"><span class="pre">(spare_height,</span> <span class="pre">scale)</span></code>。</p>
<ul class="simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">spare_height</span></code>: 如果内容未适应，则为 -1，否则大于等于 0。它是未使用（仍然可用）矩形条带的高度。当 <code class="xref any docutils literal notranslate"><span class="pre">scale</span> <span class="pre">=</span> <span class="pre">1</span></code> （没有缩放）时，它才会为正。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">scale</span></code>: 缩放因子， <code class="xref any docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">scale</span> <span class="pre">&lt;=</span> <span class="pre">1</span></code> 。</p></li>
</ul>
<p>请参阅本节的示例： <a class="reference internal" href="recipes-text.html#recipestext-i-c"><span class="std std-ref">如何用 HTML 文本填充文本框</span></a> 。</p>
</p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.23.8；仅重构。</p></li>
<li><p>新增于 v1.23.9: <a class="reference internal" href="annot.html#Annot.opacity" title="Annot.opacity"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">opacity</span></code></a> 参数。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<p><strong>Drawing Methods</strong></p>
<span class="target" id="index-4"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.draw_line">
<span class="sig-name descname"><span class="pre">draw_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dashes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineCap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineJoin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.draw_line" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF：</strong> 从 <em>p1</em> 到 <em>p2</em> (<a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a> s) 绘制一条直线。参见 <a class="reference internal" href="shape.html#Shape.draw_line" title="Shape.draw_line"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_line()</span></code></a>。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.4 中进行了修改。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-5"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.draw_zigzag">
<span class="sig-name descname"><span class="pre">draw_zigzag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">breadth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dashes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineCap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineJoin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.draw_zigzag" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF：</strong> 从 <em>p1</em> 到 <em>p2</em> ( <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a> s) 绘制一条锯齿形线。参见 <a class="reference internal" href="shape.html#Shape.draw_zigzag" title="Shape.draw_zigzag"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_zigzag()</span></code></a>。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.4 中进行了修改。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-6"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.draw_squiggle">
<span class="sig-name descname"><span class="pre">draw_squiggle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">breadth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dashes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineCap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineJoin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.draw_squiggle" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF：</strong> 从 <em>p1</em> 到 <em>p2</em> ( <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a> s) 绘制一条波浪形（弯曲、起伏）的线。参见 <a class="reference internal" href="shape.html#Shape.draw_squiggle" title="Shape.draw_squiggle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_squiggle()</span></code></a>。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.4 中进行了修改。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-7"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.draw_circle">
<span class="sig-name descname"><span class="pre">draw_circle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dashes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineCap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineJoin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.draw_circle" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF：</strong> 以 <em>center</em> (<a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a>) 为中心，半径为 <em>radius</em> 绘制一个圆。参见 <a class="reference internal" href="shape.html#Shape.draw_circle" title="Shape.draw_circle"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_circle()</span></code></a>。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.4 中进行了修改。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-8"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.draw_oval">
<span class="sig-name descname"><span class="pre">draw_oval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dashes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineCap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineJoin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.draw_oval" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF：</strong> 在给定的 <a class="reference internal" href="glossary.html#rect_like" title="rect_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">rect_like</span></code></a> 或 <a class="reference internal" href="glossary.html#quad_like" title="quad_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">quad_like</span></code></a> 内绘制一个椭圆 (ellipse)。参见 <a class="reference internal" href="shape.html#Shape.draw_oval" title="Shape.draw_oval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_oval()</span></code></a>。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.4 中进行了修改。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-9"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.draw_sector">
<span class="sig-name descname"><span class="pre">draw_sector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dashes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineCap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineJoin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fullSector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">closePath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.draw_sector" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF：</strong> 绘制一个圆形扇形， 可选地将弧连接到圆心（类似于一块披萨）。参见 <a class="reference internal" href="shape.html#Shape.draw_sector" title="Shape.draw_sector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_sector()</span></code></a>。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.4 中进行了修改。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-10"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.draw_polyline">
<span class="sig-name descname"><span class="pre">draw_polyline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dashes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineCap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineJoin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">closePath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.draw_polyline" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF：</strong> 绘制由一系列 <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a> 点定义的多个连接线。参见 <a class="reference internal" href="shape.html#Shape.draw_polyline" title="Shape.draw_polyline"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_polyline()</span></code></a>。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.4 中进行了修改。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-11"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.draw_bezier">
<span class="sig-name descname"><span class="pre">draw_bezier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dashes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineCap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineJoin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">closePath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.draw_bezier" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF：</strong> 绘制从 <em>p1</em> 到 <em>p4</em> 的三次 Bézier 曲线，控制点为 <em>p2</em> 和 <em>p3</em> （所有点为 <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a>）。参见 <a class="reference internal" href="shape.html#Shape.draw_bezier" title="Shape.draw_bezier"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_bezier()</span></code></a>。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.4 中进行了修改。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-12"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.draw_curve">
<span class="sig-name descname"><span class="pre">draw_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dashes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineCap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineJoin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">closePath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.draw_curve" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF：</strong> 这是 <em>draw_bezier()</em> 的特殊情况。参见 <a class="reference internal" href="shape.html#Shape.draw_curve" title="Shape.draw_curve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_curve()</span></code></a>。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.4 中进行了修改。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-13"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.draw_rect">
<span class="sig-name descname"><span class="pre">draw_rect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dashes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineCap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineJoin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.draw_rect" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF：</strong> 绘制一个矩形。参见 <a class="reference internal" href="shape.html#Shape.draw_rect" title="Shape.draw_rect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_rect()</span></code></a>。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.4 中进行了修改。</p></li>
<li><p>v1.22.0 中进行了修改：新增了 <em>radius</em> 参数。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-14"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.draw_quad">
<span class="sig-name descname"><span class="pre">draw_quad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dashes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineCap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lineJoin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stroke_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.draw_quad" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF：</strong> 绘制一个四边形。参见 <a class="reference internal" href="shape.html#Shape.draw_quad" title="Shape.draw_quad"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.draw_quad()</span></code></a>。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.4 中进行了修改。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-15"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.insert_font">
<span class="sig-name descname"><span class="pre">insert_font</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fontname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'helv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontbuffer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_simple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">TEXT_ENCODING_LATIN</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.insert_font" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF：</strong> 添加一个新的字体供文本输出方法使用，并返回其 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。如果字体文件尚未在文件中定义，则该字体定义将被添加。支持内建的 <a class="reference internal" href="vars.html#Base14_Fonts" title="Base14_Fonts"><code class="xref py py-data docutils literal notranslate"><span class="pre">Base14_Fonts</span></code></a> 和通过 <strong>“reserved”</strong> 字体名的 CJK 字体。字体也可以通过文件路径或包含字体文件图像的内存区域提供。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fontname</strong> (<em>str</em>) – <p>在输出文本时，使用此字体的引用名称。通常，您可以自由选择名称（但请参考 <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a>，第16页，第7.3.5节，了解构建合法 PDF 名称的正式描述）。然而，如果它与 <a class="reference internal" href="vars.html#Base14_Fonts" title="Base14_Fonts"><code class="xref py py-data docutils literal notranslate"><span class="pre">Base14_Fonts</span></code></a> 中的某个字体或某个 CJK 字体相匹配，则 <em>fontfile</em> 和 <em>fontbuffer</em> <strong>将被忽略</strong>。</p>
<p>换句话说，您不能通过 <em>fontfile</em> / <em>fontbuffer</em> 插入字体并同时指定一个保留的 <em>fontname</em>。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>保留的字体名可以以任意大小写指定，并且仍然匹配正确的内建字体定义：字体名 “helv”、”Helv”、”HELV”、”Helvetica” 等都将映射到相同的字体定义 “Helvetica”。但是，从 <a class="reference internal" href="#page"><span class="std std-ref">Page</span></a> 角度来看，这些是 <strong>不同的引用</strong>。您可以利用这一点，在页面上使用相同字体的不同 <em>encoding</em> 变体（拉丁文、希腊文、斯拉夫文）。</p>
</div>
</p></li>
<li><p><strong>fontfile</strong> (<em>str</em>) – 字体文件的路径。如果使用此参数，则 <em>fontname</em> 必须 <strong>与所有保留名称不同</strong> 。</p></li>
<li><p><strong>fontbuffer</strong> (<em>bytes/bytearray</em>) – 字体文件的内存图像。如果使用此参数，则 <em>fontname</em> 必须 <strong>与所有保留名称不同</strong>。此参数通常与 <a class="reference internal" href="font.html#Font.buffer" title="Font.buffer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Font.buffer</span></code></a> 一起使用，适用于通过 <a class="reference internal" href="font.html#font"><span class="std std-ref">Font</span></a> 支持/可用的字体。</p></li>
<li><p><strong>set_simple</strong> (<em>int</em>) – 仅适用于 <em>fontfile</em> / <em>fontbuffer</em> 的情况：强制将字体视为 “简单” 字体，即仅使用字符代码 255 以内的字符。</p></li>
<li><p><strong>encoding</strong> (<em>int</em>) – 仅适用于 “Helvetica”、”Courier” 和 “Times” 等 <a class="reference internal" href="vars.html#Base14_Fonts" title="Base14_Fonts"><code class="xref py py-data docutils literal notranslate"><span class="pre">Base14_Fonts</span></code></a> 字体集。选择以下可用的编码方式：拉丁文 (0)、斯拉夫文 (2) 或希腊文 (1)。仅对 “Symbol” 和 “ZapfDingBats” 使用默认值 (0 = 拉丁文)。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>安装的字体的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>内建字体不会导致字体文件的包含，因此生成的 PDF 文件将保持较小。然而，您的 PDF 查看器软件负责生成适当的显示效果 —— 并且 <strong>确实存在</strong> 各种差异，取决于每个查看器如何处理这些字体，尤其是 CJK 字体。此外，Symbol 和 ZapfDingbats 字体在某些情况下也会被错误处理。以下是 <strong>字体名称</strong> 及其对应的 <strong>安装字体</strong> 名称：</p>
<p><strong>Base-14 字体</strong> <a class="footnote-reference brackets" href="#f1" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>字体名称</strong></p></th>
<th class="head"><p><strong>已安装的字体</strong></p></th>
<th class="head"><p><strong>备注</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>helv</p></td>
<td><p>Helvetica</p></td>
<td><p>normal</p></td>
</tr>
<tr class="row-odd"><td><p>heit</p></td>
<td><p>Helvetica-Oblique</p></td>
<td><p>italic</p></td>
</tr>
<tr class="row-even"><td><p>hebo</p></td>
<td><p>Helvetica-Bold</p></td>
<td><p>bold</p></td>
</tr>
<tr class="row-odd"><td><p>hebi</p></td>
<td><p>Helvetica-BoldOblique</p></td>
<td><p>bold-italic</p></td>
</tr>
<tr class="row-even"><td><p>cour</p></td>
<td><p>Courier</p></td>
<td><p>normal</p></td>
</tr>
<tr class="row-odd"><td><p>coit</p></td>
<td><p>Courier-Oblique</p></td>
<td><p>italic</p></td>
</tr>
<tr class="row-even"><td><p>cobo</p></td>
<td><p>Courier-Bold</p></td>
<td><p>bold</p></td>
</tr>
<tr class="row-odd"><td><p>cobi</p></td>
<td><p>Courier-BoldOblique</p></td>
<td><p>bold-italic</p></td>
</tr>
<tr class="row-even"><td><p>tiro</p></td>
<td><p>Times-Roman</p></td>
<td><p>normal</p></td>
</tr>
<tr class="row-odd"><td><p>tiit</p></td>
<td><p>Times-Italic</p></td>
<td><p>italic</p></td>
</tr>
<tr class="row-even"><td><p>tibo</p></td>
<td><p>Times-Bold</p></td>
<td><p>bold</p></td>
</tr>
<tr class="row-odd"><td><p>tibi</p></td>
<td><p>Times-BoldItalic</p></td>
<td><p>bold-italic</p></td>
</tr>
<tr class="row-even"><td><p>symb</p></td>
<td><p>Symbol</p></td>
<td><p><a class="footnote-reference brackets" href="#f3" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></p></td>
</tr>
<tr class="row-odd"><td><p>zadb</p></td>
<td><p>ZapfDingbats</p></td>
<td><p><a class="footnote-reference brackets" href="#f3" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>CJK 字体</strong> <a class="footnote-reference brackets" href="#f2" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> （中国、日本、韩国）</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>字体名称</strong></p></th>
<th class="head"><p><strong>已安装的字体</strong></p></th>
<th class="head"><p><strong>备注</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>china-s</p></td>
<td><p>Heiti</p></td>
<td><p>简体中文</p></td>
</tr>
<tr class="row-odd"><td><p>china-ss</p></td>
<td><p>Song</p></td>
<td><p>简体中文（衬线）</p></td>
</tr>
<tr class="row-even"><td><p>china-t</p></td>
<td><p>Fangti</p></td>
<td><p>繁体中文</p></td>
</tr>
<tr class="row-odd"><td><p>china-ts</p></td>
<td><p>Ming</p></td>
<td><p>繁体中文（衬线）</p></td>
</tr>
<tr class="row-even"><td><p>japan</p></td>
<td><p>Gothic</p></td>
<td><p>日文</p></td>
</tr>
<tr class="row-odd"><td><p>japan-s</p></td>
<td><p>Mincho</p></td>
<td><p>日文（衬线）</p></td>
</tr>
<tr class="row-even"><td><p>korea</p></td>
<td><p>Dotum</p></td>
<td><p>韩文</p></td>
</tr>
<tr class="row-odd"><td><p>korea-s</p></td>
<td><p>Batang</p></td>
<td><p>韩文（衬线）</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd></dl>

<span class="target" id="index-16"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.insert_image">
<span class="sig-name descname"><span class="pre">insert_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_proportion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.insert_image" title="永久链接至目标">#</a></dt>
<dd><p><strong>仅适用于 PDF：</strong> 将图像放入给定的矩形区域。图像可以是已经存在于 PDF 中的，或者来自像素图、文件或内存区域。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rect</strong> (<em>rect_like</em>) – 图像放置的区域。必须是有限的且非空的。</p></li>
<li><p><strong>alpha</strong> (<em>int</em>) – 已废弃并被忽略。</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – 图像文件的名称（MuPDF 支持的所有格式，详见 <a class="reference internal" href="pixmap.html#imagefiles"><span class="std std-ref">支持的输入图片格式</span></a>）。</p></li>
<li><p><strong>height</strong> (<em>int</em>) – </p></li>
<li><p><strong>keep_proportion</strong> (<em>bool</em>) – 保持图像的宽高比。</p></li>
<li><p><strong>mask</strong> (<em>bytes</em><em>,</em><em>bytearray</em><em>,</em><em>io.BytesIO</em>) – 图像内存 – 用作基础图像的图像掩码（alpha 值）。指定时，基础图像必须通过文件名或流提供，并且不能是已有掩码的图像。</p></li>
<li><p><strong>oc</strong> (<em>int</em>) – (<a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>) 使图像的可见性依赖于此 <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> 或 <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a>。多个插入后的第一次被忽略。该属性与生成的 PDF 图像对象一起存储，从而控制图像在整个 PDF 中的可见性。</p></li>
<li><p><strong>overlay</strong> – 参见 <a class="reference internal" href="shape.html#commonparms"><span class="std std-ref">公共参数</span></a>。</p></li>
<li><p><strong>pixmap</strong> (<a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a>) – 包含图像的像素图。</p></li>
<li><p><strong>rotate</strong> (<em>int</em>) – 旋转图像。
必须是 90 度的整数倍。
正值表示逆时针旋转。
如果需要任意角度的旋转，考虑先将图像转换为 PDF
(<a class="reference internal" href="document.html#Document.convert_to_pdf" title="Document.convert_to_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.convert_to_pdf()</span></code></a>)，然后使用 <a class="reference internal" href="#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a>。</p></li>
<li><p><strong>stream</strong> (<em>bytes</em><em>,</em><em>bytearray</em><em>,</em><em>io.BytesIO</em>) – 图像内存（MuPDF 支持的所有格式，详见 <a class="reference internal" href="pixmap.html#imagefiles"><span class="std std-ref">支持的输入图片格式</span></a>）。</p></li>
<li><p><strong>width</strong> (<em>int</em>) – </p></li>
<li><p><strong>xref</strong> (<em>int</em>) – 已存在于 PDF 中图像的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。如果给定，则忽略参数 <code class="xref any docutils literal notranslate"><span class="pre">filename</span></code>、<a class="reference internal" href="pixmap.html"><span class="doc">Pixmap</span></a>、<a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref any py py-data docutils literal notranslate"><span class="pre">stream</span></code></a>、<a class="reference internal" href="pixmap.html#Pixmap.alpha" title="Pixmap.alpha"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">alpha</span></code></a> 和 <code class="xref any docutils literal notranslate"><span class="pre">mask</span></code>。页面将仅接收对现有图像的引用。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>嵌入图像的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref any py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。如果再次插入相同图像，这可以作为 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref any py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 参数，极大提高性能。</p>
</dd>
</dl>
<p>该示例在文档的每一页上插入相同的图像:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rect</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>       <span class="c1"># 将缩略图放在左上角</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;some.jpg&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># 图像文件</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_xref</span> <span class="o">=</span> <span class="mi">0</span>                         <span class="c1"># 第一次执行嵌入图像</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
<span class="go">      img_xref = page.insert_image(rect, stream=img,</span>
<span class="go">                  xref=img_xref,  # 第二次执行时重用现有图像</span>
<span class="go">            )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ol class="arabic simple">
<li><p>该方法会检测相同图像的多次插入（如上例所示），并且只会在第一次执行时存储其数据。即便使用默认的 <code class="xref any docutils literal notranslate"><span class="pre">xref=0</span></code>，这一点仍然适用（虽然效率较低）。</p></li>
<li><p>该方法无法检测图像是否已经是文件中打开之前的一部分。</p></li>
<li><p>您可以使用此方法为页面提供背景或前景图像，例如版权或水印。请记住，水印需要透明图像，如果放在前景中 …</p></li>
<li><p>图像可能以未压缩的形式插入，例如，如果使用了 <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> 或图像具有 alpha 通道。因此，保存文件时请考虑使用 <code class="xref any docutils literal notranslate"><span class="pre">deflate=True</span></code>。此外，还有方法可以控制图像大小 – 即使透明性涉及其中。请参见 <a class="reference internal" href="recipes-images.html#recipesimages-o"><span class="std std-ref">如何将图像添加到 PDF 页面</span></a>。</p></li>
<li><p>图像在 PDF 中按原始质量级别存储。这可能比显示所需的要高得多。在插入之前考虑 <strong>减小图像大小</strong> ，例如通过使用像素图选项，然后将其缩小或缩放（参见 <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> 章节）。PIL 方法 <code class="xref any docutils literal notranslate"><span class="pre">Image.thumbnail()</span></code> 也可以用于此目的。文件大小节省可能会非常显著。</p></li>
<li><p>另一种有效的方法是通过 <a class="reference internal" href="#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">show_pdf_page()</span></code></a> 在多个页面上显示相同的图像。请参考 <a class="reference internal" href="document.html#Document.convert_to_pdf" title="Document.convert_to_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.convert_to_pdf()</span></code></a>，了解如何获取适用于该方法的中介 PDF。</p></li>
</ol>
</div>
</dd></dl>

<span class="target" id="index-17"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.replace_image">
<span class="sig-name descname"><span class="pre">replace_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.replace_image" title="永久链接至目标">#</a></dt>
<dd><p>替换位于指定 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref any py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 的图像。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xref</strong> (<em>int</em>) – 图像的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。</p></li>
<li><p><strong>filename</strong> – 新图像的文件名。</p></li>
<li><p><strong>pixmap</strong> – 新图像的 <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a>。</p></li>
<li><p><strong>stream</strong> – 包含新图像的内存区域。</p></li>
</ul>
</dd>
</dl>
<p>参数 <code class="xref any docutils literal notranslate"><span class="pre">filename</span></code>、<a class="reference internal" href="pixmap.html"><span class="doc">Pixmap</span></a>、<a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref any py py-data docutils literal notranslate"><span class="pre">stream</span></code></a> 与 <a class="reference internal" href="#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a> 中的意义相同，特别是必须提供其中之一。</p>
<p>这是一个 <strong>全局替换：</strong> 新图像将出现在文件中所有旧图像显示的地方。</p>
<p>该方法主要用于技术目的。典型用途包括通过较小的版本替换较大的图像，例如低分辨率图像，或替换颜色图像为灰度图像等，或者更改透明度。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.21.0</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-18"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.delete_image">
<span class="sig-name descname"><span class="pre">delete_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.delete_image" title="永久链接至目标">#</a></dt>
<dd><p>删除位于指定 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref any py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 的图像。这个方法有些误导：实际上，图像会被一个小的透明 <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> 替换，使用上述的 <a class="reference internal" href="#Page.replace_image" title="Page.replace_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.replace_image()</span></code></a> 方法。可见效果是等效的。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – 图像的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。</p>
</dd>
</dl>
<p>这是一个 <strong>全局替换：</strong> 该图像会在文件中所有显示它的地方消失。</p>
<p>如果通过 <a class="reference internal" href="#Page.get_images" title="Page.get_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_images()</span></code></a>、<a class="reference internal" href="#Page.get_image_info" title="Page.get_image_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_info()</span></code></a> 或 <a class="reference internal" href="#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> 等方法检查或提取页面图像，
替换后的“虚拟”图像将会被检测为 <code class="xref any docutils literal notranslate"><span class="pre">(45,</span> <span class="pre">47,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">8,</span> <span class="pre">'DeviceGray',</span> <span class="pre">'',</span> <span class="pre">'Im1',</span> <span class="pre">'FlateDecode')</span></code>，并且似乎会“覆盖”页面上的相同边界框。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.21.0</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-19"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.get_text">
<span class="sig-name descname"><span class="pre">get_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">option</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">textpage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_text" title="永久链接至目标">#</a></dt>
<dd><p>获取页面内容的多种格式。根据 <code class="docutils literal notranslate"><span class="pre">flags</span></code> 的值，返回的内容可能包括文本、图像以及其他几种对象类型。该方法是对多个 <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a> 方法的封装，通过选择输出选项 <code class="xref any docutils literal notranslate"><span class="pre">opt</span></code> 来指定格式，具体如下：</p>
<ul class="simple">
<li><p>“text” – <a class="reference internal" href="textpage.html#TextPage.extractTEXT" title="TextPage.extractTEXT"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractTEXT()</span></code></a>，默认。仅包含 <strong>文本</strong>。</p></li>
<li><p>“blocks” – <a class="reference internal" href="textpage.html#TextPage.extractBLOCKS" title="TextPage.extractBLOCKS"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractBLOCKS()</span></code></a>。包括文本，并 <strong>可能</strong> 包括图像的元信息。</p></li>
<li><p>“words” – <a class="reference internal" href="textpage.html#TextPage.extractWORDS" title="TextPage.extractWORDS"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractWORDS()</span></code></a>。仅包含 <strong>文本</strong>。</p></li>
<li><p>“html” – <a class="reference internal" href="textpage.html#TextPage.extractHTML" title="TextPage.extractHTML"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractHTML()</span></code></a>。可能包含文本和图像。</p></li>
<li><p>“xhtml” – <a class="reference internal" href="textpage.html#TextPage.extractXHTML" title="TextPage.extractXHTML"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractXHTML()</span></code></a>。可能包含文本和图像。</p></li>
<li><p>“xml” – <a class="reference internal" href="textpage.html#TextPage.extractXML" title="TextPage.extractXML"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractXML()</span></code></a>。仅包含 <strong>文本</strong>。</p></li>
<li><p>“dict” – <a class="reference internal" href="textpage.html#TextPage.extractDICT" title="TextPage.extractDICT"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractDICT()</span></code></a>。可能包含文本和图像。</p></li>
<li><p>“json” – <a class="reference internal" href="textpage.html#TextPage.extractJSON" title="TextPage.extractJSON"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractJSON()</span></code></a>。可能包含文本和图像。</p></li>
<li><p>“rawdict” – <a class="reference internal" href="textpage.html#TextPage.extractRAWDICT" title="TextPage.extractRAWDICT"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractRAWDICT()</span></code></a>。可能包含文本和图像。</p></li>
<li><p>“rawjson” – <a class="reference internal" href="textpage.html#TextPage.extractRAWJSON" title="TextPage.extractRAWJSON"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractRAWJSON()</span></code></a>。可能包含文本和图像。</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opt</strong> (<em>str</em>) – 请求的格式的字符串，选项之一。如拼写错误，则默认为 “text”。</p></li>
<li><p><strong>clip</strong> (<em>rect-like</em>) – 限制提取内容为此矩形区域。如果为 <code class="docutils literal notranslate"><span class="pre">None</span></code> （默认值），则提取页面的可见部分。任何 <strong>不完全包含</strong> 在 <code class="docutils literal notranslate"><span class="pre">clip</span></code> 中的内容（文本、图像）将被完全忽略。要完全避免裁剪，可以使用 <code class="docutils literal notranslate"><span class="pre">clip=pymupdf.INFINITE_RECT()</span></code>。仅在 “html”、”xhtml” 和 “xml” 选项中，此参数无效。</p></li>
<li><p><strong>flags</strong> (<em>int</em>) – 控制是否包括图像或文本如何处理空格和 <code class="xref py py-data docutils literal notranslate"><span class="pre">ligatures</span></code> 的标志位。详细信息参见 <a class="reference internal" href="vars.html#textpreserve"><span class="std std-ref">字体属性</span></a> 和 <a class="reference internal" href="app1.html#text-extraction-flags"><span class="std std-ref">文本提取标志默认值</span></a>。 (v1.16.2 新增)</p></li>
<li><p><strong>textpage</strong> – 使用先前创建的 <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a>。这将显著减少执行时间 <strong>超过 50%</strong>，最大可达 <strong>95%</strong>，具体取决于提取选项。如果指定了此参数，则忽略 <a class="reference internal" href="annot.html#Annot.flags" title="Annot.flags"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">flags</span></code></a> 和 <code class="xref any docutils literal notranslate"><span class="pre">clip</span></code> 参数，因为它们是专属于 textpage 的属性。如果未指定，则会创建一个新的临时 textpage。</p></li>
<li><p><strong>sort</strong> (<em>bool</em>) – 按垂直坐标然后水平坐标对输出进行排序。在大多数情况下，这应该足以生成“自然”的阅读顺序。对于选项 “blocks”、”dict”、”json”、”rawdict”、”rawjson” 来说，排序是基于各自块的 bbox 坐标 <code class="xref any docutils literal notranslate"><span class="pre">(y1,</span> <span class="pre">x0)</span></code>。对于选项 “words” 和 “text” 来说，文本行会被完全重新合成，以遵循文档中的阅读顺序和显示顺序，这在某种程度上会恢复原始布局。</p></li>
<li><p><strong>delimiters</strong> (<em>str</em>) – 使用这些字符作为 <em>附加</em> 的单词分隔符，仅在 “words” 输出选项中有效（其他情况下忽略）。默认情况下，所有空白字符（包括不换行的空格 <code class="xref any docutils literal notranslate"><span class="pre">0xA0</span></code>）表示单词的开始和结束。现在，您可以指定更多字符来作为分隔符。例如，默认情况下 <code class="xref any docutils literal notranslate"><span class="pre">&quot;john.doe&#64;outlook.com&quot;</span></code> 会作为 <strong>一个</strong> 单词返回。如果指定 <code class="xref any docutils literal notranslate"><span class="pre">delimiters=&quot;&#64;.&quot;</span></code>，则会返回四个单词 <code class="xref any docutils literal notranslate"><span class="pre">&quot;john&quot;</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">&quot;doe&quot;</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">&quot;outlook&quot;</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">&quot;com&quot;</span></code>。其他用途包括忽略标点字符 <code class="xref any docutils literal notranslate"><span class="pre">delimiters=string.punctuation</span></code>。返回的“单词”字符串将不包含分隔符字符。（v1.23.5 新增）</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><em>str, list, dict</em></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>页面内容，以字符串、列表或字典形式返回。具体请参考对应的 <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a> 方法。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ol class="arabic simple">
<li><p>您可以将此方法用作 <strong>文档转换工具</strong>，将 <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">任何支持的文档类型</span></a> 转换为 TEXT、HTML、XHTML 或 XML 格式的文档。</p></li>
<li><p>通过 <em>clip</em> 参数包含的文本是基于字符级别决定的：只有当字符的 bbox 被完全包含在 <code class="xref any docutils literal notranslate"><span class="pre">clip</span></code> 内时，该字符才会成为输出的一部分。这与涂抹注释中使用的算法不同：如果字符的 bbox 与任何涂抹注释相交，该字符将被 <strong>移除</strong>。</p></li>
</ol>
</div>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.19.0: 增加了 <a class="reference internal" href="textpage.html"><span class="doc">TextPage</span></a> 参数</p></li>
<li><p>新增于 v1.19.1: 增加了 <code class="xref any docutils literal notranslate"><span class="pre">sort</span></code> 参数</p></li>
<li><p>新增于 v1.19.6: 增加了用于定义每个方法默认标志的常量</p></li>
<li><p>新增于 v1.23.5: 增加了 <code class="xref any docutils literal notranslate"><span class="pre">delimiters</span></code> 参数</p></li>
<li><p>更改于 v1.24.11: 更改了 <code class="xref any docutils literal notranslate"><span class="pre">sort=True</span></code> 对 “text” 和 “words” 选项的效果，使其更接近自然的阅读顺序。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-20"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.get_textbox">
<span class="sig-name descname"><span class="pre">get_textbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">textpage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_textbox" title="永久链接至目标">#</a></dt>
<dd><p>获取矩形区域内的文本。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rect</strong> (<em>rect-like</em>) – 矩形区域。</p></li>
<li><p><strong>textpage</strong> – 用于提取的 <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a>。如果未指定，将创建一个新的临时 textpage。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><p>一个包含必要换行符的字符串。此结果基于专门的代码（v1.19.0 更改）。一个典型的用法是检查 <a class="reference internal" href="#Page.search_for" title="Page.search_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.search_for()</span></code></a> 的结果：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rl</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">search_for</span><span class="p">(</span><span class="s2">&quot;currency:&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">get_textbox</span><span class="p">(</span><span class="n">rl</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&#39;Currency:&#39;</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
</p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.17.7</p></li>
<li><p>更改于 v1.19.0: 增加了 <a class="reference internal" href="textpage.html"><span class="doc">TextPage</span></a> 参数</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-21"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.get_textpage">
<span class="sig-name descname"><span class="pre">get_textpage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_textpage" title="永久链接至目标">#</a></dt>
<dd><p>为页面创建一个 <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a>。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flags</strong> (<em>int</em>) – 控制后续文本提取和搜索可用内容的标志位 —— 参见 <a class="reference internal" href="#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> 的参数说明。</p></li>
<li><p><strong>clip</strong> (<em>rect-like</em>) – 限制提取的文本范围到此区域。（v1.17.7 新增）</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a></p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.16.5</p></li>
<li><p>更改于 v1.17.7: 引入了 <code class="xref any docutils literal notranslate"><span class="pre">clip</span></code> 参数。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-22"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.get_textpage_ocr">
<span class="sig-name descname"><span class="pre">get_textpage_ocr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">language</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eng'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">72</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tessdata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_textpage_ocr" title="永久链接至目标">#</a></dt>
<dd><p><strong>光学字符识别</strong> （ <strong>OCR</strong> ）技术可用于从仅包含栅格图像格式文本的文档中提取文本数据。使用此方法对页面进行 <strong>OCR</strong> 处理以提取文本。</p>
<p>该方法返回一个包含 OCR 识别文本的 <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a>。如果调用此方法，MuPDF 将调用 Tesseract-OCR，否则返回的对象与普通的 <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a> 相同。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flags</strong> (<em>int</em>) – 控制后续文本提取和搜索可用内容的标志位 —— 参见 <a class="reference internal" href="#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> 的参数说明。</p></li>
<li><p><strong>language</strong> (<em>str</em>) – 预期的语言。若需要识别多种语言，可使用 <code class="xref any docutils literal notranslate"><span class="pre">+</span></code> 连接，例如 <code class="xref any docutils literal notranslate"><span class="pre">&quot;eng+spa&quot;</span></code> 表示英文和西班牙文。</p></li>
<li><p><strong>dpi</strong> (<em>int</em>) – 期望的分辨率（每英寸点数，DPI）。该参数影响识别质量（及执行时间）。</p></li>
<li><p><strong>full</strong> (<em>bool</em>) – 是否对整页进行 OCR，还是仅处理页面中的图像部分。</p></li>
<li><p><strong>tessdata</strong> (<em>str</em>) – Tesseract 语言数据文件 <code class="xref any docutils literal notranslate"><span class="pre">tessdata</span></code> 的文件夹名称。如果省略，则此信息必须通过环境变量 <code class="xref any docutils literal notranslate"><span class="pre">TESSDATA_PREFIX</span></code> 提供。可使用 <a class="reference internal" href="functions.html#get_tessdata" title="get_tessdata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_tessdata()</span></code></a> 方法获取。</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>此方法 <strong>不支持</strong> <code class="xref any docutils literal notranslate"><span class="pre">clip</span></code> 参数 —— OCR 始终针对整个页面矩形区域进行。</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>一个 <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a> 对象。执行时间可能明显长于 <a class="reference internal" href="#Page.get_textpage" title="Page.get_textpage"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_textpage()</span></code></a>。</p>
<p>对于整页 OCR 处理，<strong>所有文本</strong> 都将使用 Tesseract 生成的 “GlyphlessFont” 字体。对于部分 OCR 处理，原始文本将保持其原有属性，仅从图像提取的文本会使用 “GlyphlessFont”。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><strong>OCR 识别的文本仅在</strong> PyMuPDF 进行文本提取和搜索时可用，前提是 <a class="reference internal" href="textpage.html"><span class="doc">TextPage</span></a> 参数指定此方法的输出。</p>
<p><a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/jupyter-notebooks/partial-ocr.ipynb">此 Jupyter Notebook</a> 提供了 OCR 文本页面的使用示例。</p>
</div>
</p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.19.0</p></li>
<li><p>更改于 v1.19.1: 支持完整和部分 OCR 处理页面。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.get_drawings">
<span class="sig-name descname"><span class="pre">get_drawings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extended</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_drawings" title="永久链接至目标">#</a></dt>
<dd><p>返回页面的矢量图形。这些是绘制线条、矩形、四边形或曲线的指令，并包含颜色、透明度、线宽、虚线模式等属性。其他术语包括 <strong>“线条艺术”（line art）</strong> 和 <strong>“绘图”（drawings）</strong>。</p>
<dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>一个字典列表。每个字典项包含一个或多个属于同一绘制操作的指令，它们共享相同的属性（如颜色、虚线等）。在 PDF 中，这称为 <strong>“路径”（path）</strong>，但该方法适用于所有文档类型。</p>
</dd>
</dl>
<p>适用于填充（fill）、描边（stroke）和填充+描边（fill-stroke）的路径字典设计为兼容 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a> 类，包含以下键：</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>键名</p></th>
<th class="head"><p>值</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>closePath</p></td>
<td><p>与 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a> 参数相同</p></td>
</tr>
<tr class="row-odd"><td><p>color</p></td>
<td><p>描边颜色（参见 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a>）</p></td>
</tr>
<tr class="row-even"><td><p>dashes</p></td>
<td><p>虚线样式（参见 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a>）</p></td>
</tr>
<tr class="row-odd"><td><p>even_odd</p></td>
<td><p>填充区域重叠颜色模式，与 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a> 参数相同</p></td>
</tr>
<tr class="row-even"><td><p>fill</p></td>
<td><p>填充颜色（参见 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a>）</p></td>
</tr>
<tr class="row-odd"><td><p>items</p></td>
<td><p>绘制指令列表：线条、矩形、四边形或曲线</p></td>
</tr>
<tr class="row-even"><td><p>lineCap</p></td>
<td><p>线端样式（三元组），输出时应使用最大值（参见 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a>）</p></td>
</tr>
<tr class="row-odd"><td><p>lineJoin</p></td>
<td><p>线连接方式，与 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a> 参数相同</p></td>
</tr>
<tr class="row-even"><td><p>fill_opacity</p></td>
<td><p>填充颜色透明度（参见 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a>）（新增于 v1.18.17）</p></td>
</tr>
<tr class="row-odd"><td><p>stroke_opacity</p></td>
<td><p>描边颜色透明度（参见 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a>）（新增于 v1.18.17）</p></td>
</tr>
<tr class="row-even"><td><p>rect</p></td>
<td><p>此路径覆盖的页面区域，仅供参考</p></td>
</tr>
<tr class="row-odd"><td><p>layer</p></td>
<td><p>适用的可选内容组（Optional Content Group）名称（新增于 v1.22.0）</p></td>
</tr>
<tr class="row-even"><td><p>level</p></td>
<td><p>如果 <code class="xref any docutils literal notranslate"><span class="pre">extended=True</span></code>，则表示路径的层级（新增于 v1.22.0）</p></td>
</tr>
<tr class="row-odd"><td><p>seqno</p></td>
<td><p>绘制页面外观时的命令编号（新增于 v1.19.0）</p></td>
</tr>
<tr class="row-even"><td><p>type</p></td>
<td><p>该路径的类型（新增于 v1.18.17）</p></td>
</tr>
<tr class="row-odd"><td><p>width</p></td>
<td><p>线条宽度（参见 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a>）</p></td>
</tr>
</tbody>
</table>
</div>
<p>由于 <a class="reference internal" href="annot.html#Annot.opacity" title="Annot.opacity"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">opacity</span></code></a> 键已被 <code class="xref any docutils literal notranslate"><span class="pre">&quot;fill_opacity&quot;</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">&quot;stroke_opacity&quot;</span></code> 替代，因此该方法现在与 <a class="reference internal" href="shape.html#Shape.finish" title="Shape.finish"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.finish()</span></code></a> 的参数兼容。（更改于 v1.18.17）</p>
<p>除剪裁（clip）或分组（group）路径外，<code class="xref any docutils literal notranslate"><span class="pre">&quot;type&quot;</span></code> 可能具有以下值：</p>
<ul class="simple">
<li><p><strong>“f”</strong> —— <em>仅填充</em> 路径。仅相关的键有效，不适用的键（如 <code class="xref any docutils literal notranslate"><span class="pre">&quot;color&quot;</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">&quot;lineCap&quot;</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">&quot;width&quot;</span></code> 等）将设置为 <code class="docutils literal notranslate"><span class="pre">None</span></code>。</p></li>
<li><p><strong>“s”</strong> —— <em>仅描边</em> 路径。类似于上一个，仅 <code class="xref any docutils literal notranslate"><span class="pre">&quot;fill&quot;</span></code> 键的值为 <code class="docutils literal notranslate"><span class="pre">None</span></code>。</p></li>
<li><p><strong>“fs”</strong> —— 进行 <em>填充+描边</em> 操作的路径。</p></li>
</ul>
<p><code class="xref any docutils literal notranslate"><span class="pre">path[&quot;items&quot;]</span></code> 中的每个项目为以下类型之一：</p>
<ul class="simple">
<li><p><code class="xref any docutils literal notranslate"><span class="pre">(&quot;l&quot;,</span> <span class="pre">p1,</span> <span class="pre">p2)</span></code> —— 从 <code class="xref any docutils literal notranslate"><span class="pre">p1</span></code> 到 <code class="xref any docutils literal notranslate"><span class="pre">p2</span></code> 的直线（<a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a> 对象）。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">(&quot;c&quot;,</span> <span class="pre">p1,</span> <span class="pre">p2,</span> <span class="pre">p3,</span> <span class="pre">p4)</span></code> —— 三次贝塞尔曲线 <strong>从</strong> <code class="xref any docutils literal notranslate"><span class="pre">p1</span></code> <strong>到</strong> <code class="xref any docutils literal notranslate"><span class="pre">p4</span></code> （ <code class="xref any docutils literal notranslate"><span class="pre">p2</span></code> 和 <code class="xref any docutils literal notranslate"><span class="pre">p3</span></code> 为控制点）。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">(&quot;re&quot;,</span> <span class="pre">rect,</span> <span class="pre">orientation)</span></code> —— 一个 <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> 对象，表示矩形。多个矩形可以被检测到（更改于 v1.18.17）。<code class="xref any docutils literal notranslate"><span class="pre">orientation</span></code> 为 <code class="xref any docutils literal notranslate"><span class="pre">1</span></code> 表示逆时针旋转（anti-clockwise），<code class="xref any docutils literal notranslate"><span class="pre">-1</span></code> 表示顺时针旋转（更改于 v1.19.2）。</p></li>
<li><p><code class="xref any docutils literal notranslate"><span class="pre">(&quot;qu&quot;,</span> <span class="pre">quad)</span></code> —— 一个 <a class="reference internal" href="quad.html#quad"><span class="std std-ref">Quad</span></a> 对象。检测到 3 或 4 条连续直线实际形成一个四边形（更改于 v1.19.2，新增于 v1.18.17）。</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>从 v1.19.2 开始，四边形和矩形的识别更加可靠。</p>
</div>
<p>使用 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a> 类，可以在新的 PDF 页面上高保真地重现原始绘图（在正常情况下）。更多限制条件请参阅 <a class="reference external" href="RecipesDrawingAndGraphics_Extract_Drawings">如何提取绘图</a>。</p>
<p>指定 <code class="xref any docutils literal notranslate"><span class="pre">extended=True</span></code> 将显著改变输出格式。最重要的变化是增加了新的字典类型：”clip” 和 “group”。所有路径现在按层级结构组织，并通过 <code class="xref any docutils literal notranslate"><span class="pre">level</span></code> 键编码。（新增于 v1.22.0）</p>
<p>若某个路径的 <code class="xref any docutils literal notranslate"><span class="pre">level</span></code> 小于前一个路径的 <code class="xref any docutils literal notranslate"><span class="pre">level</span></code>，则表明其前面的层级已结束。相同 <code class="xref any docutils literal notranslate"><span class="pre">level</span></code> 值的 “clip” 或 “group” 表示当前剪裁或分组的作用范围已结束。例如:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+------+------+--------+------+--------+</span>
<span class="o">|</span> <span class="n">行号</span> <span class="o">|</span> <span class="n">lvl0</span> <span class="o">|</span> <span class="n">lvl1</span>   <span class="o">|</span> <span class="n">lvl2</span> <span class="o">|</span>  <span class="n">lvl3</span>  <span class="o">|</span>
<span class="o">+------+------+--------+------+--------+</span>
<span class="o">|</span>  <span class="mi">0</span>   <span class="o">|</span> <span class="n">clip</span> <span class="o">|</span>        <span class="o">|</span>      <span class="o">|</span>        <span class="o">|</span>
<span class="o">|</span>  <span class="mi">1</span>   <span class="o">|</span>      <span class="o">|</span> <span class="n">fill</span>   <span class="o">|</span>      <span class="o">|</span>        <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span>   <span class="o">|</span>      <span class="o">|</span> <span class="n">group</span>  <span class="o">|</span>      <span class="o">|</span>        <span class="o">|</span>
<span class="o">|</span>  <span class="mi">3</span>   <span class="o">|</span>      <span class="o">|</span>        <span class="o">|</span> <span class="n">clip</span> <span class="o">|</span>        <span class="o">|</span>
<span class="o">|</span>  <span class="mi">4</span>   <span class="o">|</span>      <span class="o">|</span>        <span class="o">|</span>      <span class="o">|</span> <span class="n">stroke</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">5</span>   <span class="o">|</span>      <span class="o">|</span>        <span class="o">|</span> <span class="n">fill</span> <span class="o">|</span>        <span class="o">|</span>  <span class="n">结束行</span> <span class="mi">3</span> <span class="n">的</span> <span class="n">clip</span> <span class="n">作用范围</span>
<span class="o">|</span>  <span class="mi">6</span>   <span class="o">|</span>      <span class="o">|</span> <span class="n">stroke</span> <span class="o">|</span>      <span class="o">|</span>        <span class="o">|</span>  <span class="n">结束行</span> <span class="mi">2</span> <span class="n">的</span> <span class="n">group</span> <span class="n">作用范围</span>
<span class="o">|</span>  <span class="mi">7</span>   <span class="o">|</span>      <span class="o">|</span> <span class="n">clip</span>   <span class="o">|</span>      <span class="o">|</span>        <span class="o">|</span>
<span class="o">|</span>  <span class="mi">8</span>   <span class="o">|</span> <span class="n">fill</span> <span class="o">|</span>        <span class="o">|</span>      <span class="o">|</span>        <span class="o">|</span>  <span class="n">结束行</span> <span class="mi">0</span> <span class="n">的</span> <span class="n">clip</span> <span class="n">作用范围</span>
<span class="o">+------+------+--------+------+--------+</span>
</pre></div>
</div>
<p>在上表中：</p>
<ul>
<li><p>行 0 的 clip 作用范围直到行 7 结束。</p></li>
<li><p>行 2 的 group 作用于行 3 到 5，行 3 的 clip 仅适用于行 4。</p></li>
<li><p>行 4 的 stroke 受到行 2 的 group 和行 3 的 clip 的影响，而行 3 的 clip 本身又属于行 0 的 clip 范围。</p></li>
<li><p><strong>“clip”</strong> 字典。其值（尤其是 <code class="xref any docutils literal notranslate"><span class="pre">&quot;scissor&quot;</span></code>）在后续 <strong>更高 “level” 值</strong> 的路径上仍然有效。</p>
<blockquote>
<div><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>键名</p></th>
<th class="head"><p>值</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>closePath</p></td>
<td><p>与 “stroke” 或 “fill” 字典中的相同</p></td>
</tr>
<tr class="row-odd"><td><p>even_odd</p></td>
<td><p>与 “stroke” 或 “fill” 字典中的相同</p></td>
</tr>
<tr class="row-even"><td><p>items</p></td>
<td><p>与 “stroke” 或 “fill” 字典中的相同</p></td>
</tr>
<tr class="row-odd"><td><p>rect</p></td>
<td><p>与 “stroke” 或 “fill” 字典中的相同</p></td>
</tr>
<tr class="row-even"><td><p>layer</p></td>
<td><p>与 “stroke” 或 “fill” 字典中的相同</p></td>
</tr>
<tr class="row-odd"><td><p>level</p></td>
<td><p>层级信息</p></td>
</tr>
<tr class="row-even"><td><p>scissor</p></td>
<td><p>剪裁区域</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td><p>“clip”</p></td>
</tr>
</tbody>
</table>
</div>
</div></blockquote>
</li>
<li><p><strong>“group”</strong> 字典。其值在后续 <strong>更高 “level” 值</strong> 的路径上仍然有效，遇到相同或更低 <code class="xref any docutils literal notranslate"><span class="pre">level</span></code> 值的路径时结束作用范围。</p>
<blockquote>
<div><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>键名</p></th>
<th class="head"><p>值</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>rect</p></td>
<td><p>与 “stroke” 或 “fill” 字典中的相同</p></td>
</tr>
<tr class="row-odd"><td><p>layer</p></td>
<td><p>与 “stroke” 或 “fill” 字典中的相同</p></td>
</tr>
<tr class="row-even"><td><p>level</p></td>
<td><p>层级信息</p></td>
</tr>
<tr class="row-odd"><td><p>isolated</p></td>
<td><p>(bool) 该组是否为独立组</p></td>
</tr>
<tr class="row-even"><td><p>knockout</p></td>
<td><p>(bool) 是否为 “Knockout Group”</p></td>
</tr>
<tr class="row-odd"><td><p>blendmode</p></td>
<td><p>混合模式名称，默认值为 “Normal”</p></td>
</tr>
<tr class="row-even"><td><p>opacity</p></td>
<td><p>透明度，取值范围 [0, 1]</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td><p>“group”</p></td>
</tr>
</tbody>
</table>
</div>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>此方法基于 <a class="reference internal" href="#Page.get_cdrawings" title="Page.get_cdrawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_cdrawings()</span></code></a> 输出，后者速度更快，但需要额外处理。</p>
</div>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.18.0</p></li>
<li><p>更改于 v1.18.17</p></li>
<li><p>更改于 v1.19.0: 添加 <code class="xref any docutils literal notranslate"><span class="pre">&quot;seqno&quot;</span></code> 键，移除 <code class="xref any docutils literal notranslate"><span class="pre">&quot;clippings&quot;</span></code> 键</p></li>
<li><p>更改于 v1.19.1: 统一 <code class="xref any docutils literal notranslate"><span class="pre">&quot;color&quot;</span></code> / <code class="xref any docutils literal notranslate"><span class="pre">&quot;fill&quot;</span></code> 值为 RGB 元组或 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code></p></li>
<li><p>更改于 v1.19.2: 添加 <code class="xref any docutils literal notranslate"><span class="pre">&quot;orientation&quot;</span></code> 指示 <code class="xref any docutils literal notranslate"><span class="pre">&quot;re&quot;</span></code> 项的旋转方向</p></li>
<li><p>更改于 v1.22.0: 添加 <code class="xref any docutils literal notranslate"><span class="pre">&quot;layer&quot;</span></code> 键，存储可选内容组名称</p></li>
<li><p>更改于 v1.22.0: 添加 <code class="xref any docutils literal notranslate"><span class="pre">extended</span></code> 参数，返回剪裁和分组路径</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.get_cdrawings">
<span class="sig-name descname"><span class="pre">get_cdrawings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extended</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_cdrawings" title="永久链接至目标">#</a></dt>
<dd><p>提取页面上的矢量图形。除了以下技术性差异外，在功能上等同于 <a class="reference internal" href="#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a>，但速度更快：</p>
<ul class="simple">
<li><p>每种路径类型仅包含相关的键值，例如，描边路径不包含 <code class="xref any docutils literal notranslate"><span class="pre">&quot;fill&quot;</span></code> 颜色键。请参阅 <a class="reference internal" href="#Page.get_drawings" title="Page.get_drawings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a> 方法中的注释。</p></li>
<li><p>坐标以 <a class="reference internal" href="glossary.html#point_like" title="point_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">point_like</span></code></a>、<a class="reference internal" href="glossary.html#rect_like" title="rect_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">rect_like</span></code></a> 和 <a class="reference internal" href="glossary.html#quad_like" title="quad_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">quad_like</span></code></a> <strong>元组</strong> 形式提供，而不是 <a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a>、<a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a>、<a class="reference internal" href="quad.html#quad"><span class="std std-ref">Quad</span></a> 对象。</p></li>
</ul>
<p>如果性能是一个关注点，建议使用此方法：与 1.18.17 之前的版本相比，响应时间大幅缩短。例如，某些页面以前需要 2 秒，现在只需 200 毫秒。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.18.17</p></li>
<li><p>v1.19.0 变更：移除 <code class="xref any docutils literal notranslate"><span class="pre">&quot;clippings&quot;</span></code> 键，新增 <code class="xref any docutils literal notranslate"><span class="pre">&quot;seqno&quot;</span></code> 键。</p></li>
<li><p>v1.19.1 变更：始终生成 RGB 颜色元组。</p></li>
<li><p>v1.22.0 变更：新增 <code class="xref any docutils literal notranslate"><span class="pre">&quot;layer&quot;</span></code> 键，包含路径的可选内容组（Optional Content Group）名称（或 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>）。</p></li>
<li><p>v1.22.0 变更：新增 <code class="xref any docutils literal notranslate"><span class="pre">extended</span></code> 参数，可用于返回剪裁路径。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.get_fonts">
<span class="sig-name descname"><span class="pre">get_fonts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_fonts" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：返回页面引用的字体列表。此方法是 <a class="reference internal" href="document.html#Document.get_page_fonts" title="Document.get_page_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_fonts()</span></code></a> 的包装器。</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.get_images">
<span class="sig-name descname"><span class="pre">get_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_images" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：返回页面引用的图像列表。此方法是 <a class="reference internal" href="document.html#Document.get_page_images" title="Document.get_page_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_images()</span></code></a> 的包装器。</p>
</dd></dl>

<span class="target" id="index-23"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.get_image_info">
<span class="sig-name descname"><span class="pre">get_image_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hashes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xrefs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_image_info" title="永久链接至目标">#</a></dt>
<dd><p>返回页面上显示的所有图像的元信息字典列表。适用于所有文档类型。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hashes</strong> (<em>bool</em>) – 计算每个图像的 MD5 哈希值，以便识别重复图像。这会在输出中添加 <code class="xref any docutils literal notranslate"><span class="pre">&quot;digest&quot;</span></code> 键，其值为 16 字节的 <code class="xref any docutils literal notranslate"><span class="pre">bytes</span></code> 对象。（新增于 v1.18.13）</p></li>
<li><p><strong>xrefs</strong> (<em>bool</em>) – <strong>仅适用于 PDF。</strong> 尝试查找每个图像的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>，隐含启用 <code class="xref any docutils literal notranslate"><span class="pre">hashes=True</span></code>。在字典中添加 <code class="xref any docutils literal notranslate"><span class="pre">&quot;xref&quot;</span></code> 键。如果找不到，其值为 0，表示该图像是“内嵌图像”或其 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref any py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 无法检测到。请注意，该选项会延长响应时间，因为 MD5 哈希值至少会计算两次。（新增于 v1.18.13）</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>list[dict]</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>一个字典列表，仅包含 <strong>页面上实际显示的图像</strong>，包括 <em>“内嵌图像”</em>。字典结构类似于 <code class="xref any docutils literal notranslate"><span class="pre">page.get_text(&quot;dict&quot;)</span></code> 方法返回的图像块。</p>
<p>与 <a class="reference internal" href="#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> 提取的图像不同，此方法 <strong>不会</strong> 加载图像的二进制内容，从而显著减少内存使用。此外，此方法的图像检测不受 <code class="xref any docutils literal notranslate"><span class="pre">clip</span></code> 参数或页面可见区域的限制，而 <a class="reference internal" href="#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> 仅提取 <strong>完全包含</strong> 在 <code class="xref any docutils literal notranslate"><span class="pre">clip</span></code> 内的图像。</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>键</strong></p></th>
<th class="head"><p><strong>值</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>number</p></td>
<td><p>块编号（<code class="docutils literal notranslate"><span class="pre">int</span></code>）</p></td>
</tr>
<tr class="row-odd"><td><p>bbox</p></td>
<td><p>页面上的图像边界框，<a class="reference internal" href="glossary.html#rect_like" title="rect_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">rect_like</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>width</p></td>
<td><p>原始图像宽度（<code class="docutils literal notranslate"><span class="pre">int</span></code>）</p></td>
</tr>
<tr class="row-odd"><td><p>height</p></td>
<td><p>原始图像高度（<code class="docutils literal notranslate"><span class="pre">int</span></code>）</p></td>
</tr>
<tr class="row-even"><td><p>cs-name</p></td>
<td><p>颜色空间名称（<code class="docutils literal notranslate"><span class="pre">str</span></code>）</p></td>
</tr>
<tr class="row-odd"><td><p>colorspace</p></td>
<td><p>颜色空间.n（<code class="docutils literal notranslate"><span class="pre">int</span></code>）</p></td>
</tr>
<tr class="row-even"><td><p>xres</p></td>
<td><p>x 方向分辨率（<code class="docutils literal notranslate"><span class="pre">int</span></code>）</p></td>
</tr>
<tr class="row-odd"><td><p>yres</p></td>
<td><p>y 方向分辨率（<code class="docutils literal notranslate"><span class="pre">int</span></code>）</p></td>
</tr>
<tr class="row-even"><td><p>bpc</p></td>
<td><p>每通道位数（<code class="docutils literal notranslate"><span class="pre">int</span></code>）</p></td>
</tr>
<tr class="row-odd"><td><p>size</p></td>
<td><p>图像占用的存储空间（<code class="docutils literal notranslate"><span class="pre">int</span></code>）</p></td>
</tr>
<tr class="row-even"><td><p>digest</p></td>
<td><p>MD5 哈希值（<code class="docutils literal notranslate"><span class="pre">bytes</span></code>），仅在 <code class="docutils literal notranslate"><span class="pre">hashes</span></code> 为 <code class="xref any docutils literal notranslate"><span class="pre">True</span></code> 时可用</p></td>
</tr>
<tr class="row-odd"><td><p>xref</p></td>
<td><p>图像的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>，若 <em>xrefs</em> 为 <code class="xref any docutils literal notranslate"><span class="pre">True</span></code>，否则为 0</p></td>
</tr>
<tr class="row-even"><td><p>transform</p></td>
<td><p>变换矩阵，将图像矩形转换为边界框，<a class="reference internal" href="glossary.html#matrix_like" title="matrix_like"><code class="xref py py-data docutils literal notranslate"><span class="pre">matrix_like</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>has-mask</p></td>
<td><p>图像是否透明且具有遮罩（<code class="docutils literal notranslate"><span class="pre">bool</span></code>）</p></td>
</tr>
</tbody>
</table>
</div>
<p>同一图像的多个实例都会被报告。可以通过比较 <a class="reference internal" href="pixmap.html#Pixmap.digest" title="Pixmap.digest"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">digest</span></code></a> 值来检测重复图像。</p>
</p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.18.11</p></li>
<li><p>v1.18.13 变更：新增图像 MD5 哈希值计算和 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 搜索。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.get_xobjects">
<span class="sig-name descname"><span class="pre">get_xobjects</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_xobjects" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：返回页面引用的 Form XObjects 列表。此方法是 <a class="reference internal" href="document.html#Document.get_page_xobjects" title="Document.get_page_xobjects"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_page_xobjects()</span></code></a> 的包装器。</p>
</dd></dl>

<span class="target" id="index-24"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.get_image_rects">
<span class="sig-name descname"><span class="pre">get_image_rects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_image_rects" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：返回嵌入图像的边界框和变换矩阵。这是 <a class="reference internal" href="#Page.get_image_bbox" title="Page.get_image_bbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_bbox()</span></code></a> 的改进版，具有以下区别：</p>
<ul class="simple">
<li><p><strong>无论</strong> 图像如何被调用（页面本身或其 Form XObjects 之一），结果始终完整且正确。</p></li>
<li><p>结果是一个 <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> 或 (<a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a>, <a class="reference internal" href="matrix.html#matrix"><span class="std std-ref">Matrix</span></a>) 对象的列表，具体取决于 <em>transform</em> 参数。列表中的每个项目表示图像在页面上的一个位置。<a class="reference internal" href="#Page.get_image_bbox" title="Page.get_image_bbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_bbox()</span></code></a> 可能无法检测到图像的多个实例。</p></li>
<li><p>该方法调用 <a class="reference internal" href="#Page.get_image_info" title="Page.get_image_info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_info()</span></code></a> 并设置 <code class="xref any docutils literal notranslate"><span class="pre">xrefs=True</span></code>，因此响应时间比 <a class="reference internal" href="#Page.get_image_bbox" title="Page.get_image_bbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_image_bbox()</span></code></a> 明显更长。</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item</strong> (<em>list</em><em>,</em><em>str</em><em>,</em><em>int</em>) – 来自 <a class="reference internal" href="#Page.get_images" title="Page.get_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_images()</span></code></a> 列表的一个项目，或该项目的引用 <strong>名称</strong> （item[7]），或图像的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。</p></li>
<li><p><strong>transform</strong> (<em>bool</em>) – 是否返回用于将图像矩形变换为页面边界框的矩阵。如果为 <code class="xref any docutils literal notranslate"><span class="pre">True</span></code>，则返回 <code class="xref any docutils literal notranslate"><span class="pre">(bbox,</span> <span class="pre">matrix)</span></code> 元组。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>每个图像实例的边界框及其相应的变换矩阵。如果该图像不在页面上，则返回空列表 <code class="xref any docutils literal notranslate"><span class="pre">[]</span></code>。</p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<p>新增于 v1.18.13</p>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-25"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.get_image_bbox">
<span class="sig-name descname"><span class="pre">get_image_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_image_bbox" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：返回嵌入图像的边界框和变换矩阵。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>item</strong> (<em>list</em><em>,</em><em>str</em>) – 需要指定 <code class="xref any docutils literal notranslate"><span class="pre">full=True</span></code> 时 <a class="reference internal" href="#Page.get_images" title="Page.get_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_images()</span></code></a> 返回的列表项，或该项目的引用 <strong>名称</strong> （item[-3] 或 item[7]）。</p></li>
<li><p><strong>transform</strong> (<em>bool</em>) – 是否返回用于将图像矩形变换为页面边界框的矩阵（新增于 v1.18.11）。默认情况下，仅返回边界框。如果 <code class="xref any docutils literal notranslate"><span class="pre">True</span></code>，则返回 <code class="xref any docutils literal notranslate"><span class="pre">(bbox,</span> <span class="pre">matrix)</span></code> 元组。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> 或 (<a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a>, <a class="reference internal" href="matrix.html#matrix"><span class="std std-ref">Matrix</span></a>)</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>图像的边界框，可选地返回其变换矩阵。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>(v1.16.7 变更): 如果页面实际上未显示此图像，则现在返回一个无限矩形。在之前的版本中，会抛出异常。对于形式上无效的参数仍然会抛出异常。</p></li>
<li><p>(v1.17.0 变更): 仅考虑页面直接引用的图像。这意味着嵌入的 PDF 页面中的图像将被忽略，并且会抛出异常。</p></li>
<li><p>(v1.18.5 变更): 移除了 v1.17.0 引入的限制：现在可以指定页面图像列表中的任何项目。</p></li>
<li><p>(v1.18.11 变更): 部分恢复了一些限制：仅考虑页面直接引用的图像，或由页面直接引用的 Form XObject 引用的图像。</p></li>
<li><p>(v1.18.11 变更): 现在可选择同时返回变换矩阵，格式为 <code class="xref any docutils literal notranslate"><span class="pre">(bbox,</span> <span class="pre">transform)</span></code> 元组。</p></li>
</ul>
<p></small></details></p>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ol class="arabic simple">
<li><p>请注意，<a class="reference internal" href="#Page.get_images" title="Page.get_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_images()</span></code></a> 可能包含“无效”条目，即页面 <strong>未实际显示</strong> 的图像。这不是错误，而是 PDF 创建者的有意行为。在这种情况下，不会抛出异常，而是返回一个无限矩形。可以通过在调用此方法前执行 <a class="reference internal" href="functions.html#Page.clean_contents" title="Page.clean_contents"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.clean_contents()</span></code></a> 来避免此问题。</p></li>
<li><p>图像的“变换矩阵”定义如下：满足 <code class="xref any docutils literal notranslate"><span class="pre">bbox</span> <span class="pre">/</span> <span class="pre">transform</span> <span class="pre">==</span> <span class="pre">pymupdf.Rect(0,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">1)</span></code> 的矩阵。详情请参考 <a class="reference internal" href="app3.html#imagetransformation"><span class="std std-ref">图像转换矩阵</span></a>。</p></li>
</ol>
</div>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.11 变更：返回图像变换矩阵。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<span class="target" id="index-26"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.get_svg_image">
<span class="sig-name descname"><span class="pre">get_svg_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pymupdf.Identity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_as_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_svg_image" title="永久链接至目标">#</a></dt>
<dd><p>从页面创建一个 SVG 图像。目前仅支持完整页面图像。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> (<em>matrix_like</em>) – 变换矩阵，默认值为 <a class="reference internal" href="identity.html#identity"><span class="std std-ref">Identity</span></a>。</p></li>
<li><p><strong>text_as_path</strong> (<em>bool</em>) – 控制文本的表示方式。 <code class="docutils literal notranslate"><span class="pre">True</span></code> 时，每个字符都被输出为一系列基本绘图命令，这样在浏览器中可以更精确地显示文本，但对于以文本为主的页面来说，输出文件会 <strong>大得多</strong>。如果选择 <code class="docutils literal notranslate"><span class="pre">False</span></code>，则显示质量取决于当前系统上是否存在引用的字体。对于缺失的字体，浏览器会使用默认字体进行替换，可能导致外观不佳。选择 <code class="docutils literal notranslate"><span class="pre">False</span></code> 以便能够解析 SVG 中的文本。（新增于 v1.17.5）</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>一个 UTF-8 编码的字符串，包含生成的 SVG 图像。由于 SVG 采用 XML 语法，因此可以将其保存为文本文件，标准扩展名为 <code class="xref any docutils literal notranslate"><span class="pre">.svg</span></code>。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>对于 PDF，可以通过修改页面的 CropBox 来规避“仅支持完整页面图像”的限制。</p>
</div>
</dd></dl>

<span class="target" id="index-27"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.get_pixmap">
<span class="sig-name descname"><span class="pre">get_pixmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pymupdf.Identity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorspace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">pymupdf.csRGB</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.get_pixmap" title="永久链接至目标">#</a></dt>
<dd><p>从页面创建一个 Pixmap。这可能是最常用的方法之一，用于生成 <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a>。</p>
<p>所有参数均为 <em>仅限关键字参数</em>。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> (<em>matrix_like</em>) – 变换矩阵，默认值为 <a class="reference internal" href="identity.html#identity"><span class="std std-ref">Identity</span></a>。</p></li>
<li><p><strong>dpi</strong> (<em>int</em>) – 期望的 x 和 y 方向的分辨率。如果不为 <code class="xref any docutils literal notranslate"><span class="pre">None</span></code>，则 <code class="xref any docutils literal notranslate"><span class="pre">&quot;matrix&quot;</span></code> 参数将被忽略。（新增于 v1.19.2）</p></li>
<li><p><strong>colorspace</strong> (str 或 <a class="reference internal" href="colorspace.html#colorspace"><span class="std std-ref">Colorspace</span></a>) – 期望的颜色空间，可以是 <code class="xref any docutils literal notranslate"><span class="pre">&quot;GRAY&quot;</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">&quot;RGB&quot;</span></code> 或 <code class="xref any docutils literal notranslate"><span class="pre">&quot;CMYK&quot;</span></code> （不区分大小写）。或者指定一个 <a class="reference internal" href="colorspace.html#colorspace"><span class="std std-ref">Colorspace</span></a>，即预定义的颜色空间之一：<a class="reference internal" href="vars.html#csGRAY" title="csGRAY"><code class="xref py py-data docutils literal notranslate"><span class="pre">csGRAY</span></code></a>、<a class="reference internal" href="vars.html#csRGB" title="csRGB"><code class="xref py py-data docutils literal notranslate"><span class="pre">csRGB</span></code></a> 或 <a class="reference internal" href="vars.html#csCMYK" title="csCMYK"><code class="xref py py-data docutils literal notranslate"><span class="pre">csCMYK</span></code></a>。</p></li>
<li><p><strong>clip</strong> (<em>irect_like</em>) – 仅渲染与页面矩形相交的区域。</p></li>
<li><p><strong>alpha</strong> (<em>bool</em>) – <p>是否添加 alpha 通道。如果不需要透明度，建议保持默认值 <code class="docutils literal notranslate"><span class="pre">False</span></code>，这样可以节省大量内存（RGB 情况下减少 25%）并加快处理速度。此外，这一参数会影响图像的渲染方式:</p>
<ul>
<li><p>设为 <code class="docutils literal notranslate"><span class="pre">True</span></code> 时，Pixmap 采样区域的预清理值为 <em>0x00</em>，即页面空白区域将呈现 <strong>透明</strong>。</p></li>
<li><p>设为 <code class="docutils literal notranslate"><span class="pre">False</span></code> 时，Pixmap 采样区域的预清理值为 <em>0xff</em>，即页面空白区域将呈现 <strong>白色</strong>。</p></li>
</ul>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<p>变更于 v1.14.17
默认 <a class="reference internal" href="pixmap.html#Pixmap.alpha" title="Pixmap.alpha"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">alpha</span></code></a> 值现在为 <code class="docutils literal notranslate"><span class="pre">False</span></code>。</p>
<ul>
<li><p>使用 <code class="xref any docutils literal notranslate"><span class="pre">alpha=True</span></code> 生成的图像：</p></li>
</ul>
<img alt="_images/img-alpha-1.png" src="_images/img-alpha-1.png" /><ul>
<li><p>使用 <code class="xref any docutils literal notranslate"><span class="pre">alpha=False</span></code> 生成的图像：</p></li>
</ul>
<img alt="_images/img-alpha-0.png" src="_images/img-alpha-0.png" /><p></small></details></p>
</p></li>
<li><p><strong>annots</strong> (<em>bool</em>) – <em>(新增于 v1.16.0)</em> 是否同时渲染注释，默认值为 <code class="xref any docutils literal notranslate"><span class="pre">True</span></code>。可以单独为注释创建 Pixmap。</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>该页面的 Pixmap。控制生成图像的最重要参数是 <strong>matrix</strong>。例如，可以使用 <strong>Matrix(xzoom, yzoom)</strong> 调整图像分辨率。<code class="xref any docutils literal notranslate"><span class="pre">zoom</span> <span class="pre">&gt;</span> <span class="pre">1</span></code> 将提高分辨率，例如 <code class="xref any docutils literal notranslate"><span class="pre">zoom=2</span></code> 会使图像在该方向上像素数量翻倍，从而生成 2 倍大小的图像。非正值会水平或垂直翻转。此外，矩阵还可用于旋转、倾斜，并且可以通过矩阵乘法组合多个效果。更多详情请参阅 <a class="reference internal" href="matrix.html#matrix"><span class="std std-ref">Matrix</span></a> 章节。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ul>
<li><p>如果 <code class="xref any docutils literal notranslate"><span class="pre">alpha=True</span></code>，生成的 Pixmap 将使用 <em>“预乘”</em> 像素。有关背景知识，可参考 <a class="reference external" href="https://en.wikipedia.org/wiki/Glossary_of_computer_graphics#P">预乘 Alpha 通道</a>。</p></li>
<li><p>此方法会考虑页面旋转，并不会超出 <code class="xref any docutils literal notranslate"><span class="pre">clip</span></code> 和 <a class="reference internal" href="#Page.cropbox" title="Page.cropbox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.cropbox</span></code></a> 的交集范围。如果需要页面的 <a class="reference internal" href="#Page.mediabox" title="Page.mediabox"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">mediabox</span></code></a> （并且它不同于 <a class="reference internal" href="#Page.cropbox" title="Page.cropbox"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">cropbox</span></code></a> ），可以使用以下代码片段:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;demo1.pdf&quot;</span><span class="p">)</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">rotation</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">rotation</span>
<span class="n">cropbox</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">cropbox</span>
<span class="n">page</span><span class="o">.</span><span class="n">set_cropbox</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">mediabox</span><span class="p">)</span>
<span class="n">page</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">pix</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_pixmap</span><span class="p">()</span>
<span class="n">page</span><span class="o">.</span><span class="n">set_cropbox</span><span class="p">(</span><span class="n">cropbox</span><span class="p">)</span>
<span class="k">if</span> <span class="n">rotation</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
   <span class="n">page</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>变更于 v1.19.2：新增对 <code class="xref any docutils literal notranslate"><span class="pre">dpi</span></code> 参数的支持。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.annot_names">
<span class="sig-name descname"><span class="pre">annot_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Page.annot_names" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：返回注释、小部件和链接的名称列表。从技术上讲，这些是页面的 <em>/Annots</em> 数组中每个 PDF 对象的 <em>/NM</em> 值。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.16.10</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.annot_xrefs">
<span class="sig-name descname"><span class="pre">annot_xrefs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Page.annot_xrefs" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：返回注释、小部件和链接的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 编号列表，即页面 <em>/Annots</em> 数组中的所有条目。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>包含 <em>(xref, type)</em> 元组的列表，其中 <a class="reference internal" href="annot.html#Annot.type" title="Annot.type"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">type</span></code></a> 是注释类型。可以使用 <a class="reference internal" href="annot.html#Annot.type" title="Annot.type"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">type</span></code></a> 来区分链接、表单字段和注释，详见 <a class="reference internal" href="vars.html#annotationtypes"><span class="std std-ref">注释类型</span></a>。</p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.17.1</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.load_annot">
<span class="sig-name descname"><span class="pre">load_annot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ident</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.load_annot" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：返回由 <em>ident</em> 标识的注释。<em>ident</em> 可以是其唯一名称（PDF <code class="xref any docutils literal notranslate"><span class="pre">/NM</span></code> 键）或 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ident</strong> (<em>str</em><em>,</em><em>int</em>) – 注释的名称或 xref 编号。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>该注释对象，若未找到则返回 <code class="docutils literal notranslate"><span class="pre">None</span></code>。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>方法 <a class="reference internal" href="#Page.annot_names" title="Page.annot_names"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.annot_names()</span></code></a> 和 <a class="reference internal" href="#Page.annot_xrefs" title="Page.annot_xrefs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.annot_xrefs()</span></code></a> 可分别提供名称或 xref 列表，可以使用这些方法获取标识符并通过本方法加载相应的注释。</p>
</div>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.17.1</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.load_widget">
<span class="sig-name descname"><span class="pre">load_widget</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xref</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.load_widget" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：返回由 <em>xref</em> 标识的表单字段。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xref</strong> (<em>int</em>) – 表单字段的 xref 编号。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="widget.html#widget"><span class="std std-ref">Widget</span></a></p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>该字段对象，若未找到则返回 <code class="docutils literal notranslate"><span class="pre">None</span></code>。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>该方法类似于 <a class="reference internal" href="#Page.load_annot" title="Page.load_annot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.load_annot()</span></code></a>，但仅支持使用 xref 作为标识符。</p>
</div>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.19.6</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.load_links">
<span class="sig-name descname"><span class="pre">load_links</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Page.load_links" title="永久链接至目标">#</a></dt>
<dd><p>返回页面上的第一个链接。本方法是属性 <a class="reference internal" href="#Page.first_link" title="Page.first_link"><code class="xref py py-attr docutils literal notranslate"><span class="pre">first_link</span></code></a> 的同义方法。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="link.html#link"><span class="std std-ref">Link</span></a></p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>页面上的第一个链接（或 <code class="docutils literal notranslate"><span class="pre">None</span></code>）。</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="index-28"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.set_rotation">
<span class="sig-name descname"><span class="pre">set_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rotate</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.set_rotation" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：设置页面的旋转角度。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rotate</strong> (<em>int</em>) – 以度为单位的旋转角度，必须是 90 的整数倍。该值会被转换为 0、90、180 或 270 之一。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.remove_rotation">
<span class="sig-name descname"><span class="pre">remove_rotation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Page.remove_rotation" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：将页面旋转角度重置为 0，同时保持外观和内容不变。</p>
<dl class="field-list simple">
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>进行此更改所使用的逆变换矩阵。如果页面未旋转（旋转角度为 0），则返回 <a class="reference internal" href="identity.html#identity"><span class="std std-ref">Identity</span></a>。该方法会自动重新计算页面上所有注释、链接和小部件的矩形区域。</p>
<p>该方法在使用 <a class="reference internal" href="#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> 时可能会派上用场。</p>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="index-29"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.show_pdf_page">
<span class="sig-name descname"><span class="pre">show_pdf_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">docsrc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pno</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_proportion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.show_pdf_page" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：在当前页面上以 <strong>矢量图像</strong> 形式显示另一个 PDF 的页面（功能类似于 <a class="reference internal" href="#Page.insert_image" title="Page.insert_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a>）。该方法用途广泛，例如：</p>
<ul class="simple">
<li><p>创建现有 PDF 文件的 “n-up” 版本，即将多个输入页面合并到 <strong>一个输出页面</strong> 中（示例： <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/combine-pages/combine.py">combine.py</a>），</p></li>
<li><p>创建 “海报化” PDF 文件，即将每个输入页面拆分为多个部分，每个部分分别生成一个输出页面（示例： <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/posterize-document/posterize.py">posterize.py</a>），</p></li>
<li><p>包含基于 PDF 的矢量图像，如公司徽标、水印等（示例： <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/examples/svg-logo.py">svg-logo.py</a>，该示例在每个页面上放置基于 SVG 的徽标，需要额外的软件包进行 SVG 到 PDF 的转换）。</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rect</strong> (<em>rect_like</em>) – 在当前页面上的放置位置。必须是有限矩形，并且与页面的交集不能为空。</p></li>
<li><p><strong>docsrc</strong> (<a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a>) – 包含要显示页面的源 PDF 文档。必须是不同的文档对象，但可以是相同的文件。</p></li>
<li><p><strong>pno</strong> (<em>int</em>) – 要显示的页码（从 0 开始，范围：<code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">docsrc.page_count</span></code>）。</p></li>
<li><p><strong>keep_proportion</strong> (<em>bool</em>) – 是否保持宽高比（默认值为 <code class="docutils literal notranslate"><span class="pre">True</span></code>）。如果设为 <code class="docutils literal notranslate"><span class="pre">False</span></code>，则所有四个角始终位于目标矩形的边界上，无论旋转值如何。这可能会导致图像变形或变为非矩形。</p></li>
<li><p><strong>overlay</strong> (<em>bool</em>) – 是否将图像置于前景（默认值）。若设为 <code class="docutils literal notranslate"><span class="pre">False</span></code> ，则图像将置于背景。</p></li>
<li><p><strong>oc</strong> (<em>int</em>) – (<a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>) 使显示依赖于此 <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> / <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a> （必须在目标 PDF 中定义） <a class="footnote-reference brackets" href="#f9" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a> 。（新增于 v1.18.3）</p></li>
<li><p><strong>rotate</strong> (<em>float</em>) – 旋转源矩形显示的角度。支持任意角度（在 v1.14.11 版本中更改）。（新增于 v1.14.10）</p></li>
<li><p><strong>clip</strong> (<em>rect_like</em>) – 指定要显示的源页面区域。默认为整个页面，否则必须是有限矩形，并且其与源页面的交集不能为空。</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>与方法 <a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a> 不同，此方法不会复制注释、小部件或链接，因此这些元素不会包含在目标页面中 <a class="footnote-reference brackets" href="#f6" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>。但页面的 <strong>其他资源（文本、图像、字体等）</strong> 都会被导入当前 PDF，因此它们仍然会出现在文本提取结果以及 <a class="reference internal" href="#Page.get_fonts" title="Page.get_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_fonts()</span></code></a> 和 <a class="reference internal" href="#Page.get_images" title="Page.get_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_images()</span></code></a> 列表中，即使它们不在由 <em>clip</em> 指定的可见区域内。</p>
</div>
<p>示例：在同一页面上显示相同的源页面，分别旋转 90 度和 -90 度:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>  <span class="c1"># 创建一个新的空 PDF</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span>  <span class="c1"># 新建一个 A4 页面</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 上半部分页面</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r1</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 下半部分页面</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">page</span><span class="o">.</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">src</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;PyMuPDF.pdf&quot;</span><span class="p">)</span>  <span class="c1"># 载入源 PDF</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">show_pdf_page</span><span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">show_pdf_page</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rotate</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;show.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/img-showpdfpage.jpg"><img alt="_images/img-showpdfpage.jpg" src="_images/img-showpdfpage.jpg" style="width: 280.0px; height: 395.5px;" /></a>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.14.11 版本更改：弃用参数 <em>reuse_xref</em>。源矩形在目标矩形内居中定位，并支持任意旋转角度。</p></li>
<li><p>v1.18.3 版本更改：新增参数 <code class="xref any docutils literal notranslate"><span class="pre">oc</span></code>。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.new_shape">
<span class="sig-name descname"><span class="pre">new_shape</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Page.new_shape" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：为当前页面创建一个新的 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a> 对象。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a></p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>一个新的 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a> 对象，用于复合绘图。详情请参考 <a class="reference internal" href="shape.html#shape"><span class="std std-ref">Shape</span></a> 说明。</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="index-30"></span><dl class="py method">
<dt class="sig sig-object py" id="Page.search_for">
<span class="sig-name descname"><span class="pre">search_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">needle</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">TEXT_DEHYPHENATE</span> <span class="pre">|</span> <span class="pre">TEXT_PRESERVE_WHITESPACE</span> <span class="pre">|</span> <span class="pre">TEXT_PRESERVE_LIGATURES</span> <span class="pre">|</span> <span class="pre">TEXT_MEDIABOX_CLIP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">textpage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.search_for" title="永久链接至目标">#</a></dt>
<dd><p>在页面上搜索 <em>needle</em>。此方法是 <a class="reference internal" href="textpage.html#TextPage.search" title="TextPage.search"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.search()</span></code></a> 的封装。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>needle</strong> (<em>str</em>) – 要搜索的文本，可包含空格。搜索不区分大小写，但仅适用于 ASCII 字符。例如，”COMPÉTENCES” 不会匹配 “compétences”，但可以匹配 “compÉtences”。德语变音符号等也遵循相同的规则。</p></li>
<li><p><strong>clip</strong> (<em>rect_like</em>) – 仅在此区域内搜索。（新增于 v1.18.2）</p></li>
<li><p><strong>quads</strong> (<em>bool</em>) – 是否返回 <a class="reference internal" href="quad.html#quad"><span class="std std-ref">Quad</span></a> 对象（默认返回 <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a>）。</p></li>
<li><p><strong>flags</strong> (<em>int</em>) – 控制底层 <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a> 的数据提取行为。默认情况下，保留连字和空格，并检测连字符 <a class="footnote-reference brackets" href="#f8" id="id10" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a>。</p></li>
<li><p><strong>textpage</strong> – 使用预先创建的 <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a> 对象，这可以显著减少执行时间。如果提供了此参数，则 <em>flags</em> 和 <em>clip</em> 参数将被忽略。如果未提供，将临时创建一个 <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a>。（新增于 v1.19.0）</p></li>
</ul>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p>返回一个 <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> 或 <a class="reference internal" href="quad.html#quad"><span class="std std-ref">Quad</span></a> 对象的列表，每个对象 <strong>通常</strong> 包围 <em>needle</em> 的一个匹配项。<strong>然而</strong>，如果 <em>needle</em> 分布在多行上，则每一部分都会单独返回。例如，如果 <code class="xref any docutils literal notranslate"><span class="pre">needle</span> <span class="pre">=</span> <span class="pre">&quot;search</span> <span class="pre">string&quot;</span></code>，则可能返回两个矩形。</p>
</dd>
</dl>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<p>v1.18.2 版本更新：</p>
<ul class="simple">
<li><p>取消了结果列表长度限制（移除 <code class="xref any docutils literal notranslate"><span class="pre">hit_max</span></code> 参数）。</p></li>
<li><p>支持跨行 <strong>连字符</strong> 匹配。例如，搜索 “method” 时，即使它在换行处被拆分为 “meth-od”，仍然可以找到，并返回两个矩形：一个围绕 “meth”（不包含连字符），另一个围绕 “od”。</p></li>
</ul>
<p></small></details></p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>该方法支持 <strong>多行文本标注</strong>，可将返回列表直接用作创建标注的参数。</p>
</div>
<div class="admonition caution">
<p class="admonition-title">小心</p>
<ul class="simple">
<li><p>该方法有一个特殊行为：连续多次出现的 <em>needle</em> 会被视为 <strong>一个</strong> 匹配项。例如，如果页面上有 “abc” 和 “abcabc”，则仅返回两个矩形，一个对应 “abc”，另一个对应 “abcabc”。</p></li>
<li><p>可使用 <a class="reference internal" href="#Page.get_textbox" title="Page.get_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_textbox()</span></code></a> 检查每个矩形实际包含的文本。</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>该方法 <strong>不支持正则表达式</strong> 进行搜索。如需类似功能，可先提取文本，再使用正则表达式进行匹配。例如，匹配单词的方法如下:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;...&quot;</span><span class="p">)</span>  <span class="c1"># 定义正则表达式模式</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">words</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="s2">&quot;words&quot;</span><span class="p">)</span>  <span class="c1"># 提取页面上的单词</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matches</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span> <span class="k">if</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="mi">4</span><span class="p">])]</span>
</pre></div>
</div>
<p><code class="xref any docutils literal notranslate"><span class="pre">matches</span></code> 列表将包含所有匹配正则表达式的单词。同理，可以从 <code class="xref any docutils literal notranslate"><span class="pre">page.get_text(&quot;dict&quot;)</span></code> 输出的 <code class="xref any docutils literal notranslate"><span class="pre">span[&quot;text&quot;]</span></code> 中筛选匹配项。</p>
</div>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>v1.18.2 版本更新：新增 <code class="xref any docutils literal notranslate"><span class="pre">clip</span></code> 参数，移除 <code class="xref any docutils literal notranslate"><span class="pre">hit_max</span></code> 参数，默认启用“去连字符”功能。</p></li>
<li><p>v1.19.0 版本更新：新增 <a class="reference internal" href="textpage.html"><span class="doc">TextPage</span></a> 参数。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.set_mediabox">
<span class="sig-name descname"><span class="pre">set_mediabox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.set_mediabox" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：通过修改页面对象的 <a class="reference internal" href="#Page.mediabox" title="Page.mediabox"><code class="xref py py-data docutils literal notranslate"><span class="pre">mediabox</span></code></a> 来更改页面的物理尺寸。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> (<em>rect_like</em>) – 要设置的新 <a class="reference internal" href="#Page.mediabox" title="Page.mediabox"><code class="xref py py-data docutils literal notranslate"><span class="pre">mediabox</span></code></a> 值。</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>此方法会移除页面的所有其他（可选）矩形定义（如 <a class="reference internal" href="#Page.cropbox" title="Page.cropbox"><code class="xref py py-data docutils literal notranslate"><span class="pre">cropbox</span></code></a>、ArtBox、TrimBox 和 BleedBox），以防止不一致的情况。这些矩形将恢复默认值。</p>
</div>
<div class="admonition caution">
<p class="admonition-title">小心</p>
<p>对于非空页面，调整 <a class="reference internal" href="#Page.mediabox" title="Page.mediabox"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">mediabox</span></code></a> 可能会产生意外效果。因为所有内容的位置都依赖于此值，修改后可能导致内容偏移甚至消失。</p>
</div>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.16.13</p></li>
<li><p>v1.19.4 版本更新：移除所有其他矩形定义。</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.set_cropbox">
<span class="sig-name descname"><span class="pre">set_cropbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.set_cropbox" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：更改页面的可见部分。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> (<em>rect_like</em>) – 页面新的可见区域。注意，这 <strong>必须</strong> 以 <strong>未旋转坐标</strong> 指定，且不能为空或无限，必须完全包含在 <a class="reference internal" href="#Page.mediabox" title="Page.mediabox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.mediabox</span></code></a> 中。</p>
</dd>
</dl>
<p>执行后 <strong>（如果页面未旋转）</strong>， <a class="reference internal" href="#Page.rect" title="Page.rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rect</span></code></a> 将等于此矩形，但如果需要，会将其移动到左上角（0, 0）的位置。示例：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">rect</span>
<span class="go">pymupdf.Rect(0.0, 0.0, 595.0, 842.0)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">cropbox</span>  <span class="c1"># cropbox 和 mediabox 相等</span>
<span class="go">pymupdf.Rect(0.0, 0.0, 595.0, 842.0)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 现在将 cropbox 设置为页面的一部分</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">set_cropbox</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="n">Rect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 这也会改变 &quot;rect&quot; 属性：</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">rect</span>
<span class="go">pymupdf.Rect(0.0, 0.0, 300.0, 300.0)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 但 mediabox 保持不变</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">mediabox</span>
<span class="go">pymupdf.Rect(0.0, 0.0, 595.0, 842.0)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 恢复 CropBox 更改</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 可以将其设置为 MediaBox</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">set_cropbox</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">mediabox</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 或通过“刷新” MediaBox：将移除所有其他矩形</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">set_mediabox</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">mediabox</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.set_artbox">
<span class="sig-name descname"><span class="pre">set_artbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.set_artbox" title="永久链接至目标">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.set_bleedbox">
<span class="sig-name descname"><span class="pre">set_bleedbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.set_bleedbox" title="永久链接至目标">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Page.set_trimbox">
<span class="sig-name descname"><span class="pre">set_trimbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Page.set_trimbox" title="永久链接至目标">#</a></dt>
<dd><p>仅适用于 PDF：在页面对象中设置相应的矩形。有关这些对象的意义，请参见 <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a>，第 77 页。参数和限制与 <a class="reference internal" href="#Page.set_cropbox" title="Page.set_cropbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.set_cropbox()</span></code></a> 相同。</p>
<p><details>
<summary><small style="cursor:pointer;">Show/hide history</small></summary><small></p>
<ul class="simple">
<li><p>新增于 v1.19.4</p></li>
</ul>
<p></small></details></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.rotation">
<span class="sig-name descname"><span class="pre">rotation</span></span><a class="headerlink" href="#Page.rotation" title="永久链接至目标">#</a></dt>
<dd><p>包含页面的旋转角度（对于非 PDF 类型始终为 0）。这是 PDF 文件中该值的副本。PDF 文档中说明：</p>
<blockquote>
<div><p><em>“页面显示或打印时应该顺时针旋转的度数。该值必须是 90 的倍数。默认值：0。”</em></p>
<p>在 PyMuPDF 中，我们确保此属性始终为 0、90、180 或 270 其中之一。</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.cropbox_position">
<span class="sig-name descname"><span class="pre">cropbox_position</span></span><a class="headerlink" href="#Page.cropbox_position" title="永久链接至目标">#</a></dt>
<dd><p>包含页面 <code class="xref any docutils literal notranslate"><span class="pre">/CropBox</span></code> 的左上角点（仅适用于 PDF），否则为 <em>Point(0, 0)</em>。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.cropbox">
<span class="sig-name descname"><span class="pre">cropbox</span></span><a class="headerlink" href="#Page.cropbox" title="永久链接至目标">#</a></dt>
<dd><p>页面 <code class="xref any docutils literal notranslate"><span class="pre">/CropBox</span></code> （仅适用于 PDF）。始终返回 <strong>未旋转</strong> 的页面矩形。对于非 PDF 类型，这将始终等于页面矩形。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>在 PDF 中，<code class="xref any docutils literal notranslate"><span class="pre">/MediaBox</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">/CropBox</span></code> 和页面矩形之间的关系有时可能会令人困惑，请查阅词汇表中的 <a class="reference internal" href="glossary.html#MediaBox" title="MediaBox"><code class="xref py py-data docutils literal notranslate"><span class="pre">MediaBox</span></code></a>。</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.artbox">
<span class="sig-name descname"><span class="pre">artbox</span></span><a class="headerlink" href="#Page.artbox" title="永久链接至目标">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.bleedbox">
<span class="sig-name descname"><span class="pre">bleedbox</span></span><a class="headerlink" href="#Page.bleedbox" title="永久链接至目标">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.trimbox">
<span class="sig-name descname"><span class="pre">trimbox</span></span><a class="headerlink" href="#Page.trimbox" title="永久链接至目标">#</a></dt>
<dd><p>页面 <code class="xref any docutils literal notranslate"><span class="pre">/ArtBox</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">/BleedBox</span></code>、<code class="xref any docutils literal notranslate"><span class="pre">/TrimBox</span></code>，如果没有提供，则默认为 <a class="reference internal" href="#Page.cropbox" title="Page.cropbox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.cropbox</span></code></a>。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.mediabox_size">
<span class="sig-name descname"><span class="pre">mediabox_size</span></span><a class="headerlink" href="#Page.mediabox_size" title="永久链接至目标">#</a></dt>
<dd><p>包含页面 <a class="reference internal" href="#Page.mediabox" title="Page.mediabox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.mediabox</span></code></a> 的宽度和高度（仅适用于 PDF），否则是 <a class="reference internal" href="#Page.rect" title="Page.rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rect</span></code></a> 的右下角坐标。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.mediabox">
<span class="sig-name descname"><span class="pre">mediabox</span></span><a class="headerlink" href="#Page.mediabox" title="永久链接至目标">#</a></dt>
<dd><p>页面 <a class="reference internal" href="#Page.mediabox" title="Page.mediabox"><code class="xref py py-data docutils literal notranslate"><span class="pre">mediabox</span></code></a> （仅适用于 PDF），否则为 <a class="reference internal" href="#Page.rect" title="Page.rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.rect</span></code></a>。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>对于大多数 PDF 文档和 <strong>所有其他文档类型</strong>， <code class="xref any docutils literal notranslate"><span class="pre">page.rect</span> <span class="pre">==</span> <span class="pre">page.cropbox</span> <span class="pre">==</span> <span class="pre">page.mediabox</span></code> 为真。然而，对于某些 PDF，页面的可见部分是真正的 <a class="reference internal" href="#Page.mediabox" title="Page.mediabox"><code class="xref py py-data docutils literal notranslate"><span class="pre">mediabox</span></code></a> 的子集。此外，如果页面已旋转，则其 <a class="reference internal" href="#Page.rect" title="Page.rect"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">Page.rect</span></code></a> 可能不等于 <a class="reference internal" href="#Page.cropbox" title="Page.cropbox"><code class="xref any py py-attr docutils literal notranslate"><span class="pre">Page.cropbox</span></code></a>。在这些情况下，上述属性有助于正确定位页面元素。</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.transformation_matrix">
<span class="sig-name descname"><span class="pre">transformation_matrix</span></span><a class="headerlink" href="#Page.transformation_matrix" title="永久链接至目标">#</a></dt>
<dd><p>该矩阵将 PDF 空间中的坐标转换为 MuPDF 空间中的坐标。例如，在 PDF 中， <code class="xref any docutils literal notranslate"><span class="pre">/Rect</span> <span class="pre">[x0</span> <span class="pre">y0</span> <span class="pre">x1</span> <span class="pre">y1]</span></code> 中的 (x0, y0) 指定矩形的 <strong>左下角</strong> 点 – 与 MuPDF 的系统相对，在该系统中，(x0, y0) 指定的是左上角。将 PDF 坐标与此矩阵相乘将得到 (Py-) MuPDF 矩形版本。显然，逆矩阵将再次得出 PDF 矩形。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="matrix.html#matrix"><span class="std std-ref">Matrix</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.rotation_matrix">
<span class="sig-name descname"><span class="pre">rotation_matrix</span></span><a class="headerlink" href="#Page.rotation_matrix" title="永久链接至目标">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.derotation_matrix">
<span class="sig-name descname"><span class="pre">derotation_matrix</span></span><a class="headerlink" href="#Page.derotation_matrix" title="永久链接至目标">#</a></dt>
<dd><p>这些矩阵可用于处理旋转的 PDF 页面。当向 PDF 页面添加/插入任何内容时，始终使用 <strong>未旋转</strong> 页面上的坐标。这些矩阵有助于在两种状态之间转换。例如，如果页面旋转了 90 度 – 那么一个 A4 页面的左上角点 (0, 0) 会位于何处？</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>  <span class="c1"># 旋转 ISO A4 页面</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span><span class="o">.</span><span class="n">rect</span>
<span class="go">Rect(0.0, 0.0, 842.0, 595.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># 左上角点到哪里去了？</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">*</span> <span class="n">page</span><span class="o">.</span><span class="n">rotation_matrix</span>
<span class="go">Point(842.0, 0.0)</span>
<span class="gp">&gt;&gt;&gt;</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="matrix.html#matrix"><span class="std std-ref">Matrix</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.first_link">
<span class="sig-name descname"><span class="pre">first_link</span></span><a class="headerlink" href="#Page.first_link" title="永久链接至目标">#</a></dt>
<dd><p>包含页面的第一个 <a class="reference internal" href="link.html#link"><span class="std std-ref">Link</span></a> （如果没有，则为 <code class="docutils literal notranslate"><span class="pre">None</span></code> ）。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="link.html#link"><span class="std std-ref">Link</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.first_annot">
<span class="sig-name descname"><span class="pre">first_annot</span></span><a class="headerlink" href="#Page.first_annot" title="永久链接至目标">#</a></dt>
<dd><p>包含页面的第一个 <a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a> （如果没有，则为 <code class="docutils literal notranslate"><span class="pre">None</span></code> ）。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.first_widget">
<span class="sig-name descname"><span class="pre">first_widget</span></span><a class="headerlink" href="#Page.first_widget" title="永久链接至目标">#</a></dt>
<dd><p>包含页面的第一个 <a class="reference internal" href="widget.html#widget"><span class="std std-ref">Widget</span></a> （如果没有，则为 <code class="docutils literal notranslate"><span class="pre">None</span></code> ）。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="widget.html#widget"><span class="std std-ref">Widget</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.number">
<span class="sig-name descname"><span class="pre">number</span></span><a class="headerlink" href="#Page.number" title="永久链接至目标">#</a></dt>
<dd><p>页面编号。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><a class="headerlink" href="#Page.parent" title="永久链接至目标">#</a></dt>
<dd><p>拥有该页面的文档对象。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.rect">
<span class="sig-name descname"><span class="pre">rect</span></span><a class="headerlink" href="#Page.rect" title="永久链接至目标">#</a></dt>
<dd><p>包含页面的矩形。与 <a class="reference internal" href="#Page.bound" title="Page.bound"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.bound()</span></code></a> 的结果相同。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Page.xref">
<span class="sig-name descname"><span class="pre">xref</span></span><a class="headerlink" href="#Page.xref" title="永久链接至目标">#</a></dt>
<dd><p>页面在 PDF 中的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a>。如果不是 PDF，则为零。</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a></p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">英文</label><div class="tab-content docutils container">
</div>
</div>
<hr class="docutils" />
</section>
<section id="get-links">
<span id="link-dict-description"></span><h2><em>get_links()</em> 条目的描述<a class="headerlink" href="#get-links" title="此标题的永久链接">#</a></h2>
<p>Description of <em>get_links()</em> Entries</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">中文</label><div class="tab-content docutils container">
<p><a class="reference internal" href="#Page.get_links" title="Page.get_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_links()</span></code></a> 方法返回的列表中，每个条目都是一个包含以下键的字典：</p>
<ul class="simple">
<li><p><em>kind</em> （必需）: 一个整数，指示链接的类型。可能的值包括 <em>LINK_NONE</em>、<em>LINK_GOTO</em>、<em>LINK_GOTOR</em>、<em>LINK_LAUNCH</em> 或 <em>LINK_URI</em>。有关这些名称的值和含义，请参阅 <a class="reference internal" href="vars.html#linkdest-kinds"><span class="std std-ref">链接目标类型</span></a>。</p></li>
<li><p><em>from</em> （必需）: 一个 <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> 对象，描述页面上可见区域的 “热区”（通常鼠标悬停时会变成手型指针）。</p></li>
</ul>
</div>
</div>
<ul>
<li><ul class="simple">
<li><p><em>page</em>: 一个从 0 开始的整数，表示目标页面。对于 <em>LINK_GOTO</em> 和 <em>LINK_GOTOR</em> 链接类型，此字段为必需项，否则会被忽略。</p></li>
<li><p><em>to</em>: 目标位置，可以是：</p></li>
</ul>
<ul class="simple">
<li><p>一个 <em>pymupdf.Point</em>，表示目标页面上的具体位置（默认为 <em>pymupdf.Point(0, 0)</em>）。</p></li>
<li><p>一个符号名称（间接名称）。如果使用符号名称，则必须设置 <em>page = -1</em>，且该名称必须在 PDF 文件中定义，否则无法正确解析。</p></li>
</ul>
<p>此字段适用于 <em>LINK_GOTO</em> 和 <em>LINK_GOTOR</em> 类型的链接，否则会被忽略。</p>
<ul class="simple">
<li><p><em>file</em>: 一个字符串，指定目标文件路径。适用于 <em>LINK_GOTOR</em> 和 <em>LINK_LAUNCH</em> 类型的链接，否则会被忽略。</p></li>
<li><p><em>uri</em>: 一个字符串，指定目标互联网资源。适用于 <em>LINK_URI</em> 类型的链接，否则会被忽略。请确保该字符串以明确的协议前缀开头，如 <code class="xref any docutils literal notranslate"><span class="pre">&quot;http://&quot;</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">&quot;https://&quot;</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">&quot;file://&quot;</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">&quot;ftp://&quot;</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">&quot;mailto:&quot;</span></code> 等，否则浏览器可能会错误地解释 URL 类型。</p></li>
<li><p><em>xref</em>: 一个整数，指定该链接对象在 PDF 文件中的 <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 号。请勿修改此字段，它用于删除或更新链接。如果是非 PDF 文档，该字段的值为 <em>-1</em>。如果 <em>get_links()</em> 方法返回的列表中 <strong>任何</strong> 链接类型不受 MuPDF 支持，则该列表中的所有 <em>xref</em> 值都将为 <em>-1</em>，详见 <a class="reference internal" href="#notes-on-supporting-links"><span class="std std-ref">支持链接的说明</span></a>。</p></li>
</ul>
</li>
</ul>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">英文</label><div class="tab-content docutils container">
<p>Each entry of the <a class="reference internal" href="#Page.get_links" title="Page.get_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_links()</span></code></a> list is a dictionary with the following keys:</p>
<ul class="simple">
<li><p><em>kind</em>:  (required) an integer indicating the kind of link. This is one of <em>LINK_NONE</em>, <em>LINK_GOTO</em>, <em>LINK_GOTOR</em>, <em>LINK_LAUNCH</em>, or <em>LINK_URI</em>. For values and meaning of these names refer to <a class="reference internal" href="vars.html#linkdest-kinds"><span class="std std-ref">链接目标类型</span></a>.</p></li>
<li><p><em>from</em>:  (required) a <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a> describing the “hot spot” location on the page’s visible representation (where the cursor changes to a hand image, usually).</p></li>
<li><p><em>page</em>:  a 0-based integer indicating the destination page. Required for <em>LINK_GOTO</em> and <em>LINK_GOTOR</em>, else ignored.</p></li>
<li><p><em>to</em>:   either a <em>pymupdf.Point</em>, specifying the destination location on the provided page, default is <em>pymupdf.Point(0, 0)</em>, or a symbolic (indirect) name. If an indirect name is specified, <em>page = -1</em> is required and the name must be defined in the PDF in order for this to work. Required for <em>LINK_GOTO</em> and <em>LINK_GOTOR</em>, else ignored.</p></li>
<li><p><em>file</em>: a string specifying the destination file. Required for <em>LINK_GOTOR</em> and <em>LINK_LAUNCH</em>, else ignored.</p></li>
<li><p><em>uri</em>:  a string specifying the destination internet resource. Required for <em>LINK_URI</em>, else ignored. You should make sure to start this string with an unambiguous substring, that classifies the subtype of the URL, like <code class="xref any docutils literal notranslate"><span class="pre">&quot;http://&quot;</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">&quot;https://&quot;</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">&quot;file://&quot;</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">&quot;ftp://&quot;</span></code>, <code class="xref any docutils literal notranslate"><span class="pre">&quot;mailto:&quot;</span></code>, etc. Otherwise your browser will try to interpret the text and come to unwanted / unexpected conclusions about the intended URL type.</p></li>
<li><p><em>xref</em>: an integer specifying the PDF <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> of the link object. Do not change this entry in any way. Required for link deletion and update, otherwise ignored. For non-PDF documents, this entry contains <em>-1</em>. It is also <em>-1</em> for <strong>all</strong> entries in the <em>get_links()</em> list, if <strong>any</strong> of the links is not supported by MuPDF - see <a class="reference internal" href="#notes-on-supporting-links"><span class="std std-ref">支持链接的说明</span></a>.</p></li>
</ul>
</div>
</div>
</section>
<section id="notes-on-supporting-links">
<span id="id11"></span><h2>支持链接的说明<a class="headerlink" href="#notes-on-supporting-links" title="此标题的永久链接">#</a></h2>
<p>Notes on Supporting Links</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">中文</label><div class="tab-content docutils container">
<p>MuPDF 对链接的支持在 <strong>v1.10a</strong> 版本中发生了变化。这些更改影响了链接类型 <a class="reference internal" href="vars.html#LINK_GOTO" title="LINK_GOTO"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_GOTO</span></code></a> 和 <a class="reference internal" href="vars.html#LINK_GOTOR" title="LINK_GOTOR"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_GOTOR</span></code></a>。</p>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">英文</label><div class="tab-content docutils container">
<p>MuPDF’s support for links has changed in <strong>v1.10a</strong>. These changes affect link types <a class="reference internal" href="vars.html#LINK_GOTO" title="LINK_GOTO"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_GOTO</span></code></a> and <a class="reference internal" href="vars.html#LINK_GOTOR" title="LINK_GOTOR"><code class="xref py py-data docutils literal notranslate"><span class="pre">LINK_GOTOR</span></code></a>.</p>
</div>
</div>
<section id="get-links-first-link">
<h3>读取（涉及方法 <em>get_links()</em> 和 <em>first_link</em> 属性链）<a class="headerlink" href="#get-links-first-link" title="此标题的永久链接">#</a></h3>
<p>Reading (pertains to method <em>get_links()</em> and the <em>first_link</em> property chain)</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">中文</label><div class="tab-content docutils container">
<p>如果 MuPDF 检测到指向另一个文件的链接，它会提供 <em>LINK_GOTOR</em> 或 <em>LINK_LAUNCH</em> 类型的链接。对于 <em>LINK_GOTOR</em> 类型的链接，其目标可以是具体的页码（可能包括位置信息），或者是一个间接目标。</p>
<p>如果目标是间接目标，则该链接的 <em>page</em> 值将被设置为 <code class="xref any docutils literal notranslate"><span class="pre">-1</span></code>，而 <em>link.dest.dest</em> 将包含该目标名称。在 <em>get_links()</em> 返回的字典列表中，该信息将作为 <em>to</em> 值提供。</p>
<p><strong>内部链接始终</strong> 为 <em>LINK_GOTO</em> 类型。如果内部链接指定了间接目标，它 <strong>将始终被解析</strong>，并返回解析后的直接目标。对于内部链接，<strong>不会返回目标名称</strong>，如果目标未定义，该链接将被忽略。</p>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">英文</label><div class="tab-content docutils container">
<p>If MuPDF detects a link to another file, it will supply either a <em>LINK_GOTOR</em> or a <em>LINK_LAUNCH</em> link kind. In case of <em>LINK_GOTOR</em> destination details may either be given as page number (eventually including position information), or as an indirect destination.</p>
<p>If an indirect destination is given, then this is indicated by <em>page = -1</em>, and <em>link.dest.dest</em> will contain this name. The dictionaries in the <em>get_links()</em> list will contain this information as the <em>to</em> value.</p>
<p><strong>Internal links are always</strong> of kind <em>LINK_GOTO</em>. If an internal link specifies an indirect destination, it <strong>will always be resolved</strong> and the resulting direct destination will be returned. Names are <strong>never returned for internal links</strong>, and undefined destinations will cause the link to be ignored.</p>
</div>
</div>
</section>
<section id="id12">
<h3>写入<a class="headerlink" href="#id12" title="此标题的永久链接">#</a></h3>
<p>Writing</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">中文</label><div class="tab-content docutils container">
<p>PyMuPDF 通过构造并写入适当的 PDF 对象 <strong>源</strong> 来写入（更新、插入）链接。这使得可以为 <em>LINK_GOTOR</em> <strong>和</strong> <em>LINK_GOTO</em> 类型的链接指定间接目标（不支持 <em>PDF 1.2</em> 之前的文件格式）。</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>如果 <em>LINK_GOTO</em> 链接的间接目标指定了一个未定义的名称，则该链接在 MuPDF / PyMuPDF 中将无法再次被找到 / 读取。然而，其他 PDF 阅读器 <strong>可以</strong> 识别它，但会将其标记为错误。</p>
<p>由于间接 <em>LINK_GOTOR</em> 目标通常无法进行有效性检查，因此 <strong>始终被接受</strong>。</p>
</div>
<p><strong>示例：如何插入指向同一文档中另一页的链接</strong></p>
<ol class="arabic simple">
<li><p>确定当前页面上链接应放置的矩形区域。这可以是图像的边界框（bbox）或某些文本的位置。</p></li>
<li><p>确定目标页码（”pno”，从 0 开始）及其上的一个 <a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a>，该链接应指向该点。</p></li>
<li><p>创建字典 <code class="xref any docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">{&quot;kind&quot;:</span> <span class="pre">pymupdf.LINK_GOTO,</span> <span class="pre">&quot;page&quot;:</span> <span class="pre">pno,</span> <span class="pre">&quot;from&quot;:</span> <span class="pre">bbox,</span> <span class="pre">&quot;to&quot;:</span> <span class="pre">point}</span></code>。</p></li>
<li><p>执行 <code class="xref any docutils literal notranslate"><span class="pre">page.insert_link(d)</span></code> 以插入链接。</p></li>
</ol>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">英文</label><div class="tab-content docutils container">
<p>PyMuPDF writes (updates, inserts) links by constructing and writing the appropriate PDF object <strong>source</strong>. This makes it possible to specify indirect destinations for <em>LINK_GOTOR</em> <strong>and</strong> <em>LINK_GOTO</em> link kinds (pre <em>PDF 1.2</em> file formats are <strong>not supported</strong>).</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>If a <em>LINK_GOTO</em> indirect destination specifies an undefined name, this link can later on not be found / read again with MuPDF / PyMuPDF. Other readers however <strong>will</strong> detect it, but flag it as erroneous.</p>
</div>
<p>Indirect <em>LINK_GOTOR</em> destinations can in general of course not be checked for validity and are therefore <strong>always accepted</strong>.</p>
<p><strong>Example: How to insert a link pointing to another page in the same document</strong></p>
<ol class="arabic simple">
<li><p>Determine the rectangle on the current page, where the link should be placed. This may be the bbox of an image or some text.</p></li>
<li><p>Determine the target page number (“pno”, 0-based) and a <a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a> on it, where the link should be directed to.</p></li>
<li><p>Create a dictionary <code class="xref any docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">{&quot;kind&quot;:</span> <span class="pre">pymupdf.LINK_GOTO,</span> <span class="pre">&quot;page&quot;:</span> <span class="pre">pno,</span> <span class="pre">&quot;from&quot;:</span> <span class="pre">bbox,</span> <span class="pre">&quot;to&quot;:</span> <span class="pre">point}</span></code>.</p></li>
<li><p>Execute <code class="xref any docutils literal notranslate"><span class="pre">page.insert_link(d)</span></code>.</p></li>
</ol>
</div>
</div>
</section>
</section>
<section id="document-page">
<h2><a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> 和 <a class="reference internal" href="#page"><span class="std std-ref">Page</span></a> 的同源方法<a class="headerlink" href="#document-page" title="此标题的永久链接">#</a></h2>
<p>Homologous Methods of <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> and <a class="reference internal" href="#page"><span class="std std-ref">Page</span></a></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">中文</label><div class="tab-content docutils container">
<p>这是 <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> 级别和 <a class="reference internal" href="#page"><span class="std std-ref">Page</span></a> 级别上同源方法的概览。</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Document 级别</strong></p></th>
<th class="head"><p><strong>Page 级别</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>Document.get_page_fonts(pno)</em></p></td>
<td><p><a class="reference internal" href="#Page.get_fonts" title="Page.get_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_fonts()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><em>Document.get_page_images(pno)</em></p></td>
<td><p><a class="reference internal" href="#Page.get_images" title="Page.get_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_images()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><em>Document.get_page_pixmap(pno, …)</em></p></td>
<td><p><a class="reference internal" href="#Page.get_pixmap" title="Page.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_pixmap()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><em>Document.get_page_text(pno, …)</em></p></td>
<td><p><a class="reference internal" href="#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><em>Document.search_page_for(pno, …)</em></p></td>
<td><p><a class="reference internal" href="#Page.search_for" title="Page.search_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.search_for()</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
<p>其中，页码 “pno” 是一个以 0 为基准的整数，范围 <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>大多数文档方法（左列）仅用于提供便利，实际上只是对 <code class="xref any docutils literal notranslate"><span class="pre">Document[pno].</span></code> 的封装。因此，每次执行时都会 <strong>加载并丢弃页面</strong>。</p>
<p>然而，前两种方法的行为有所不同。它们仅需要页面的对象定义语句，而 <strong>不会</strong> 加载页面。例如，<a class="reference internal" href="#Page.get_fonts" title="Page.get_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_fonts()</span></code></a> 反向封装了 <code class="xref any docutils literal notranslate"><span class="pre">Document.get_page_fonts(pno)</span></code>，其定义如下：<em>page.get_fonts == page.parent.get_page_fonts(page.number)</em>。</p>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">英文</label><div class="tab-content docutils container">
<p>This is an overview of homologous methods on the <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> and on the <a class="reference internal" href="#page"><span class="std std-ref">Page</span></a> level.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Document Level</strong></p></th>
<th class="head"><p><strong>Page Level</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>Document.get_page_fonts(pno)</em></p></td>
<td><p><a class="reference internal" href="#Page.get_fonts" title="Page.get_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_fonts()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><em>Document.get_page_images(pno)</em></p></td>
<td><p><a class="reference internal" href="#Page.get_images" title="Page.get_images"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_images()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><em>Document.get_page_pixmap(pno, …)</em></p></td>
<td><p><a class="reference internal" href="#Page.get_pixmap" title="Page.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_pixmap()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><em>Document.get_page_text(pno, …)</em></p></td>
<td><p><a class="reference internal" href="#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><em>Document.search_page_for(pno, …)</em></p></td>
<td><p><a class="reference internal" href="#Page.search_for" title="Page.search_for"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.search_for()</span></code></a></p></td>
</tr>
</tbody>
</table>
</div>
<p>The page number “pno” is a 0-based integer <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Most document methods (left column) exist for convenience reasons, and are just wrappers for: <em>Document[pno].&lt;page method&gt;</em>. So they <strong>load and discard the page</strong> on each execution.</p>
<p>However, the first two methods work differently. They only need a page’s object definition statement - the page itself will <strong>not</strong> be loaded. So e.g. <a class="reference internal" href="#Page.get_fonts" title="Page.get_fonts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_fonts()</span></code></a> is a wrapper the other way round and defined as follows: <em>page.get_fonts == page.parent.get_page_fonts(page.number)</em>.</p>
</div>
</div>
</div>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="f1" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">1</a><span class="fn-bracket">]</span></span>
<p>If your existing code already uses the installed base name as a font reference (as it was supported by PyMuPDF versions earlier than 1.14), this will continue to work.</p>
</aside>
<aside class="footnote brackets" id="f2" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">2</a><span class="fn-bracket">]</span></span>
<p>Not all PDF reader software (including internet browsers and office software) display all of these fonts. And if they do, the difference between the <strong>serifed</strong> and the <strong>non-serifed</strong> version may hardly be noticeable. But serifed and non-serifed versions lead to different installed base fonts, thus providing an option to be displayable with your specific PDF viewer.</p>
</aside>
<aside class="footnote brackets" id="f3" role="note">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id4">1</a>,<a role="doc-backlink" href="#id5">2</a>)</span>
<p>Not all PDF readers display these fonts at all. Some others do, but use a wrong character spacing, etc.</p>
</aside>
<aside class="footnote brackets" id="f4" role="note">
<span class="label"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></span>
<p>You are generally free to choose any of the <a class="reference internal" href="annot.html#mupdficons"><span class="std std-ref">MuPDF 中的注释图标</span></a> you consider adequate.</p>
</aside>
<aside class="footnote brackets" id="f5" role="note">
<span class="label"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></span>
<p>The previous algorithm caused images to be <strong>shrunk</strong> to this intersection. Now the image can be anywhere on <a class="reference internal" href="#Page.mediabox" title="Page.mediabox"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Page.mediabox</span></code></a>, potentially being invisible or only partially visible if the cropbox (representing the visible page part) is smaller.</p>
</aside>
<aside class="footnote brackets" id="f6" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">6</a><span class="fn-bracket">]</span></span>
<p>If you need to also see annotations or fields in the target page, you can convert the source PDF using <a class="reference internal" href="document.html#Document.bake" title="Document.bake"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.bake()</span></code></a>. The underlying MuPDF function of that method will convert these objects to normal page content. Then use <a class="reference internal" href="#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a> with the converted PDF page.</p>
</aside>
<aside class="footnote brackets" id="f7" role="note">
<span class="label"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></span>
<p>In PDF, an area enclosed by some lines or curves can have a property called “orientation”. This is significant for switching on or off the fill color of that area when there exist multiple area overlaps - see discussion in method <a class="reference internal" href="shape.html#Shape.finish" title="Shape.finish"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Shape.finish()</span></code></a> using the “non-zero winding number” rule. While orientation of curves, quads, triangles and other shapes enclosed by lines always was detectable, this has been impossible for “re” (rectangle) items in the past. Adding the orientation parameter now delivers the missing information.</p>
</aside>
<aside class="footnote brackets" id="f8" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id10">8</a><span class="fn-bracket">]</span></span>
<p>Hyphenation detection simply means that if the last character of a line is “-”, it will be assumed to be a continuation character. That character will not be found by text searching with its default flag setting. Please take note, that a MuPDF <em>line</em> may not always be what you expect: words separated by overly large gaps (e.g. caused by text justification) may constitute separate MuPDF lines. If then any of these words ends with a hyphen, it will only be found by text searching if hyphenation is switched off.</p>
</aside>
<aside class="footnote brackets" id="f9" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">9</a><span class="fn-bracket">]</span></span>
<p>Objects inside the source page, like images, text or drawings, are never aware of whether their owning page now is under OC control inside the target PDF. If source page objects are OC-controlled in the source PDF, then this will not be retained on the target: they will become unconditionally visible.</p>
</aside>
</aside>
<div class="feedbackLink"><a id="feedbackLinkBottom" target=_blank>您对此页面有任何反馈吗？</b></a></div><hr class="docutils" />
<script>

   var url_string = window.location.href;
   var a = document.getElementById('feedbackLinkBottom');
   a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link&url="+url_string);

</script>

<p style="color:#999" id="footerDisclaimer">本软件按原样提供，不作任何明示或暗示担保。本软件根据许可分发，除非根据该许可条款明确授权，否则不得复制、修改或分发。请参阅 <a href="https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link">artifex.com</a> 上的许可信息，或联系 Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States 了解更多信息。</p>



<script>

   let docLanguage = document.getElementsByTagName('html')[0].getAttribute('lang');

   function getHeaderAndFooterTranslation(str) {
       if (docLanguage == "ja") {
           if (str == "Do you have any feedback on this page?") {
               return "このページに関するご意見はありますか？";
           } else if (str == "Find <b>#pymupdf</b> on <b>Discord</b>") {
               return "<b>Discord</b>の <b>#pymupdf</b> を見つける";
           } else if (str == "This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.") {

               return "このソフトウェアは無保証で提供されており、明示または黙示を問わず、いかなる保証もありません。このソフトウェアはライセンスの下で配布され、ライセンスの条件に明示的に許可されている場合を除き、コピー、変更、または配布してはなりません。ライセンシング情報については、<a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a>でライセンス情報を参照するか、アメリカ合衆国カリフォルニア州サンフランシスコのArtifex Software Inc. までお問い合わせください。"

           }
       }

       return str;
   }

   document.getElementById("findOnDiscord").innerHTML = getHeaderAndFooterTranslation("Find <b>#pymupdf</b> on <b>Discord</b>");
   document.getElementById("feedbackLinkTop").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("feedbackLinkBottom").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("footerDisclaimer").innerHTML = getHeaderAndFooterTranslation("This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.");


   // more translation for admonition-title as the in-built translation isn't great, needs: 注釈 -> 注
   if (docLanguage == "ja") {
       const collection = document.getElementsByClassName("admonition-title");
       for (var i=0;i<collection.length;i++) {
           collection[i].innerHTML = "注";
       }
   }


</script><p class="footer-version">This documentation covers all versions up to 1.25.4.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="pixmap.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Pixmap</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="outline.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Outline</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2025, Artifex
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 19. 3月 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Page</a><ul>
<li><a class="reference internal" href="#id2">更改 Page</a><ul>
<li><a class="reference internal" href="#Page"><code class="docutils literal notranslate"><span class="pre">Page</span></code></a><ul>
<li><a class="reference internal" href="#Page.bound"><code class="docutils literal notranslate"><span class="pre">Page.bound()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_caret_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_caret_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_text_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_text_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_freetext_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_freetext_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_file_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_file_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_ink_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_ink_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_line_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_line_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_rect_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_rect_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_circle_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_circle_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_redact_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_redact_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.apply_redactions"><code class="docutils literal notranslate"><span class="pre">Page.apply_redactions()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_polyline_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_polyline_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_polygon_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_polygon_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_underline_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_underline_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_strikeout_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_strikeout_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_squiggly_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_squiggly_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_highlight_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_highlight_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.cluster_drawings"><code class="docutils literal notranslate"><span class="pre">Page.cluster_drawings()</span></code></a></li>
<li><a class="reference internal" href="#Page.find_tables"><code class="docutils literal notranslate"><span class="pre">Page.find_tables()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_stamp_annot"><code class="docutils literal notranslate"><span class="pre">Page.add_stamp_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.add_widget"><code class="docutils literal notranslate"><span class="pre">Page.add_widget()</span></code></a></li>
<li><a class="reference internal" href="#Page.delete_annot"><code class="docutils literal notranslate"><span class="pre">Page.delete_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.delete_widget"><code class="docutils literal notranslate"><span class="pre">Page.delete_widget()</span></code></a></li>
<li><a class="reference internal" href="#Page.delete_link"><code class="docutils literal notranslate"><span class="pre">Page.delete_link()</span></code></a></li>
<li><a class="reference internal" href="#Page.insert_link"><code class="docutils literal notranslate"><span class="pre">Page.insert_link()</span></code></a></li>
<li><a class="reference internal" href="#Page.update_link"><code class="docutils literal notranslate"><span class="pre">Page.update_link()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_label"><code class="docutils literal notranslate"><span class="pre">Page.get_label()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_links"><code class="docutils literal notranslate"><span class="pre">Page.get_links()</span></code></a></li>
<li><a class="reference internal" href="#Page.links"><code class="docutils literal notranslate"><span class="pre">Page.links()</span></code></a></li>
<li><a class="reference internal" href="#Page.annots"><code class="docutils literal notranslate"><span class="pre">Page.annots()</span></code></a></li>
<li><a class="reference internal" href="#Page.widgets"><code class="docutils literal notranslate"><span class="pre">Page.widgets()</span></code></a></li>
<li><a class="reference internal" href="#Page.write_text"><code class="docutils literal notranslate"><span class="pre">Page.write_text()</span></code></a></li>
<li><a class="reference internal" href="#Page.insert_text"><code class="docutils literal notranslate"><span class="pre">Page.insert_text()</span></code></a></li>
<li><a class="reference internal" href="#Page.insert_textbox"><code class="docutils literal notranslate"><span class="pre">Page.insert_textbox()</span></code></a></li>
<li><a class="reference internal" href="#Page.insert_htmlbox"><code class="docutils literal notranslate"><span class="pre">Page.insert_htmlbox()</span></code></a></li>
<li><a class="reference internal" href="#Page.draw_line"><code class="docutils literal notranslate"><span class="pre">Page.draw_line()</span></code></a></li>
<li><a class="reference internal" href="#Page.draw_zigzag"><code class="docutils literal notranslate"><span class="pre">Page.draw_zigzag()</span></code></a></li>
<li><a class="reference internal" href="#Page.draw_squiggle"><code class="docutils literal notranslate"><span class="pre">Page.draw_squiggle()</span></code></a></li>
<li><a class="reference internal" href="#Page.draw_circle"><code class="docutils literal notranslate"><span class="pre">Page.draw_circle()</span></code></a></li>
<li><a class="reference internal" href="#Page.draw_oval"><code class="docutils literal notranslate"><span class="pre">Page.draw_oval()</span></code></a></li>
<li><a class="reference internal" href="#Page.draw_sector"><code class="docutils literal notranslate"><span class="pre">Page.draw_sector()</span></code></a></li>
<li><a class="reference internal" href="#Page.draw_polyline"><code class="docutils literal notranslate"><span class="pre">Page.draw_polyline()</span></code></a></li>
<li><a class="reference internal" href="#Page.draw_bezier"><code class="docutils literal notranslate"><span class="pre">Page.draw_bezier()</span></code></a></li>
<li><a class="reference internal" href="#Page.draw_curve"><code class="docutils literal notranslate"><span class="pre">Page.draw_curve()</span></code></a></li>
<li><a class="reference internal" href="#Page.draw_rect"><code class="docutils literal notranslate"><span class="pre">Page.draw_rect()</span></code></a></li>
<li><a class="reference internal" href="#Page.draw_quad"><code class="docutils literal notranslate"><span class="pre">Page.draw_quad()</span></code></a></li>
<li><a class="reference internal" href="#Page.insert_font"><code class="docutils literal notranslate"><span class="pre">Page.insert_font()</span></code></a></li>
<li><a class="reference internal" href="#Page.insert_image"><code class="docutils literal notranslate"><span class="pre">Page.insert_image()</span></code></a></li>
<li><a class="reference internal" href="#Page.replace_image"><code class="docutils literal notranslate"><span class="pre">Page.replace_image()</span></code></a></li>
<li><a class="reference internal" href="#Page.delete_image"><code class="docutils literal notranslate"><span class="pre">Page.delete_image()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_text"><code class="docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_textbox"><code class="docutils literal notranslate"><span class="pre">Page.get_textbox()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_textpage"><code class="docutils literal notranslate"><span class="pre">Page.get_textpage()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_textpage_ocr"><code class="docutils literal notranslate"><span class="pre">Page.get_textpage_ocr()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_drawings"><code class="docutils literal notranslate"><span class="pre">Page.get_drawings()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_cdrawings"><code class="docutils literal notranslate"><span class="pre">Page.get_cdrawings()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_fonts"><code class="docutils literal notranslate"><span class="pre">Page.get_fonts()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_images"><code class="docutils literal notranslate"><span class="pre">Page.get_images()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_image_info"><code class="docutils literal notranslate"><span class="pre">Page.get_image_info()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_xobjects"><code class="docutils literal notranslate"><span class="pre">Page.get_xobjects()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_image_rects"><code class="docutils literal notranslate"><span class="pre">Page.get_image_rects()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_image_bbox"><code class="docutils literal notranslate"><span class="pre">Page.get_image_bbox()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_svg_image"><code class="docutils literal notranslate"><span class="pre">Page.get_svg_image()</span></code></a></li>
<li><a class="reference internal" href="#Page.get_pixmap"><code class="docutils literal notranslate"><span class="pre">Page.get_pixmap()</span></code></a></li>
<li><a class="reference internal" href="#Page.annot_names"><code class="docutils literal notranslate"><span class="pre">Page.annot_names()</span></code></a></li>
<li><a class="reference internal" href="#Page.annot_xrefs"><code class="docutils literal notranslate"><span class="pre">Page.annot_xrefs()</span></code></a></li>
<li><a class="reference internal" href="#Page.load_annot"><code class="docutils literal notranslate"><span class="pre">Page.load_annot()</span></code></a></li>
<li><a class="reference internal" href="#Page.load_widget"><code class="docutils literal notranslate"><span class="pre">Page.load_widget()</span></code></a></li>
<li><a class="reference internal" href="#Page.load_links"><code class="docutils literal notranslate"><span class="pre">Page.load_links()</span></code></a></li>
<li><a class="reference internal" href="#Page.set_rotation"><code class="docutils literal notranslate"><span class="pre">Page.set_rotation()</span></code></a></li>
<li><a class="reference internal" href="#Page.remove_rotation"><code class="docutils literal notranslate"><span class="pre">Page.remove_rotation()</span></code></a></li>
<li><a class="reference internal" href="#Page.show_pdf_page"><code class="docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a></li>
<li><a class="reference internal" href="#Page.new_shape"><code class="docutils literal notranslate"><span class="pre">Page.new_shape()</span></code></a></li>
<li><a class="reference internal" href="#Page.search_for"><code class="docutils literal notranslate"><span class="pre">Page.search_for()</span></code></a></li>
<li><a class="reference internal" href="#Page.set_mediabox"><code class="docutils literal notranslate"><span class="pre">Page.set_mediabox()</span></code></a></li>
<li><a class="reference internal" href="#Page.set_cropbox"><code class="docutils literal notranslate"><span class="pre">Page.set_cropbox()</span></code></a></li>
<li><a class="reference internal" href="#Page.set_artbox"><code class="docutils literal notranslate"><span class="pre">Page.set_artbox()</span></code></a></li>
<li><a class="reference internal" href="#Page.set_bleedbox"><code class="docutils literal notranslate"><span class="pre">Page.set_bleedbox()</span></code></a></li>
<li><a class="reference internal" href="#Page.set_trimbox"><code class="docutils literal notranslate"><span class="pre">Page.set_trimbox()</span></code></a></li>
<li><a class="reference internal" href="#Page.rotation"><code class="docutils literal notranslate"><span class="pre">Page.rotation</span></code></a></li>
<li><a class="reference internal" href="#Page.cropbox_position"><code class="docutils literal notranslate"><span class="pre">Page.cropbox_position</span></code></a></li>
<li><a class="reference internal" href="#Page.cropbox"><code class="docutils literal notranslate"><span class="pre">Page.cropbox</span></code></a></li>
<li><a class="reference internal" href="#Page.artbox"><code class="docutils literal notranslate"><span class="pre">Page.artbox</span></code></a></li>
<li><a class="reference internal" href="#Page.bleedbox"><code class="docutils literal notranslate"><span class="pre">Page.bleedbox</span></code></a></li>
<li><a class="reference internal" href="#Page.trimbox"><code class="docutils literal notranslate"><span class="pre">Page.trimbox</span></code></a></li>
<li><a class="reference internal" href="#Page.mediabox_size"><code class="docutils literal notranslate"><span class="pre">Page.mediabox_size</span></code></a></li>
<li><a class="reference internal" href="#Page.mediabox"><code class="docutils literal notranslate"><span class="pre">Page.mediabox</span></code></a></li>
<li><a class="reference internal" href="#Page.transformation_matrix"><code class="docutils literal notranslate"><span class="pre">Page.transformation_matrix</span></code></a></li>
<li><a class="reference internal" href="#Page.rotation_matrix"><code class="docutils literal notranslate"><span class="pre">Page.rotation_matrix</span></code></a></li>
<li><a class="reference internal" href="#Page.derotation_matrix"><code class="docutils literal notranslate"><span class="pre">Page.derotation_matrix</span></code></a></li>
<li><a class="reference internal" href="#Page.first_link"><code class="docutils literal notranslate"><span class="pre">Page.first_link</span></code></a></li>
<li><a class="reference internal" href="#Page.first_annot"><code class="docutils literal notranslate"><span class="pre">Page.first_annot</span></code></a></li>
<li><a class="reference internal" href="#Page.first_widget"><code class="docutils literal notranslate"><span class="pre">Page.first_widget</span></code></a></li>
<li><a class="reference internal" href="#Page.number"><code class="docutils literal notranslate"><span class="pre">Page.number</span></code></a></li>
<li><a class="reference internal" href="#Page.parent"><code class="docutils literal notranslate"><span class="pre">Page.parent</span></code></a></li>
<li><a class="reference internal" href="#Page.rect"><code class="docutils literal notranslate"><span class="pre">Page.rect</span></code></a></li>
<li><a class="reference internal" href="#Page.xref"><code class="docutils literal notranslate"><span class="pre">Page.xref</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#get-links"><em>get_links()</em> 条目的描述</a></li>
<li><a class="reference internal" href="#notes-on-supporting-links">支持链接的说明</a><ul>
<li><a class="reference internal" href="#get-links-first-link">读取（涉及方法 <em>get_links()</em> 和 <em>first_link</em> 属性链）</a></li>
<li><a class="reference internal" href="#id12">写入</a></li>
</ul>
</li>
<li><a class="reference internal" href="#document-page"><span class="xref std std-ref">Document</span> 和 <span class="xref std std-ref">Page</span> 的同源方法</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/tabs.js"></script>
    <script src="_static/translations.js"></script>
    </body>
</html>