<!doctype html>
<html class="no-js" lang="zh-CN">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="Artifex" name="author" />
<meta content="PyMuPDF 是一个高性能 Python 库，用于 PDF（及其他）文档的数据提取、分析、转换和操作。" name="description" />
<meta content="PDF Text Extraction, PDF Image Extraction, PDF Conversion, PDF Tables, PDF Splitting, PDF Creation, Pyodide, PyScript" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZTN4VTL9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZTN4VTL9M');
    </script>
    <link rel="author" title="关于此文档" href="about.html" /><link rel="index" title="索引" href="genindex.html" /><link rel="search" title="搜索" href="search.html" /><link rel="next" title="PyMuPDF、LLM 和 RAG" href="rag.html" /><link rel="prev" title="基础用法" href="the-basics.html" />

    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/><!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>教程 - PyMuPDF 1.25.4 文档</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMuPDF 1.25.4 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/sidebar-logo-dark.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/sidebar-logo-light.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyMuPDF 1.25.4 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">关于/About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">功能比较</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-performance">性能</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-license">许可和版权</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf4llm/index.html">PyMuPDF4LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf-pro.html">PyMuPDF Pro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">用户指南/User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-basics.html">基础用法</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">PyMuPDF、LLM 和 RAG</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">资源</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">教程/How to Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how-to-open-a-file.html">打开文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-text.html">文本</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-images.html">图片</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-annotations.html">注释</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-drawing-and-graphics.html">绘图和图形</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-stories.html">故事</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-journalling.html">日记</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-multiprocessing.html">多进程</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-ocr.html">OCR - 光学字符识别</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-optional-content.html">可选内容支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-low-level-interfaces.html">低级接口</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-common-issues-and-their-solutions.html">常见问题及其解决方案</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API参考/API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="module.html">命令行界面</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="classes.html">类</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="annot.html">Annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="archive-class.html">Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="colorspace.html">Colorspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="displaylist.html">DisplayList</a></li>
<li class="toctree-l2"><a class="reference internal" href="document.html">Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-writer-class.html">DocumentWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="font.html">Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="irect.html">IRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="link.html">Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkdest.html">linkDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="outline.html">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixmap.html">Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="point.html">Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="quad.html">Quad</a></li>
<li class="toctree-l2"><a class="reference internal" href="rect.html">Rect</a></li>
<li class="toctree-l2"><a class="reference internal" href="shape.html">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="story-class.html">Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="textpage.html">TextPage</a></li>
<li class="toctree-l2"><a class="reference internal" href="textwriter.html">TextWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="widget.html">Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml-class.html">Xml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algebra.html">几何对象的运算符代数</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lowlevel.html">低级函数和类</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html">函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="device.html">设备</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop_low.html">协同工作: DisplayList 和 TextPage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">常量和枚举</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">颜色数据库</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">其他/Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app1.html">附录 1：文本提取详细信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app2.html">附录 2：嵌入式文件的注意事项</a></li>
<li class="toctree-l1"><a class="reference internal" href="app3.html">附录 3：各类技术信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app4.html">附录 4：性能比较方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">更新日志</a></li>
<li class="toctree-l1"><a class="reference internal" href="znames.html">已废弃名称</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div style="display:flex;justify-content:space-between;align-items: center;">
    <form class="sidebar-search-container top" method="get" action="search.html" role="search" style="width:75%">
      <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
    <div class="discordLink" style="display:flex;align-items:center;margin-top: -5px;">
        <a href="https://discord.gg/TSpYGBW4eq" id="findOnDiscord" target=_blank>Find <b>#pymupdf</b> on <b>Discord</b></a>
        <a href="https://discord.gg/TSpYGBW4eq" target=_blank>
            <div style="width:30px;height:30px;margin-left:5px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
                    <defs>
                        <style>.discordLogoFill{fill:#5865f2;}</style>
                    </defs>
                    <g id="Discord_Logo" data-name="Discord Logo">
                        <path class="discordLogoFill" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                    </g>
                </svg>
            </div>
        </a>
    </div>

</div><section id="tutorial">
<span id="id1"></span><h1>教程<a class="headerlink" href="#tutorial" title="此标题的永久链接">#</a></h1>
<p>Tutorial</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">中文</label><div class="tab-content docutils container">
<p>本教程将逐步向您展示如何在Python中使用 <cite>PyMuPDF</cite> ，即 <cite>MuPDF</cite>。</p>
<p>由于 <cite>MuPDF</cite> 不仅支持PDF格式，还支持XPS、OpenXPS、CBZ、CBR、FB2和EPUB格式， <cite>PyMuPDF</cite> 同样支持这些格式 <a class="footnote-reference brackets" href="#f4" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> 。然而，为了简洁起见，我们将仅讨论PDF文件。在仅支持PDF文件的地方，会明确指出这一点。</p>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">英文</label><div class="tab-content docutils container">
<p>This tutorial will show you the use of <cite>PyMuPDF</cite>, <cite>MuPDF</cite> in <cite>Python</cite>, step by step.</p>
<p>Because <cite>MuPDF</cite> supports not only PDF, but also XPS, OpenXPS, CBZ, CBR, FB2 and EPUB formats, so does PyMuPDF <a class="footnote-reference brackets" href="#f1" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. Nevertheless, for the sake of brevity we will only talk about PDF files. At places where indeed only PDF files are supported, this will be mentioned explicitly.</p>
</div>
</div>
<section id="id4">
<h2>导入绑定<a class="headerlink" href="#id4" title="此标题的永久链接">#</a></h2>
<p>Importing the Bindings</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">中文</label><div class="tab-content docutils container">
<p>MuPDF的Python绑定可以通过以下导入语句使用。我们还展示了如何检查您的版本：</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
<span class="go">PyMuPDF 1.16.0: MuPDF 1.16.0库的Python绑定。</span>
<span class="go">版本日期：2019-07-28 07:30:14。</span>
<span class="go">为Python 3.7在win32 (64位) 平台上构建。</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">英文</label><div class="tab-content docutils container">
<p>The Python bindings to MuPDF are made available by this import statement. We also show here how your version can be checked:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pymupdf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pymupdf</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
<span class="go">PyMuPDF 1.16.0: Python bindings for the MuPDF 1.16.0 library.</span>
<span class="go">Version date: 2019-07-28 07:30:14.</span>
<span class="go">Built for Python 3.7 on win32 (64-bit).</span>
</pre></div>
</div>
</div>
</div>
<section id="fitz">
<h3>注意名称 <em>fitz</em><a class="headerlink" href="#fitz" title="此标题的永久链接">#</a></h3>
<p>Note on the Name <em>fitz</em></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">中文</label><div class="tab-content docutils container">
<p>旧版本的 <cite>PyMuPDF</cite> 使用的 <strong>Python</strong> 导入名称为 <code class="xref any docutils literal notranslate"><span class="pre">fitz</span></code>。新版本改用了 <code class="xref any docutils literal notranslate"><span class="pre">pymupdf</span></code>，并提供了 <code class="xref any docutils literal notranslate"><span class="pre">fitz</span></code> 作为后备，以便旧代码仍然能正常工作。</p>
<p>之所以使用 <code class="xref any docutils literal notranslate"><span class="pre">fitz</span></code> 这个名称，有一个历史原因：</p>
<p>MuPDF的原始渲染库叫做 <em>Libart</em>。</p>
<p><em>“在Artifex软件公司收购MuPDF项目后，开发重点转向编写一个新的现代图形库，名为”Fitz”。Fitz最初是作为一个研发项目，打算替代老旧的Ghostscript图形库，但它最终成为了MuPDF的渲染引擎。”</em> (引用自 <a class="reference external" href="https://en.wikipedia.org/wiki/MuPDF">Wikipedia</a>) 。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>如果安装了已经废弃的pypi.org包 <code class="xref any docutils literal notranslate"><span class="pre">fitz</span></code>，则使用遗留名称 <code class="xref any docutils literal notranslate"><span class="pre">fitz</span></code> 可能会失败；请参阅 <span class="xref std std-ref">安装后问题</span>。</p>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">英文</label><div class="tab-content docutils container">
<p>Old versions of <cite>PyMuPDF</cite> had their <strong>Python</strong> import name as <code class="xref any docutils literal notranslate"><span class="pre">fitz</span></code>. Newer versions use <code class="xref any docutils literal notranslate"><span class="pre">pymupdf</span></code> instead, and offer <code class="xref any docutils literal notranslate"><span class="pre">fitz</span></code> as a fallback so that old code will still work.</p>
<p>The reason for the name <code class="xref any docutils literal notranslate"><span class="pre">fitz</span></code> is a historical curiosity:</p>
<p>The original rendering library for MuPDF was called <em>Libart</em>.</p>
<p><em>“After Artifex Software acquired the MuPDF project, the development focus shifted on writing a new modern graphics library called “Fitz”. Fitz was originally intended as an R&amp;D project to replace the aging Ghostscript graphics library, but has instead become the rendering engine powering MuPDF.”</em> (Quoted from <a class="reference external" href="https://en.wikipedia.org/wiki/MuPDF">Wikipedia</a>).</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Use of legacy name <code class="xref any docutils literal notranslate"><span class="pre">fitz</span></code> can fail if defunct pypi.org package <code class="xref any docutils literal notranslate"><span class="pre">fitz</span></code> is installed; see <a class="reference internal" href="installation.html#problems-after-installation"><span class="std std-ref">安装后的问题</span></a>.</p>
</div>
</div>
</div>
</section>
</section>
<section id="tutorial-opening-a-document">
<span id="id6"></span><h2>打开文档<a class="headerlink" href="#tutorial-opening-a-document" title="此标题的永久链接">#</a></h2>
<p>Opening a Document</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">中文</label><div class="tab-content docutils container">
<p>要访问一个 <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">支持的文档</span></a>，必须使用以下语句打开：</p>
<blockquote>
<div><p>doc = pymupdf.open(filename)  # 或 pymupdf.Document(filename)</p>
</div></blockquote>
<p>这会创建一个 <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> 对象 <em>doc</em>。<em>filename</em> 必须是一个 Python 字符串 (或 <code class="xref any docutils literal notranslate"><span class="pre">pathlib.Path</span></code>) ，指定一个现有文件的名称。</p>
<p>还可以从内存数据打开文档，或者创建一个新的空 PDF。有关详细信息，请参阅 <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a>。你还可以将 <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> 作为 <em>上下文管理器</em> 使用。</p>
<p>一个文档包含许多属性和函数。其中包括元信息 (如 “作者” 或 “主题”) 、总页数、目录和加密信息。</p>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">英文</label><div class="tab-content docutils container">
<p>To access a <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">supported document</span></a>, it must be opened with the following statement:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>  <span class="c1"># or pymupdf.Document(filename)</span>
</pre></div>
</div>
<p>This creates the <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> object <em>doc</em>. <em>filename</em> must be a Python string (or a <code class="xref any docutils literal notranslate"><span class="pre">pathlib.Path</span></code>) specifying the name of an existing file.</p>
<p>It is also possible to open a document from memory data, or to create a new, empty PDF. See <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> for details. You can also use <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> as a <em>context manager</em>.</p>
<p>A document contains many attributes and functions. Among them are meta information (like “author” or “subject”), number of total pages, outline and encryption information.</p>
</div>
</div>
</section>
<section id="document">
<h2>一些 <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> 方法和属性<a class="headerlink" href="#document" title="此标题的永久链接">#</a></h2>
<p>Some <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> Methods and Attributes</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">中文</label><div class="tab-content docutils container">
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Method / Attribute</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="document.html#Document.page_count" title="Document.page_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.page_count</span></code></a></p></td>
<td><p>页数 (<em>int</em>)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="document.html#Document.metadata" title="Document.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.metadata</span></code></a></p></td>
<td><p>元数据 (<em>dict</em>)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="document.html#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a></p></td>
<td><p>获取目录 (<em>list</em>)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="document.html#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a></p></td>
<td><p>加载一个 <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">英文</label><div class="tab-content docutils container">
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Method / Attribute</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="document.html#Document.page_count" title="Document.page_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.page_count</span></code></a></p></td>
<td><p>the number of pages (<em>int</em>)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="document.html#Document.metadata" title="Document.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.metadata</span></code></a></p></td>
<td><p>the metadata (<em>dict</em>)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="document.html#Document.get_toc" title="Document.get_toc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.get_toc()</span></code></a></p></td>
<td><p>get the table of contents (<em>list</em>)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="document.html#Document.load_page" title="Document.load_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.load_page()</span></code></a></p></td>
<td><p>read a <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="id7">
<h2>访问元数据<a class="headerlink" href="#id7" title="此标题的永久链接">#</a></h2>
<p>Accessing Meta Data</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">中文</label><div class="tab-content docutils container">
<p>PyMuPDF 完全支持标准元数据。 <a class="reference internal" href="document.html#Document.metadata" title="Document.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.metadata</span></code></a> 是一个 Python 字典，包含以下键。它适用于 <strong>所有文档类型</strong>，尽管并非所有条目总是包含数据。有关它们的含义和格式的详细信息，请参考相应的手册，例如 PDF 的 <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a>。进一步的信息也可以在 <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> 章节中找到。元数据字段是字符串类型，如果没有特别说明，则为 <em>None</em> 。还请注意，并非所有字段总是包含有意义的数据——即使它们不是 <em>None</em>。</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>键</p></th>
<th class="head"><p>值</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>producer</p></td>
<td><p>生产者 (生产软件)</p></td>
</tr>
<tr class="row-odd"><td><p>format</p></td>
<td><p>格式：’PDF-1.4’, ‘EPUB’ 等</p></td>
</tr>
<tr class="row-even"><td><p>encryption</p></td>
<td><p>如果有的话，使用的加密方法</p></td>
</tr>
<tr class="row-odd"><td><p>author</p></td>
<td><p>作者</p></td>
</tr>
<tr class="row-even"><td><p>modDate</p></td>
<td><p>最后修改日期</p></td>
</tr>
<tr class="row-odd"><td><p>keywords</p></td>
<td><p>关键词</p></td>
</tr>
<tr class="row-even"><td><p>title</p></td>
<td><p>标题</p></td>
</tr>
<tr class="row-odd"><td><p>creationDate</p></td>
<td><p>创建日期</p></td>
</tr>
<tr class="row-even"><td><p>creator</p></td>
<td><p>创建应用程序</p></td>
</tr>
<tr class="row-odd"><td><p>subject</p></td>
<td><p>主题</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>除了这些标准元数据之外， <strong>PDF 文档</strong> 从 PDF 版本 1.4 开始，还可能包含所谓的  <em>“元数据流”</em>  (参见 <a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref py py-data docutils literal notranslate"><span class="pre">stream</span></code></a>) 。这些流中的信息以 XML 编码。PyMuPDF 特意不包含用于此目的的 XML 组件 (<a class="reference internal" href="xml-class.html#xml"><span class="std std-ref">PyMuPDF Xml class</span></a> 是一个用于访问 <a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a> 对象 DOM 内容的帮助类) ，因此我们不直接支持访问其中包含的信息。但你可以提取整个流，使用像 <a class="reference external" href="https://pypi.org/project/lxml/">lxml</a> 这样的包来检查或修改它，然后将结果存回 PDF。如果需要，你还可以完全删除这些数据。</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>在代码库中有两个实用脚本，分别是 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/import-metadata/import.py">metadata import (PDF only)</a> 和 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/export-metadata/export.py">metadata export</a> ，它们分别从 CSV 文件导入或导出元数据。</p>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">英文</label><div class="tab-content docutils container">
<p>PyMuPDF fully supports standard metadata. <a class="reference internal" href="document.html#Document.metadata" title="Document.metadata"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Document.metadata</span></code></a> is a Python dictionary with the following keys. It is available for <strong>all document types</strong>, though not all entries may always contain data. For details of their meanings and formats consult the respective manuals, e.g. <a class="reference internal" href="app3.html#adobemanual"><span class="std std-ref">Adobe PDF 参考</span></a> for PDF. Further information can also be found in chapter <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a>. The meta data fields are strings or <em>None</em> if not otherwise indicated. Also be aware that not all of them always contain meaningful data – even if they are not <em>None</em>.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>producer</p></td>
<td><p>producer (producing software)</p></td>
</tr>
<tr class="row-odd"><td><p>format</p></td>
<td><p>format: ‘PDF-1.4’, ‘EPUB’, etc.</p></td>
</tr>
<tr class="row-even"><td><p>encryption</p></td>
<td><p>encryption method used if any</p></td>
</tr>
<tr class="row-odd"><td><p>author</p></td>
<td><p>author</p></td>
</tr>
<tr class="row-even"><td><p>modDate</p></td>
<td><p>date of last modification</p></td>
</tr>
<tr class="row-odd"><td><p>keywords</p></td>
<td><p>keywords</p></td>
</tr>
<tr class="row-even"><td><p>title</p></td>
<td><p>title</p></td>
</tr>
<tr class="row-odd"><td><p>creationDate</p></td>
<td><p>date of creation</p></td>
</tr>
<tr class="row-even"><td><p>creator</p></td>
<td><p>creating application</p></td>
</tr>
<tr class="row-odd"><td><p>subject</p></td>
<td><p>subject</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Apart from these standard metadata, <strong>PDF documents</strong> starting from PDF version 1.4 may also contain so-called <em>“metadata streams”</em> (see also <a class="reference internal" href="glossary.html#stream" title="stream"><code class="xref py py-data docutils literal notranslate"><span class="pre">stream</span></code></a>). Information in such streams is coded in XML. PyMuPDF deliberately contains no XML components for this purpose (the <a class="reference internal" href="xml-class.html#xml"><span class="std std-ref">PyMuPDF Xml class</span></a> is a helper class intended to access the DOM content of a <a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a> object), so we do not directly support access to information contained therein. But you can extract the stream as a whole, inspect or modify it using a package like <a class="reference external" href="https://pypi.org/project/lxml/">lxml</a> and then store the result back into the PDF. If you want, you can also delete this data altogether.</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>There are two utility scripts in the repository that <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/import-metadata/import.py">metadata import (PDF only)</a> resp. <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/export-metadata/export.py">metadata export</a> metadata from resp. to CSV files.</p>
</div>
</div>
</div>
</section>
<section id="id8">
<h2>使用大纲<a class="headerlink" href="#id8" title="此标题的永久链接">#</a></h2>
<p>Working with Outlines</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">中文</label><div class="tab-content docutils container">
<p>获取文档所有大纲 (也叫“书签”) 的最简单方法是加载其 <em>目录</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">toc</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_toc</span><span class="p">()</span>
</pre></div>
</div>
<p>这将返回一个 Python 列表 <em>[[lvl, title, page, …], …]</em>，其结构类似于书籍中常见的目录。</p>
<p><em>lvl</em> 是条目的层级 (从 1 开始) ，<em>title</em> 是条目的标题，<em>page</em> 是页码 (以 1 为基准！) 。其他参数描述书签目标的详细信息。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>在代码库中有两个实用脚本，分别是 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/import-toc/import.py">toc import (PDF only)</a> 和 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/export-toc/export.py">toc export</a>，它们分别从 CSV 文件导入或导出目录。</p>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">英文</label><div class="tab-content docutils container">
<p>The easiest way to get all outlines (also called “bookmarks”) of a document, is by loading its <em>table of contents</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">toc</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">get_toc</span><span class="p">()</span>
</pre></div>
</div>
<p>This will return a Python list of lists <em>[[lvl, title, page, …], …]</em> which looks much like a conventional table of contents found in books.</p>
<p><em>lvl</em> is the hierarchy level of the entry (starting from 1), <em>title</em> is the entry’s title, and <em>page</em> the page number (1-based!). Other parameters describe details of the bookmark target.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>There are two utility scripts in the repository that <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/import-toc/import.py">toc import (PDF only)</a> resp. <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/export-toc/export.py">toc export</a> table of contents from resp. to CSV files.</p>
</div>
</div>
</div>
</section>
<section id="id9">
<h2>使用页面<a class="headerlink" href="#id9" title="此标题的永久链接">#</a></h2>
<p>Working with Pages</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">中文</label><div class="tab-content docutils container">
<p><a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> 处理是 MuPDF 功能的核心。</p>
<ul class="simple">
<li><p>您可以将页面渲染为栅格图像或矢量图像 (SVG) ，并可选择性地进行缩放、旋转、平移或剪切。</p></li>
<li><p>您可以提取页面的文本和图像，支持多种格式并且可以搜索文本字符串。</p></li>
<li><p>对于 PDF 文档，还可以使用更多方法向页面添加文本或图像。</p></li>
</ul>
<p>首先，必须创建一个 <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a>。这是 <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> 的一个方法:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">load_page</span><span class="p">(</span><span class="n">pno</span><span class="p">)</span>  <span class="c1"># 加载文档的页面 &#39;pno&#39; (从 0 开始)</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">pno</span><span class="p">]</span>  <span class="c1"># 简写形式</span>
</pre></div>
</div>
<p>这里的任何整数 <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code> 都是有效的。负数表示从文档末尾向回计数，因此 <em>doc[-1]</em> 是最后一页，类似于 Python 序列。</p>
<p>更高级的方式是将文档作为其页面的 <strong>迭代器</strong> 使用:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
    <span class="c1"># 对 &#39;page&#39; 做一些操作</span>

<span class="c1"># ... 或者反向读取</span>
<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">doc</span><span class="p">):</span>
    <span class="c1"># 对 &#39;page&#39; 做一些操作</span>

<span class="c1"># ... 甚至可以使用切片</span>
<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">pages</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
    <span class="c1"># 对 &#39;page&#39; 做一些操作</span>
</pre></div>
</div>
<p>一旦获取到页面，以下是您通常会对页面执行的操作：</p>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">英文</label><div class="tab-content docutils container">
<p><a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> handling is at the core of MuPDF’s functionality.</p>
<ul class="simple">
<li><p>You can render a page into a raster or vector (SVG) image, optionally zooming, rotating, shifting or shearing it.</p></li>
<li><p>You can extract a page’s text and images in many formats and search for text strings.</p></li>
<li><p>For PDF documents many more methods are available to add text or images to pages.</p></li>
</ul>
<p>First, a <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a> must be created. This is a method of <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">load_page</span><span class="p">(</span><span class="n">pno</span><span class="p">)</span>  <span class="c1"># loads page number &#39;pno&#39; of the document (0-based)</span>
<span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="n">pno</span><span class="p">]</span>  <span class="c1"># the short form</span>
</pre></div>
</div>
<p>Any integer <code class="xref any docutils literal notranslate"><span class="pre">-∞</span> <span class="pre">&lt;</span> <span class="pre">pno</span> <span class="pre">&lt;</span> <span class="pre">page_count</span></code> is possible here. Negative numbers count backwards from the end, so <em>doc[-1]</em> is the last page, like with Python sequences.</p>
<p>Some more advanced way would be using the document as an <strong>iterator</strong> over its pages:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="p">:</span>
    <span class="c1"># do something with &#39;page&#39;</span>

<span class="c1"># ... or read backwards</span>
<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">doc</span><span class="p">):</span>
    <span class="c1"># do something with &#39;page&#39;</span>

<span class="c1"># ... or even use &#39;slicing&#39;</span>
<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">pages</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
    <span class="c1"># do something with &#39;page&#39;</span>
</pre></div>
</div>
<p>Once you have your page, here is what you would typically do with it:</p>
</div>
</div>
<section id="id10">
<h3>检查页面的链接、注释或表单字段<a class="headerlink" href="#id10" title="此标题的永久链接">#</a></h3>
<p>Inspecting the Links, Annotations or Form Fields of a Page</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">中文</label><div class="tab-content docutils container">
<p>链接在文档中显示为“热区”，当文档在某些查看软件中显示时，点击这些区域时，通常会跳转到该热区所编码的目标。当光标显示为手形时，通常会跳转到该目标。以下是获取所有链接的方法:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 获取页面上的所有链接</span>
<span class="n">links</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_links</span><span class="p">()</span>
</pre></div>
</div>
<p><em>links</em> 是一个 Python 字典列表。详细信息请参见 <a class="reference internal" href="page.html#Page.get_links" title="Page.get_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_links()</span></code></a>。</p>
<p>您还可以使用迭代器逐个获取链接:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">links</span><span class="p">():</span>
    <span class="c1"># 对 &#39;link&#39; 做一些操作</span>
</pre></div>
</div>
<p>如果处理的是 PDF 文档页面，页面上可能还存在注释 (<a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a>) 或表单字段 (<a class="reference internal" href="widget.html#widget"><span class="std std-ref">Widget</span></a>)，每种都有自己的迭代器:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">annot</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">annots</span><span class="p">():</span>
    <span class="c1"># 对 &#39;annot&#39; 做一些操作</span>

<span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">widgets</span><span class="p">():</span>
    <span class="c1"># 对 &#39;field&#39; 做一些操作</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--2">英文</label><div class="tab-content docutils container">
<p>Links are shown as “hot areas” when a document is displayed with some viewer software. If you click while your cursor shows a hand symbol, you will usually be taken to the target that is encoded in that hot area. Here is how to get all links:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get all links on a page</span>
<span class="n">links</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_links</span><span class="p">()</span>
</pre></div>
</div>
<p><em>links</em> is a Python list of dictionaries. For details see <a class="reference internal" href="page.html#Page.get_links" title="Page.get_links"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_links()</span></code></a>.</p>
<p>You can also use an iterator which emits one link at a time:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">links</span><span class="p">():</span>
    <span class="c1"># do something with &#39;link&#39;</span>
</pre></div>
</div>
<p>If dealing with a PDF document page, there may also exist annotations (<a class="reference internal" href="annot.html#annot"><span class="std std-ref">Annot</span></a>) or form fields (<a class="reference internal" href="widget.html#widget"><span class="std std-ref">Widget</span></a>), each of which have their own iterators:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">annot</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">annots</span><span class="p">():</span>
    <span class="c1"># do something with &#39;annot&#39;</span>

<span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">widgets</span><span class="p">():</span>
    <span class="c1"># do something with &#39;field&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id11">
<h3>渲染页面<a class="headerlink" href="#id11" title="此标题的永久链接">#</a></h3>
<p>Rendering a Page</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">中文</label><div class="tab-content docutils container">
<p>此示例创建页面内容的 <strong>光栅</strong> 图像:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pix</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_pixmap</span><span class="p">()</span>
</pre></div>
</div>
<p><em>pix</em> 是一个 <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> 对象，其中 (在这种情况下) 包含页面的 <strong>RGB</strong> 图像，准备好用于多种用途。方法 <a class="reference internal" href="page.html#Page.get_pixmap" title="Page.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_pixmap()</span></code></a> 提供了许多控制图像的变体：分辨率 / DPI、色彩空间 (例如生成灰度图像或具有减色方案的图像) 、透明度、旋转、镜像、平移、剪切等。例如：要创建一个 <strong>RGBA</strong> 图像 (即包含 alpha 通道) ，请指定 <em>pix = page.get_pixmap(alpha=True)</em>。</p>
<p>一个 <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> 包含许多方法和属性，下面会提到其中的一些。包括 <em>width</em>、<em>height</em> (每个以像素为单位) 和 <em>stride</em> (每一水平图像行的字节数) 。属性 <em>samples</em> 表示表示图像数据的矩形字节区域 (一个 Python <em>bytes</em> 对象) 。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>你还可以通过使用 <a class="reference internal" href="page.html#Page.get_svg_image" title="Page.get_svg_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_svg_image()</span></code></a> 创建页面的 <strong>矢量</strong> 图像。详细信息请参阅 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/wiki/Vector-Image-Support">Vector Image Support page</a>。</p>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">英文</label><div class="tab-content docutils container">
<p>This example creates a <strong>raster</strong> image of a page’s content:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pix</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_pixmap</span><span class="p">()</span>
</pre></div>
</div>
<p><em>pix</em> is a <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> object which (in this case) contains an <strong>RGB</strong> image of the page, ready to be used for many purposes. Method <a class="reference internal" href="page.html#Page.get_pixmap" title="Page.get_pixmap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_pixmap()</span></code></a> offers lots of variations for controlling the image: resolution / DPI, colorspace (e.g. to produce a grayscale image or an image with a subtractive color scheme), transparency, rotation, mirroring, shifting, shearing, etc. For example: to create an <strong>RGBA</strong> image (i.e. containing an alpha channel), specify <em>pix = page.get_pixmap(alpha=True)</em>.</p>
<p>A <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> contains a number of methods and attributes which are referenced below. Among them are the integers <em>width</em>, <em>height</em> (each in pixels) and <em>stride</em> (number of bytes of one horizontal image line). Attribute <em>samples</em> represents a rectangular area of bytes representing the image data (a Python <em>bytes</em> object).</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>You can also create a <strong>vector</strong> image of a page by using <a class="reference internal" href="page.html#Page.get_svg_image" title="Page.get_svg_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_svg_image()</span></code></a>. Refer to this <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/wiki/Vector-Image-Support">Vector Image Support page</a> for details.</p>
</div>
</div>
</div>
</section>
<section id="id12">
<h3>将页面图像保存在文件中<a class="headerlink" href="#id12" title="此标题的永久链接">#</a></h3>
<p>Saving the Page Image in a File</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">中文</label><div class="tab-content docutils container">
<p>我们可以简单地将图像存储在 PNG 文件中:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pix</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;page-</span><span class="si">%i</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="n">page</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">英文</label><div class="tab-content docutils container">
<p>We can simply store the image in a PNG file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pix</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;page-</span><span class="si">%i</span><span class="s2">.png&quot;</span> <span class="o">%</span> <span class="n">page</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="displaying-the-image-in-guis">
<h3>Displaying the Image in GUIs<a class="headerlink" href="#displaying-the-image-in-guis" title="此标题的永久链接">#</a></h3>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--11-input--1" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--1">中文</label><div class="tab-content docutils container">
<p>我们还可以在 GUI 对话框管理器中使用它。<a class="reference internal" href="pixmap.html#Pixmap.samples" title="Pixmap.samples"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Pixmap.samples</span></code></a> 将所有像素的字节区域表示为 Python 字节对象。以下是一些示例，更多内容请参阅 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/tree/master/examples">examples</a> 目录。</p>
</div>
<input class="tab-input" id="tab-set--11-input--2" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--2">英文</label><div class="tab-content docutils container">
<p>We can also use it in GUI dialog managers. <a class="reference internal" href="pixmap.html#Pixmap.samples" title="Pixmap.samples"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Pixmap.samples</span></code></a> represents an area of bytes of all the pixels as a Python bytes object. Here are some examples, find more in the <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/tree/master/examples">examples</a> directory.</p>
</div>
</div>
<section id="wxpython">
<h4>wxPython<a class="headerlink" href="#wxpython" title="此标题的永久链接">#</a></h4>
<p>wxPython</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--12-input--1" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--1">中文</label><div class="tab-content docutils container">
<p>请参阅其文档以了解对 RGB(A) 像素图的调整，以及可能针对您的 wxPython 版本的具体信息:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span><span class="p">:</span>
    <span class="n">bitmap</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Bitmap</span><span class="o">.</span><span class="n">FromBufferRGBA</span><span class="p">(</span><span class="n">pix</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">bitmap</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Bitmap</span><span class="o">.</span><span class="n">FromBuffer</span><span class="p">(</span><span class="n">pix</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--12-input--2" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--2">英文</label><div class="tab-content docutils container">
<p>Consult their documentation for adjustments to RGB(A) pixmaps and, potentially, specifics for your wxPython release:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span><span class="p">:</span>
    <span class="n">bitmap</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Bitmap</span><span class="o">.</span><span class="n">FromBufferRGBA</span><span class="p">(</span><span class="n">pix</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">bitmap</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Bitmap</span><span class="o">.</span><span class="n">FromBuffer</span><span class="p">(</span><span class="n">pix</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="tkinter">
<h4>Tkinter<a class="headerlink" href="#tkinter" title="此标题的永久链接">#</a></h4>
<p>Tkinter</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--13-input--1" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--1">中文</label><div class="tab-content docutils container">
<p>请参阅 <a class="reference external" href="https://Pillow.readthedocs.io">Pillow documentation</a> 的第 3.19 节:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageTk</span>

<span class="c1"># 根据 alpha 设置模式</span>
<span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;RGBA&quot;</span> <span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span> <span class="k">else</span> <span class="s2">&quot;RGB&quot;</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">frombytes</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="p">[</span><span class="n">pix</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">height</span><span class="p">],</span> <span class="n">pix</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span>
<span class="n">tkimg</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
<p>以下代码 <strong>避免使用 Pillow</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 如果存在 alpha，则移除它</span>
<span class="n">pix1</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">pix</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span> <span class="k">else</span> <span class="n">pix</span>  <span class="c1"># PPM 不支持透明度</span>
<span class="n">imgdata</span> <span class="o">=</span> <span class="n">pix1</span><span class="o">.</span><span class="n">tobytes</span><span class="p">(</span><span class="s2">&quot;ppm&quot;</span><span class="p">)</span>  <span class="c1"># 非常快速！</span>
<span class="n">tkimg</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">imgdata</span><span class="p">)</span>
</pre></div>
</div>
<p>如果你在寻找一个完整的 Tkinter 脚本，用于分页浏览 <strong>任何支持的</strong> 文档，<a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/browse-document/browse.py">这里是代码!</a> 它还可以对页面进行缩放，并且可以在 Python 2 或 3 下运行。它需要非常方便的 <a class="reference external" href="https://pypi.org/project/PySimpleGUI/">PySimpleGUI</a> 纯 Python 包。</p>
</div>
<input class="tab-input" id="tab-set--13-input--2" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--2">英文</label><div class="tab-content docutils container">
<p>Please also see section 3.19 of the <a class="reference external" href="https://Pillow.readthedocs.io">Pillow documentation</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageTk</span>

<span class="c1"># set the mode depending on alpha</span>
<span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;RGBA&quot;</span> <span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span> <span class="k">else</span> <span class="s2">&quot;RGB&quot;</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">frombytes</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="p">[</span><span class="n">pix</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">height</span><span class="p">],</span> <span class="n">pix</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span>
<span class="n">tkimg</span> <span class="o">=</span> <span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
<p>The following <strong>avoids using Pillow</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># remove alpha if present</span>
<span class="n">pix1</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Pixmap</span><span class="p">(</span><span class="n">pix</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span> <span class="k">else</span> <span class="n">pix</span>  <span class="c1"># PPM does not support transparency</span>
<span class="n">imgdata</span> <span class="o">=</span> <span class="n">pix1</span><span class="o">.</span><span class="n">tobytes</span><span class="p">(</span><span class="s2">&quot;ppm&quot;</span><span class="p">)</span>  <span class="c1"># extremely fast!</span>
<span class="n">tkimg</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">imgdata</span><span class="p">)</span>
</pre></div>
</div>
<p>If you are looking for a complete Tkinter script paging through <strong>any supported</strong> document, <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/browse-document/browse.py">here it is!</a>. It can also zoom into pages, and it runs under Python 2 or 3. It requires the extremely handy <a class="reference external" href="https://pypi.org/project/PySimpleGUI/">PySimpleGUI</a> pure Python package.</p>
</div>
</div>
</section>
<section id="pyqt4pyqt5pyside">
<h4>PyQt4、PyQt5、PySide<a class="headerlink" href="#pyqt4pyqt5pyside" title="此标题的永久链接">#</a></h4>
<p>PyQt4, PyQt5, PySide</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--14-input--1" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--1">中文</label><div class="tab-content docutils container">
<p>请参阅 <a class="reference external" href="https://Pillow.readthedocs.io">Pillow documentation</a> 的第 3.16 节:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageQt</span>

<span class="c1"># 根据 alpha 设置模式</span>
<span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;RGBA&quot;</span> <span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span> <span class="k">else</span> <span class="s2">&quot;RGB&quot;</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">frombytes</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="p">[</span><span class="n">pix</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">height</span><span class="p">],</span> <span class="n">pix</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span>
<span class="n">qtimg</span> <span class="o">=</span> <span class="n">ImageQt</span><span class="o">.</span><span class="n">ImageQt</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
<p>同样，你也可以 <strong>避免使用 Pillow</strong>。幸运的是，Qt 的 <code class="xref any docutils literal notranslate"><span class="pre">QImage</span></code> 支持原生 Python 指针，所以以下代码是创建 Qt 图像的推荐方式:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtGui</span><span class="w"> </span><span class="kn">import</span> <span class="n">QImage</span>

<span class="c1"># 根据 alpha 设置正确的 QImage 格式</span>
<span class="n">fmt</span> <span class="o">=</span> <span class="n">QImage</span><span class="o">.</span><span class="n">Format_RGBA8888</span> <span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span> <span class="k">else</span> <span class="n">QImage</span><span class="o">.</span><span class="n">Format_RGB888</span>
<span class="n">qtimg</span> <span class="o">=</span> <span class="n">QImage</span><span class="p">(</span><span class="n">pix</span><span class="o">.</span><span class="n">samples_ptr</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--14-input--2" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--2">英文</label><div class="tab-content docutils container">
<p>Please also see section 3.16 of the <a class="reference external" href="https://Pillow.readthedocs.io">Pillow documentation</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageQt</span>

<span class="c1"># set the mode depending on alpha</span>
<span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;RGBA&quot;</span> <span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span> <span class="k">else</span> <span class="s2">&quot;RGB&quot;</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">frombytes</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="p">[</span><span class="n">pix</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">height</span><span class="p">],</span> <span class="n">pix</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span>
<span class="n">qtimg</span> <span class="o">=</span> <span class="n">ImageQt</span><span class="o">.</span><span class="n">ImageQt</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
<p>Again, you also can get along <strong>without using Pillow.</strong> Qt’s <code class="xref any docutils literal notranslate"><span class="pre">QImage</span></code> luckily supports native Python pointers, so the following is the recommended way to create Qt images:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtGui</span><span class="w"> </span><span class="kn">import</span> <span class="n">QImage</span>

<span class="c1"># set the correct QImage format depending on alpha</span>
<span class="n">fmt</span> <span class="o">=</span> <span class="n">QImage</span><span class="o">.</span><span class="n">Format_RGBA8888</span> <span class="k">if</span> <span class="n">pix</span><span class="o">.</span><span class="n">alpha</span> <span class="k">else</span> <span class="n">QImage</span><span class="o">.</span><span class="n">Format_RGB888</span>
<span class="n">qtimg</span> <span class="o">=</span> <span class="n">QImage</span><span class="p">(</span><span class="n">pix</span><span class="o">.</span><span class="n">samples_ptr</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id13">
<h3>提取文本和图像<a class="headerlink" href="#id13" title="此标题的永久链接">#</a></h3>
<p>Extracting Text and Images</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--15-input--1" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--1">中文</label><div class="tab-content docutils container">
<p>我们还可以以多种不同的形式和详细级别提取页面上的所有文本、图像和其他信息:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span>
</pre></div>
</div>
<p>使用以下字符串之一作为 <em>opt</em> 来获取不同的格式 <a class="footnote-reference brackets" href="#f5" id="id14" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a>：</p>
<ul class="simple">
<li><p><strong>“text”</strong>:  (默认) 纯文本，带有换行符。没有格式，没有文本位置详情，也没有图像。</p></li>
<li><p><strong>“blocks”</strong>: 生成文本块 (即段落) 列表。</p></li>
<li><p><strong>“words”</strong>: 生成单词列表 (不包含空格的字符串) 。</p></li>
<li><p><strong>“html”</strong>: 创建页面的完整视觉版本，包括任何图像。可以使用浏览器显示。</p></li>
<li><p><strong>“dict”</strong> / <strong>“json”</strong>: 与 HTML 相同的信息级别，但以 Python 字典或 JSON 字符串的形式提供。有关其结构的详细信息，请参见 <a class="reference internal" href="textpage.html#TextPage.extractDICT" title="TextPage.extractDICT"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractDICT()</span></code></a>。</p></li>
<li><p><strong>“rawdict”</strong> / <strong>“rawjson”</strong>: <strong>“dict”</strong> / <strong>“json”</strong> 的超集。它还提供字符详细信息，如 XML。有关其结构的详细信息，请参见 <a class="reference internal" href="textpage.html#TextPage.extractRAWDICT" title="TextPage.extractRAWDICT"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractRAWDICT()</span></code></a>。</p></li>
<li><p><strong>“xhtml”</strong>: 作为文本版本的文本信息级别，但包括图像。也可以由浏览器显示。</p></li>
<li><p><strong>“xml”</strong>: 不包含图像，但包含每个文本字符的完整位置和字体信息。使用 XML 模块进行解析。</p></li>
</ul>
<p>为了给您一个关于这些替代方案输出的概念，我们提供了文本示例提取。请参见 <span class="xref std std-ref">附录1</span>。</p>
</div>
<input class="tab-input" id="tab-set--15-input--2" name="tab-set--15" type="radio"><label class="tab-label" for="tab-set--15-input--2">英文</label><div class="tab-content docutils container">
<p>We can also extract all text, images and other information of a page in many different forms, and levels of detail:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span>
</pre></div>
</div>
<p>Use one of the following strings for <em>opt</em> to obtain different formats <a class="footnote-reference brackets" href="#f2" id="id15" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>:</p>
<ul class="simple">
<li><p><strong>“text”</strong>: (default) plain text with line breaks. No formatting, no text position details, no images.</p></li>
<li><p><strong>“blocks”</strong>: generate a list of text blocks (= paragraphs).</p></li>
<li><p><strong>“words”</strong>: generate a list of words (strings not containing spaces).</p></li>
<li><p><strong>“html”</strong>: creates a full visual version of the page including any images. This can be displayed with your internet browser.</p></li>
<li><p><strong>“dict”</strong> / <strong>“json”</strong>: same information level as HTML, but provided as a Python dictionary or resp. JSON string. See <a class="reference internal" href="textpage.html#TextPage.extractDICT" title="TextPage.extractDICT"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractDICT()</span></code></a> for details of its structure.</p></li>
<li><p><strong>“rawdict”</strong> / <strong>“rawjson”</strong>: a super-set of <strong>“dict”</strong> / <strong>“json”</strong>. It additionally provides character detail information like XML. See <a class="reference internal" href="textpage.html#TextPage.extractRAWDICT" title="TextPage.extractRAWDICT"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextPage.extractRAWDICT()</span></code></a> for details of its structure.</p></li>
<li><p><strong>“xhtml”</strong>: text information level as the TEXT version but includes images. Can also be displayed by internet browsers.</p></li>
<li><p><strong>“xml”</strong>: contains no images, but full position and font information down to each single text character. Use an XML module to interpret.</p></li>
</ul>
<p>To give you an idea about the output of these alternatives, we did text example extracts. See <a class="reference internal" href="app1.html#appendix1"><span class="std std-ref">附录 1：文本提取详细信息</span></a>.</p>
</div>
</div>
</section>
<section id="id16">
<h3>搜索文本<a class="headerlink" href="#id16" title="此标题的永久链接">#</a></h3>
<p>Searching for Text</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--16-input--1" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--1">中文</label><div class="tab-content docutils container">
<p>您可以确切地找到页面上某个文本字符串出现的位置:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">areas</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">search_for</span><span class="p">(</span><span class="s2">&quot;mupdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>这将返回一个矩形列表 (参见 <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a>) ，每个矩形包围一个 “mupdf” 字符串的出现位置 (不区分大小写) 。您可以使用这些信息，例如在 PDF 中高亮显示这些区域，或者创建文档的交叉引用。</p>
<p>请务必查看 <span class="xref std std-ref">合作</span> 章节，并查看示例程序 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/demo/demo.py">demo.py</a> 和 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/demo/demo-lowlevel.py">demo-lowlevel.py</a>。其中包含了如何使用 <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a>、<a class="reference internal" href="device.html#device"><span class="std std-ref">设备</span></a> 和 <a class="reference internal" href="displaylist.html#displaylist"><span class="std std-ref">DisplayList</span></a> 类进行更直接的控制的详细信息，例如在性能考虑因素提示时使用。</p>
</div>
<input class="tab-input" id="tab-set--16-input--2" name="tab-set--16" type="radio"><label class="tab-label" for="tab-set--16-input--2">英文</label><div class="tab-content docutils container">
<p>You can find out, exactly where on a page a certain text string appears:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">areas</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">search_for</span><span class="p">(</span><span class="s2">&quot;mupdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This delivers a list of rectangles (see <a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a>), each of which surrounds one occurrence of the string “mupdf” (case insensitive). You could use this information to e.g. highlight those areas (PDF only) or create a cross reference of the document.</p>
<p>Please also do have a look at chapter <a class="reference internal" href="coop_low.html#cooperation"><span class="std std-ref">协同工作: DisplayList 和 TextPage</span></a> and at demo programs <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/demo/demo.py">demo.py</a> and <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/demo/demo-lowlevel.py">demo-lowlevel.py</a>. Among other things they contain details on how the <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a>, <a class="reference internal" href="device.html#device"><span class="std std-ref">设备</span></a> and <a class="reference internal" href="displaylist.html#displaylist"><span class="std std-ref">DisplayList</span></a> classes can be used for a more direct control, e.g. when performance considerations suggest it.</p>
</div>
</div>
</section>
</section>
<section id="story-html-pdf">
<span id="workingwithstories"></span><h2><a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a>：从 HTML 源生成 PDF<a class="headerlink" href="#story-html-pdf" title="此标题的永久链接">#</a></h2>
<p>Stories: Generating PDF from HTML Source</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--17-input--1" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--1">中文</label><div class="tab-content docutils container">
<p><a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a> 类是 PyMuPDF 版本 1.21.0 引入的新特性。它代表了对 MuPDF <strong>“story”</strong> 接口的支持。</p>
<p>以下是来自 <a class="reference external" href="https://www.artifex.com">Artifex</a> 的 Robin Watts 编写的书籍 <a class="reference external" href="https://mupdf.com/docs/mupdf-explored.html">“MuPDF Explored”</a> 中的摘录：</p>
<p><em>故事提供了一种简单的方法来布局带有样式的内容，用于设备，比如文档写入器提供的设备 (…) 。故事的概念源自桌面出版，进而 (…) 来自报纸。如果你考虑传统的报纸布局，它将包含各种新闻文章 (故事) ，这些文章被布局到多个栏目中，可能跨多个页面。</em></p>
<p><em>因此，MuPDF 使用故事来表示带有样式信息的文本流。故事的使用者随后可以提供一系列矩形，将故事布局到这些矩形中，定位后的文本可以被绘制到输出设备上。这将文本本身 (故事) 与文本应流入的区域 (布局) 分开。</em></p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>Story 的工作方式有点类似于互联网浏览器：它忠实地解析和渲染 HTML 超文本以及可选的样式表 (CSS) 。但它的 <strong>输出是 PDF</strong> — 而不是网页。</p>
</div>
<p>创建 <a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a> 时，会考虑最多来自三种不同信息来源的输入。所有这些项都是可选的。</p>
<ol class="arabic simple">
<li><p>HTML 源代码，可以是 Python 字符串，或者 <strong>由脚本创建</strong>，使用 <a class="reference internal" href="xml-class.html#xml"><span class="std std-ref">Xml</span></a> 的方法。</p></li>
<li><p>CSS (层叠样式表) 源代码，以 Python 字符串提供。CSS 可用于提供样式信息 (如文本字体大小、颜色等) ，就像网页一样。显然，这个字符串也可以从文件中读取。</p></li>
<li><p>当 DOM 引用图片或使用除标准 <a class="reference internal" href="app3.html#base-14-fonts"><span class="std std-ref">PDF Base 14 字体</span></a>、CJK 字体和 PyMuPDF 二进制生成的 NOTO 字体之外的文本字体时，必须使用 <a class="reference internal" href="archive-class.html#archive"><span class="std std-ref">Archive</span></a>。</p></li>
</ol>
<p><a class="reference internal" href="xml-class.html#xml"><span class="std std-ref">API</span></a> 允许完全从头创建 DOM，包括所需的样式信息。它也可以用来修改或扩展 <strong>提供的</strong> HTML：文本可以被删除或替换，或其样式可以被更改。还可以添加从数据库提取的文本，并填充类似模板的 HTML 文档。</p>
<p><strong>不要求</strong> 提供语法上完整的 HTML 文档：像 <code class="docutils literal notranslate"><span class="pre">&lt;b&gt;Hello</span> <span class="pre">&lt;i&gt;World!&lt;/i&gt;&lt;/b&gt;</span></code> 这样的片段完全可以接受，并且许多/大多数语法错误会被自动修正。</p>
<p>当 HTML 被认为完整后，它可以用于创建 PDF 文档。这是通过新的 <a class="reference internal" href="document-writer-class.html#documentwriter"><span class="std std-ref">DocumentWriter</span></a> 类完成的。程序员调用其方法来创建一个新的空白页面，并将矩形传递给 <a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a> 来填充它们。</p>
<p><a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a> 会返回完成代码，指示是否还有内容待写。内容的哪一部分将落到哪个矩形或页面上，自动由 <a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a> 本身决定 — 只能通过提供矩形来影响它。</p>
<p>请参阅 <a class="reference internal" href="recipes-stories.html#recipesstories"><span class="std std-ref">Stories recipes</span></a> 了解一些典型的用例。</p>
</div>
<input class="tab-input" id="tab-set--17-input--2" name="tab-set--17" type="radio"><label class="tab-label" for="tab-set--17-input--2">英文</label><div class="tab-content docutils container">
<p>The <a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a> class is a new feature of PyMuPDF version 1.21.0. It represents support for MuPDF’s <strong>“story”</strong> interface.</p>
<p>The following is a quote from the book <a class="reference external" href="https://mupdf.com/docs/mupdf-explored.html">“MuPDF Explored”</a> by Robin Watts from <a class="reference external" href="https://www.artifex.com">Artifex</a>:</p>
<p><em>Stories provide a way to easily layout styled content for use with devices, such as those offered by Document Writers (…). The concept of a story comes from desktop publishing, which in turn (…) gets it from newspapers. If you consider a traditional newspaper layout, it will consist of various news articles (stories) that are laid out into multiple columns, possibly across multiple pages.</em></p>
<p><em>Accordingly, MuPDF uses a story to represent a flow of text with styling information. The user of the story can then supply a sequence of rectangles into which the story will be laid out, and the positioned text can then be drawn to an output device. This keeps the concept of the text itself (the story) to be separated from the areas into which the text should be flowed (the layout).</em></p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>A Story works somewhat similar to an internet browser: It faithfully parses and renders HTML hypertext and also optional stylesheets (CSS). But its <strong>output is a PDF</strong> – not web pages.</p>
</div>
<p>When creating a <a class="reference internal" href="story-class.html#story"><span class="std std-ref">Story</span></a>, the input from up to three different information sources is taken into account. All these items are optional.</p>
<ol class="arabic simple">
<li><p>HTML source code, either a Python string or <strong>created by the script</strong> using methods of <a class="reference internal" href="xml-class.html#xml"><span class="std std-ref">Xml</span></a>.</p></li>
<li><p>CSS (Cascaded Style Sheet) source code, provided as a Python string. CSS can be used to provide styling information (text font size, color, etc.) like it would happen for web pages. Obviously, this string may also be read from a file.</p></li>
<li><p>An <a class="reference internal" href="archive-class.html#archive"><span class="std std-ref">Archive</span></a> <strong>must be used</strong> whenever the DOM references images, or uses text fonts except the standard <a class="reference internal" href="app3.html#base-14-fonts"><span class="std std-ref">PDF Base 14 字体</span></a>, CJK fonts and the NOTO fonts generated into the PyMuPDF binary.</p></li>
</ol>
<p>The <a class="reference internal" href="xml-class.html#xml"><span class="std std-ref">API</span></a> allows creating DOMs completely from scratch, including desired styling information. It can also be used to modify or extend <strong>provided</strong> HTML: text can be deleted or replaced, or its styling can be changed. Text – for example extracted from databases – can also be added and fill template-like HTML documents.</p>
<p>It is <strong>not required</strong> to provide syntactically complete HTML documents: snippets like <code class="docutils literal notranslate"><span class="pre">&lt;b&gt;Hello</span> <span class="pre">&lt;i&gt;World!&lt;/i&gt;&lt;/b&gt;</span></code> are fully accepted, and many / most syntax errors are automatically corrected.</p>
<p>After the HTML is considered complete, it can be used to create a PDF document. This happens via the new <a class="reference internal" href="document-writer-class.html#documentwriter"><span class="std std-ref">DocumentWriter</span></a> class. The programmer calls its methods to create a new empty page, and passes rectangles to the Story to fill them.</p>
<p>The story in turn will return completion codes indicating whether or not more content is waiting to be written. Which part of the content will land in which rectangle or on which page is automatically determined by the story itself – it cannot be influenced other than by providing the rectangles.</p>
<p>Please see the <a class="reference internal" href="recipes-stories.html#recipesstories"><span class="std std-ref">Stories recipes</span></a> for a number of typical use cases.</p>
</div>
</div>
</section>
<section id="pdf">
<h2>PDF 维护<a class="headerlink" href="#pdf" title="此标题的永久链接">#</a></h2>
<p>PDF Maintenance</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--18-input--1" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--1">中文</label><div class="tab-content docutils container">
<p>PDF 是唯一可以使用 PyMuPDF <strong>修改</strong> 的文档类型。其他文件类型都是只读的。</p>
<p>然而，您可以将 <strong>任何文档</strong>  (包括图像) 转换为 PDF，然后对转换结果应用所有 PyMuPDF 功能。有关更多信息，请参阅 <a class="reference internal" href="document.html#Document.convert_to_pdf" title="Document.convert_to_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.convert_to_pdf()</span></code></a>，并查看演示脚本 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/convert-document/convert.py">pdf-converter.py</a>，该脚本可以将任何 <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">supported document</span></a> 转换为 PDF。</p>
<p><a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> 始终将 PDF 以当前 (可能已修改) 状态保存到磁盘。</p>
<p>您通常可以选择将文件保存到新文件，或者将修改追加到现有文件 (“增量保存”) ，后者通常非常快。</p>
<p>以下描述了您可以如何操作 PDF 文档。此描述并非完整：更多内容可以在接下来的章节中找到。</p>
</div>
<input class="tab-input" id="tab-set--18-input--2" name="tab-set--18" type="radio"><label class="tab-label" for="tab-set--18-input--2">英文</label><div class="tab-content docutils container">
<p>PDFs are the only document type that can be <strong>modified</strong> using PyMuPDF. Other file types are read-only.</p>
<p>However, you can convert <strong>any document</strong> (including images) to a PDF and then apply all PyMuPDF features to the conversion result. Find out more here <a class="reference internal" href="document.html#Document.convert_to_pdf" title="Document.convert_to_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.convert_to_pdf()</span></code></a>, and also look at the demo script <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/convert-document/convert.py">pdf-converter.py</a> which can convert any <a class="reference internal" href="how-to-open-a-file.html#supported-file-types"><span class="std std-ref">supported document</span></a> to PDF.</p>
<p><a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> always stores a PDF in its current (potentially modified) state on disk.</p>
<p>You normally can choose whether to save to a new file, or just append your modifications to the existing one (“incremental save”), which often is very much faster.</p>
<p>The following describes ways how you can manipulate PDF documents. This description is by no means complete: much more can be found in the following chapters.</p>
</div>
</div>
<section id="id17">
<h3>修改、创建、重新排列和删除页面<a class="headerlink" href="#id17" title="此标题的永久链接">#</a></h3>
<p>Modifying, Creating, Re-arranging and Deleting Pages</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--19-input--1" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--1">中文</label><div class="tab-content docutils container">
<p>PDF 的 <strong>页面树</strong> (描述所有页面的结构) 可以通过多种方式进行操作：</p>
<p><a class="reference internal" href="document.html#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_page()</span></code></a> 和 <a class="reference internal" href="document.html#Document.delete_pages" title="Document.delete_pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_pages()</span></code></a> 用于删除页面。</p>
<p><a class="reference internal" href="document.html#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.copy_page()</span></code></a>、<a class="reference internal" href="document.html#Document.fullcopy_page" title="Document.fullcopy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.fullcopy_page()</span></code></a> 和 <a class="reference internal" href="document.html#Document.move_page" title="Document.move_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.move_page()</span></code></a> 用于在同一文档内复制或移动页面。</p>
<p><a class="reference internal" href="document.html#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a> 允许根据指定的页面序列缩小 PDF。参数是一个包含要保留的页面编号的序列 <a class="footnote-reference brackets" href="#f6" id="id18" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>。这些整数必须满足 <em>0 &lt;= i &lt; page_count</em> 。执行后，未包含在此列表中的所有页面都会被删除。剩余的页面将按照指定顺序出现，并且可以重复出现多次。</p>
<p>因此，您可以轻松创建新的 PDF 文件，例如：</p>
<ul class="simple">
<li><p>仅包含前 10 页或后 10 页，</p></li>
<li><p>仅包含奇数页或偶数页 (用于双面打印) ，</p></li>
<li><p>仅包含 (或不包含) 特定文本的页面，</p></li>
<li><p>反转页面顺序，……</p></li>
</ul>
<p>… 以及任何您能想到的操作。</p>
<p>保存的新文档仍然会包含有效的链接、注释和书签 (即指向选定页面或外部资源) 。</p>
<p><a class="reference internal" href="document.html#Document.insert_page" title="Document.insert_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a> 和 <a class="reference internal" href="document.html#Document.new_page" title="Document.new_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.new_page()</span></code></a> 可用于插入新页面。</p>
<p>此外，页面本身还可以通过多种方法进行修改，例如页面旋转、注释和链接管理、文本和图像插入等。</p>
</div>
<input class="tab-input" id="tab-set--19-input--2" name="tab-set--19" type="radio"><label class="tab-label" for="tab-set--19-input--2">英文</label><div class="tab-content docutils container">
<p>There are several ways to manipulate the so-called <strong>page tree</strong> (a structure describing all the pages) of a PDF:</p>
<p><a class="reference internal" href="document.html#Document.delete_page" title="Document.delete_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_page()</span></code></a> and <a class="reference internal" href="document.html#Document.delete_pages" title="Document.delete_pages"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.delete_pages()</span></code></a> delete pages.</p>
<p><a class="reference internal" href="document.html#Document.copy_page" title="Document.copy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.copy_page()</span></code></a>, <a class="reference internal" href="document.html#Document.fullcopy_page" title="Document.fullcopy_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.fullcopy_page()</span></code></a> and <a class="reference internal" href="document.html#Document.move_page" title="Document.move_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.move_page()</span></code></a> copy or move a page to other locations within the same document.</p>
<p><a class="reference internal" href="document.html#Document.select" title="Document.select"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.select()</span></code></a> shrinks a PDF down to selected pages. Parameter is a sequence <a class="footnote-reference brackets" href="#f3" id="id19" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> of the page numbers that you want to keep. These integers must all be in range <em>0 &lt;= i &lt; page_count</em>. When executed, all pages <strong>missing</strong> in this list will be deleted. Remaining pages will occur <strong>in the sequence and as many times (!) as you specify them</strong>.</p>
<p>So you can easily create new PDFs with</p>
<ul class="simple">
<li><p>the first or last 10 pages,</p></li>
<li><p>only the odd or only the even pages (for doing double-sided printing),</p></li>
<li><p>pages that <strong>do</strong> or <strong>don’t</strong> contain a given text,</p></li>
<li><p>reverse the page sequence, …</p></li>
</ul>
<p>… whatever you can think of.</p>
<p>The saved new document will contain links, annotations and bookmarks that are still valid (i.a.w. either pointing to a selected page or to some external resource).</p>
<p><a class="reference internal" href="document.html#Document.insert_page" title="Document.insert_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_page()</span></code></a> and <a class="reference internal" href="document.html#Document.new_page" title="Document.new_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.new_page()</span></code></a> insert new pages.</p>
<p>Pages themselves can moreover be modified by a range of methods (e.g. page rotation, annotation and link maintenance, text and image insertion).</p>
</div>
</div>
</section>
<section id="id20">
<h3>合并和拆分 PDF 文档<a class="headerlink" href="#id20" title="此标题的永久链接">#</a></h3>
<p>Joining and Splitting PDF Documents</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--20-input--1" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--1">中文</label><div class="tab-content docutils container">
<p><a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a> 方法用于 <strong>在不同</strong> PDF 文档之间复制页面。以下是一个简单的 <strong>合并</strong> 示例 (假设 <em>doc1</em> 和 <em>doc2</em> 是已打开的 PDF 文档)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 将 doc2 的所有页面追加到 doc1 末尾</span>
<span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">)</span>
</pre></div>
</div>
<p>下面是一个 <strong>拆分</strong> <em>doc1</em> 的示例。它创建一个新文档，其中包含 <em>doc1</em> 的前 10 页和后 10 页:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc2</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>                 <span class="c1"># 创建新的空 PDF</span>
<span class="n">doc2</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc1</span><span class="p">,</span> <span class="n">to_page</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>  <span class="c1"># 复制前 10 页</span>
<span class="n">doc2</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc1</span><span class="p">,</span> <span class="n">from_page</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">doc1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># 复制后 10 页</span>
<span class="n">doc2</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;first-and-last-10.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>更多信息请参考 <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> 章节，同时也可以查看 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py">PDFjoiner.py</a> 示例。</p>
</div>
<input class="tab-input" id="tab-set--20-input--2" name="tab-set--20" type="radio"><label class="tab-label" for="tab-set--20-input--2">英文</label><div class="tab-content docutils container">
<p>Method <a class="reference internal" href="document.html#Document.insert_pdf" title="Document.insert_pdf"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.insert_pdf()</span></code></a> copies pages <strong>between different</strong> PDF documents. Here is a simple <strong>joiner</strong> example (<em>doc1</em> and <em>doc2</em> being opened PDFs):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># append complete doc2 to the end of doc1</span>
<span class="n">doc1</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc2</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is a snippet that <strong>splits</strong> <em>doc1</em>. It creates a new document of its first and its last 10 pages:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">doc2</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>                 <span class="c1"># new empty PDF</span>
<span class="n">doc2</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc1</span><span class="p">,</span> <span class="n">to_page</span> <span class="o">=</span> <span class="mi">9</span><span class="p">)</span>  <span class="c1"># first 10 pages</span>
<span class="n">doc2</span><span class="o">.</span><span class="n">insert_pdf</span><span class="p">(</span><span class="n">doc1</span><span class="p">,</span> <span class="n">from_page</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">doc1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># last 10 pages</span>
<span class="n">doc2</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;first-and-last-10.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>More can be found in the <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> chapter. Also have a look at <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/join-documents/join.py">PDFjoiner.py</a>.</p>
</div>
</div>
</section>
<section id="id21">
<h3>嵌入数据<a class="headerlink" href="#id21" title="此标题的永久链接">#</a></h3>
<p>Embedding Data</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--21-input--1" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--1">中文</label><div class="tab-content docutils container">
<p>PDF 文档可以作为容器存储任意数据 (如可执行文件、其他 PDF、文本或二进制文件等) ，类似于 ZIP 压缩包。</p>
<p>PyMuPDF 通过 <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> 的 <em>embfile_</em> 方法和属性完全支持此功能。有关详细信息，请参阅 <span class="xref std std-ref">附录 3</span>，或者访问 Wiki 页面 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/wiki/Dealing-with-Embedded-Files">dealing with embedding files</a>，以及示例脚本 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/copy-embedded/copy.py">embedded-copy.py</a>、 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/export-embedded/export.py">embedded-export.py</a>、 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/import-embedded/import.py">embedded-import.py</a> 和 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/list-embedded/list.py">embedded-list.py</a>。</p>
</div>
<input class="tab-input" id="tab-set--21-input--2" name="tab-set--21" type="radio"><label class="tab-label" for="tab-set--21-input--2">英文</label><div class="tab-content docutils container">
<p>PDFs can be used as containers for arbitrary data (executables, other PDFs, text or binary files, etc.) much like ZIP archives.</p>
<p>PyMuPDF fully supports this feature via <a class="reference internal" href="document.html#document"><span class="std std-ref">Document</span></a> <em>embfile_*</em> methods and attributes. For some detail read <span class="xref std std-ref">Appendix 3</span>, consult the Wiki on <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/wiki/Dealing-with-Embedded-Files">dealing with embedding files</a>, or the example scripts <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/copy-embedded/copy.py">embedded-copy.py</a>, <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/export-embedded/export.py">embedded-export.py</a>, <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/import-embedded/import.py">embedded-import.py</a>, and <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/blob/master/examples/list-embedded/list.py">embedded-list.py</a>.</p>
</div>
</div>
</section>
<section id="id22">
<h3>保存<a class="headerlink" href="#id22" title="此标题的永久链接">#</a></h3>
<p>Saving</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--22-input--1" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--1">中文</label><div class="tab-content docutils container">
<p>如上所述，<a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> 方法 <strong>始终</strong> 以当前状态保存文档。</p>
<p>如果指定选项 <em>incremental=True</em>，可以将更改写回 <strong>原始 PDF</strong>。此过程通常 <strong>极快</strong>，因为更改只是 <strong>追加</strong> 到原文件，而不会完全重写它。</p>
<p><a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> 选项与 MuPDF 命令行工具 <em>mutool clean</em> 的选项对应，具体如下表所示。</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>关于 <em>object, stream, xref</em> 等术语的解释，请参阅 <a class="reference internal" href="glossary.html#glossary"><span class="std std-ref">术语</span></a> 章节。</p>
</div>
<p>例如，执行 <em>mutool clean -ggggz file.pdf</em> 可以获得极佳的压缩效果，其等效的 PyMuPDF 代码为 <em>doc.save(filename, garbage=4, deflate=True)</em>。</p>
</div>
<input class="tab-input" id="tab-set--22-input--2" name="tab-set--22" type="radio"><label class="tab-label" for="tab-set--22-input--2">英文</label><div class="tab-content docutils container">
<p>As mentioned above, <a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> will <strong>always</strong> save the document in its current state.</p>
<p>You can write changes back to the <strong>original PDF</strong> by specifying option <em>incremental=True</em>. This process is (usually) <strong>extremely fast</strong>, since changes are <strong>appended to the original file</strong> without completely rewriting it.</p>
<p><a class="reference internal" href="document.html#Document.save" title="Document.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.save()</span></code></a> options correspond to options of MuPDF’s command line utility <em>mutool clean</em>, see the following table.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Save Option</strong></p></th>
<th class="head"><p><strong>mutool</strong></p></th>
<th class="head"><p><strong>Effect</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>garbage=1</p></td>
<td><p>g</p></td>
<td><p>garbage collect unused objects</p></td>
</tr>
<tr class="row-odd"><td><p>garbage=2</p></td>
<td><p>gg</p></td>
<td><p>in addition to 1, compact <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> tables</p></td>
</tr>
<tr class="row-even"><td><p>garbage=3</p></td>
<td><p>ggg</p></td>
<td><p>in addition to 2, merge duplicate objects</p></td>
</tr>
<tr class="row-odd"><td><p>garbage=4</p></td>
<td><p>gggg</p></td>
<td><p>in addition to 3, merge duplicate stream content</p></td>
</tr>
<tr class="row-even"><td><p>clean=True</p></td>
<td><p>cs</p></td>
<td><p>clean and sanitize content streams</p></td>
</tr>
<tr class="row-odd"><td><p>deflate=True</p></td>
<td><p>z</p></td>
<td><p>deflate uncompressed streams</p></td>
</tr>
<tr class="row-even"><td><p>deflate_images=True</p></td>
<td><p>i</p></td>
<td><p>deflate image streams</p></td>
</tr>
<tr class="row-odd"><td><p>deflate_fonts=True</p></td>
<td><p>f</p></td>
<td><p>deflate fontfile streams</p></td>
</tr>
<tr class="row-even"><td><p>ascii=True</p></td>
<td><p>a</p></td>
<td><p>convert binary data to ASCII format</p></td>
</tr>
<tr class="row-odd"><td><p>linear=True</p></td>
<td><p>l</p></td>
<td><p>create a linearized version</p></td>
</tr>
<tr class="row-even"><td><p>expand=True</p></td>
<td><p>d</p></td>
<td><p>decompress all streams</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>For an explanation of terms like <em>object, stream, xref</em> consult the <a class="reference internal" href="glossary.html#glossary"><span class="std std-ref">术语</span></a> chapter.</p>
</div>
<p>For example, <em>mutool clean -ggggz file.pdf</em> yields excellent compression results. It corresponds to <em>doc.save(filename, garbage=4, deflate=True)</em>.</p>
</div>
</div>
</section>
</section>
<section id="id23">
<h2>关闭<a class="headerlink" href="#id23" title="此标题的永久链接">#</a></h2>
<p>Closing</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--23-input--1" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--1">中文</label><div class="tab-content docutils container">
<p>通常，在程序运行时，”close” 文档以释放对底层文件的控制权，使操作系统能够管理它，是一种理想的做法。</p>
<p>可以使用 <a class="reference internal" href="document.html#Document.close" title="Document.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.close()</span></code></a> 方法实现这一点。除了关闭底层文件外，该方法还会释放与文档相关的缓冲区。</p>
</div>
<input class="tab-input" id="tab-set--23-input--2" name="tab-set--23" type="radio"><label class="tab-label" for="tab-set--23-input--2">英文</label><div class="tab-content docutils container">
<p>It is often desirable to “close” a document to relinquish control of the underlying file to the OS, while your program continues.</p>
<p>This can be achieved by the <a class="reference internal" href="document.html#Document.close" title="Document.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Document.close()</span></code></a> method. Apart from closing the underlying file, buffer areas associated with the document will be freed.</p>
</div>
</div>
</section>
<section id="id24">
<h2>进一步阅读<a class="headerlink" href="#id24" title="此标题的永久链接">#</a></h2>
<p>Further Reading</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--24-input--1" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--1">中文</label><div class="tab-content docutils container">
<p>另外，还可以查看 PyMuPDF 的 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/wiki">Wiki</a> 页面。特别是侧边栏标题 <strong>“Recipes”</strong> 下列出的内容，涵盖了 15 多个主题，并采用 “How-To” 风格编写。</p>
<p>本文档还包含一个 <a class="reference internal" href="faq.html#faq"><span class="std std-ref">FAQ</span></a> 章节，该部分与上述 Recipes 紧密相关，并且会随着时间的推移不断扩展内容。</p>
</div>
<input class="tab-input" id="tab-set--24-input--2" name="tab-set--24" type="radio"><label class="tab-label" for="tab-set--24-input--2">英文</label><div class="tab-content docutils container">
<p>Also have a look at PyMuPDF’s <a class="reference external" href="https://github.com/pymupdf/PyMuPDF/wiki">Wiki</a> pages. Especially those named in the sidebar under title <strong>“Recipes”</strong> cover over 15 topics written in “How-To” style.</p>
<p>This document also contains a <a class="reference internal" href="faq.html#faq"><span class="std std-ref">FAQ</span></a>. This chapter has close connection to the aforementioned recipes, and it will be extended with more content over time.</p>
</div>
</div>
<hr class="docutils" />
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="f1" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">1</a><span class="fn-bracket">]</span></span>
<p>PyMuPDF lets you also open several image file types just like normal documents. See section <a class="reference internal" href="pixmap.html#imagefiles"><span class="std std-ref">支持的输入图片格式</span></a> in chapter <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> for more comments.</p>
</aside>
<aside class="footnote brackets" id="f2" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id15">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> is a convenience wrapper for several methods of another PyMuPDF class, <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a>. The names of these methods correspond to the argument string passed to <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> :  <em>Page.get_text(“dict”)</em> is equivalent to <em>TextPage.extractDICT()</em> .</p>
</aside>
<aside class="footnote brackets" id="f3" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id19">3</a><span class="fn-bracket">]</span></span>
<p>“Sequences” are Python objects conforming to the sequence protocol. These objects implement a method named <em>__getitem__()</em>. Best known examples are Python tuples and lists. But <em>array.array</em>, <em>numpy.array</em> and PyMuPDF’s “geometry” objects (<a class="reference internal" href="algebra.html#algebra"><span class="std std-ref">几何对象的运算符代数</span></a>) are sequences, too. Refer to <a class="reference internal" href="app3.html#sequencetypes"><span class="std std-ref">在 PyMuPDF 中使用 Python 序列作为参数</span></a> for details.</p>
</aside>
<aside class="footnote brackets" id="f4" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">4</a><span class="fn-bracket">]</span></span>
<p>PyMuPDF 还允许您像打开普通文档一样打开多种图像文件类型。请参阅 <a class="reference internal" href="pixmap.html#pixmap"><span class="std std-ref">Pixmap</span></a> 章节中的 <a class="reference internal" href="pixmap.html#imagefiles"><span class="std std-ref">支持的输入图片格式</span></a> 部分，以获取更多相关信息。</p>
</aside>
<aside class="footnote brackets" id="f5" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id14">5</a><span class="fn-bracket">]</span></span>
<p><a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> 是对 PyMuPDF 另一个类 <a class="reference internal" href="textpage.html#textpage"><span class="std std-ref">TextPage</span></a> 多种方法的封装。传递给 <a class="reference internal" href="page.html#Page.get_text" title="Page.get_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.get_text()</span></code></a> 的参数字符串与这些方法的名称相对应。例如，<em>Page.get_text(“dict”)</em> 等价于 <em>TextPage.extractDICT()</em> 。</p>
</aside>
<aside class="footnote brackets" id="f6" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id18">6</a><span class="fn-bracket">]</span></span>
<p>“序列” (Sequences) 是符合 Python 序列协议的对象。这些对象实现了一个名为 <em>__getitem__()</em> 的方法。最常见的例子是 Python 的元组 (tuple) 和列表 (list) 。此外，<em>array.array</em>、<em>numpy.array</em> 以及 PyMuPDF 的 “几何” 对象 (<a class="reference internal" href="algebra.html#algebra"><span class="std std-ref">几何对象的运算符代数</span></a>) 也是序列。更多详情请参考 <a class="reference internal" href="app3.html#sequencetypes"><span class="std std-ref">在 PyMuPDF 中使用 Python 序列作为参数</span></a> 章节。</p>
</aside>
</aside>
<div class="feedbackLink"><a id="feedbackLinkBottom" target=_blank>您对此页面有任何反馈吗？</b></a></div><hr class="docutils" />
<script>

   var url_string = window.location.href;
   var a = document.getElementById('feedbackLinkBottom');
   a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link&url="+url_string);

</script>

<p style="color:#999" id="footerDisclaimer">本软件按原样提供，不作任何明示或暗示担保。本软件根据许可分发，除非根据该许可条款明确授权，否则不得复制、修改或分发。请参阅 <a href="https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link">artifex.com</a> 上的许可信息，或联系 Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States 了解更多信息。</p>



<script>

   let docLanguage = document.getElementsByTagName('html')[0].getAttribute('lang');

   function getHeaderAndFooterTranslation(str) {
       if (docLanguage == "ja") {
           if (str == "Do you have any feedback on this page?") {
               return "このページに関するご意見はありますか？";
           } else if (str == "Find <b>#pymupdf</b> on <b>Discord</b>") {
               return "<b>Discord</b>の <b>#pymupdf</b> を見つける";
           } else if (str == "This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.") {

               return "このソフトウェアは無保証で提供されており、明示または黙示を問わず、いかなる保証もありません。このソフトウェアはライセンスの下で配布され、ライセンスの条件に明示的に許可されている場合を除き、コピー、変更、または配布してはなりません。ライセンシング情報については、<a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a>でライセンス情報を参照するか、アメリカ合衆国カリフォルニア州サンフランシスコのArtifex Software Inc. までお問い合わせください。"

           }
       }

       return str;
   }

   document.getElementById("findOnDiscord").innerHTML = getHeaderAndFooterTranslation("Find <b>#pymupdf</b> on <b>Discord</b>");
   document.getElementById("feedbackLinkTop").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("feedbackLinkBottom").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("footerDisclaimer").innerHTML = getHeaderAndFooterTranslation("This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.");


   // more translation for admonition-title as the in-built translation isn't great, needs: 注釈 -> 注
   if (docLanguage == "ja") {
       const collection = document.getElementsByClassName("admonition-title");
       for (var i=0;i<collection.length;i++) {
           collection[i].innerHTML = "注";
       }
   }


</script><p class="footer-version">This documentation covers all versions up to 1.25.4.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="rag.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">PyMuPDF、LLM 和 RAG</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="the-basics.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">基础用法</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2025, Artifex
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 19. 3月 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">教程</a><ul>
<li><a class="reference internal" href="#id4">导入绑定</a><ul>
<li><a class="reference internal" href="#fitz">注意名称 <em>fitz</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tutorial-opening-a-document">打开文档</a></li>
<li><a class="reference internal" href="#document">一些 <span class="xref std std-ref">Document</span> 方法和属性</a></li>
<li><a class="reference internal" href="#id7">访问元数据</a></li>
<li><a class="reference internal" href="#id8">使用大纲</a></li>
<li><a class="reference internal" href="#id9">使用页面</a><ul>
<li><a class="reference internal" href="#id10">检查页面的链接、注释或表单字段</a></li>
<li><a class="reference internal" href="#id11">渲染页面</a></li>
<li><a class="reference internal" href="#id12">将页面图像保存在文件中</a></li>
<li><a class="reference internal" href="#displaying-the-image-in-guis">Displaying the Image in GUIs</a><ul>
<li><a class="reference internal" href="#wxpython">wxPython</a></li>
<li><a class="reference internal" href="#tkinter">Tkinter</a></li>
<li><a class="reference internal" href="#pyqt4pyqt5pyside">PyQt4、PyQt5、PySide</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id13">提取文本和图像</a></li>
<li><a class="reference internal" href="#id16">搜索文本</a></li>
</ul>
</li>
<li><a class="reference internal" href="#story-html-pdf"><span class="xref std std-ref">Story</span>：从 HTML 源生成 PDF</a></li>
<li><a class="reference internal" href="#pdf">PDF 维护</a><ul>
<li><a class="reference internal" href="#id17">修改、创建、重新排列和删除页面</a></li>
<li><a class="reference internal" href="#id20">合并和拆分 PDF 文档</a></li>
<li><a class="reference internal" href="#id21">嵌入数据</a></li>
<li><a class="reference internal" href="#id22">保存</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id23">关闭</a></li>
<li><a class="reference internal" href="#id24">进一步阅读</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/tabs.js"></script>
    <script src="_static/translations.js"></script>
    </body>
</html>