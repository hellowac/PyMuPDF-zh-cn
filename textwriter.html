<!doctype html>
<html class="no-js" lang="zh-CN">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="Artifex" name="author" />
<meta content="PyMuPDF 是一个高性能 Python 库，用于 PDF（及其他）文档的数据提取、分析、转换和操作。" name="description" />
<meta content="PDF Text Extraction, PDF Image Extraction, PDF Conversion, PDF Tables, PDF Splitting, PDF Creation, Pyodide, PyScript" name="keywords" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZTN4VTL9M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JZTN4VTL9M');
    </script>
    <link rel="author" title="关于此文档" href="about.html" /><link rel="index" title="索引" href="genindex.html" /><link rel="search" title="搜索" href="search.html" /><link rel="next" title="Tools" href="tools.html" /><link rel="prev" title="TextPage" href="textpage.html" />

    <link rel="shortcut icon" href="_static/PyMuPDF.ico"/><!-- Generated with Sphinx 5.3.0 and Furo 2023.03.27 -->
        <title>TextWriter - PyMuPDF 1.25.4 文档</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMuPDF 1.25.4 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/sidebar-logo-dark.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/sidebar-logo-light.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PyMuPDF 1.25.4 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">关于/About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="about.html">功能比较</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-performance">性能</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html#about-license">许可和版权</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf4llm/index.html">PyMuPDF4LLM</a></li>
<li class="toctree-l1"><a class="reference internal" href="pymupdf-pro.html">PyMuPDF Pro</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">用户指南/User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="the-basics.html">基础用法</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="rag.html">PyMuPDF、LLM 和 RAG</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">资源</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">教程/How to Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how-to-open-a-file.html">打开文件</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-text.html">文本</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-images.html">图片</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-annotations.html">注释</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-drawing-and-graphics.html">绘图和图形</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-stories.html">故事</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-journalling.html">日记</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-multiprocessing.html">多进程</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-ocr.html">OCR - 光学字符识别</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-optional-content.html">可选内容支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-low-level-interfaces.html">低级接口</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes-common-issues-and-their-solutions.html">常见问题及其解决方案</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API参考/API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="module.html">命令行界面</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="classes.html">类</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="annot.html">Annot</a></li>
<li class="toctree-l2"><a class="reference internal" href="archive-class.html">Archive</a></li>
<li class="toctree-l2"><a class="reference internal" href="colorspace.html">Colorspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="displaylist.html">DisplayList</a></li>
<li class="toctree-l2"><a class="reference internal" href="document.html">Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="document-writer-class.html">DocumentWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="font.html">Font</a></li>
<li class="toctree-l2"><a class="reference internal" href="identity.html">Identity</a></li>
<li class="toctree-l2"><a class="reference internal" href="irect.html">IRect</a></li>
<li class="toctree-l2"><a class="reference internal" href="link.html">Link</a></li>
<li class="toctree-l2"><a class="reference internal" href="linkdest.html">linkDest</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="outline.html">Outline</a></li>
<li class="toctree-l2"><a class="reference internal" href="page.html">Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="pixmap.html">Pixmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="point.html">Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="quad.html">Quad</a></li>
<li class="toctree-l2"><a class="reference internal" href="rect.html">Rect</a></li>
<li class="toctree-l2"><a class="reference internal" href="shape.html">Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="story-class.html">Story</a></li>
<li class="toctree-l2"><a class="reference internal" href="textpage.html">TextPage</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">TextWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="widget.html">Widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="xml-class.html">Xml</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="algebra.html">几何对象的运算符代数</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lowlevel.html">低级函数和类</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="functions.html">函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="device.html">设备</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop_low.html">协同工作: DisplayList 和 TextPage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="vars.html">常量和枚举</a></li>
<li class="toctree-l1"><a class="reference internal" href="colors.html">颜色数据库</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">其他/Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="app1.html">附录 1：文本提取详细信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app2.html">附录 2：嵌入式文件的注意事项</a></li>
<li class="toctree-l1"><a class="reference internal" href="app3.html">附录 3：各类技术信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="app4.html">附录 4：性能比较方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">更新日志</a></li>
<li class="toctree-l1"><a class="reference internal" href="znames.html">已废弃名称</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div style="display:flex;justify-content:space-between;align-items: center;">
    <form class="sidebar-search-container top" method="get" action="search.html" role="search" style="width:75%">
      <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
      <input type="hidden" name="check_keywords" value="yes">
      <input type="hidden" name="area" value="default">
    </form>
</div>

<div style="display:flex;justify-content:space-between;align-items:center;margin-top:20px;">
    <div class="discordLink" style="display:flex;align-items:center;margin-top: -5px;">
        <a href="https://discord.gg/TSpYGBW4eq" id="findOnDiscord" target=_blank>Find <b>#pymupdf</b> on <b>Discord</b></a>
        <a href="https://discord.gg/TSpYGBW4eq" target=_blank>
            <div style="width:30px;height:30px;margin-left:5px;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36">
                    <defs>
                        <style>.discordLogoFill{fill:#5865f2;}</style>
                    </defs>
                    <g id="Discord_Logo" data-name="Discord Logo">
                        <path class="discordLogoFill" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
                    </g>
                </svg>
            </div>
        </a>
    </div>

</div><section id="textwriter">
<span id="id1"></span><h1>TextWriter<a class="headerlink" href="#textwriter" title="此标题的永久链接">#</a></h1>
<p><div style="width:100%; text-align:right"><b>This class is for PDF only.</b></div></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">中文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p>新功能 v1.16.18</p></li>
</ul>
<p>此类表示 MuPDF <em>文本</em> 对象。基本思想是 <strong>解耦 (1) 文本准备和 (2) 文本输出</strong> 到 PDF 页面。</p>
<p>在 <strong>准备阶段</strong>，文本写入器存储任意数量的文本片段（“跨度”），并附带其位置和各自的字体信息。<strong>输出</strong> 可以多次发生，且每次输出到具有兼容页面大小的 PDF 页面。</p>
<p>文本写入器是 <a class="reference internal" href="page.html#Page.insert_text" title="Page.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_text()</span></code></a> 等方法的优雅替代方案：</p>
<ul class="simple">
<li><p><strong>改进的文本定位：</strong> 选择插入文本的起始点。存储文本后，返回的是该跨度的 <em>最后一个字符</em> 后的位置（光标位置）。</p></li>
<li><p><strong>自由选择字体：</strong> 每个文本跨度都有自己的字体和 <a class="reference internal" href="glossary.html#fontsize" title="fontsize"><code class="xref py py-data docutils literal notranslate"><span class="pre">fontsize</span></code></a>。这使得在组合大量文本时，轻松切换字体。</p></li>
<li><p><strong>自动回退字体：</strong> 如果选定的字体不支持某个字符，将自动搜索替代字体。这显著降低了在输出中看到无法打印符号（“TOFU”——看起来像一个小矩形）的风险。PyMuPDF 现在还带有 <strong>通用字体 “Droid Sans Fallback Regular”</strong>，支持 <strong>所有拉丁字符</strong> （包括西里尔字母和希腊字母），以及 <strong>所有 CJK 字符</strong> （中文、日文、韩文）。</p></li>
<li><p><strong>西里尔字母和希腊字母支持：</strong> <a class="reference internal" href="app3.html#base-14-fonts"><span class="std std-ref">PDF Base 14 字体</span></a> 集成了对西里尔字母和希腊字母的支持 <strong>无需指定编码</strong>。您的文本可以是拉丁字母、希腊字母和西里尔字母的混合。</p></li>
<li><p><strong>透明度支持：</strong> 参数 <em>opacity</em> 被支持。这为创建水印样式的文本提供了便捷方式。</p></li>
<li><p><strong>对齐文本：</strong> 支持任何字体——不仅仅是 <a class="reference internal" href="page.html#Page.insert_textbox" title="Page.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_textbox()</span></code></a> 中的简单字体。</p></li>
<li><p><strong>可重用性：</strong> TextWriter 对象独立于 PDF 页面存在。它可以多次写入，无论是到相同页面还是其他页面，选择不同的颜色或透明度。</p></li>
</ul>
<p>使用此对象涉及三个步骤：</p>
<ol class="arabic simple">
<li><p>在 <strong>创建</strong> 时，TextWriter 需要一个固定的 <strong>页面矩形</strong>，并基于该矩形计算文本位置。TextWriter 仅能写入该大小的页面。</p></li>
<li><p>使用 <a class="reference internal" href="#TextWriter.append" title="TextWriter.append"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.append()</span></code></a>、<a class="reference internal" href="#TextWriter.appendv" title="TextWriter.appendv"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.appendv()</span></code></a> 和 <a class="reference internal" href="#TextWriter.fill_textbox" title="TextWriter.fill_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.fill_textbox()</span></code></a> 方法存储文本，按需多次存储。</p></li>
<li><p>在某些 PDF 页面上输出 TextWriter 对象。</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ul class="simple">
<li><p>从 v1.17.0 开始，TextWriters <strong>支持</strong> 通过 <a class="reference internal" href="#TextWriter.write_text" title="TextWriter.write_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.write_text()</span></code></a> 的 <em>morph</em> 参数旋转文本。</p></li>
<li><p>还有 <a class="reference internal" href="page.html#Page.write_text" title="Page.write_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.write_text()</span></code></a> 方法，它将一个或多个 TextWriter 组合并将它们联合写入给定矩形和旋转角度——类似于 <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a>。</p></li>
</ul>
</div>
<p><strong>类 API</strong></p>
<dl class="py class">
<dt class="sig sig-object py" id="TextWriter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TextWriter</span></span><a class="headerlink" href="#TextWriter" title="永久链接至目标">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="TextWriter.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TextWriter.__init__" title="永久链接至目标">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rect</strong> (<em>rect-like</em>) – 内部用于文本定位计算的矩形。</p></li>
<li><p><strong>opacity</strong> (<em>float</em>) – 设置文本透明度。值应在 <code class="xref any docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1)</span></code> 区间外的将被忽略。例如，0.5 代表 50% 的透明度。</p></li>
<li><p><strong>color</strong> (<em>float</em><em>,</em><em>sequ</em>) – 文本的颜色。所有颜色都通过浮动值指定，范围 <em>0 &lt;= color &lt;= 1</em>。单个浮动值表示灰度级，序列表示色彩空间通过其长度。</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TextWriter.append">
<span class="sig-name descname"><span class="pre">append</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">language</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_to_left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small_caps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TextWriter.append" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p><em>在 v1.18.9 中更改</em></p></li>
<li><p><em>在 v1.18.15 中更改</em></p></li>
</ul>
<p>以水平写入模式添加新的文本。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>point_like</em>) – 文本的起始位置，即第一个字符的左下角。</p></li>
<li><p><strong>text</strong> (<em>str</em>) – 任意长度的字符串。文本将从位置 “pos” 开始写入。</p></li>
<li><p><strong>font</strong> – 一个 <a class="reference internal" href="font.html#font"><span class="std std-ref">Font</span></a> 对象。如果省略，使用 <code class="xref any docutils literal notranslate"><span class="pre">pymupdf.Font(&quot;helv&quot;)</span></code>。</p></li>
<li><p><strong>fontsize</strong> (<em>float</em>) – <a class="reference internal" href="glossary.html#fontsize" title="fontsize"><code class="xref py py-data docutils literal notranslate"><span class="pre">fontsize</span></code></a>，正数，默认为 11。</p></li>
<li><p><strong>language</strong> (<em>str</em>) – 使用的语言，例如 “en” 表示英文。有效值应符合 ISO 639 标准 1、2、3 或 5。预留待用：目前没有效果。</p></li>
<li><p><strong>right_to_left</strong> (<em>bool</em>) – <em>(在 v1.18.9 中新增)</em> 是否按从右到左的顺序写入文本。适用于阿拉伯语或希伯来语等语言。默认为 <em>False</em>。若为 <em>True</em>，文本中的任何拉丁部分将自动转换。没有其他效果，即 <a class="reference internal" href="#TextWriter.last_point" title="TextWriter.last_point"><code class="xref py py-attr docutils literal notranslate"><span class="pre">TextWriter.last_point</span></code></a> 仍然是最右边的字符，并且不会进行对齐。因此，您可能需要使用 <a class="reference internal" href="#TextWriter.fill_textbox" title="TextWriter.fill_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.fill_textbox()</span></code></a> 代替。</p></li>
<li><p><strong>small_caps</strong> (<em>bool</em>) – <p><em>(在 v1.18.15 中新增)</em> 如果字体中有小型大写字母，则使用该字形。否则将使用原始字符（该字体或回退字体）。回退字体永远不会返回小型大写字母。例如，以下代码片段:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">new_page</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;PyMuPDF: the Python bindings for MuPDF&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">font</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="s2">&quot;figo&quot;</span><span class="p">)</span>  <span class="c1"># 选择带小型大写字母的字体</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tw</span> <span class="o">=</span> <span class="n">pymupdf</span><span class="o">.</span><span class="n">TextWriter</span><span class="p">(</span><span class="n">page</span><span class="o">.</span><span class="n">rect</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tw</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span> <span class="n">text</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">,</span> <span class="n">small_caps</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tw</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">page</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">ez_save</span><span class="p">(</span><span class="s2">&quot;x.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>将生成以下 PDF 文本：</p>
<img alt="_images/img-smallcaps.jpg" src="_images/img-smallcaps.jpg" /></p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#TextWriter.text_rect" title="TextWriter.text_rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">text_rect</span></code></a> 和 <a class="reference internal" href="#TextWriter.last_point" title="TextWriter.last_point"><code class="xref py py-attr docutils literal notranslate"><span class="pre">last_point</span></code></a>。<em>(在 v1.18.0 中更改:)</em> 如果字体不支持，将引发异常——通过 <code class="xref py py-attr docutils literal notranslate"><span class="pre">Font.is_writable</span></code> 检查。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TextWriter.appendv">
<span class="sig-name descname"><span class="pre">appendv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">language</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small_caps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TextWriter.appendv" title="永久链接至目标">#</a></dt>
<dd><p><em>在 v1.18.15 中更改</em></p>
<p>以垂直、从上到下的写入模式添加新文本。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos</strong> (<em>point_like</em>) – 文本的起始位置，即第一个字符的左下角。</p></li>
<li><p><strong>text</strong> (<em>str</em>) – 一个字符串。它将从位置 “pos” 开始写入。</p></li>
<li><p><strong>font</strong> – 一个 <a class="reference internal" href="font.html#font"><span class="std std-ref">Font</span></a> 对象。如果省略，使用 <code class="xref any docutils literal notranslate"><span class="pre">pymupdf.Font(&quot;helv&quot;)</span></code>。</p></li>
<li><p><strong>fontsize</strong> (<em>float</em>) – <a class="reference internal" href="glossary.html#fontsize" title="fontsize"><code class="xref py py-data docutils literal notranslate"><span class="pre">fontsize</span></code></a>，正浮动数，默认为 11。</p></li>
<li><p><strong>language</strong> (<em>str</em>) – 使用的语言，例如 “en” 表示英文。有效值应符合 ISO 639 标准 1、2、3 或 5。预留待用：目前没有效果。</p></li>
<li><p><strong>small_caps</strong> (<em>bool</em>) – <em>(在 v1.18.15 中新增)</em> 见 <a class="reference internal" href="#TextWriter.append" title="TextWriter.append"><code class="xref py py-meth docutils literal notranslate"><span class="pre">append()</span></code></a>。</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#TextWriter.text_rect" title="TextWriter.text_rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">text_rect</span></code></a> 和 <a class="reference internal" href="#TextWriter.last_point" title="TextWriter.last_point"><code class="xref py py-attr docutils literal notranslate"><span class="pre">last_point</span></code></a>。<em>(在 v1.18.0 中更改:)</em> 如果字体不支持，将引发异常——通过 <code class="xref py py-attr docutils literal notranslate"><span class="pre">Font.is_writable</span></code> 检查。</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="TextWriter.fill_textbox">
<span class="sig-name descname"><span class="pre">fill_textbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_to_left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small_caps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TextWriter.fill_textbox" title="永久链接至目标">#</a></dt>
<dd><ul class="simple">
<li><p>在 v1.17.3 中更改: 新增 <code class="xref any docutils literal notranslate"><span class="pre">pos</span></code> 参数指定开始写入的矩形位置。</p></li>
<li><p>在 v1.18.9 中更改: 返回不适合矩形的行的列表。支持右到左写入（如阿拉伯文、希伯来文）。</p></li>
<li><p>在 v1.18.15 中更改: 如果字体支持，优先使用小型大写字母。</p></li>
</ul>
<p>以水平写入模式填充给定矩形中的文本。这是作为 <a class="reference internal" href="#TextWriter.append" title="TextWriter.append"><code class="xref py py-meth docutils literal notranslate"><span class="pre">append()</span></code></a> 的替代方法的便捷方法。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rect</strong> (<em>rect_like</em>) – 要填充的区域。文本不会超出此区域。</p></li>
<li><p><strong>text</strong> (<em>str</em><em>,</em><em>sequ</em>) – 文本。可以是（UTF-8）字符串或字符串的列表/元组。字符串将首先通过 <em>splitlines()</em> 转换为列表。每个列表项将从新的一行开始（强制换行）。</p></li>
<li><p><strong>pos</strong> (<em>point_like</em>) – <em>(v1.17.3 中新增)</em> 在此点开始存储。默认是在矩形的左上角附近。</p></li>
<li><p><strong>font</strong> – <a class="reference internal" href="font.html#font"><span class="std std-ref">Font</span></a>，默认为 <code class="xref any docutils literal notranslate"><span class="pre">pymupdf.Font(&quot;helv&quot;)</span></code>。</p></li>
<li><p><strong>fontsize</strong> (<em>float</em>) – <a class="reference internal" href="glossary.html#fontsize" title="fontsize"><code class="xref py py-data docutils literal notranslate"><span class="pre">fontsize</span></code></a>。</p></li>
<li><p><strong>align</strong> (<em>int</em>) – 文本对齐。使用 TEXT_ALIGN_LEFT、TEXT_ALIGN_CENTER、TEXT_ALIGN_RIGHT 或 TEXT_ALIGN_JUSTIFY。</p></li>
<li><p><strong>right_to_left</strong> (<em>bool</em>) – <em>(在 v1.18.9 中新增)</em> 是否按从右到左写入文本。适用于阿拉伯文或希伯来文等语言。默认为 <em>False</em>。如果为 <em>True</em>，任何拉丁部分将自动反转。你仍然需要设置对齐方式（如果你想要右对齐），它不会自动发生——其他对齐选项仍然可用。</p></li>
<li><p><strong>warn</strong> (<em>bool</em>) – 如果文本溢出，什么都不做、警告或引发异常。溢出的文本将不会写入。<strong>在 v1.18.9 中更改：</strong></p></li>
</ul>
</dd>
</dl>
<ul class="simple">
<li><p>默认值为 <em>None</em>。</p></li>
<li><p>将返回溢出的行列表。</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>small_caps</strong> (<em>bool</em>) – <em>(在 v1.18.15 中新增)</em> 见 <a class="reference internal" href="#TextWriter.append" title="TextWriter.append"><code class="xref py py-meth docutils literal notranslate"><span class="pre">append()</span></code></a>。</p>
</dd>
<dt class="field-even">返回类型<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
<dt class="field-odd">返回<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>在 v1.18.9 中新增</em>——未适配矩形的行的列表。每个项是一个元组 <code class="xref any docutils literal notranslate"><span class="pre">(text,</span> <span class="pre">length)</span></code>，其中包含字符串及其长度（在页面上）。</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">备注</p>
<p>按需多次使用这些方法——没有技术限制（除非系统的内存限制）。你也可以混合使用 <a class="reference internal" href="#TextWriter.append" title="TextWriter.append"><code class="xref py py-meth docutils literal notranslate"><span class="pre">append()</span></code></a> 和文本框，且可以同时使用两者。文本定位完全由插入点控制。因此，没有必要遵循任何顺序。<em>(在 v1.18.0 中更改:)</em> 如果字体不支持，将引发异常——通过 <code class="xref py py-attr docutils literal notranslate"><span class="pre">Font.is_writable</span></code> 检查。</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="TextWriter.write_text">
<span class="sig-name descname"><span class="pre">write_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">page</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">render_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#TextWriter.write_text" title="永久链接至目标">#</a></dt>
<dd><p>将 TextWriter 文本写入页面，页面是唯一必填参数。其他参数可用来临时覆盖创建 TextWriter 时使用的值。</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>page</strong> – 写入此 <a class="reference internal" href="page.html#page"><span class="std std-ref">Page</span></a>。</p></li>
<li><p><strong>opacity</strong> (<em>float</em>) – 覆盖 TextWriter 的透明度值。</p></li>
<li><p><strong>color</strong> (<em>sequ</em>) – 覆盖 TextWriter 的颜色值。</p></li>
<li><p><strong>morph</strong> (<em>sequ</em>) – 通过应用矩阵修改文本外观。如果提供，它必须是一个序列 <em>(fixpoint, matrix)</em>，其中 <em>fixpoint</em> 为类似点的值，<em>matrix</em> 为类似矩阵的值。一个典型示例是围绕 <em>fixpoint</em> 旋转文本。</p></li>
<li><p><strong>overlay</strong> (<em>bool</em>) – 放在前景（默认）还是背景。</p></li>
<li><p><strong>oc</strong> (<em>int</em>) – <em>(在 v1.18.4 中新增)</em> <a class="reference internal" href="glossary.html#xref" title="xref"><code class="xref py py-data docutils literal notranslate"><span class="pre">xref</span></code></a> 的 <a class="reference internal" href="glossary.html#OCG" title="OCG"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCG</span></code></a> 或 <a class="reference internal" href="glossary.html#OCMD" title="OCMD"><code class="xref py py-data docutils literal notranslate"><span class="pre">OCMD</span></code></a>。</p></li>
<li><p><strong>render_mode</strong> (<em>int</em>) – <p>PDF 的 <code class="xref any docutils literal notranslate"><span class="pre">Tr</span></code> 操作符值。值：0（默认）、1、2、3（不可见）。</p>
<img alt="_images/img-rendermode.jpg" src="_images/img-rendermode.jpg" /></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="TextWriter.text_rect">
<span class="sig-name descname"><span class="pre">text_rect</span></span><a class="headerlink" href="#TextWriter.text_rect" title="永久链接至目标">#</a></dt>
<dd><p>当前占用的区域。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="TextWriter.last_point">
<span class="sig-name descname"><span class="pre">last_point</span></span><a class="headerlink" href="#TextWriter.last_point" title="永久链接至目标">#</a></dt>
<dd><p>“光标位置”——一个 <a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a>，表示最后一个已写字符的底部右侧。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="point.html#point"><span class="std std-ref">Point</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="TextWriter.opacity">
<span class="sig-name descname"><span class="pre">opacity</span></span><a class="headerlink" href="#TextWriter.opacity" title="永久链接至目标">#</a></dt>
<dd><p>文本的透明度（可修改）。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="TextWriter.color">
<span class="sig-name descname"><span class="pre">color</span></span><a class="headerlink" href="#TextWriter.color" title="永久链接至目标">#</a></dt>
<dd><p>文本的颜色（可修改）。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p>float,tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="TextWriter.rect">
<span class="sig-name descname"><span class="pre">rect</span></span><a class="headerlink" href="#TextWriter.rect" title="永久链接至目标">#</a></dt>
<dd><p>此 TextWriter 创建的页面矩形。不得修改。</p>
<dl class="field-list simple">
<dt class="field-odd">返回类型<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="rect.html#rect"><span class="std std-ref">Rect</span></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="admonition note">
<p class="admonition-title">备注</p>
<p>要查看一些处理 TextWriter 的示例脚本，请查看 <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/textwriter">this</a> 仓库。</p>
</div>
<ol class="arabic simple">
<li><p>透明度和颜色适用于 <strong>此对象中的所有文本</strong>。</p></li>
<li><p>如果需要不同的颜色/透明度，必须创建一个单独的 TextWriter。每当您确定颜色应更改时，只需使用先前返回的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_point</span></code> 作为新文本跨度的位置，将文本附加到相应的 TextWriter 中。</p></li>
<li><p>项目或文本框的附加可以按任意顺序进行：只有位置参数控制文本出现的地方。</p></li>
<li><p>字体和 <a class="reference internal" href="glossary.html#fontsize" title="fontsize"><code class="xref py py-data docutils literal notranslate"><span class="pre">fontsize</span></code></a> 在同一 TextWriter 中可以自由变化。这可以让不同属性的文本出现在同一行上：只需相应地指定 <em>pos</em>，例如将其设置为先前添加项的 <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_point</span></code>。</p></li>
<li><p>您可以使用 <a class="reference internal" href="#TextWriter.fill_textbox" title="TextWriter.fill_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.fill_textbox()</span></code></a> 的 <em>pos</em> 参数设置第一个文本字符的位置。这允许从不同的 <a class="reference internal" href="#textwriter"><span class="std std-ref">TextWriter</span></a> 对象填充相同的文本框，从而允许使用多种颜色、透明度等。</p></li>
<li><p>MuPDF 不支持所有字体的此功能，例如不支持 Type3 字体。从 v1.18.0 开始，可以通过字体属性 <code class="xref py py-attr docutils literal notranslate"><span class="pre">Font.is_writable</span></code> 检查此问题。当使用 <a class="reference internal" href="#textwriter"><span class="std std-ref">TextWriter</span></a> 方法时，该属性也会被检查。</p></li>
</ol>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">英文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p>New in v1.16.18</p></li>
</ul>
<p>This class represents a MuPDF <em>text</em> object. The basic idea is to <strong>decouple (1) text preparation, and (2) text output</strong> to PDF pages.</p>
<p>During <strong>preparation</strong>, a text writer stores any number of text pieces (“spans”) together with their positions and individual font information. The <strong>output</strong> of the writer’s prepared content may happen multiple times to any PDF page with a compatible page size.</p>
<p>A text writer is an elegant alternative to methods <a class="reference internal" href="page.html#Page.insert_text" title="Page.insert_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_text()</span></code></a> and friends:</p>
<ul class="simple">
<li><p><strong>Improved text positioning:</strong> Choose any point where insertion of text should start. Storing text returns the “cursor position” after the <em>last character</em> of the span.</p></li>
<li><p><strong>Free font choice:</strong> Each text span has its own font and <a class="reference internal" href="glossary.html#fontsize" title="fontsize"><code class="xref py py-data docutils literal notranslate"><span class="pre">fontsize</span></code></a>. This lets you easily switch when composing a larger text.</p></li>
<li><p><strong>Automatic fallback fonts:</strong> If a character is not supported by the chosen font, alternative fonts are automatically searched. This significantly reduces the risk of seeing unprintable symbols in the output (“TOFUs” – looking like a small rectangle). PyMuPDF now also comes with the <strong>universal font “Droid Sans Fallback Regular”</strong>, which supports <strong>all Latin</strong> characters (including Cyrillic and Greek), and <strong>all CJK</strong> characters (Chinese, Japanese, Korean).</p></li>
<li><p><strong>Cyrillic and Greek Support:</strong> The <a class="reference internal" href="app3.html#base-14-fonts"><span class="std std-ref">PDF Base 14 字体</span></a> have integrated support of Cyrillic and Greek characters <strong>without specifying encoding.</strong> Your text may be a mixture of Latin, Greek and Cyrillic.</p></li>
<li><p><strong>Transparency support:</strong> Parameter <em>opacity</em> is supported. This offers a handy way to create watermark-style text.</p></li>
<li><p><strong>Justified text:</strong> Supported for any font – not just simple fonts as in <a class="reference internal" href="page.html#Page.insert_textbox" title="Page.insert_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.insert_textbox()</span></code></a>.</p></li>
<li><p><strong>Reusability:</strong> A TextWriter object exists independent from PDF pages. It can be written multiple times, either to the same or to other pages, in the same or in different PDFs, choosing different colors or transparency.</p></li>
</ul>
<p>Using this object entails three steps:</p>
<ol class="arabic simple">
<li><p>When <strong>created</strong>, a TextWriter requires a fixed <strong>page rectangle</strong> in relation to which it calculates text positions. A text writer can write to pages of this size only.</p></li>
<li><p>Store text in the TextWriter using methods <a class="reference internal" href="#TextWriter.append" title="TextWriter.append"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.append()</span></code></a>, <a class="reference internal" href="#TextWriter.appendv" title="TextWriter.appendv"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.appendv()</span></code></a> and <a class="reference internal" href="#TextWriter.fill_textbox" title="TextWriter.fill_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.fill_textbox()</span></code></a> as often as is desired.</p></li>
<li><p>Output the TextWriter object on some PDF page(s).</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">备注</p>
<ul class="simple">
<li><p>Starting with version 1.17.0, TextWriters <strong>do support</strong> text rotation via the <em>morph</em> parameter of <a class="reference internal" href="#TextWriter.write_text" title="TextWriter.write_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.write_text()</span></code></a>.</p></li>
<li><p>There also exists <a class="reference internal" href="page.html#Page.write_text" title="Page.write_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.write_text()</span></code></a> which combines one or more TextWriters and jointly writes them to a given rectangle and with a given rotation angle – much like <a class="reference internal" href="page.html#Page.show_pdf_page" title="Page.show_pdf_page"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.show_pdf_page()</span></code></a>.</p></li>
</ul>
</div>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Method / Attribute</strong></p></th>
<th class="head"><p><strong>Short Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#TextWriter.append" title="TextWriter.append"><code class="xref py py-meth docutils literal notranslate"><span class="pre">append()</span></code></a></p></td>
<td><p>Add text in horizontal write mode</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#TextWriter.appendv" title="TextWriter.appendv"><code class="xref py py-meth docutils literal notranslate"><span class="pre">appendv()</span></code></a></p></td>
<td><p>Add text in vertical write mode</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#TextWriter.fill_textbox" title="TextWriter.fill_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fill_textbox()</span></code></a></p></td>
<td><p>Fill rectangle (horizontal write mode)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#TextWriter.write_text" title="TextWriter.write_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write_text()</span></code></a></p></td>
<td><p>Output TextWriter to a PDF page</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#TextWriter.color" title="TextWriter.color"><code class="xref py py-attr docutils literal notranslate"><span class="pre">color</span></code></a></p></td>
<td><p>Text color (can be changed)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#TextWriter.last_point" title="TextWriter.last_point"><code class="xref py py-attr docutils literal notranslate"><span class="pre">last_point</span></code></a></p></td>
<td><p>Last written character ends here</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#TextWriter.opacity" title="TextWriter.opacity"><code class="xref py py-attr docutils literal notranslate"><span class="pre">opacity</span></code></a></p></td>
<td><p>Text opacity (can be changed)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#TextWriter.rect" title="TextWriter.rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">rect</span></code></a></p></td>
<td><p>Page rectangle used by this TextWriter</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#TextWriter.text_rect" title="TextWriter.text_rect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">text_rect</span></code></a></p></td>
<td><p>Area occupied so far</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Class API</strong></p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>To see some demo scripts dealing with TextWriter, have a look at <a class="reference external" href="https://github.com/pymupdf/PyMuPDF-Utilities/tree/master/textwriter">this</a> repository.</p>
</div>
<ol class="arabic simple">
<li><p>Opacity and color apply to <strong>all the text</strong> in this object.</p></li>
<li><p>If you need different colors / transparency, you must create a separate TextWriter. Whenever you determine the color should change, simply append the text to the respective TextWriter using the previously returned <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_point</span></code> as position for the new text span.</p></li>
<li><p>Appending items or text boxes can occur in arbitrary order: only the position parameter controls where text appears.</p></li>
<li><p>Font and <a class="reference internal" href="glossary.html#fontsize" title="fontsize"><code class="xref py py-data docutils literal notranslate"><span class="pre">fontsize</span></code></a> can freely vary within the same TextWriter. This can be used to let text with different properties appear on the same displayed line: just specify <em>pos</em> accordingly, and e.g. set it to <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_point</span></code> of the previously added item.</p></li>
<li><p>You can use the <em>pos</em> argument of <a class="reference internal" href="#TextWriter.fill_textbox" title="TextWriter.fill_textbox"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TextWriter.fill_textbox()</span></code></a> to set the position of the first text character. This allows filling the same textbox with contents from different <a class="reference internal" href="#textwriter"><span class="std std-ref">TextWriter</span></a> objects, thus allowing for multiple colors, opacities, etc.</p></li>
<li><p>MuPDF does not support all fonts with this feature, e.g. no Type3 fonts. Starting with v1.18.0 this can be checked via the font attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">Font.is_writable</span></code>. This attribute is also checked when using <a class="reference internal" href="#textwriter"><span class="std std-ref">TextWriter</span></a> methods.</p></li>
</ol>
</div>
</div>
<div class="feedbackLink"><a id="feedbackLinkBottom" target=_blank>您对此页面有任何反馈吗？</b></a></div><hr class="docutils" />
<script>

   var url_string = window.location.href;
   var a = document.getElementById('feedbackLinkBottom');
   a.setAttribute("href", "https://artifex.com/contributor/feedback.php?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link&url="+url_string);

</script>

<p style="color:#999" id="footerDisclaimer">本软件按原样提供，不作任何明示或暗示担保。本软件根据许可分发，除非根据该许可条款明确授权，否则不得复制、修改或分发。请参阅 <a href="https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link">artifex.com</a> 上的许可信息，或联系 Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States 了解更多信息。</p>



<script>

   let docLanguage = document.getElementsByTagName('html')[0].getAttribute('lang');

   function getHeaderAndFooterTranslation(str) {
       if (docLanguage == "ja") {
           if (str == "Do you have any feedback on this page?") {
               return "このページに関するご意見はありますか？";
           } else if (str == "Find <b>#pymupdf</b> on <b>Discord</b>") {
               return "<b>Discord</b>の <b>#pymupdf</b> を見つける";
           } else if (str == "This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.") {

               return "このソフトウェアは無保証で提供されており、明示または黙示を問わず、いかなる保証もありません。このソフトウェアはライセンスの下で配布され、ライセンスの条件に明示的に許可されている場合を除き、コピー、変更、または配布してはなりません。ライセンシング情報については、<a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a>でライセンス情報を参照するか、アメリカ合衆国カリフォルニア州サンフランシスコのArtifex Software Inc. までお問い合わせください。"

           }
       }

       return str;
   }

   document.getElementById("findOnDiscord").innerHTML = getHeaderAndFooterTranslation("Find <b>#pymupdf</b> on <b>Discord</b>");
   document.getElementById("feedbackLinkTop").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("feedbackLinkBottom").innerHTML = getHeaderAndFooterTranslation("Do you have any feedback on this page?");
   document.getElementById("footerDisclaimer").innerHTML = getHeaderAndFooterTranslation("This software is provided AS-IS with no warranty, either express or implied. This software is distributed under license and may not be copied, modified or distributed except as expressly authorized under the terms of that license. Refer to licensing information at <a href='https://www.artifex.com?utm_source=rtd-pymupdf&utm_medium=rtd&utm_content=footer-link'>artifex.com</a> or contact Artifex Software Inc., 39 Mesa Street, Suite 108A, San Francisco CA 94129, United States for further information.");


   // more translation for admonition-title as the in-built translation isn't great, needs: 注釈 -> 注
   if (docLanguage == "ja") {
       const collection = document.getElementsByClassName("admonition-title");
       for (var i=0;i<collection.length;i++) {
           collection[i].innerHTML = "注";
       }
   }


</script><p class="footer-version">This documentation covers all versions up to 1.25.4.</p>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="tools.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Tools</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="textpage.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">TextPage</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2015-2025, Artifex
            </div>
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 19. 3月 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">TextWriter</a><ul>
<li><a class="reference internal" href="#TextWriter"><code class="docutils literal notranslate"><span class="pre">TextWriter</span></code></a><ul>
<li><a class="reference internal" href="#TextWriter.__init__"><code class="docutils literal notranslate"><span class="pre">TextWriter.__init__()</span></code></a></li>
<li><a class="reference internal" href="#TextWriter.append"><code class="docutils literal notranslate"><span class="pre">TextWriter.append()</span></code></a></li>
<li><a class="reference internal" href="#TextWriter.appendv"><code class="docutils literal notranslate"><span class="pre">TextWriter.appendv()</span></code></a></li>
<li><a class="reference internal" href="#TextWriter.fill_textbox"><code class="docutils literal notranslate"><span class="pre">TextWriter.fill_textbox()</span></code></a></li>
<li><a class="reference internal" href="#TextWriter.write_text"><code class="docutils literal notranslate"><span class="pre">TextWriter.write_text()</span></code></a></li>
<li><a class="reference internal" href="#TextWriter.text_rect"><code class="docutils literal notranslate"><span class="pre">TextWriter.text_rect</span></code></a></li>
<li><a class="reference internal" href="#TextWriter.last_point"><code class="docutils literal notranslate"><span class="pre">TextWriter.last_point</span></code></a></li>
<li><a class="reference internal" href="#TextWriter.opacity"><code class="docutils literal notranslate"><span class="pre">TextWriter.opacity</span></code></a></li>
<li><a class="reference internal" href="#TextWriter.color"><code class="docutils literal notranslate"><span class="pre">TextWriter.color</span></code></a></li>
<li><a class="reference internal" href="#TextWriter.rect"><code class="docutils literal notranslate"><span class="pre">TextWriter.rect</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/tabs.js"></script>
    <script src="_static/translations.js"></script>
    </body>
</html>